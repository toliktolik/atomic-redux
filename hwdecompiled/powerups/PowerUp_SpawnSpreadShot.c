/*
 * Function: PowerUp_SpawnSpreadShot
 * Address: 00488b50
 * Category: powerups
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


uint __thiscall
PowerUp_SpawnSpreadShot(void *this,int param_1,int param_2,char param_3,int *param_4)

{
  _String_base _Var1;
  bool bVar2;
  char *pcVar3;
  void **ppvVar4;
  undefined3 uVar10;
  undefined4 *puVar5;
  int *piVar6;
  uint uVar7;
  char *pcVar8;
  int iVar9;
  int iVar11;
  int extraout_ECX;
  int extraout_ECX_00;
  uint extraout_EDX;
  uint extraout_EDX_00;
  int *piVar12;
  undefined8 uVar13;
  undefined1 local_58 [28];
  undefined1 local_3c [4];
  uint local_38;
  undefined4 local_28;
  uint local_24;
  int local_20;
  void *local_1c;
  int *local_18;
  char local_13;
  bool local_12;
  bool local_11;
  void *local_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_00514f73;
  local_10 = ExceptionList;
  local_1c = this;
  local_11 = false;
  local_12 = false;
  local_13 = '\0';
  local_18 = (int *)0x0;
  local_20 = 0;
  piVar12 = param_4;
  if (param_4 == (int *)0x0) {
    piVar12 = &local_20;
  }
  iVar9 = *(int *)(param_1 + 0x14);
  ExceptionList = &local_10;
  ppvVar4 = &local_10;
  if (*piVar12 < iVar9) {
    do {
      iVar9 = *piVar12;
      *piVar12 = iVar9 + 1;
      if (*(uint *)(param_1 + 0x18) < 0x10) {
        iVar11 = param_1 + 4;
      }
      else {
        iVar11 = *(int *)(param_1 + 4);
      }
      _Var1 = *(_String_base *)(iVar11 + iVar9);
      uVar10 = (undefined3)((uint)iVar9 >> 8);
      if ((((_Var1 == (_String_base)0x20) || (_Var1 == (_String_base)0x9)) ||
          (_Var1 == (_String_base)0xa)) || (_Var1 == (_String_base)0x2c)) {
        bVar2 = true;
      }
      else {
        bVar2 = false;
      }
      if (local_13 != '\0') {
        local_13 = '\0';
        goto LAB_00488bdc;
      }
      if (_Var1 != (_String_base)0x27) {
        if (_Var1 == (_String_base)0x22) {
          if (local_11 != false) goto LAB_00488bdc;
          local_12 = local_12 == false;
          goto LAB_00488c22;
        }
        if (_Var1 != (_String_base)0x5c) goto LAB_00488c1b;
        local_13 = '\x01';
        goto LAB_00488cff;
      }
      if (local_12 == false) {
        local_11 = local_11 == false;
      }
LAB_00488c1b:
      if (local_11 == false) {
LAB_00488c22:
        if (local_12 != false) goto LAB_00488bdc;
        if (_Var1 == (_String_base)0x29) {
          if (param_3 != '\0') goto LAB_00488ea5;
          Level_InitializeDictastroika(local_3c,"Unexpected List End");
          local_8 = 0;
          uVar13 = D3D_SetViewport(local_1c,(int)local_3c);
          uVar7 = (uint)uVar13;
          if (0xf < local_24) {
                    /* WARNING: Subroutine does not return */
            System_ShutdownHandler(local_38,(uint)((ulonglong)uVar13 >> 0x20));
          }
          goto LAB_00488d47;
        }
        if (_Var1 == (_String_base)0x28) {
          if (local_18 != (int *)0x0) {
            local_24 = 0xf;
            local_28 = 0;
            local_38 = local_38 & 0xffffff00;
            pcVar3 = "Unexpected List Start";
            do {
              pcVar8 = pcVar3;
              pcVar3 = pcVar8 + 1;
            } while (*pcVar8 != '\0');
            String_Assign(local_3c,(_String_base *)"Unexpected List Start",
                          (uint)(pcVar8 + -0x533a28));
            local_8 = 1;
            uVar13 = D3D_SetViewport(local_1c,(int)local_3c);
            uVar7 = (uint)uVar13;
            if (0xf < local_24) {
                    /* WARNING: Subroutine does not return */
              System_ShutdownHandler(extraout_ECX_00,(uint)((ulonglong)uVar13 >> 0x20));
            }
            goto LAB_00488d47;
          }
          param_4 = (int *)operator_new(0x18);
          local_8 = 2;
          if (param_4 == (int *)0x0) {
            piVar6 = (int *)0x0;
          }
          else {
            piVar6 = Registry_QueryValue(param_4);
          }
          local_8 = 0xffffffff;
          uVar7 = PowerUp_SpawnSpreadShot(local_1c,param_1,(int)piVar6,'\x01',piVar12);
          if ((char)uVar7 == '\0') goto LAB_00488e90;
          param_4 = piVar6;
          SexyFramework_HandleInput((void *)(param_2 + 8),&param_4);
        }
        else {
          if (!bVar2) goto LAB_00488bdc;
          if (local_18 != (int *)0x0) {
            local_18 = (int *)0x0;
          }
        }
      }
      else {
LAB_00488bdc:
        if (local_18 == (int *)0x0) {
          puVar5 = (undefined4 *)operator_new(0x24);
          if (puVar5 == (undefined4 *)0x0) {
            param_4 = (int *)0x0;
          }
          else {
            param_4 = System_ProcessTimerEvents(puVar5);
          }
          local_18 = param_4;
          SexyFramework_HandleInput((void *)(param_2 + 8),&param_4);
        }
        Memory_AllocateSound((_String_base *)(local_18 + 2),1,_Var1);
      }
LAB_00488cff:
    } while (*piVar12 < *(int *)(param_1 + 0x14));
    if (local_11 != false) {
      Level_InitializeDictastroika(local_3c,"Unterminated Single Quotes");
      local_8 = 3;
      uVar7 = D3D_SetViewport(local_1c,(int)local_3c);
      if (0xf < local_24) {
                    /* WARNING: Subroutine does not return */
        System_ShutdownHandler(extraout_ECX,local_38);
      }
LAB_00488d47:
      ExceptionList = local_10;
      return uVar7 & 0xffffff00;
    }
    iVar9 = CONCAT31((int3)((uint)*(int *)(param_1 + 0x14) >> 8),local_12);
    ppvVar4 = (void **)ExceptionList;
    if (local_12 != false) {
      Level_InitializeDictastroika(local_3c,"Unterminated Double Quotes");
      local_8 = 4;
      D3D_SetViewport(local_1c,(int)local_3c);
      uVar7 = String_Destructor((int)local_3c,extraout_EDX);
      ExceptionList = local_10;
      return uVar7 & 0xffffff00;
    }
  }
  ExceptionList = ppvVar4;
  uVar10 = (undefined3)((uint)iVar9 >> 8);
  if (param_3 != '\0') {
    Level_InitializeDictastroika(local_58,"Unterminated List");
    local_8 = 5;
    D3D_SetViewport(local_1c,(int)local_58);
    uVar7 = String_Destructor((int)local_58,extraout_EDX_00);
LAB_00488e90:
    ExceptionList = local_10;
    return uVar7 & 0xffffff00;
  }
LAB_00488ea5:
  ExceptionList = local_10;
  return CONCAT31(uVar10,1);
}


