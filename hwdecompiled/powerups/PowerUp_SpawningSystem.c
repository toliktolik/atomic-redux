/*
 * Function: PowerUp_SpawningSystem
 * Address: 00419eb0
 * Category: powerups
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

int __fastcall PowerUp_SpawningSystem(int param_1)

{
  float fVar1;
  double dVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  void *pvVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int *piVar10;
  uint local_14;
  void *local_10;
  undefined4 uStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  uStack_c = 0x5108bb;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar3 = GetBossIndex(*(void **)(param_1 + 0x5c),*(int *)((int)*(void **)(param_1 + 0x5c) + 0x960))
  ;
  iVar8 = 0;
  do {
    iVar4 = *(int *)(param_1 + 0x314 + iVar8 * 4);
    if (iVar4 == 0) {
      iVar9 = iVar3 * 0x10;
      iVar4 = *(int *)(*(int *)(param_1 + 0x5c) + 0x147c);
      iVar7 = *(int *)(iVar9 + 4 + iVar4);
      if (iVar7 != 0) {
        iVar7 = *(int *)(iVar9 + 8 + iVar4) - iVar7;
        iVar4 = iVar7 * 0x66666667;
        if ((iVar7 / 0x50 != 0) &&
           ((*(int *)(param_1 + 0x17c) < *(int *)(param_1 + 0x184) + -2000 ||
            (iVar4 = CONCAT31((int3)((uint)*(int *)(param_1 + 0x17c) >> 8),
                              *(char *)(param_1 + 0x327)), *(char *)(param_1 + 0x327) != '\0')))) {
          iVar7 = Collision_HandleEnemyHit();
          iVar4 = iVar7 / 200;
          if (iVar7 % 200 == 0) {
            iVar4 = *(int *)(*(int *)(param_1 + 0x5c) + 0x147c);
            iVar7 = *(int *)(iVar9 + 4 + iVar4);
            if (iVar7 == 0) {
              local_14 = 0;
            }
            else {
              local_14 = (*(int *)(iVar9 + 8 + iVar4) - iVar7) / 0x50;
            }
            iVar4 = *(int *)(*(int *)(param_1 + 0x5c) + 0x147c);
            uVar5 = Collision_HandleEnemyHit();
            iVar4 = *(int *)(iVar9 + 4 + iVar4);
            piVar10 = (int *)((uVar5 % local_14) * 0x50 + iVar4);
            iVar4 = CONCAT31((int3)((uint)iVar4 >> 8),(char)piVar10[0x13]);
            if ((char)piVar10[0x13] != '\0') {
              iVar7 = Collision_HandleEnemyHit();
              iVar4 = iVar7 / 0x14;
              if (iVar7 % 0x14 != 0) goto LAB_0041a13c;
            }
            if (piVar10[4] == iVar8) {
              pvVar6 = operator_new(0x50);
              if (pvVar6 == (void *)0x0) {
                pvVar6 = (void *)0x0;
              }
              else {
                *(undefined4 *)((int)pvVar6 + 0x38) = 0;
                *(undefined4 *)((int)pvVar6 + 0x3c) = 0;
                *(undefined4 *)((int)pvVar6 + 0x40) = 0;
              }
              *(void **)(param_1 + 0x314 + iVar8 * 4) = pvVar6;
              *(undefined4 *)((int)pvVar6 + 8) = 0;
              *(undefined4 *)((int)pvVar6 + 0xc) = 0;
              local_8 = 0xffffffff;
              local_14 = 0;
              if (0 < *(int *)(*piVar10 + 0x18)) {
                do {
                  Vector_PushBack_8ByteObjects
                            ((void *)(*(int *)(param_1 + 0x314 + iVar8 * 4) + 0x34),
                             (undefined4 *)(piVar10[0xe] + local_14 * 8));
                  local_14 = local_14 + 1;
                } while ((int)local_14 < *(int *)(*piVar10 + 0x18));
              }
              iVar4 = *(int *)(param_1 + 0x314 + iVar8 * 4);
              *(int *)(iVar4 + 0x28) = piVar10[10];
              *(int *)(iVar4 + 0x2c) = piVar10[0xb];
              *(undefined1 *)(*(int *)(param_1 + 0x314 + iVar8 * 4) + 0x31) = 0;
              *(char *)(*(int *)(param_1 + 0x314 + iVar8 * 4) + 0x30) = (char)piVar10[0xc];
              *(char *)(*(int *)(param_1 + 0x314 + iVar8 * 4) + 0x4c) = (char)piVar10[0x13];
              *(int *)(*(int *)(param_1 + 0x314 + iVar8 * 4) + 0x10) = piVar10[4];
              **(int **)(param_1 + 0x314 + iVar8 * 4) = *piVar10;
              iVar4 = *(int *)(param_1 + 0x314 + iVar8 * 4);
              *(int *)(iVar4 + 0x18) = piVar10[6];
              *(int *)(iVar4 + 0x1c) = piVar10[7];
              *(int *)(*(int *)(param_1 + 0x314 + iVar8 * 4) + 0x20) = piVar10[8];
              *(undefined4 *)(*(int *)(param_1 + 0x314 + iVar8 * 4) + 0x44) = 1;
              iVar4 = piVar10[0x12];
              *(int *)(*(int *)(param_1 + 0x314 + iVar8 * 4) + 0x48) = iVar4;
              if (iVar8 == 1) {
                iVar4 = *(int *)(param_1 + 0x318);
                fVar1 = *(float *)(param_1 + 0x74);
LAB_0041a0f0:
                *(double *)(iVar4 + 0x18) = (double)(fVar1 + (float)*(double *)(iVar4 + 0x18));
              }
              else if (iVar8 == 2) {
                iVar4 = *(int *)(param_1 + 0x31c);
                fVar1 = *(float *)(param_1 + 0x78);
                goto LAB_0041a0f0;
              }
              iVar7 = *(int *)(param_1 + 0x314 + iVar8 * 4);
              if (*(double *)(iVar7 + 0x18) < _DAT_0052c950 !=
                  (NAN(*(double *)(iVar7 + 0x18)) || NAN(_DAT_0052c950))) {
                *(double *)(iVar7 + 0x18) = *(double *)(iVar7 + 0x18) + _DAT_0052c948;
              }
              iVar7 = *(int *)(param_1 + 0x314 + iVar8 * 4);
              dVar2 = *(double *)(iVar7 + 0x18);
              iVar4 = CONCAT22((short)((uint)iVar4 >> 0x10),
                               (ushort)(dVar2 < _DAT_0052c950) << 8 |
                               (ushort)(NAN(dVar2) || NAN(_DAT_0052c950)) << 10 |
                               (ushort)(dVar2 == _DAT_0052c950) << 0xe);
              if (dVar2 < _DAT_0052c950 != (NAN(dVar2) || NAN(_DAT_0052c950))) {
                *(double *)(iVar7 + 0x18) = *(double *)(iVar7 + 0x18) + _DAT_0052c948;
              }
            }
          }
        }
      }
    }
LAB_0041a13c:
    iVar8 = iVar8 + 1;
    if (3 < iVar8) {
      ExceptionList = local_10;
      return iVar4;
    }
  } while( true );
}


