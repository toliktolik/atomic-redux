/*
 * Function: Boss_ProcessHeadAttack
 * Address: 004061f0
 * Category: bosses
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __thiscall
Boss_ProcessHeadAttack(void *this,undefined4 *param_1,undefined4 *param_2,undefined4 *param_3)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  undefined4 *puVar8;
  undefined4 *unaff_ESI;
  undefined4 *puVar9;
  undefined4 *unaff_EDI;
  uint unaff_retaddr;
  undefined4 local_78 [24];
  uint local_18;
  undefined1 *local_14;
  void *local_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  puVar8 = param_2;
  puVar1 = param_1;
  local_8 = 0xffffffff;
  puStack_c = &DAT_0050f790;
  local_10 = ExceptionList;
  local_18 = DAT_00569f5c ^ unaff_retaddr;
  local_14 = &stack0xffffff7c;
  puVar9 = param_3;
  puVar2 = local_78;
  for (iVar4 = 0x18; iVar4 != 0; iVar4 = iVar4 + -1) {
    *puVar2 = *puVar9;
    puVar9 = puVar9 + 1;
    puVar2 = puVar2 + 1;
  }
  iVar4 = *(int *)((int)this + 4);
  if (iVar4 == 0) {
    uVar5 = 0;
  }
  else {
    uVar5 = (*(int *)((int)this + 0xc) - iVar4) / 0x60;
  }
  if (param_2 != (undefined4 *)0x0) {
    if (iVar4 == 0) {
      iVar6 = 0;
    }
    else {
      iVar6 = (*(int *)((int)this + 8) - iVar4) / 0x60;
    }
    if ((undefined4 *)(0x2aaaaaaU - iVar6) < param_2) {
      ExceptionList = &local_10;
      local_14 = &stack0xffffff7c;
      Level_InitializeVodkavania();
    }
    else {
      if (iVar4 == 0) {
        iVar6 = 0;
      }
      else {
        iVar6 = (*(int *)((int)this + 8) - iVar4) / 0x60;
      }
      if (uVar5 < (uint)(iVar6 + (int)param_2)) {
        if (0x2aaaaaa - (uVar5 >> 1) < uVar5) {
          uVar5 = 0;
        }
        else {
          uVar5 = uVar5 + (uVar5 >> 1);
        }
        if (iVar4 == 0) {
          iVar4 = 0;
        }
        else {
          iVar4 = (*(int *)((int)this + 8) - iVar4) / 0x60;
        }
        ExceptionList = &local_10;
        local_14 = &stack0xffffff7c;
        if (uVar5 < (uint)(iVar4 + (int)param_2)) {
          ExceptionList = &local_10;
          local_14 = &stack0xffffff7c;
          iVar4 = Vector_Size_96ByteObjects((int)this);
          uVar5 = iVar4 + (int)puVar8;
        }
        param_3 = (undefined4 *)operator_new(uVar5 * 0x60);
        local_8 = 0;
        param_2 = (undefined4 *)
                  MemoryCopy_Forward_96ByteObjects(*(undefined4 **)((int)this + 4),param_1,param_3);
        Vector_Clear_4ByteObjects(param_2,(int)puVar8,local_78);
        MemoryCopy_Forward_96ByteObjects
                  (param_1,*(undefined4 **)((int)this + 8),param_2 + (int)puVar8 * 0x18);
        iVar4 = *(int *)((int)this + 4);
        if (iVar4 == 0) {
          uVar7 = 0;
        }
        else {
          uVar7 = (*(int *)((int)this + 8) - iVar4) / 0x60;
        }
        if (iVar4 != 0) {
                    /* WARNING: Subroutine does not return */
          System_ShutdownHandler(iVar4,uVar7);
        }
        *(undefined4 **)((int)this + 0xc) = param_3 + uVar5 * 0x18;
        *(undefined4 **)((int)this + 8) = param_3 + ((int)puVar8 + uVar7) * 0x18;
        *(undefined4 **)((int)this + 4) = param_3;
      }
      else {
        param_3 = *(undefined4 **)((int)this + 8);
        if ((undefined4 *)(((int)param_3 - (int)param_1) / 0x60) < param_2) {
          puVar2 = (undefined4 *)((int)param_2 * 0x60 + (int)param_1);
          ExceptionList = &local_10;
          param_1 = (undefined4 *)((int)param_2 * 0x60);
          puVar9 = param_3;
          param_3 = (undefined4 *)&stack0xffffff70;
          local_14 = &stack0xffffff7c;
          PowerUp_ProcessHomingMissiles(puVar1,puVar9,puVar2);
          local_8 = 2;
          Enemy_ProcessTankLogic
                    (*(undefined4 **)((int)this + 8),
                     (int)puVar8 - ((int)*(undefined4 **)((int)this + 8) - (int)puVar1) / 0x60,
                     local_78);
          iVar4 = *(int *)((int)this + 8) + (int)param_1;
          *(int *)((int)this + 8) = iVar4;
          puVar8 = (undefined4 *)(iVar4 - (int)param_1);
        }
        else {
          param_1 = param_3 + (int)param_2 * -0x18;
          ExceptionList = &local_10;
          local_14 = &stack0xffffff7c;
          uVar3 = PowerUp_ProcessHomingMissiles(param_1,param_3,param_3);
          puVar2 = param_3;
          puVar9 = param_1;
          param_2 = (undefined4 *)&stack0xffffff78;
          *(undefined4 *)((int)this + 8) = uVar3;
          param_3 = (undefined4 *)&stack0xffffff74;
          param_1 = (undefined4 *)&stack0xffffff70;
          MemoryCopy_Backward_96ByteObjects_Wrapper(&param_1,puVar1,puVar9,puVar2);
          puVar8 = puVar1 + (int)puVar8 * 0x18;
        }
        param_1 = (undefined4 *)&stack0xffffff70;
        MemoryFill_96ByteObjects(puVar1,puVar8,local_78);
      }
    }
  }
  ExceptionList = local_10;
  Exception_SetMessage((void *)(local_18 ^ unaff_retaddr),unaff_EDI,unaff_ESI);
  return;
}


