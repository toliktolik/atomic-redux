/*
 * Function: UI_ProcessButtonEvents
 * Address: 004178a0
 * Category: ui
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl
UI_ProcessButtonEvents
          (uint *param_1,uint param_2,byte *param_3,void *param_4,undefined4 param_5,byte *param_6,
          uint param_7)

{
  byte *pbVar1;
  byte bVar2;
  char cVar3;
  byte *pbVar4;
  byte *pbVar5;
  undefined1 uVar6;
  locale *plVar7;
  facet *this;
  uint uVar8;
  size_t sVar9;
  char *pcVar10;
  undefined4 *puVar11;
  uint uVar12;
  int iVar13;
  size_t sVar14;
  byte *pbVar15;
  uint unaff_retaddr;
  undefined4 *in_stack_ffffffb4;
  char *in_stack_ffffffb8;
  uint local_34;
  uint local_30;
  byte *local_2c;
  uint local_28;
  uint local_24;
  byte *local_20;
  int local_1c;
  bool local_15;
  uint local_14;
  void *local_10;
  undefined4 uStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  uStack_c = 0x510600;
  local_10 = ExceptionList;
  local_14 = DAT_00569f5c ^ unaff_retaddr;
  bVar2 = *param_6;
  if ((bVar2 == 0x2b) || (bVar2 == 0x2d)) {
    local_20 = (byte *)0x1;
  }
  else if ((bVar2 == 0x30) && ((param_6[1] == 0x78 || (param_6[1] == 0x58)))) {
    local_20 = (byte *)0x2;
  }
  else {
    local_20 = (byte *)0x0;
  }
  ExceptionList = &local_10;
  plVar7 = (locale *)SexyWidget_ProcessInput(param_4,(int *)&local_28);
  local_8 = 0;
  this = Renderer_SetModelViewMatrix(plVar7);
  uVar12 = local_28;
  local_8 = 0xffffffff;
  if (local_28 != 0) {
    Threading_LockSectorByIndex(&local_1c,0);
    iVar13 = *(int *)(uVar12 + 4);
    if ((iVar13 != 0) && (iVar13 != -1)) {
      *(int *)(uVar12 + 4) = iVar13 + -1;
    }
    puVar11 = (undefined4 *)(~-(uint)(*(int *)(uVar12 + 4) != 0) & uVar12);
    Threading_UnlockSectorByIndex(&local_1c);
    if (puVar11 != (undefined4 *)0x0) {
      (**(code **)*puVar11)(1);
    }
  }
  UI_ProcessTextInput(this,&stack0xffffffb4);
  local_8 = 1;
  uVar6 = (**(code **)(*(int *)this + 8))();
  local_28 = CONCAT31(local_28._1_3_,uVar6);
  pcVar10 = in_stack_ffffffb8;
  if (local_34 < 0x10) {
    pcVar10 = &stack0xffffffb8;
  }
  local_15 = '\0' < *pcVar10;
  if ('\0' < *pcVar10) {
    pcVar10 = in_stack_ffffffb8;
    if (local_34 < 0x10) {
      pcVar10 = &stack0xffffffb8;
    }
    cVar3 = *pcVar10;
    local_15 = false;
    uVar12 = param_7;
    while (((cVar3 != '\x7f' && ('\0' < cVar3)) && ((uint)(int)cVar3 < uVar12 - (int)local_20))) {
      uVar12 = uVar12 - (int)cVar3;
      pbVar1 = param_6 + uVar12;
      STL_MemoryCopy(param_6 + uVar12 + 1,pbVar1,(param_7 - uVar12) + 1);
      *pbVar1 = 0x2c;
      param_7 = param_7 + 1;
      if ('\0' < pcVar10[1]) {
        pcVar10 = pcVar10 + 1;
      }
      cVar3 = *pcVar10;
      local_15 = true;
    }
  }
  pbVar1 = local_20;
  uVar12 = *(uint *)((int)param_4 + 0x14);
  if (((int)uVar12 < 1) || (uVar12 <= param_7)) {
    local_1c = 0;
  }
  else {
    local_1c = uVar12 - param_7;
  }
  uVar8 = *(uint *)((int)param_4 + 0xc) & 0x1c0;
  uVar12 = param_2;
  pbVar15 = param_3;
  if (uVar8 != 0x40) {
    uVar12 = param_2;
    pbVar5 = param_3;
    iVar13 = local_1c;
    pbVar15 = param_6;
    pbVar4 = local_20;
    if (uVar8 == 0x100) {
      for (; local_2c = pbVar5, local_30 = uVar12, pbVar4 != (byte *)0x0; pbVar4 = pbVar4 + -1) {
        Character_OutputValidator(&local_30,*pbVar15);
        uVar12 = local_30;
        pbVar5 = local_2c;
        pbVar15 = pbVar15 + 1;
      }
      param_7 = param_7 - (int)pbVar1;
      param_6 = param_6 + (int)pbVar1;
      uVar12 = local_30;
      pbVar15 = local_2c;
      for (iVar13 = local_1c; param_2 = uVar12, param_3 = pbVar15, iVar13 != 0; iVar13 = iVar13 + -1
          ) {
        Character_OutputValidator(&param_2,(byte)param_5);
        uVar12 = param_2;
        pbVar15 = param_3;
      }
      local_1c = 0;
    }
    else {
      for (; local_20 = pbVar5, local_24 = uVar12, iVar13 != 0; iVar13 = iVar13 + -1) {
        Character_OutputValidator(&local_24,(byte)param_5);
        uVar12 = local_24;
        pbVar5 = local_20;
      }
      local_1c = 0;
      uVar12 = local_24;
      pbVar15 = local_20;
    }
  }
  pbVar1 = param_6;
  uVar8 = param_7;
  if (local_15 == false) {
    for (; uVar8 != 0; uVar8 = uVar8 - 1) {
      param_2 = uVar12;
      param_3 = pbVar15;
      Character_OutputValidator(&param_2,*pbVar1);
      uVar12 = param_2;
      pbVar15 = param_3;
      pbVar1 = pbVar1 + 1;
    }
  }
  else {
    while( true ) {
      sVar9 = _strcspn((char *)param_6,",");
      param_3 = param_6;
      for (sVar14 = sVar9; local_30 = uVar12, local_2c = pbVar15, sVar14 != 0; sVar14 = sVar14 - 1)
      {
        Character_OutputValidator(&local_30,*param_3);
        param_3 = param_3 + 1;
        uVar12 = local_30;
        pbVar15 = local_2c;
      }
      param_6 = param_6 + sVar9;
      param_7 = param_7 - sVar9;
      if (param_7 == 0) break;
      if ((byte)local_28 != 0) {
        local_24 = uVar12;
        local_20 = pbVar15;
        Character_OutputValidator(&local_24,(byte)local_28);
        uVar12 = local_24;
        pbVar15 = local_20;
      }
      param_6 = param_6 + 1;
      param_7 = param_7 - 1;
    }
  }
  *(undefined4 *)((int)param_4 + 0x14) = 0;
  param_2 = uVar12;
  param_3 = pbVar15;
  for (iVar13 = local_1c; iVar13 != 0; iVar13 = iVar13 + -1) {
    Character_OutputValidator(&param_2,(byte)param_5);
  }
  param_1[1] = (uint)param_3;
  *param_1 = param_2;
  if (0xf < local_34) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler((int)in_stack_ffffffb8,param_2);
  }
  ExceptionList = local_10;
  Exception_SetMessage
            ((void *)(local_14 ^ unaff_retaddr),in_stack_ffffffb4,(undefined4 *)in_stack_ffffffb8);
  return;
}


