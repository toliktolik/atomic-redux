/*
 * Function: RegistrationDialog_HandleSubmit
 * Address: 0042d140
 * Category: ui
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __thiscall RegistrationDialog_HandleSubmit(void *this,int param_1)

{
  char cVar1;
  void *pvVar2;
  int *piVar3;
  undefined4 *puVar4;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint extraout_EDX_03;
  uint extraout_EDX_04;
  uint extraout_EDX_05;
  uint extraout_EDX_06;
  uint uVar5;
  uint uVar6;
  undefined1 local_84 [28];
  _String_base local_68 [28];
  undefined1 local_4c [28];
  _String_base local_30 [28];
  uint local_14;
  void *local_10;
  undefined4 uStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  uStack_c = 0x511b32;
  local_10 = ExceptionList;
  uVar6 = 0;
  local_14 = 0;
  ExceptionList = &local_10;
  (**(code **)(**(int **)((int)this + 0xc0) + 0xb8))();
  if (param_1 == 0) {
    Craft_ProcessDeflector(&stack0xffffff5c);
    (**(code **)(**(int **)((int)this + 0xc0) + 0x14c))();
  }
  else {
    if (param_1 == 0x31) {
      if (*(int *)(*(int *)((int)this + 0xcc) + 0x70) == 0) {
        (**(code **)(**(int **)((int)this + 0xc0) + 0x148))();
        ExceptionList = local_10;
        return;
      }
      cVar1 = Registration_EncryptAndValidateUserCode
                        (*(int *)((int)this + 0xcc) + 0x5c,
                         (byte *)(*(int *)((int)this + 0xd0) + 0x5c));
      if (cVar1 == '\0') {
        pvVar2 = operator_new(0x11c);
        local_8 = 0;
        if (pvVar2 == (void *)0x0) {
          piVar3 = (int *)0x0;
          uVar5 = extraout_EDX_00;
        }
        else {
          Level_InitializeDictastroika
                    (local_4c,
                     "The registration number you entered is not valid for that name.\n\nMake sure the name and registration number are entered correctly."
                    );
          local_8 = CONCAT31(local_8._1_3_,1);
          local_14 = 1;
          Level_InitializeDictastroika(local_30,"ERROR");
          uVar6 = 3;
          local_8 = 2;
          local_14 = 3;
          piVar3 = ParticleSystem_Constructor
                             (pvVar2,*(int *)((int)this + 0xc0),0x168,0x104,local_30,(uint)local_4c)
          ;
          uVar5 = extraout_EDX_01;
        }
        if ((uVar6 & 2) != 0) {
          uVar6 = uVar6 & 0xfffffffd;
          String_Destructor((int)local_30,uVar5);
          uVar5 = extraout_EDX_02;
        }
        local_8 = 0xffffffff;
        if ((uVar6 & 1) != 0) {
          String_Destructor((int)local_4c,uVar5);
        }
        (**(code **)(**(int **)((int)this + 0xc0) + 0x100))();
        (**(code **)(*piVar3 + 0xd4))();
        UI_Widget_ApplyBlending
                  (*(void **)(*(int *)((int)this + 0xc0) + 0x2dc),*(int **)((int)this + 0xcc));
        ExceptionList = local_10;
        return;
      }
      PowerUp_ProcessThunderstrike
                ((_String_base *)(*(int *)((int)this + 0xc0) + 0x620),extraout_EDX,
                 (_String_base *)(*(int *)((int)this + 0xcc) + 0x5c),0,0xffffffff);
      PowerUp_ProcessThunderstrike
                ((_String_base *)(*(int *)((int)this + 0xc0) + 0x658),extraout_EDX_03,
                 (_String_base *)(*(int *)((int)this + 0xd0) + 0x5c),0,0xffffffff);
      *(undefined1 *)(*(int *)((int)this + 0xc0) + 0x674) = 1;
      (**(code **)(**(int **)((int)this + 0xc0) + 0x108))();
      (**(code **)(**(int **)((int)this + 0xc0) + 0x108))();
      (**(code **)(**(int **)((int)this + 0xc0) + 0x108))();
      piVar3 = (int *)(**(code **)(**(int **)((int)this + 0xc0) + 0xfc))(7);
      if (piVar3 != (int *)0x0) {
        UI_ProcessChildAnimation(*(void **)(*(int *)((int)this + 0xc0) + 0x2dc),(int *)piVar3[0x52])
        ;
        piVar3[0x52] = 0;
        if (*(char *)(*(int *)((int)this + 0xc0) + 0x5fd) == '\0') {
          piVar3[5] = piVar3[5] + -0x23;
        }
        (**(code **)(*piVar3 + 0x34))
                  (0x140 - piVar3[4] / 2,0xf0 - piVar3[5] / 2,piVar3[4],piVar3[5]);
        (**(code **)(*piVar3 + 0xbc))();
        uVar6 = local_14;
      }
      *(undefined1 *)(*(int *)((int)this + 0xc0) + 0xb32) = 0;
      pvVar2 = operator_new(0x11c);
      local_8 = 5;
      if (pvVar2 == (void *)0x0) {
        puVar4 = (undefined4 *)0x0;
        uVar5 = extraout_EDX_04;
      }
      else {
        Level_InitializeDictastroika
                  (local_84,
                   "Thank you for registering Heavy Weapon Deluxe!  The air strike has now been called off."
                  );
        local_8 = CONCAT31(local_8._1_3_,6);
        local_14 = 4;
        Level_InitializeDictastroika(local_68,"THANK YOU");
        uVar6 = 0xc;
        local_8 = 7;
        local_14 = 0xc;
        puVar4 = ParticleSystem_Constructor
                           (pvVar2,*(int *)((int)this + 0xc0),0x140,0xd2,local_68,(uint)local_84);
        uVar5 = extraout_EDX_05;
      }
      if ((uVar6 & 8) != 0) {
        uVar6 = uVar6 & 0xfffffff7;
        String_Destructor((int)local_68,uVar5);
        uVar5 = extraout_EDX_06;
      }
      local_8 = 0xffffffff;
      if ((uVar6 & 4) != 0) {
        String_Destructor((int)local_84,uVar5);
      }
      (**(code **)(**(int **)((int)this + 0xc0) + 0x100))(0x1f,puVar4);
      ExceptionList = local_10;
      return;
    }
    if (param_1 == 0x32) {
      (**(code **)(**(int **)((int)this + 0xc0) + 0x104))();
      ExceptionList = local_10;
      return;
    }
  }
  ExceptionList = local_10;
  return;
}


