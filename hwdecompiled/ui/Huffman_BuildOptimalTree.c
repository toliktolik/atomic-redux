/*
 * Function: Huffman_BuildOptimalTree
 * Address: 004db0d0
 * Category: ui
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __fastcall Huffman_BuildOptimalTree(undefined4 param_1,int param_2)

{
  short sVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int *in_EAX;
  uint uVar7;
  int iVar8;
  int iVar9;
  short *psVar10;
  uint uVar11;
  uint uVar12;
  int *piVar13;
  undefined4 *puVar14;
  int iVar15;
  ushort *puVar16;
  int local_18;
  int local_14;
  int *local_10;
  int local_c;
  
  iVar2 = in_EAX[1];
  iVar3 = *in_EAX;
  piVar13 = (int *)in_EAX[2];
  iVar8 = *piVar13;
  iVar4 = piVar13[1];
  iVar5 = piVar13[2];
  uVar11 = piVar13[4];
  puVar14 = (undefined4 *)(param_2 + 0xb34);
  for (iVar9 = 8; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar14 = 0;
    puVar14 = puVar14 + 1;
  }
  iVar9 = 0;
  *(undefined2 *)(iVar3 + 2 + *(int *)(param_2 + 0xb54 + *(int *)(param_2 + 0x144c) * 4) * 4) = 0;
  local_14 = *(int *)(param_2 + 0x144c) + 1;
  local_c = 0;
  if (local_14 < 0x23d) {
    local_10 = (int *)(param_2 + 0xb54 + local_14 * 4);
    local_18 = 0x23d - local_14;
    local_14 = local_14 + local_18;
    do {
      iVar6 = *local_10;
      uVar7 = *(ushort *)(iVar3 + 2 + (uint)*(ushort *)(iVar3 + 2 + iVar6 * 4) * 4) + 1;
      if ((int)uVar11 < (int)uVar7) {
        iVar9 = iVar9 + 1;
        uVar7 = uVar11;
        local_c = iVar9;
      }
      *(short *)(iVar3 + 2 + iVar6 * 4) = (short)uVar7;
      if (iVar6 <= iVar2) {
        psVar10 = (short *)(param_2 + 0xb34 + uVar7 * 2);
        *psVar10 = *psVar10 + 1;
        iVar15 = 0;
        if (iVar5 <= iVar6) {
          iVar15 = *(int *)(iVar4 + (iVar6 - iVar5) * 4);
        }
        uVar12 = (uint)*(ushort *)(iVar3 + iVar6 * 4);
        *(int *)(param_2 + 0x16a0) = *(int *)(param_2 + 0x16a0) + (uVar7 + iVar15) * uVar12;
        iVar9 = local_c;
        if (iVar8 != 0) {
          *(uint *)(param_2 + 0x16a4) =
               *(int *)(param_2 + 0x16a4) +
               ((uint)*(ushort *)(iVar8 + 2 + iVar6 * 4) + iVar15) * uVar12;
        }
      }
      local_10 = local_10 + 1;
      local_18 = local_18 + -1;
    } while (local_18 != 0);
    if (iVar9 != 0) {
      puVar16 = (ushort *)(param_2 + 0xb34 + uVar11 * 2);
      do {
        iVar8 = uVar11 - 1;
        psVar10 = (short *)(param_2 + 0xb34 + iVar8 * 2);
        sVar1 = *(short *)(param_2 + 0xb34 + iVar8 * 2);
        while (sVar1 == 0) {
          psVar10 = psVar10 + -1;
          iVar8 = iVar8 + -1;
          sVar1 = *psVar10;
        }
        psVar10 = (short *)(param_2 + 0xb34 + iVar8 * 2);
        *psVar10 = *psVar10 + -1;
        psVar10 = (short *)(param_2 + 0xb36 + iVar8 * 2);
        *psVar10 = *psVar10 + 2;
        *puVar16 = *puVar16 - 1;
        iVar9 = iVar9 + -2;
      } while (0 < iVar9);
      for (; uVar11 != 0; uVar11 = uVar11 - 1) {
        uVar7 = (uint)*puVar16;
        if (uVar7 != 0) {
          piVar13 = (int *)(param_2 + 0xb54 + local_14 * 4);
          local_10 = (int *)uVar7;
          do {
            local_14 = local_14 + -1;
            piVar13 = piVar13 + -1;
            iVar8 = *piVar13;
            if (iVar8 <= iVar2) {
              uVar7 = (uint)*(ushort *)(iVar3 + 2 + iVar8 * 4);
              if (uVar7 != uVar11) {
                *(int *)(param_2 + 0x16a0) =
                     *(int *)(param_2 + 0x16a0) +
                     (uVar11 - uVar7) * (uint)*(ushort *)(iVar3 + iVar8 * 4);
                *(short *)(iVar3 + 2 + iVar8 * 4) = (short)uVar11;
              }
              uVar7 = (int)local_10 - 1;
              local_10 = (int *)uVar7;
            }
          } while (uVar7 != 0);
        }
        puVar16 = puVar16 + -1;
      }
    }
  }
  return;
}


