/*
 * Function: Threading_DestroyMutex
 * Address: 004fd3bc
 * Category: system
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Removing unreachable block (ram,0x004fd4c1) */

void __fastcall Threading_DestroyMutex(int param_1,undefined4 param_2)

{
  byte *pbVar1;
  int *piVar2;
  uint *puVar3;
  undefined1 uVar4;
  undefined4 uVar5;
  char cVar6;
  code *pcVar7;
  byte bVar8;
  undefined4 in_EAX;
  uint uVar9;
  int iVar10;
  byte bVar12;
  int iVar11;
  char cVar13;
  undefined4 unaff_EBX;
  int unaff_EBP;
  undefined4 unaff_EDI;
  undefined4 *puVar14;
  byte in_AF;
  
  puVar14 = (undefined4 *)CONCAT22((short)((uint)unaff_EDI >> 0x10),(short)in_EAX);
  bVar12 = (byte)((uint)param_2 >> 8);
  *(byte *)(param_1 + -0x5d) = *(byte *)(param_1 + -0x5d) & bVar12;
  uVar9 = CONCAT31((int3)(CONCAT22((short)((uint)in_EAX >> 0x10),(short)unaff_EDI) >> 8),
                   (char)unaff_EDI) & 0xffffffd8;
  pbVar1 = (byte *)(param_1 + unaff_EBP * 2);
  cVar6 = bVar12 + *pbVar1;
  iVar10 = param_1 + -1;
  if (iVar10 == 0 || cVar6 != '\0') {
    Threading_CreateMutex(iVar10);
    return;
  }
  if (!CARRY1(bVar12,*pbVar1)) {
    return;
  }
  puVar3 = (uint *)(param_1 + -0x7466f86f + (int)puVar14 * 4);
  *puVar3 = *puVar3 & uVar9;
  bVar8 = (byte)uVar9;
  bVar12 = 9 < (bVar8 & 0xf) | in_AF;
  bVar8 = bVar8 + bVar12 * '\x06';
  bVar8 = bVar8 + (0x90 < (bVar8 & 0xf0) | bVar12 * (0xf9 < bVar8)) * '`';
  pbVar1 = (byte *)(unaff_EBP + -0x5658909a);
  *pbVar1 = *pbVar1 ^ bVar8;
  if ('\0' < (char)*pbVar1) {
    pcVar7 = (code *)swi(1);
    (*pcVar7)();
    return;
  }
  *(int *)(param_1 + 0x3a84bf4d) = *(int *)(param_1 + 0x3a84bf4d) + -0x6a50dd00;
  cVar13 = (char)unaff_EBX + cRam4279922e;
  iVar11 = CONCAT31(CONCAT21((short)((uint)param_2 >> 0x10),cVar6),0xf);
  uVar5 = in((short)iVar11);
  *puVar14 = uVar5;
  *(byte *)(param_1 + 0x5f) = *(byte *)(param_1 + 0x5f) & (byte)((uint)iVar10 >> 8);
  LOCK();
  piVar2 = (int *)(CONCAT31((int3)((uint)unaff_EBX >> 8),cVar13) + -0x57 + iVar11);
  iVar10 = *piVar2;
  *piVar2 = unaff_EBP;
  UNLOCK();
  uVar4 = in((short)iVar11);
  *(undefined1 *)(puVar14 + 1) = uVar4;
  if (iVar11 != 0 || iVar10 != 0) {
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  out(0x90,bVar8);
  return;
}


