/*
 * Function: System_ExitHandler
 * Address: 004e03b0
 * Category: system
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl System_ExitHandler(int *param_1)

{
  int iVar1;
  bool bVar2;
  undefined4 *puVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  int *piVar7;
  int iVar8;
  int local_14;
  undefined1 local_c;
  undefined4 *local_8;
  
  puVar3 = (undefined4 *)(**(code **)param_1[1])(param_1,1,0xa0);
  param_1[0x68] = (int)puVar3;
  *puVar3 = JPEG_SetOutputDimensions;
  puVar3[1] = JPEG_ProcessSampledOutput;
  *(undefined1 *)(puVar3 + 2) = 0;
  if (*(char *)((int)param_1 + 0x10a) != '\0') {
    *(undefined4 *)(*param_1 + 0x14) = 0x19;
    (**(code **)*param_1)(param_1);
  }
  if (((char)param_1[0x12] == '\0') || (bVar2 = true, param_1[0x46] < 2)) {
    bVar2 = false;
  }
  local_14 = 0;
  if (0 < param_1[9]) {
    piVar7 = (int *)(param_1[0x31] + 0x24);
    local_8 = puVar3 + 0xd;
    do {
      iVar4 = (piVar7[-7] * *piVar7) / param_1[0x46];
      iVar5 = (piVar7[-6] * *piVar7) / param_1[0x46];
      iVar8 = param_1[0x45];
      iVar1 = param_1[0x44];
      local_8[0xc] = iVar5;
      if ((char)piVar7[3] == '\0') {
        *local_8 = JPEG_InitializeImageNull;
      }
      else if ((iVar4 == iVar1) && (iVar5 == iVar8)) {
        *local_8 = JPEG_CopyImageData;
      }
      else {
        if ((iVar4 * 2 == iVar1) && (iVar5 == iVar8)) {
          if ((bVar2) && (2 < (uint)piVar7[1])) {
            *local_8 = Debug_AssertHandler;
          }
          else {
            *local_8 = JPEG_UpsampleVertical;
          }
        }
        else if ((iVar4 * 2 == iVar1) && (iVar5 * 2 == iVar8)) {
          if ((bVar2) && (2 < (uint)piVar7[1])) {
            *local_8 = Memory_TrackAllocation;
            *(undefined1 *)(puVar3 + 2) = 1;
          }
          else {
            *local_8 = Debug_OutputString;
          }
        }
        else if ((iVar1 % iVar4 == 0) && (iVar8 % iVar5 == 0)) {
          local_c = (undefined1)(iVar1 / iVar4);
          *local_8 = JPEG_UpsampleHorizontal;
          *(undefined1 *)(local_14 + 0x8c + (int)puVar3) = local_c;
          *(char *)(local_14 + 0x96 + (int)puVar3) = (char)(iVar8 / iVar5);
        }
        else {
          *(undefined4 *)(*param_1 + 0x14) = 0x26;
          (**(code **)*param_1)(param_1);
        }
        iVar8 = param_1[0x45];
        iVar1 = param_1[1];
        iVar4 = Math_AlignToMultiple(param_1[0x17],param_1[0x44]);
        uVar6 = (**(code **)(iVar1 + 8))(param_1,1,iVar4,iVar8);
        local_8[-10] = uVar6;
      }
      local_14 = local_14 + 1;
      local_8 = local_8 + 1;
      piVar7 = piVar7 + 0x15;
    } while (local_14 < param_1[9]);
  }
  return;
}


