/*
 * Function: FileSystem_ProcessPath
 * Address: 004a3b50
 * Category: system
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


uint __fastcall
FileSystem_ProcessPath
          (undefined4 param_1,uint param_2,int param_3,_String_base *param_4,_String_base *param_5)

{
  int iVar1;
  char *pcVar2;
  _String_base *p_Var3;
  char *pcVar4;
  uint uVar5;
  int iVar6;
  undefined8 uVar7;
  _String_base local_58 [4];
  uint local_54;
  undefined4 local_44;
  uint local_40;
  uint local_38;
  undefined4 local_28;
  uint local_24;
  undefined4 local_20 [2];
  int local_18;
  int local_14;
  void *local_10;
  undefined4 uStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  uStack_c = 0x515a48;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  p_Var3 = Background_ProcessSkyLayer(local_58,param_2,param_4,(uint)param_5);
  local_8 = 0;
  uVar7 = StringMap_FindOrInsert((void *)(param_3 + 0x58),local_20,p_Var3);
  uVar5 = (uint)((ulonglong)uVar7 >> 0x20);
  local_18 = *(int *)uVar7;
  local_14 = ((int *)uVar7)[1];
  local_8 = 0xffffffff;
  if (0xf < local_24) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(local_14,local_38);
  }
  local_24 = 0xf;
  local_28 = 0;
  local_38 = local_38 & 0xffffff00;
  if (0xf < local_40) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(local_14,uVar5);
  }
  local_40 = 0xf;
  local_44 = 0;
  local_54 = local_54 & 0xffffff00;
  if ((char)local_14 == '\0') {
    PowerUp_ProcessThunderstrike((_String_base *)(local_18 + 0x28),uVar5,param_5,0,0xffffffff);
  }
  pcVar2 = "/";
  do {
    pcVar4 = pcVar2;
    pcVar2 = pcVar4 + 1;
  } while (*pcVar4 != '\0');
  uVar5 = String_Compare(param_4,0,*(uint *)(param_4 + 0x14),(_String_base *)&DAT_00534470,
                         (uint)(pcVar4 + -0x534470));
  if (uVar5 != 0) {
    iVar1 = *(int *)(param_3 + 0x68);
    iVar6 = Tree_DeleteNode(iVar1,*(undefined4 *)(iVar1 + 4),&local_18);
    uVar5 = Image_DrawEllipse((void *)(param_3 + 100),1);
    *(int *)(iVar1 + 4) = iVar6;
    **(int **)(iVar6 + 4) = iVar6;
  }
  ExceptionList = local_10;
  return CONCAT31((int3)(uVar5 >> 8),(char)local_14);
}


