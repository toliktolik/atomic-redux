/*
 * Function: System_GetThreadID
 * Address: 0044c1c0
 * Category: system
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall System_GetThreadID(uint param_1,uint param_2,uint param_3,undefined4 *param_4)

{
  int *piVar1;
  void *this;
  LSTATUS LVar2;
  HMODULE hModule;
  DWORD DVar3;
  int iVar4;
  HWND unaff_EDI;
  bool bVar5;
  uint unaff_retaddr;
  undefined4 *in_stack_ffffff48;
  undefined4 *in_stack_ffffff4c;
  DWORD local_a8;
  DWORD local_24;
  undefined1 local_20 [4];
  DWORD local_1c;
  tagPOINT local_18;
  int local_10;
  HKEY local_c;
  uint local_8;
  
  this = DAT_00569f5c;
  local_8 = (uint)DAT_00569f5c ^ unaff_retaddr;
  if (DAT_0056da79 != '\0') goto switchD_0044c37d_caseD_113;
  if (param_3 < 0x105) {
    if (param_3 != 0x104) {
      if (param_3 < 0x1d) {
        if (param_3 != 0x1c) {
          if (param_3 == 1) {
            if (DAT_0056da78 == '\0') {
              DAT_0056da78 = '\x01';
              GetCursorPos(&local_18);
              DAT_0056da74 = local_18.x;
              DAT_0056da70 = local_18.y;
              in_stack_ffffff48 = (undefined4 *)0x94;
              GetVersionExA((LPOSVERSIONINFOA)&stack0xffffff48);
              if ((local_a8 == 1) &&
                 (local_10 = RegOpenKeyA((HKEY)0x80000001,"Control Panel\\Desktop",&local_c),
                 local_10 == 0)) {
                local_1c = 4;
                LVar2 = RegQueryValueExA(local_c,"ScreenSaveUsePassword",(LPDWORD)0x0,&local_24,
                                         (LPBYTE)&local_10,&local_1c);
                if ((LVar2 == 0) &&
                   ((local_10 != 0 &&
                    (hModule = LoadLibraryA("PASSWORD.CPL"), hModule != (HMODULE)0x0)))) {
                  DAT_0056da6c = GetProcAddress(hModule,"VerifyScreenSavePwd");
                  SystemParametersInfoA(0x61,1,local_20,0);
                }
                RegCloseKey(local_c);
                Exception_SetMessage
                          ((void *)(local_8 ^ unaff_retaddr),in_stack_ffffff48,in_stack_ffffff4c);
                return;
              }
            }
            goto switchD_0044c37d_caseD_113;
          }
          if (param_3 != 6) {
            if (param_3 != 0x10) {
              Exception_SetMessage(DAT_00569f5c,in_stack_ffffff48,in_stack_ffffff4c);
              return;
            }
            goto switchD_0044c37d_caseD_201;
          }
        }
      }
      else if (param_3 != 0x86) {
        if (param_3 != 0x100) {
          Exception_SetMessage(DAT_00569f5c,in_stack_ffffff48,in_stack_ffffff4c);
          return;
        }
        goto switchD_0044c37d_caseD_201;
      }
      if (param_2 != 0) {
        Exception_SetMessage(DAT_00569f5c,in_stack_ffffff48,in_stack_ffffff4c);
        return;
      }
    }
    goto switchD_0044c37d_caseD_201;
  }
  switch(param_3) {
  case 0x112:
    if (param_2 < 0xf061) {
      if ((param_2 == 0xf060) || (param_2 == 0xf040)) goto LAB_0044c3a8;
      bVar5 = param_2 == 0xf050;
    }
    else {
      bVar5 = param_2 == 0xf140;
    }
    if (bVar5) {
LAB_0044c3a8:
      *param_4 = 0;
      Exception_SetMessage(this,in_stack_ffffff48,in_stack_ffffff4c);
      return;
    }
  default:
    goto switchD_0044c37d_caseD_113;
  case 0x200:
    break;
  case 0x201:
  case 0x204:
  case 0x207:
    goto switchD_0044c37d_caseD_201;
  }
  if (((param_1 & 0xffff) != DAT_0056da74) || (param_1 >> 0x10 != DAT_0056da70)) {
    DAT_0056da68 = DAT_0056da68 + 1;
    DAT_0056da70 = param_1 >> 0x10;
    DAT_0056da74 = param_1 & 0xffff;
  }
  if (DAT_0056da68 < 4) goto LAB_0044c3a8;
switchD_0044c37d_caseD_201:
  if ((DAT_0056da10 != (void *)0x0) && (*(HWND *)((int)DAT_0056da10 + 0x30c) != unaff_EDI))
  goto switchD_0044c37d_caseD_113;
  DVar3 = GetTickCount();
  if (DVar3 - _DAT_0056da34 < 1000) {
    if (param_3 < 0x1d) {
      if ((param_3 == 0x1c) || (param_3 == 6)) goto switchD_0044c37d_caseD_113;
      bVar5 = param_3 == 0x10;
    }
    else {
      if (param_3 == 0x86) goto switchD_0044c37d_caseD_113;
      bVar5 = param_3 == 0x200;
    }
    if (bVar5) goto switchD_0044c37d_caseD_113;
  }
  if (((DAT_0056da6c != (FARPROC)0x0) && (DAT_0056da10 != (void *)0x0)) &&
     (*(char *)((int)DAT_0056da10 + 0x303) != '\0')) {
    if ((*(int *)((int)DAT_0056da10 + 0x328) != 0) &&
       (piVar1 = *(int **)(*(int *)((int)DAT_0056da10 + 0x328) + 0x58), piVar1 != (int *)0x0)) {
      (**(code **)(*piVar1 + 0x28))(piVar1);
      *(undefined1 *)((int)DAT_0056da10 + 0x324) = 1;
    }
    DAT_0056da79 = '\x01';
    iVar4 = (*DAT_0056da6c)();
    DAT_0056da79 = '\0';
    if (DAT_0056da10 != (void *)0x0) {
      *(undefined1 *)((int)DAT_0056da10 + 0x324) = 0;
      Registry_OpenKey(DAT_0056da10,'\0');
    }
    if (iVar4 == 0) {
      GetCursorPos(&local_18);
      DAT_0056da74 = local_18.x;
      DAT_0056da70 = local_18.y;
      DAT_0056da68 = iVar4;
      Exception_SetMessage((void *)(local_8 ^ unaff_retaddr),in_stack_ffffff48,in_stack_ffffff4c);
      return;
    }
    SystemParametersInfoA(0x61,0,local_20,0);
    FreeLibrary((HMODULE)0x0);
    DAT_0056da6c = (FARPROC)0x0;
  }
  DAT_0056da79 = '\x01';
  PostMessageA(unaff_EDI,0x10,0,0);
switchD_0044c37d_caseD_113:
  Exception_SetMessage((void *)(local_8 ^ unaff_retaddr),in_stack_ffffff48,in_stack_ffffff4c);
  return;
}


