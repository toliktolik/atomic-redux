/*
 * Function: Thunk_System_Initialize
 * Address: 004ec189
 * Category: system
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

ulonglong __fastcall Thunk_System_Initialize(undefined4 param_1,undefined4 *param_2)

{
  char *pcVar1;
  ushort *puVar2;
  uint *puVar3;
  int *piVar4;
  int iVar5;
  code *pcVar6;
  undefined4 uVar7;
  undefined1 uVar8;
  byte bVar13;
  int iVar9;
  uint uVar10;
  undefined4 uVar11;
  undefined4 *puVar12;
  ushort *extraout_ECX;
  byte *pbVar14;
  undefined4 extraout_ECX_00;
  ushort uVar15;
  uint uVar16;
  uint *unaff_EBX;
  int unaff_EBP;
  byte *unaff_ESI;
  int *unaff_EDI;
  undefined2 in_CS;
  undefined2 uVar17;
  undefined2 in_DS;
  char in_CF;
  byte bVar18;
  byte in_AF;
  bool bVar19;
  undefined8 uVar20;
  ulonglong uVar21;
  
  iVar9 = _DAT_d6e79be8;
  do {
    pcVar1 = (char *)(iVar9 + -0x6c + (int)param_2 * 2);
    *pcVar1 = *pcVar1 + -0x43 + in_CF;
    piVar4 = unaff_EDI + 1;
    *unaff_EDI = iVar9;
    uVar17 = 0xbd31;
    uVar20 = func_0x261388a0(in_CS);
    param_2 = (undefined4 *)((ulonglong)uVar20 >> 0x20);
    uVar16 = (uint)uVar20;
    *unaff_ESI = *unaff_ESI & (byte)((uint)extraout_ECX >> 8);
    uVar7 = _DAT_bff9460c;
    while( true ) {
      in_AF = 9 < ((byte)uVar16 & 0xf) | in_AF;
      uVar10 = CONCAT31((int3)(uVar16 >> 8),(byte)uVar16 + in_AF * '\x06') & 0xffffff0f;
      uVar16 = CONCAT22((short)(uVar10 >> 0x10),CONCAT11((char)(uVar16 >> 8) + in_AF,(char)uVar10));
      uVar15 = (ushort)((ulonglong)uVar20 >> 0x20);
      if ((POPCOUNT(*unaff_ESI) & 1U) != 0) break;
      if (-1 < (char)*unaff_ESI) {
        if (*unaff_ESI != 0) {
          uVar11 = in(0x26);
          uVar16 = (int)(int3)((uint)uVar11 >> 8) >> 0x17 & *(uint *)((int)unaff_EBX + 5);
          if (uVar16 != 0) {
            *(undefined4 *)((int)unaff_EDI + 5) = _DAT_bff94610;
            return CONCAT44(uVar16,uVar7) & 0xffffff00ffffffff;
          }
                    /* WARNING: Bad instruction - Truncating control flow here */
          halt_baddata();
        }
        puVar12 = (undefined4 *)CONCAT31((int3)(uVar16 - 1 >> 8),DAT_b13b51fe);
        puVar3 = puVar12 + 1;
        out(*puVar12,uVar15);
        if (0 < (int)uVar16) {
          pbVar14 = (byte *)CONCAT31((int3)((uint)extraout_ECX >> 8),0xa9);
          *pbVar14 = *pbVar14 ^ (byte)unaff_EBX;
                    /* WARNING: Bad instruction - Truncating control flow here */
          halt_baddata();
        }
        bVar18 = (int *)*puVar3 < piVar4;
        *puVar3 = *puVar3 - (int)piVar4;
        uVar20 = func_0x84551275();
        iVar9 = *(int *)((int)uVar20 + -0x48d01b3e);
        *(char *)piVar4 = (char)uVar20;
        out(0x9c,(int)uVar20);
        *(char *)((int)unaff_EBX + -0x35422083) =
             *(char *)((int)unaff_EBX + -0x35422083) + (char)((uint)extraout_ECX_00 >> 8);
        *(char *)((int)unaff_EDI + 5) = (char)uVar20;
        iVar5 = CONCAT31((int3)((uint)extraout_ECX_00 >> 8),0x15) + unaff_EDI[-0x11];
        bVar13 = (byte)((ulonglong)uVar20 >> 8) & *(byte *)(puVar12 + 0x1615bef9);
        bVar19 = (short)((ushort)bVar13 << 8) < 0;
        if (!bVar19) {
          *(uint *)(unaff_EBP + -0x10) = *(uint *)(unaff_EBP + -0x10) | 0x2b;
          pbVar14 = (byte *)(iVar5 + -0xd82b5b0);
          *pbVar14 = *pbVar14 ^ (byte)((uint)unaff_EBX >> 8);
          *(uint *)((int)unaff_EBX + -0x7f55e095) =
               *(uint *)((int)unaff_EBX + -0x7f55e095) | (uint)&stack0x00000000;
          pcVar6 = (code *)swi(3);
          uVar21 = (*pcVar6)();
          return uVar21;
        }
        uVar8 = in(0x89);
        uVar10 = CONCAT31(CONCAT21((short)((ulonglong)uVar20 >> 0x10),
                                   bVar19 << 7 | (bVar13 == 0) << 6 | in_AF << 4 |
                                   ((POPCOUNT(bVar13) & 1U) == 0) << 2),uVar8) | 0x200;
        uVar16 = *unaff_EBX;
        *unaff_EBX = *unaff_EBX + uVar10;
        puVar2 = (ushort *)segment(in_DS,(short)unaff_EBX + 0x3d5b);
        *puVar2 = *puVar2 + (ushort)CARRY4(uVar16,uVar10) * (((ushort)iVar5 & 3) - (*puVar2 & 3));
        *(undefined **)
         (*(int *)((int)((ulonglong)uVar20 >> 0x20) + iVar9 + (uint)bVar18 + 0x4e) * -0x2387b925 +
         -4) = &UNK_00500545;
        func_0xd361d14e();
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      }
    }
    *extraout_ECX = *extraout_ECX + (ushort)in_AF * ((uVar15 & 3) - (*extraout_ECX & 3));
    if (extraout_ECX == (ushort *)0x1) {
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    unaff_EDI = unaff_EDI + 2;
    iVar9 = in(uVar15);
    *piVar4 = iVar9;
    unaff_EBX = (uint *)*param_2;
    uVar16 = uVar16 & 0x9262d7c7;
    bVar13 = (byte)(uVar16 >> 8);
    in_CF = bVar13 < *(byte *)((int)extraout_ECX + -0x29186419);
    iVar9 = CONCAT22((short)(uVar16 >> 0x10),
                     CONCAT11(bVar13 - *(byte *)((int)extraout_ECX + -0x29186419),(char)uVar16));
    in_CS = uVar17;
  } while( true );
}


