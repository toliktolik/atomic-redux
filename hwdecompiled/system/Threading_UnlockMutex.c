/*
 * Function: Threading_UnlockMutex
 * Address: 00481360
 * Category: system
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __fastcall Threading_UnlockMutex(int param_1)

{
  undefined4 *puVar1;
  char cVar2;
  int iVar3;
  undefined4 *unaff_EBX;
  undefined4 *unaff_EDI;
  uint unaff_retaddr;
  undefined4 *puVar4;
  undefined4 *puVar5;
  _String_base *p_Var6;
  char *pcVar7;
  undefined1 local_118 [32];
  undefined4 local_f8 [23];
  char local_9c;
  int local_7c;
  int local_78;
  int local_74;
  int local_70;
  int local_68;
  undefined4 *local_c;
  uint local_8;
  
  local_8 = DAT_00569f5c ^ unaff_retaddr;
  pcVar7 = "QueryInterface IID_IDirect3D7";
  puVar1 = (undefined4 *)(param_1 + 0x1c);
  p_Var6 = *(_String_base **)(param_1 + 0x10);
  local_c = puVar1;
  iVar3 = (*(code *)**(undefined4 **)p_Var6)(p_Var6,&DAT_00532ee0,puVar1);
  cVar2 = Threading_LockMutex(iVar3,p_Var6);
  if (cVar2 != '\0') {
    Exception_SetMessage((void *)(local_8 ^ unaff_retaddr),(undefined4 *)pcVar7,unaff_EDI);
    return;
  }
  p_Var6 = (_String_base *)*puVar1;
  pcVar7 = "CreateDevice IID_IDirect3DHALDevice";
  puVar1 = (undefined4 *)(param_1 + 0x20);
  iVar3 = (**(code **)(*(int *)p_Var6 + 0x10))
                    (p_Var6,&DAT_00532ed0,*(undefined4 *)(param_1 + 0x14),puVar1);
  cVar2 = Threading_LockMutex(iVar3,p_Var6);
  if (cVar2 == '\0') {
    puVar4 = local_f8;
    for (iVar3 = 0x3b; iVar3 != 0; iVar3 = iVar3 + -1) {
      *puVar4 = 0;
      puVar4 = puVar4 + 1;
    }
    p_Var6 = (_String_base *)&DAT_0052c7cf;
    iVar3 = (**(code **)(*(int *)*puVar1 + 0xc))((int *)*puVar1,local_f8);
    cVar2 = Threading_LockMutex(iVar3,p_Var6);
    if (cVar2 == '\0') {
      DAT_0056e340 = ~(byte)((uint)_local_9c >> 8) & 1;
      DAT_0056e344 = local_78;
      DAT_0056e348 = local_7c;
      DAT_0056df34 = local_74;
      DAT_0056e33c = local_70;
      DAT_0056e338 = local_68;
      DAT_0056e358 = 0;
      if (local_74 == 0) {
        DAT_0056df34 = 0x40;
        DAT_0056e33c = 0x40;
        DAT_0056e348 = 0x40;
        DAT_0056e344 = 0x40;
        DAT_0056e338 = 1;
      }
      else {
        if (0x400 < local_74) {
          DAT_0056df34 = 0x400;
        }
        if (0x400 < local_70) {
          DAT_0056e33c = 0x400;
        }
        if (local_7c < 1) {
          DAT_0056e348 = 1;
        }
        if (local_78 < 1) {
          DAT_0056e348 = 1;
        }
        if (local_68 == 0) {
          DAT_0056e338 = 0x10000;
        }
      }
      DAT_0056e34c = 0;
      (**(code **)(*(int *)*puVar1 + 0x10))((int *)*puVar1,SexyWidget_SetUVCoords,0);
      if (-1 < local_9c) {
        DAT_0056e34c = DAT_0056e34c & 0xfffffff7;
      }
      SexyWidget_GetUVCoords(param_1);
      (**(code **)(*(int *)*local_c + 0x18))
                ((int *)*local_c,&DAT_00532ed0,SexyWidget_ProcessVertices,local_118);
      puVar5 = (undefined4 *)0xff000000;
      puVar4 = (undefined4 *)0x1;
      (**(code **)(*(int *)*puVar1 + 0x28))((int *)*puVar1,0,0,1,0xff000000,0x3f800000,0);
      Exception_SetMessage((void *)(local_8 ^ unaff_retaddr),puVar4,puVar5);
      return;
    }
  }
  Exception_SetMessage((void *)(local_8 ^ unaff_retaddr),(undefined4 *)pcVar7,unaff_EBX);
  return;
}


