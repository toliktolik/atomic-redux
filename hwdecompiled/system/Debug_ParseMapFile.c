/*
 * Function: Debug_ParseMapFile
 * Address: 004a7f40
 * Category: system
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __thiscall Debug_ParseMapFile(void *this,_String_base *param_1)

{
  _String_base _Var1;
  uint uVar2;
  byte bVar3;
  HANDLE hFindFile;
  int iVar4;
  undefined4 uVar5;
  uint uVar6;
  _String_base *p_Var7;
  _String_base *p_Var8;
  int *piVar9;
  int *piVar10;
  int extraout_ECX;
  _String_base *extraout_ECX_00;
  _String_base *extraout_ECX_01;
  _String_base *extraout_ECX_02;
  _String_base *extraout_ECX_03;
  _String_base *extraout_ECX_04;
  _String_base *extraout_ECX_05;
  _String_base *extraout_ECX_06;
  int extraout_ECX_07;
  int extraout_ECX_08;
  int extraout_ECX_09;
  int extraout_ECX_10;
  int extraout_ECX_11;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint extraout_EDX_03;
  uint extraout_EDX_04;
  uint extraout_EDX_05;
  uint extraout_EDX_06;
  uint extraout_EDX_07;
  uint extraout_EDX_08;
  uint extraout_EDX_09;
  uint extraout_EDX_10;
  uint extraout_EDX_11;
  uint extraout_EDX_12;
  uint extraout_EDX_13;
  uint extraout_EDX_14;
  uint extraout_EDX_15;
  uint extraout_EDX_16;
  uint unaff_EDI;
  _String_base *p_Var11;
  bool bVar12;
  uint unaff_retaddr;
  _String_base local_236c [4096];
  _String_base local_136c [4096];
  _WIN32_FIND_DATAA local_36c;
  _String_base local_22c [28];
  int local_210;
  byte abStackY_20c [100];
  int local_1a8;
  undefined **local_1a4 [13];
  _String_base local_170 [4];
  uint local_16c;
  undefined4 local_15c;
  uint local_158;
  _String_base local_154 [4];
  uint local_150;
  undefined4 local_140;
  uint local_13c;
  _String_base local_138 [4];
  uint local_134;
  undefined4 local_124;
  uint local_120;
  _String_base local_11c [4];
  uint local_118;
  undefined4 local_108;
  uint local_104;
  _String_base local_100 [4];
  uint local_fc;
  undefined4 local_ec;
  uint local_e8;
  _String_base local_e4 [4];
  uint local_e0;
  undefined4 local_d0;
  uint local_cc;
  uint local_c8;
  _String_base local_c4 [4];
  uint local_c0;
  int local_b0;
  uint local_ac;
  _String_base local_a8 [4];
  uint local_a4;
  undefined4 local_94;
  uint local_90;
  _String_base local_8c [4];
  uint local_88;
  undefined4 local_78;
  uint local_74;
  uint local_70;
  uint local_6c;
  uint local_68;
  uint local_64;
  char local_60 [4];
  int *local_5c;
  undefined4 local_58;
  uint local_54;
  undefined1 local_50 [4];
  _String_base *local_4c [4];
  uint local_3c;
  uint local_38;
  uint local_34;
  uint in_stack_ffffffd0;
  _String_base *p_Var13;
  uint uVar14;
  LPWIN32_FIND_DATAA lpFindFileData;
  undefined4 *puVar15;
  undefined4 *puVar16;
  
  puVar16 = (undefined4 *)&DAT_00515f19;
  puVar15 = (undefined4 *)ExceptionList;
  ExceptionList = &stack0xfffffff0;
  System_LoadLibrary(this);
  GetTickCount();
  lpFindFileData = &local_36c;
  hFindFile = FindFirstFileA("*.map",lpFindFileData);
  if (hFindFile == (HANDLE)0xffffffff) {
    ExceptionList = puVar15;
    Exception_SetMessage((void *)((uint)lpFindFileData ^ unaff_retaddr),puVar15,puVar16);
    return;
  }
  FindClose(hFindFile);
  local_60[0] = (char)hFindFile;
  local_5c = (int *)Collision_CheckPenetration();
  *(undefined1 *)((int)local_5c + 0x31) = 1;
  local_5c[1] = (int)local_5c;
  *local_5c = (int)local_5c;
  local_5c[2] = (int)local_5c;
  local_58 = 0;
  iVar4 = Collision_ResolveOverlap();
  *(undefined1 *)(iVar4 + 0x35) = 1;
  *(int *)(iVar4 + 4) = iVar4;
  *(int *)iVar4 = iVar4;
  *(int *)(iVar4 + 8) = iVar4;
  p_Var13 = (_String_base *)0x4a8007;
  STL_Iterator_ArrowOperator(&local_210,(int)local_36c.cFileName,1,1);
  if (local_1a8 == 0) {
    STL_String_FindLastNotOf((int)local_1a4);
    local_1a4[0] = &PTR_IOSBase_DestructorWrapper_00531324;
    IOStream_RefCountDestructor((ios_base *)local_1a4);
    uVar14 = 0x4a804a;
    TreeSet_RemoveRange4
              (&stack0xffffffd8,(undefined4 *)&stack0xffffffd4,*(int **)p_Var13,(int *)p_Var13);
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(extraout_ECX,uVar14);
  }
  local_ac = 0xf;
  local_b0 = 0;
  local_c0 = local_c0 & 0xffffff00;
  p_Var7 = *(_String_base **)(abStackY_20c + *(int *)(local_210 + 4));
  if (((uint)p_Var7 & 1) == 0) {
    do {
      bVar3 = Collision_RectIntersect(abStackY_20c + *(int *)(local_210 + 4) + -4,10);
      Array_GetElement(&local_210,local_136c,0x1000,bVar3);
      p_Var13 = local_136c;
      local_38 = 0xf;
      local_3c = 0;
      local_4c[0] = (_String_base *)((uint)local_4c[0] & 0xffffff00);
      do {
        _Var1 = *p_Var13;
        p_Var13 = p_Var13 + 1;
      } while (_Var1 != (_String_base)0x0);
      String_Assign(local_50,local_136c,(int)p_Var13 - (int)(local_136c + 1));
      if (local_3c < 0x17) {
LAB_004a8265:
        p_Var13 = (_String_base *)0x0;
        p_Var7 = GameMenu_ProcessRegistrationScreen(local_50,local_138,0,0xc);
        if (*(uint *)(p_Var7 + 0x18) < 0x10) {
          p_Var7 = p_Var7 + 4;
        }
        else {
          p_Var7 = *(_String_base **)(p_Var7 + 4);
        }
        uVar14 = 0;
        bVar12 = true;
        p_Var8 = (_String_base *)0xd;
        p_Var11 = (_String_base *)"Line numbers";
        do {
          if (p_Var8 == (_String_base *)0x0) break;
          p_Var8 = p_Var8 + -1;
          bVar12 = *p_Var7 == *p_Var11;
          p_Var7 = p_Var7 + 1;
          p_Var11 = p_Var11 + 1;
        } while (bVar12);
        if (0xf < local_120) {
                    /* WARNING: Subroutine does not return */
          System_ShutdownHandler((int)p_Var8,0);
        }
        local_120 = 0xf;
        local_124 = 0;
        local_134 = local_134 & 0xffffff00;
        if (bVar12) {
          uVar14 = XML_GetElementValue(local_50,&stack0xffffffe8,0xffffffff,1);
          if (uVar14 == 0xffffffff) {
            uVar14 = local_3c;
          }
          uVar6 = UI_Widget_ResetTransform(local_50,&stack0xffffffe8,0,1);
          p_Var7 = GameMenu_ProcessRegistrationScreen
                             (local_50,local_170,uVar6 + 1,(uVar14 - uVar6) - 1);
          p_Var13 = (_String_base *)0x0;
          PowerUp_ProcessThunderstrike(local_c4,extraout_EDX_05,p_Var7,0,0xffffffff);
          if (0xf < local_158) {
                    /* WARNING: Subroutine does not return */
            System_ShutdownHandler(local_16c,extraout_EDX_06);
          }
          local_158 = 0xf;
          local_15c = 0;
          local_16c = local_16c & 0xffffff00;
          p_Var8 = extraout_ECX_03;
          uVar14 = extraout_EDX_06;
        }
        else if ((local_b0 != 0) && (local_3c == 0x50)) {
          p_Var7 = (_String_base *)0xc;
          do {
            p_Var13 = GameMenu_ProcessRegistrationScreen(local_50,local_154,(uint)(p_Var7 + -0xc),6)
            ;
            if (*(uint *)(p_Var13 + 0x18) < 0x10) {
              p_Var13 = p_Var13 + 4;
            }
            else {
              p_Var13 = *(_String_base **)(p_Var13 + 4);
            }
            local_54 = _atol((char *)p_Var13);
            if (0xf < local_13c) {
                    /* WARNING: Subroutine does not return */
              System_ShutdownHandler(local_150,extraout_EDX_07);
            }
            local_13c = 0xf;
            local_140 = 0;
            local_150 = local_150 & 0xffffff00;
            GameMenu_ProcessRegistrationScreen(local_50,local_8c,(uint)(p_Var7 + -5),4);
            p_Var13 = p_Var7;
            GameMenu_ProcessRegistrationScreen(local_50,local_a8,(uint)p_Var7,8);
            uVar5 = Vector_IsParallel();
            p_Var8 = extraout_ECX_04;
            uVar14 = extraout_EDX_08;
            if (((char)uVar5 != '\0') &&
               (uVar5 = Vector_IsParallel(), p_Var8 = extraout_ECX_05, uVar14 = extraout_EDX_09,
               (char)uVar5 != '\0')) {
              local_cc = 0xf;
              local_d0 = 0;
              local_e0 = local_e0 & 0xffffff00;
              uVar14 = 0x4a8477;
              PowerUp_ProcessThunderstrike(local_e4,(uint)local_c4,local_c4,0,0xffffffff);
              local_64 = uVar14;
              local_c8 = local_54;
              local_68 = local_34;
              p_Var8 = (_String_base *)ResourceMap_FindOrInsertResource2(&stack0xffffffd8,&local_68)
              ;
              p_Var13 = (_String_base *)0x0;
              PowerUp_ProcessThunderstrike(p_Var8,extraout_EDX_10,local_e4,0,0xffffffff);
              *(uint *)(p_Var8 + 0x1c) = local_c8;
              if (0xf < local_cc) {
                    /* WARNING: Subroutine does not return */
                System_ShutdownHandler((int)extraout_ECX_06,local_c8);
              }
              local_cc = 0xf;
              local_d0 = 0;
              local_e0 = local_e0 & 0xffffff00;
              p_Var8 = extraout_ECX_06;
              uVar14 = local_c8;
            }
            if (0xf < local_90) {
                    /* WARNING: Subroutine does not return */
              System_ShutdownHandler(local_a4,uVar14);
            }
            local_90 = 0xf;
            local_94 = 0;
            local_a4 = local_a4 & 0xffffff00;
            if (0xf < local_74) {
                    /* WARNING: Subroutine does not return */
              System_ShutdownHandler((int)p_Var8,local_88);
            }
            p_Var7 = p_Var7 + 0x14;
            local_74 = 0xf;
            local_78 = 0;
            local_88 = local_88 & 0xffffff00;
          } while ((int)p_Var7 < 0x5c);
        }
      }
      else {
        p_Var13 = local_4c[0];
        if (local_38 < 0x10) {
          p_Var13 = (_String_base *)local_4c;
        }
        if (p_Var13[5] != (_String_base)0x3a) goto LAB_004a8265;
        GameMenu_ProcessRegistrationScreen(local_50,local_11c,1,4);
        p_Var13 = (_String_base *)0x6;
        GameMenu_ProcessRegistrationScreen(local_50,local_100,6,8);
        uVar5 = Vector_IsParallel();
        p_Var8 = extraout_ECX_00;
        uVar14 = extraout_EDX;
        if (((char)uVar5 != '\0') &&
           (uVar5 = Vector_IsParallel(), p_Var8 = extraout_ECX_01, uVar14 = extraout_EDX_00,
           (char)uVar5 != '\0')) {
          p_Var13 = (_String_base *)0x15;
          uVar6 = UI_Widget_ResetTransform(local_50,&stack0xffffffe8,0x15,1);
          p_Var8 = local_4c[0];
          if (local_38 < 0x10) {
            p_Var8 = (_String_base *)local_4c;
          }
          uVar14 = extraout_EDX_01;
          if ((p_Var8[0x14] == (_String_base)0x20) && (-1 < (int)uVar6)) {
            local_6c = in_stack_ffffffd0;
            local_70 = unaff_EDI;
            p_Var7 = GameMenu_ProcessRegistrationScreen(local_50,local_22c,0x15,uVar6 - 0x15);
            in_stack_ffffffd0 = local_6c;
            unaff_EDI = local_70;
            p_Var8 = (_String_base *)ResourceMap_FindOrInsertResource(local_60,&local_70);
            p_Var13 = (_String_base *)0x4a81f8;
            Level_InitializeZamblamia(p_Var8,extraout_EDX_02,p_Var7);
            String_Destructor((int)local_22c,extraout_EDX_03);
            p_Var8 = extraout_ECX_02;
            uVar14 = extraout_EDX_04;
          }
        }
        if (0xf < local_e8) {
                    /* WARNING: Subroutine does not return */
          System_ShutdownHandler(local_fc,uVar14);
        }
        local_e8 = 0xf;
        local_ec = 0;
        local_fc = local_fc & 0xffffff00;
        if (0xf < local_104) {
                    /* WARNING: Subroutine does not return */
          System_ShutdownHandler((int)p_Var8,local_118);
        }
        local_104 = 0xf;
        local_108 = 0;
        local_118 = local_118 & 0xffffff00;
      }
      if (0xf < local_38) {
                    /* WARNING: Subroutine does not return */
        System_ShutdownHandler((int)p_Var8,uVar14);
      }
      p_Var7 = *(_String_base **)(local_210 + 4);
      local_38 = 0xf;
      local_3c = 0;
      local_4c[0] = (_String_base *)((uint)local_4c[0] & 0xffffff00);
    } while ((abStackY_20c[(int)p_Var7] & 1) == 0);
  }
  p_Var8 = *(_String_base **)(param_1 + 0x14);
  if (0 < (int)p_Var8) {
    p_Var11 = (_String_base *)0xfffffffc;
    do {
      p_Var7 = p_Var11;
      if (p_Var8 <= p_Var11 + 4) {
        std::_String_base::_Xran(param_1);
      }
      if (*(uint *)(param_1 + 0x18) < 0x10) {
        p_Var8 = param_1 + 4;
      }
      else {
        p_Var8 = *(_String_base **)(param_1 + 4);
      }
      if ((p_Var11 + 4)[(int)p_Var8] == (_String_base)0x3a) {
        GameMenu_ProcessRegistrationScreen(param_1,local_a8,(uint)p_Var11,4);
        p_Var13 = p_Var11 + 5;
        GameMenu_ProcessRegistrationScreen(param_1,local_8c,(uint)p_Var13,8);
        uVar5 = Vector_IsParallel();
        iVar4 = extraout_ECX_07;
        uVar14 = extraout_EDX_11;
        p_Var11 = p_Var7;
        if (((char)uVar5 != '\0') &&
           (uVar5 = Vector_IsParallel(), uVar6 = local_54, iVar4 = extraout_ECX_08,
           uVar14 = extraout_EDX_12, p_Var11 = p_Var7, (char)uVar5 != '\0')) {
          local_68 = local_34;
          local_64 = local_54;
          p_Var13 = (_String_base *)0x4a863f;
          piVar9 = Collision_CircleIntersect(local_60,&local_68);
          piVar10 = local_5c;
          iVar4 = extraout_ECX_09;
          uVar14 = extraout_EDX_13;
          p_Var11 = p_Var7;
          if (piVar9 != local_5c) {
            if ((piVar9 != (int *)*local_5c) && (piVar9[4] != uVar6)) {
              Math_CalculateDistance((int *)&stack0xffffffe4);
              iVar4 = extraout_ECX_10;
              uVar14 = extraout_EDX_14;
              p_Var11 = p_Var7;
            }
            uVar6 = local_54;
            if (((piVar9 != piVar10) && (piVar9[3] == local_34)) &&
               (uVar2 = piVar9[4], local_54 - uVar2 != -1)) {
              p_Var13 = (_String_base *)(piVar9 + 6);
              p_Var7 = (_String_base *)0x4a86ad;
              iVar4 = (*DAT_005a3800)();
              if (iVar4 == 0) {
                if (0xf < (uint)piVar9[0xb]) {
                  p_Var13 = *(_String_base **)p_Var13;
                }
                p_Var8 = local_136c;
                do {
                  _Var1 = *p_Var13;
                  p_Var13 = p_Var13 + 1;
                  *p_Var8 = _Var1;
                  p_Var8 = p_Var8 + 1;
                } while (_Var1 != (_String_base)0x0);
              }
              if (uVar6 != uVar2) {
                p_Var13 = local_136c;
                do {
                  p_Var8 = p_Var13;
                  p_Var13 = p_Var8 + 1;
                } while (*p_Var8 != (_String_base)0x0);
                Exception_Release(p_Var8,"+0x%X");
              }
              p_Var13 = local_136c;
              local_38 = 0xf;
              local_3c = 0;
              local_4c[0] = (_String_base *)((uint)local_4c[0] & 0xffffff00);
              do {
                _Var1 = *p_Var13;
                p_Var13 = p_Var13 + 1;
              } while (_Var1 != (_String_base)0x0);
              String_Assign(local_50,local_136c,(int)p_Var13 - (int)(local_136c + 1));
              uVar6 = local_34;
              uVar14 = local_54;
              local_70 = local_34;
              local_6c = local_54;
              piVar9 = (int *)0x4a8755;
              piVar10 = Collision_LineIntersect(&stack0xffffffd8,&local_70);
              if (piVar10 != piVar9) {
                if ((piVar10 != (int *)*piVar9) && (piVar10[4] != uVar14)) {
                  Math_CalculateAngle((int *)&stack0xffffffe4);
                }
                if ((piVar10 != piVar9) && (piVar10[3] == uVar6)) {
                  p_Var7 = local_236c;
                  local_34 = 0x4a87aa;
                  Exception_Release(p_Var7,"\r\n    %s line %d +0x%X");
                  p_Var13 = local_236c;
                  do {
                    _Var1 = *p_Var13;
                    p_Var13 = p_Var13 + 1;
                  } while (_Var1 != (_String_base)0x0);
                  Enemy_ProcessSatelliteLogic
                            (local_50,local_236c,(int)p_Var13 - (int)(local_236c + 1));
                }
              }
              p_Var11 = p_Var7;
              PowerUp_ProcessFlakCannon(param_1,(uint)p_Var7,0xd);
              p_Var13 = local_4c[0];
              if (local_38 < 0x10) {
                p_Var13 = (_String_base *)local_4c;
              }
              p_Var8 = p_Var13;
              do {
                _Var1 = *p_Var8;
                p_Var8 = p_Var8 + 1;
              } while (_Var1 != (_String_base)0x0);
              UI_ShowPauseMenu(param_1,(uint)p_Var7,p_Var13,(int)p_Var8 - (int)(p_Var13 + 1));
              if (0xf < local_38) {
                    /* WARNING: Subroutine does not return */
                System_ShutdownHandler((int)local_4c[0],extraout_EDX_15);
              }
              local_38 = 0xf;
              local_3c = 0;
              local_4c[0] = (_String_base *)((uint)local_4c[0] & 0xffffff00);
              iVar4 = extraout_ECX_11;
              uVar14 = extraout_EDX_15;
            }
          }
        }
        if (0xf < local_74) {
                    /* WARNING: Subroutine does not return */
          System_ShutdownHandler(iVar4,local_88);
        }
        local_74 = 0xf;
        local_78 = 0;
        local_88 = local_88 & 0xffffff00;
        if (0xf < local_90) {
                    /* WARNING: Subroutine does not return */
          System_ShutdownHandler(iVar4,uVar14);
        }
        local_90 = 0xf;
        local_94 = 0;
        local_a4 = local_a4 & 0xffffff00;
      }
      p_Var8 = *(_String_base **)(param_1 + 0x14);
      p_Var7 = p_Var11 + 5;
      p_Var11 = p_Var11 + 1;
    } while ((int)p_Var7 < (int)p_Var8);
  }
  if (0xf < local_ac) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler((int)p_Var7,local_c0);
  }
  local_ac = 0xf;
  local_b0 = 0;
  local_c0 = local_c0 & 0xffffff00;
  STL_String_FindLastNotOf((int)local_1a4);
  local_1a4[0] = &PTR_IOSBase_DestructorWrapper_00531324;
  IOStream_RefCountDestructor((ios_base *)local_1a4);
  iVar4 = 0x4a890b;
  TreeSet_RemoveRange4
            (&stack0xffffffd8,(undefined4 *)&stack0xffffffd4,*(int **)p_Var13,(int *)p_Var13);
                    /* WARNING: Subroutine does not return */
  System_ShutdownHandler(iVar4,extraout_EDX_16);
}


