/*
 * Function: Threading_SuspendThread
 * Address: 004fdaa0
 * Category: system
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x004fdb35) overlaps instruction at (ram,0x004fdb34)
    */
/* WARNING: Removing unreachable block (ram,0x004fda4e) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall
Threading_SuspendThread(int param_1,undefined4 param_2,char *param_3,undefined4 param_4)

{
  ushort *puVar1;
  short sVar2;
  code *pcVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  uint5 uVar6;
  undefined1 uVar7;
  byte bVar8;
  char cVar9;
  uint in_EAX;
  uint uVar10;
  char **ppcVar11;
  undefined4 *puVar13;
  byte bVar16;
  int iVar14;
  undefined4 extraout_ECX;
  undefined4 uVar15;
  uint uVar17;
  int unaff_EBX;
  uint unaff_EBP;
  undefined4 *unaff_ESI;
  undefined4 *puVar18;
  char *pcVar19;
  char *pcVar20;
  bool bVar21;
  byte bVar22;
  byte bVar23;
  float10 in_ST0;
  float10 fVar24;
  float10 extraout_ST0;
  float10 in_ST1;
  float10 extraout_ST1;
  float10 in_ST2;
  float10 in_ST3;
  float10 in_ST4;
  float10 in_ST5;
  float10 in_ST6;
  float10 in_ST7;
  undefined8 uVar25;
  double *pdVar12;
  
  uVar17 = CONCAT22((short)((uint)param_2 >> 0x10),CONCAT11(0x7c,(char)param_2));
  uVar10 = in_EAX & 0x63bb0d14;
  bVar23 = (byte)param_1 & 0x1f;
  uVar5 = (ulonglong)uVar17 << bVar23;
  uVar4 = uVar5 | uVar17 >> 0x21 - bVar23;
  uVar17 = (uint)uVar4;
  iVar14 = param_1 + -1;
  if (iVar14 != 0 && uVar10 != 0) {
    bVar23 = (byte)iVar14 & 0x1f;
    uVar6 = CONCAT14((uVar5 & 0x100000000) != 0,*(undefined4 *)(uVar10 + 0xdd46c076));
    uVar5 = (ulonglong)(uVar6 >> bVar23) | (ulonglong)uVar6 << 0x21 - bVar23;
    *(undefined4 *)(uVar10 + 0xdd46c076) = (int)uVar5;
    bVar21 = (uVar5 & 0x100000000) != 0;
    do {
      *(int *)(param_1 + -0x6c) = (int)(&stack0x00000000 + (uint)bVar21 + *(int *)(param_1 + -0x6c))
      ;
      bVar23 = (byte)(uVar10 >> 8);
      bVar22 = (byte)uVar4;
      bVar21 = bVar23 < bVar22;
      bVar23 = bVar23 - bVar22;
      uVar10 = (uint)bVar23 << 8;
    } while (bVar23 == 0);
    pcVar3 = (code *)swi(1);
    (*pcVar3)();
    return;
  }
  bVar23 = 0;
  bVar21 = (in_EAX & 0x100) != 0;
  if ((int)(uVar10 + 1) < 0) {
    puVar18 = unaff_ESI + 1;
    pdVar12 = (double *)*unaff_ESI;
    uVar15 = CONCAT31((int3)((uint)iVar14 >> 8),*(undefined1 *)(param_1 + 0x34682b6c));
    pcVar19 = param_3;
    if (uVar10 != 0xffffffff) {
      pdVar12 = (double *)CONCAT31((int3)((uint)pdVar12 >> 8),-bVar21);
      goto code_r0x004fdad4;
    }
    *(uint *)(unaff_EBP + 0x2b) = unaff_EBP;
    goto code_r0x004fdad4;
  }
  ppcVar11 = (char **)((uVar10 + 0xec9a5cfa) - (uint)bVar21);
  pcVar20 = param_3 + 1;
  fVar24 = in_ST0;
  in_ST0 = in_ST1;
  in_ST1 = in_ST2;
  in_ST2 = in_ST3;
  in_ST3 = in_ST4;
  in_ST4 = in_ST5;
  in_ST5 = in_ST6;
  in_ST6 = in_ST7;
  do {
    uVar7 = in((short)uVar17);
    unaff_EBX = unaff_EBX + 1;
    *(longlong *)(uVar17 - 0x7f) = (longlong)ROUND(fVar24);
    bVar21 = (CONCAT31((int3)((uint)ppcVar11 >> 8),uVar7) | 0x85c507f0) == 0;
    bVar23 = 9 < ((byte)param_4 & 0xf) | bVar23;
    bVar8 = (byte)param_4 + bVar23 * '\x06';
    bVar22 = 0x90 < (bVar8 & 0xf0) | bVar23 * (0xf9 < bVar8);
    puVar13 = (undefined4 *)CONCAT31((int3)((uint)param_4 >> 8),bVar8 + bVar22 * '`');
    iVar14 = iVar14 + -1;
    in_ST7 = in_ST6;
    if (iVar14 == 0 || bVar21) {
      param_4 = 0x4fdacb;
      uVar25 = func_0xc9ead6cd();
      uVar17 = (uint)((ulonglong)uVar25 >> 0x20);
      cVar9 = (char)uVar25 + '\x03';
      pdVar12 = (double *)CONCAT31((int3)((ulonglong)uVar25 >> 8),cVar9);
      puVar18 = unaff_ESI + 1;
      *(undefined4 *)pcVar20 = *unaff_ESI;
      param_4 = 0xffffffd0;
      in_ST0 = extraout_ST0 / (float10)*pdVar12;
      uVar15 = extraout_ECX;
      pcVar19 = pcVar20 + 4;
      in_ST1 = extraout_ST1;
      if ((char)uVar25 < -3) {
        pdVar12 = (double *)
                  CONCAT22((short)((ulonglong)uVar25 >> 0x10),
                           (ushort)(byte)(cVar9 + (char)((ulonglong)uVar25 >> 8) * '\x1e'));
      }
code_r0x004fdad4:
      out(*puVar18,(short)uVar17);
      bVar16 = (byte)((uint)uVar15 >> 8);
      bVar22 = bVar16 < *(byte *)(unaff_EBP + 0x2b6d898a);
      bVar8 = *(byte *)(unaff_EBP + 0x2b6d898a);
      param_3 = (char *)0xd6f97434;
      puVar1 = (ushort *)(unaff_EBP + 0x1e + uVar17 * 8);
      sVar2 = ((ushort)pdVar12 & 3) - (*puVar1 & 3);
      bVar21 = 0 < sVar2;
      *puVar1 = *puVar1 + (ushort)bVar22 * sVar2;
      out(0x94,pdVar12);
      out(0x9d,(char)pdVar12);
      puVar13 = (undefined4 *)(int)(short)(ushort)pdVar12;
      unaff_ESI = (undefined4 *)((int)puVar18 + 5);
      *pcVar19 = *(char *)(puVar18 + 1);
      pcVar20 = (char *)*(undefined6 *)(unaff_EBP + 0x1de39d3f);
      iVar14 = CONCAT22((short)((uint)uVar15 >> 0x10),CONCAT11(bVar16 - bVar8,(char)uVar15)) + -1;
      if (iVar14 == 0 || bVar21) {
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      }
    }
    ppcVar11 = (char **)puVar13;
    if (iVar14 == 0) goto code_r0x004fdb42;
    while( true ) {
      if (!bVar21) {
        return;
      }
      bVar21 = unaff_EBP < uVar17;
      uVar10 = unaff_EBP - uVar17;
      unaff_EBP = uVar10 - bVar22;
      *(int *)(unaff_EBX + 0x62) =
           (*(int *)(unaff_EBX + 0x62) - unaff_EBP) - (uint)(bVar21 || uVar10 < bVar22);
      ppcVar11 = &param_3;
      unaff_ESI = puVar13;
code_r0x004fdb42:
      LOCK();
      uVar7 = *(undefined1 *)(iVar14 + -0x28be7347);
      *(undefined1 *)(iVar14 + -0x28be7347) = (char)((uint)iVar14 >> 8);
      UNLOCK();
      if (CONCAT22((short)((uint)iVar14 >> 0x10),CONCAT11(uVar7,(char)iVar14)) != 0) {
        return;
      }
      bVar8 = (byte)ppcVar11;
      if (SBORROW1(bVar8,*pcVar20)) break;
      bVar22 = 0x1c < bVar8;
      puVar13 = (undefined4 *)CONCAT31((int3)((uint)ppcVar11 >> 8),bVar8 - 0x1d);
      bVar21 = (byte)(bVar8 - 0x1d) == '\0';
      iVar14 = 0;
    }
    iVar14 = 0;
    fVar24 = in_ST0;
    in_ST0 = in_ST1;
    in_ST1 = in_ST2;
    in_ST2 = in_ST3;
    in_ST3 = in_ST4;
    in_ST4 = in_ST5;
    in_ST5 = in_ST6;
    in_ST6 = in_ST7;
    _DAT_ae2e1365 = ppcVar11;
  } while( true );
}


