/*
 * Function: System_FPUContextSave
 * Address: 004fedc4
 * Category: system
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x004fedd7) overlaps instruction at (ram,0x004fedd2)
    */
/* WARNING: Removing unreachable block (ram,0x004fedb7) */
/* WARNING: Removing unreachable block (ram,0x004fee29) */
/* WARNING: Removing unreachable block (ram,0x004fee42) */
/* WARNING: Removing unreachable block (ram,0x004feeb1) */

void System_FPUContextSave(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  code *pcVar3;
  byte bVar4;
  uint uVar5;
  int extraout_ECX;
  char *pcVar6;
  undefined2 extraout_DX;
  int *unaff_EBX;
  int unaff_EBP;
  int unaff_EDI;
  undefined2 in_ES;
  undefined2 in_FPUControlWord;
  undefined2 in_FPUStatusWord;
  undefined2 in_FPUTagWord;
  undefined2 in_FPULastInstructionOpcode;
  undefined4 in_FPUDataPointer;
  undefined4 in_FPUInstructionPointer;
  float10 extraout_ST0;
  unkbyte10 extraout_ST1;
  unkbyte10 in_ST2;
  unkbyte10 in_ST3;
  unkbyte10 in_ST4;
  unkbyte10 in_ST5;
  unkbyte10 in_ST6;
  unkbyte10 in_ST7;
  undefined4 uStack_8;
  
  pcVar3 = (code *)swi(0x2b);
  uVar5 = (*pcVar3)();
  iVar1 = *unaff_EBX;
  uStack_8 = CONCAT22(uStack_8._2_2_,in_ES);
  uVar5 = uVar5 ^ *(uint *)((int)unaff_EBX + -0x1665e3d6);
  if (!SCARRY4(unaff_EBP,1)) {
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  bVar4 = (byte)uVar5 & 0xfb;
  *(undefined2 *)(extraout_ECX + 0x49) = in_FPUControlWord;
  *(undefined2 *)(extraout_ECX + 0x4d) = in_FPUStatusWord;
  *(undefined2 *)(extraout_ECX + 0x51) = in_FPUTagWord;
  *(undefined4 *)(extraout_ECX + 0x5d) = in_FPUDataPointer;
  *(undefined4 *)(extraout_ECX + 0x55) = in_FPUInstructionPointer;
  *(undefined2 *)(extraout_ECX + 0x5b) = in_FPULastInstructionOpcode;
  *(float10 *)(extraout_ECX + 0x65) = extraout_ST0 + (float10)iVar1;
  *(unkbyte10 *)(extraout_ECX + 0x6f) = extraout_ST1;
  *(unkbyte10 *)(extraout_ECX + 0x79) = in_ST2;
  *(unkbyte10 *)(extraout_ECX + 0x83) = in_ST3;
  *(unkbyte10 *)(extraout_ECX + 0x8d) = in_ST4;
  *(unkbyte10 *)(extraout_ECX + 0x97) = in_ST5;
  *(unkbyte10 *)(extraout_ECX + 0xa1) = in_ST6;
  *(unkbyte10 *)(extraout_ECX + 0xab) = in_ST7;
  *(longlong *)(unaff_EDI + -0x43) = (longlong)ROUND(extraout_ST0 + (float10)iVar1);
  if ((char)bVar4 < '\x01') {
    if ((POPCOUNT(bVar4) & 1U) != 0) {
      pcVar3 = (code *)swi(0x29);
      (*pcVar3)();
      uVar2 = in(extraout_DX);
      *(undefined4 *)(unaff_EDI + 1) = uVar2;
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  uVar5 = uVar5 & 0xfffffffb | 0x7e;
  *(char *)(uVar5 + 0x7f93c15f) = (char)uVar5;
  pcVar6 = (char *)(extraout_ECX - *(int *)(uStack_8 + -0x241ab61d));
  *pcVar6 = *pcVar6 - (char)((uint)pcVar6 >> 8);
  in(0xf1);
  do {
                    /* WARNING: Do nothing block with infinite loop */
  } while( true );
}


