/*
 * Function: Threading_CreateSemaphore
 * Address: 004816d0
 * Category: system
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl
Threading_CreateSemaphore
          (_String_base *param_1,int *param_2,int param_3,int param_4,int param_5,int param_6,
          undefined4 param_7)

{
  char cVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int extraout_ECX;
  uint uVar5;
  int extraout_EDX;
  ushort *puVar6;
  _String_base *p_Var7;
  undefined4 local_80 [2];
  int local_78;
  int local_70;
  ushort *local_5c;
  
  if (param_1 != (_String_base *)0x0) {
    local_80[0] = 0x7c;
    p_Var7 = param_1;
    iVar2 = (**(code **)(*(int *)param_1 + 100))(param_1,0,local_80,0x21,0,"Lock Texture");
    cVar1 = Threading_LockMutex(iVar2,p_Var7);
    if (cVar1 == '\0') {
      iVar3 = SexyWidget_GetWidth((int)param_2);
      iVar2 = param_5;
      if (iVar3 - param_3 <= param_5) {
        iVar2 = SexyWidget_GetWidth(extraout_ECX);
        iVar2 = iVar2 - extraout_EDX;
      }
      iVar4 = SexyWidget_GetHeight((int)param_2);
      iVar3 = param_6;
      if (iVar4 - param_4 <= param_6) {
        iVar3 = SexyWidget_GetHeight((int)param_2);
        iVar3 = iVar3 - param_4;
      }
      if ((iVar2 < param_5) || (iVar3 < param_6)) {
        puVar6 = local_5c;
        for (uVar5 = (uint)(local_78 * local_70) >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
          puVar6[0] = 0;
          puVar6[1] = 0;
          puVar6 = puVar6 + 2;
        }
        for (uVar5 = local_78 * local_70 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
          *(undefined1 *)puVar6 = 0;
          puVar6 = (ushort *)((int)puVar6 + 1);
        }
      }
      if ((0 < iVar2) && (0 < iVar3)) {
        switch(param_7) {
        case 1:
          Texture_CopyPixels((undefined4 *)local_5c,local_70,param_3,param_4,iVar2);
          break;
        case 2:
          Texture_ConvertARGBTo4444(local_5c,local_70,param_2,param_3,iVar2);
          break;
        case 4:
          Graphics_ProcessTextureMapping(local_5c,local_70,param_2,param_3,iVar2);
          break;
        case 8:
          Graphics_UpdateTextureCoords((int)local_5c,local_70,param_3,param_4,iVar3);
        }
      }
      iVar2 = (**(code **)(*(int *)param_1 + 0x80))(param_1,0,"Texture Unlock");
      Threading_LockMutex(iVar2,param_1);
    }
  }
  return;
}


