/*
 * Function: Memory_ValidateHeap
 * Address: 004fc95f
 * Category: memory
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x004fca93) overlaps instruction at (ram,0x004fca92)
    */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Removing unreachable block (ram,0x004fc9f0) */
/* WARNING: Removing unreachable block (ram,0x004fca3d) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

ulonglong __thiscall
Memory_ValidateHeap(void *this,undefined1 *param_1,undefined4 param_2,uint param_3,
                   undefined4 param_4,undefined4 param_5,uint param_6,int param_7,undefined4 param_8
                   ,byte *param_9)

{
  byte *pbVar1;
  uint *puVar2;
  uint uVar3;
  code *pcVar4;
  byte bVar5;
  byte bVar6;
  undefined1 uVar7;
  undefined4 in_EAX;
  void *extraout_ECX;
  uint uVar9;
  byte *unaff_EBX;
  uint unaff_EBP;
  int unaff_ESI;
  undefined4 *puVar10;
  undefined1 *unaff_EDI;
  undefined2 in_CS;
  byte bVar11;
  bool bVar12;
  byte in_AF;
  float10 fVar13;
  int unaff_retaddr;
  undefined1 *puVar8;
  
  bVar11 = 0x91 < (byte)in_EAX;
  bVar5 = (byte)in_EAX + 0x6e;
  if (!(bool)bVar11 && bVar5 != 0) {
    unaff_retaddr = CONCAT31((int3)((uint)unaff_retaddr >> 8),(char)((uint)in_EAX >> 8));
code_r0x004fc96d:
    bVar6 = 0x84;
    if (bVar5 != 0) {
      unaff_retaddr = CONCAT31((int3)((uint)unaff_retaddr >> 8),(char)unaff_retaddr - (char)this);
      unaff_EDI = unaff_EDI + 4;
      pbVar1 = (byte *)(unaff_ESI + -0x53);
      bVar11 = *pbVar1;
      *pbVar1 = *pbVar1 + 0x16;
      bVar6 = (0xe9 < bVar11) + 0x7d;
      puVar8 = param_1;
      if ((POPCOUNT(bVar6) & 1U) != 0) {
        bVar11 = *(uint *)(param_1 + 0x54) < unaff_ESI + 4U;
        unaff_EBX = param_1 + -1;
        goto LAB_004fc98d;
      }
    }
    else {
LAB_004fc98d:
      puVar8 = (undefined1 *)CONCAT31((int3)((uint)unaff_EBX >> 8),0x8d);
      *(int *)(puVar8 + 0xb) = *(int *)(puVar8 + 0xb) + 1;
      bVar12 = bVar6 < 0x35;
      bVar5 = bVar6 - 0x35;
      bVar6 = bVar5 - bVar11;
      *(uint *)(unaff_EBP + 0xbd83c683) =
           *(uint *)(unaff_EBP + 0xbd83c683) << 1 |
           (uint)(CARRY4((uint)unaff_EDI,_DAT_e9a19320) ||
                 CARRY4((uint)(unaff_EDI + _DAT_e9a19320),(uint)(bVar12 || bVar5 < bVar11)));
    }
    unaff_EBX = (byte *)CONCAT31((int3)((uint)puVar8 >> 8),0x3d);
    out((short)unaff_retaddr,bVar6);
    *(char *)((int)this + 0x2e) = *(char *)((int)this + 0x2e) + -1;
    puVar2 = (uint *)((int)this + -0x4b);
    uVar9 = *puVar2;
    uVar3 = *puVar2;
    *puVar2 = *puVar2 + unaff_EBP;
    if (SCARRY4(uVar3,unaff_EBP)) goto LAB_004fca05;
    bVar5 = in((short)param_6);
    bVar11 = 9 < (bVar5 & 0xf) | in_AF;
    bVar5 = bVar5 + bVar11 * '\x06';
    unaff_retaddr =
         CONCAT31((int3)((uint)param_8 >> 8),
                  bVar5 + (0x90 < (bVar5 & 0xf0) | CARRY4(uVar9,unaff_EBP) | bVar11 * (0xf9 < bVar5)
                          ) * '`');
    pcVar4 = (code *)swi(4);
    this = (void *)param_7;
    unaff_EBX = param_9;
    uVar9 = param_3;
    unaff_EDI = param_1;
    if (SCARRY4(uVar3,unaff_EBP)) {
      unaff_retaddr = (*pcVar4)();
      this = extraout_ECX;
    }
  }
  else {
    in_AF = 9 < (bVar5 & 0xf) | in_AF;
    bVar6 = bVar5 + in_AF * -6;
    bVar11 = 0x9f < bVar6 | bVar11 | in_AF * (bVar6 < 6);
    this = (void *)((int)this + -1);
    uVar9 = unaff_EBP;
    if (this == (void *)0x0) goto code_r0x004fc96d;
  }
  param_9 = (byte *)CONCAT22(param_9._2_2_,in_CS);
  *unaff_EDI = (char)unaff_retaddr;
  fVar13 = *(float10 *)((int)this + 0x74ed0d38);
  *(uint *)(unaff_EBX + 0x278cd2e1) = *(uint *)(unaff_EBX + 0x278cd2e1) ^ 0xffffffed;
  out(9,0x47);
  uRam9238a0f2 = uRam9238a0f2 << 0x11 | uRam9238a0f2 >> 0xf;
  uVar7 = in(0x19ab);
  puVar10 = (undefined4 *)(unaff_retaddr + -2);
  out(*(undefined1 *)(unaff_retaddr + -1),0x19ab);
  puVar8 = (undefined1 *)CONCAT31(0x9238a1,uVar7);
  if (param_9 != (byte *)0x1) {
    if ((int)this + -1 == 0 || param_9 != (byte *)0x1) {
      param_9[-0xffffffff00000005] = 0x1c;
      param_9[-0xffffffff00000004] = 0x5d;
      param_9[-0xffffffff00000003] = 0x8b;
      param_9[-0xffffffff00000002] = 5;
      return CONCAT44(0x766819ab,puVar8);
    }
    bVar11 = *unaff_EBX;
    _DAT_46ab5253 = puVar8;
    *unaff_EBX = *unaff_EBX >> 1 | (bVar11 & 1) << 7;
    *(undefined1 **)(param_9 + -5) = unaff_EDI + 1;
    if (uVar9 == 1 || ((int)(uVar9 - 1) < 0 != ((bVar11 & 1) != 0)) != (int)(uVar9 - 1) < 0) {
      *(double *)(unaff_EDI + 0x7f) = (double)fVar13;
    }
    *(int *)(*(int *)(param_9 + -5) + -4) = (int)this + -1;
    pcVar4 = (code *)swi(0xc0);
    (*pcVar4)();
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  uVar9 = uRam76681996 ^ 0x766819ab;
  unaff_retaddr = CONCAT31((int3)(uVar9 >> 8),0x2c);
  *puVar8 = (char)this;
  if (-1 < (int)uVar9) {
    out(*puVar10,(short)unaff_retaddr);
    out((short)unaff_retaddr,puVar8);
  }
LAB_004fca05:
  return CONCAT44((int)((ulonglong)((longlong)*(int *)(unaff_EBX + unaff_retaddr) * -0x6a9a521a) >>
                       0x20),
                  (int)((longlong)*(int *)(unaff_EBX + unaff_retaddr) * -0x6a9a521a) + -0x54a461ec)
         & 0xffffffffffffffb5;
}


