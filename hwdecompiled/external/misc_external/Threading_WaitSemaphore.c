/*
 * Function: Threading_WaitSemaphore
 * Address: 00481840
 * Category: enemies
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __fastcall Threading_WaitSemaphore(int param_1)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int extraout_ECX;
  uint uVar4;
  int iVar5;
  undefined4 local_8;
  
  iVar5 = 0;
  local_8 = 0;
  iVar3 = param_1;
  while( true ) {
    iVar1 = *(int *)(param_1 + 4);
    if (iVar1 == 0) {
      uVar4 = 0;
    }
    else {
      iVar3 = *(int *)(param_1 + 8) - iVar1;
      uVar4 = iVar3 / 0xc;
    }
    if ((int)uVar4 <= local_8) break;
    piVar2 = *(int **)(iVar5 + iVar1);
    if (piVar2 != (int *)0x0) {
      (**(code **)(*piVar2 + 8))(piVar2);
      iVar3 = extraout_ECX;
    }
    local_8 = local_8 + 1;
    iVar5 = iVar5 + 0xc;
  }
  if (*(int *)(param_1 + 4) != 0) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(iVar3,uVar4);
  }
  piVar2 = *(int **)(param_1 + 0x10);
  *(undefined4 *)(param_1 + 4) = 0;
  *(undefined4 *)(param_1 + 8) = 0;
  *(undefined4 *)(param_1 + 0xc) = 0;
  *(undefined4 *)(param_1 + 0x30) = 0;
  if (piVar2 != (int *)0x0) {
    (**(code **)(*piVar2 + 8))(piVar2);
    *(undefined4 *)(param_1 + 0x10) = 0;
  }
  return;
}


