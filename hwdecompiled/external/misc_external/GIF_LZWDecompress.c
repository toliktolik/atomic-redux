/*
 * Function: GIF_LZWDecompress
 * Address: 004d29d0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl GIF_LZWDecompress(int *param_1)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  int *extraout_ECX;
  int *piVar5;
  int iVar6;
  int *piVar7;
  
  piVar1 = param_1;
  if (param_1[5] != 0xca) {
    *(undefined4 *)(*param_1 + 0x14) = 0x14;
    *(int *)(*param_1 + 0x18) = param_1[5];
    (**(code **)*param_1)(param_1);
  }
  iVar2 = param_1[0xc];
  uVar4 = param_1[0xd];
  if ((uint)(iVar2 * 8) < uVar4 || iVar2 * 8 - uVar4 == 0) {
    iVar2 = Math_AlignToMultiple(param_1[7],8);
    param_1[0x17] = iVar2;
    iVar2 = Math_AlignToMultiple(param_1[8],8);
    param_1[0x46] = 1;
  }
  else if ((uint)(iVar2 * 4) < uVar4 || iVar2 * 4 - uVar4 == 0) {
    iVar2 = Math_AlignToMultiple(param_1[7],4);
    param_1[0x17] = iVar2;
    iVar2 = Math_AlignToMultiple(param_1[8],4);
    param_1[0x46] = 2;
  }
  else if (uVar4 < (uint)(iVar2 * 2)) {
    iVar2 = param_1[8];
    param_1[0x17] = param_1[7];
    param_1[0x46] = 8;
  }
  else {
    iVar2 = Math_AlignToMultiple(param_1[7],2);
    param_1[0x17] = iVar2;
    iVar2 = Math_AlignToMultiple(param_1[8],2);
    param_1[0x46] = 4;
  }
  piVar5 = (int *)param_1[0x31];
  param_1[0x18] = iVar2;
  piVar7 = param_1 + 9;
  param_1 = (int *)0x0;
  if (0 < *piVar7) {
    piVar5 = piVar5 + 3;
    do {
      iVar2 = piVar1[0x46];
      iVar3 = iVar2;
      if (iVar2 < 8) {
        do {
          iVar6 = piVar5[-1] * iVar3 * 2;
          if ((iVar6 - piVar1[0x44] * iVar2 != 0 && piVar1[0x44] * iVar2 <= iVar6) ||
             (iVar6 = *piVar5 * iVar3 * 2,
             iVar6 - piVar1[0x45] * iVar2 != 0 && piVar1[0x45] * iVar2 <= iVar6)) break;
          iVar3 = iVar3 * 2;
        } while (iVar3 < 8);
      }
      piVar5[6] = iVar3;
      param_1 = (int *)((int)param_1 + 1);
      piVar5 = piVar5 + 0x15;
    } while ((int)param_1 < piVar1[9]);
  }
  iVar2 = 0;
  if (0 < piVar1[9]) {
    piVar7 = (int *)(piVar1[0x31] + 0x24);
    do {
      iVar3 = Math_AlignToMultiple(piVar7[-7] * *piVar7 * piVar1[7],piVar1[0x44] << 3);
      piVar7[1] = iVar3;
      iVar3 = Math_AlignToMultiple(piVar7[-6] * piVar1[8] * *piVar7,piVar1[0x45] << 3);
      piVar7[2] = iVar3;
      iVar2 = iVar2 + 1;
      piVar7 = piVar7 + 0x15;
      piVar5 = extraout_ECX;
    } while (iVar2 < piVar1[9]);
  }
  switch(piVar1[0xb]) {
  case 1:
    piVar1[0x19] = 1;
    break;
  case 2:
  case 3:
    piVar1[0x19] = 3;
    break;
  case 4:
  case 5:
    piVar1[0x19] = 4;
    break;
  default:
    piVar1[0x19] = piVar1[9];
  }
  iVar2 = 1;
  if (*(char *)((int)piVar1 + 0x4a) == '\0') {
    iVar2 = piVar1[0x19];
  }
  piVar1[0x1a] = iVar2;
  uVar4 = GIF_EncodeImage(piVar5,(int)piVar1);
  if ((char)uVar4 == '\0') {
    piVar1[0x1b] = 1;
    return;
  }
  piVar1[0x1b] = piVar1[0x45];
  return;
}


