/*
 * Function: Memory_CompactHeap
 * Address: 004fccd6
 * Category: memory
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */

void __fastcall Memory_CompactHeap(int param_1,undefined4 param_2)

{
  int *piVar1;
  byte bVar2;
  byte bVar3;
  byte bVar4;
  byte bVar5;
  byte bVar6;
  byte bVar7;
  byte bVar8;
  byte bVar9;
  byte bVar10;
  byte bVar11;
  byte bVar12;
  byte bVar13;
  char cVar14;
  undefined4 in_EAX;
  byte *pbVar15;
  int extraout_ECX;
  byte bVar16;
  byte *unaff_ESI;
  int unaff_EDI;
  byte in_AF;
  bool in_SF;
  byte in_TF;
  byte in_IF;
  byte in_NT;
  byte in_AC;
  byte in_VIF;
  byte in_VIP;
  byte in_ID;
  undefined8 uVar17;
  
  uVar17 = CONCAT44(param_2,in_EAX);
  if (in_SF) {
    return;
  }
  while( true ) {
    pbVar15 = (byte *)uVar17;
    bVar3 = *unaff_ESI;
    bVar2 = *pbVar15;
    bVar16 = (byte)((ulonglong)uVar17 >> 0x28);
    bVar13 = *pbVar15 + bVar16;
    *pbVar15 = bVar13 + (0x83 < bVar3);
    bVar4 = *(byte *)(param_1 + -1);
    cVar14 = bVar4 + 0x55;
    if (cVar14 == '\0' || (char)bVar4 < -0x55) break;
    bVar5 = in_NT & 1;
    bVar6 = in_IF & 1;
    bVar7 = in_TF & 1;
    bVar8 = in_AF & 1;
    bVar9 = in_ID & 1;
    bVar10 = in_VIP & 1;
    bVar11 = in_VIF & 1;
    bVar12 = in_AC & 1;
    uVar17 = func_0xc01b6ebd((uint)(pbVar15 +
                                   (CARRY1(bVar2,bVar16) || CARRY1(bVar13,0x83 < bVar3)) +
                                   0xb4a7e529) & 0xffffff47);
    unaff_ESI = (byte *)(unaff_EDI + -5);
    out(*(undefined1 *)(unaff_EDI + -4),(short)((ulonglong)uVar17 >> 0x20));
    param_1 = extraout_ECX;
    unaff_EDI = ((uint)bVar5 * 0x4000 | (uint)SBORROW1(bVar4,-0x55) * 0x800 | 0x400 |
                 (uint)bVar6 * 0x200 | (uint)bVar7 * 0x100 | (uint)(cVar14 < '\0') * 0x80 |
                 (uint)(cVar14 == '\0') * 0x40 | (uint)bVar8 * 0x10 |
                 (uint)((POPCOUNT(cVar14) & 1U) == 0) * 4 | (uint)(bVar4 < 0xab) |
                 (uint)bVar9 * 0x200000 | (uint)bVar10 * 0x100000 | (uint)bVar11 * 0x80000 |
                (uint)bVar12 * 0x40000) - 4;
  }
  piVar1 = (int *)(((uint)(pbVar15 +
                          (CARRY1(bVar2,bVar16) || CARRY1(bVar13,0x83 < bVar3)) + 0xb4a7e529) &
                   0xffffff47) + 0x450bc883);
  *piVar1 = *piVar1 - param_1;
  *(byte *)(unaff_EDI + -1) = *unaff_ESI;
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}


