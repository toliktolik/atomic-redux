/*
 * Function: GIF_ReadExtension
 * Address: 004d1f50
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl GIF_ReadExtension(int *param_1)

{
  undefined1 uVar1;
  undefined4 *puVar2;
  void *this;
  char cVar3;
  uint uVar4;
  int iVar5;
  undefined1 *puVar6;
  int iVar7;
  undefined4 *in_stack_ffffffd4;
  undefined4 *in_stack_ffffffd8;
  void *local_18;
  void *local_10;
  
  this = DAT_00569f5c;
  puVar2 = (undefined4 *)param_1[6];
  iVar7 = puVar2[1];
  puVar6 = (undefined1 *)*puVar2;
  if (iVar7 == 0) {
    cVar3 = (*(code *)puVar2[3])(param_1);
    if (cVar3 == '\0') goto LAB_004d2061;
    iVar7 = puVar2[1];
    puVar6 = (undefined1 *)*puVar2;
  }
  uVar1 = *puVar6;
  iVar7 = iVar7 + -1;
  puVar6 = puVar6 + 1;
  if (iVar7 == 0) {
    cVar3 = (*(code *)puVar2[3])(param_1);
    if (cVar3 == '\0') {
LAB_004d2061:
      Exception_SetMessage(this,in_stack_ffffffd4,in_stack_ffffffd8);
      return;
    }
    iVar7 = puVar2[1];
    puVar6 = (undefined1 *)*puVar2;
  }
  iVar7 = iVar7 + -1;
  uVar4 = CONCAT11(uVar1,*puVar6) - 2;
  puVar6 = puVar6 + 1;
  if ((int)uVar4 < 0xe) {
    local_10 = (void *)(((int)uVar4 < 1) - 1 & uVar4);
  }
  else {
    local_10 = (void *)0xe;
  }
  local_18 = (void *)0x0;
  if (local_10 != (void *)0x0) {
    do {
      if (iVar7 == 0) {
        cVar3 = (*(code *)puVar2[3])(param_1);
        if (cVar3 == '\0') goto LAB_004d2061;
        iVar7 = puVar2[1];
        puVar6 = (undefined1 *)*puVar2;
      }
      iVar7 = iVar7 + -1;
      (&stack0xffffffd4)[(int)local_18] = *puVar6;
      puVar6 = puVar6 + 1;
      local_18 = (void *)((int)local_18 + 1);
    } while (local_18 < local_10);
  }
  iVar5 = uVar4 - (int)local_10;
  if (param_1[0x5f] == 0xe0) {
    GIF_ReadImageDescriptor(iVar5);
  }
  else if (param_1[0x5f] == 0xee) {
    GIF_WriteImageDescriptor(local_10,iVar5);
  }
  else {
    *(undefined4 *)(*param_1 + 0x14) = 0x44;
    *(int *)(*param_1 + 0x18) = param_1[0x5f];
    (**(code **)*param_1)(param_1);
  }
  *puVar2 = puVar6;
  puVar2[1] = iVar7;
  if (0 < iVar5) {
    (**(code **)(param_1[6] + 0x10))(param_1,iVar5);
  }
  Exception_SetMessage(this,in_stack_ffffffd4,in_stack_ffffffd8);
  return;
}


