/*
 * Function: AudioCodec_ConvertFormat
 * Address: 004b74f0
 * Category: audio
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void AudioCodec_ConvertFormat(int param_1,void *param_2)

{
  char *pcVar1;
  uint uVar2;
  _String_base *p_Var3;
  char *pcVar4;
  int iVar5;
  int extraout_ECX;
  int extraout_ECX_00;
  int extraout_ECX_01;
  int extraout_ECX_02;
  int extraout_ECX_03;
  int iVar6;
  uint extraout_EDX;
  int extraout_EDX_00;
  uint extraout_EDX_01;
  int *piVar7;
  int *piVar8;
  undefined8 uVar9;
  uint unaff_retaddr;
  undefined4 *puVar10;
  undefined4 *puVar11;
  int local_9c [3];
  _String_base local_90 [4];
  int local_8c;
  uint local_78;
  int local_74 [2];
  int local_6c [3];
  _String_base local_60 [4];
  uint local_5c;
  undefined4 local_4c;
  uint local_48;
  undefined4 local_44;
  int local_40;
  _String_base local_3c [4];
  uint local_38;
  uint local_28;
  uint local_24;
  undefined4 local_20;
  int local_1c;
  char local_18 [4];
  uint local_14;
  void *local_10;
  undefined4 uStack_c;
  int local_8;
  
  uStack_c = 0x51708b;
  local_10 = ExceptionList;
  local_14 = DAT_00569f5c ^ unaff_retaddr;
  local_1c = 0;
  local_20 = 0;
  local_24 = 0xf;
  local_28 = 0;
  local_38 = local_38 & 0xffffff00;
  local_8 = 0;
  local_18[0] = '.';
  ExceptionList = &local_10;
  uVar2 = XML_GetElementValue(param_2,local_18,0xffffffff,1);
  if (uVar2 != 0xffffffff) {
    p_Var3 = GameMenu_ProcessRegistrationScreen(param_2,local_90,uVar2 + 1,0xffffffff);
    local_8._0_1_ = 1;
    uVar9 = Image_CreateSurface(local_60,(int)p_Var3);
    local_8._0_1_ = 2;
    PowerUp_ProcessThunderstrike
              (local_3c,(uint)((ulonglong)uVar9 >> 0x20),(_String_base *)uVar9,0,0xffffffff);
    if (0xf < local_48) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler(extraout_ECX,extraout_EDX);
    }
    local_48 = 0xf;
    local_4c = 0;
    local_5c = local_5c & 0xffffff00;
    local_8 = (uint)local_8._1_3_ << 8;
    if (0xf < local_78) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler(local_8c,extraout_EDX);
    }
  }
  pcVar1 = "wav";
  do {
    pcVar4 = pcVar1;
    pcVar1 = pcVar4 + 1;
  } while (*pcVar4 != '\0');
  uVar2 = String_Compare(local_3c,0,local_28,(_String_base *)&DAT_00537930,
                         (uint)(pcVar4 + -0x537930));
  if (uVar2 != 0) {
    pcVar1 = "ogg";
    do {
      pcVar4 = pcVar1;
      pcVar1 = pcVar4 + 1;
    } while (*pcVar4 != '\0');
    uVar2 = String_Compare(local_3c,0,local_28,(_String_base *)&DAT_0053792c,
                           (uint)(pcVar4 + -0x53792c));
    if (uVar2 != 0) {
      pcVar1 = "mp3";
      do {
        pcVar4 = pcVar1;
        pcVar1 = pcVar4 + 1;
      } while (*pcVar4 != '\0');
      uVar2 = String_Compare(local_3c,0,local_28,(_String_base *)&DAT_00537928,
                             (uint)(pcVar4 + -0x537928));
      if (uVar2 != 0) {
        if (*(char *)(DAT_005a4380 + 8) == '\0') {
          if (*(uint *)((int)param_2 + 0x18) < 0x10) {
            puVar11 = (undefined4 *)0x0;
            puVar10 = (undefined4 *)0x0;
            iVar5 = (**(code **)(DAT_005a4380 + 0x48))(0,(int)param_2 + 4,0,0,4);
            iVar6 = extraout_ECX_02;
            local_1c = iVar5;
          }
          else {
            puVar11 = (undefined4 *)0x0;
            puVar10 = (undefined4 *)0x0;
            iVar5 = (**(code **)(DAT_005a4380 + 0x48))(0,*(undefined4 *)((int)param_2 + 4),0,0,4);
            iVar6 = extraout_ECX_01;
            local_1c = iVar5;
          }
        }
        else {
          if (*(uint *)((int)param_2 + 0x18) < 0x10) {
            iVar6 = (int)param_2 + 4;
          }
          else {
            iVar6 = *(int *)((int)param_2 + 4);
          }
          puVar11 = (undefined4 *)0x204;
          puVar10 = (undefined4 *)0x0;
          iVar5 = (**(code **)(DAT_005a4380 + 0x4c))(0,iVar6,0,0,0x204,0);
          iVar6 = extraout_ECX_00;
        }
        uVar9 = CONCAT44(iVar5,local_20);
        goto joined_r0x004b76bd;
      }
    }
  }
  if (*(uint *)((int)param_2 + 0x18) < 0x10) {
    iVar6 = (int)param_2 + 4;
  }
  else {
    iVar6 = *(int *)((int)param_2 + 4);
  }
  puVar11 = (undefined4 *)0x0;
  puVar10 = (undefined4 *)0x0;
  uVar9 = (**(code **)(DAT_005a4380 + 0x58))(0,iVar6,0,0,0);
  iVar5 = (int)uVar9;
  iVar6 = extraout_ECX_03;
joined_r0x004b76bd:
  if (iVar5 == 0) {
    if (0xf < local_24) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler(iVar6,(uint)((ulonglong)uVar9 >> 0x20));
    }
  }
  else {
    Widget_IsButtonDown(local_9c);
    local_74[0] = param_1;
    local_9c[0] = extraout_EDX_00;
    local_9c[1] = (int)uVar9;
    piVar7 = local_9c;
    piVar8 = local_6c;
    for (iVar6 = 10; iVar6 != 0; iVar6 = iVar6 + -1) {
      *piVar8 = *piVar7;
      piVar7 = piVar7 + 1;
      piVar8 = piVar8 + 1;
    }
    AudioCodec_EncodeFrame((void *)(local_40 + 4),&local_44,local_74);
    if (0xf < local_24) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler(local_38,extraout_EDX_01);
    }
  }
  ExceptionList = local_10;
  Exception_SetMessage((void *)(local_14 ^ unaff_retaddr),puVar10,puVar11);
  return;
}


