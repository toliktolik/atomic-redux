/*
 * Function: Algorithm_Merge
 * Address: 0045c600
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __thiscall Algorithm_Merge(void *this,void *param_1,uint param_2)

{
  bool bVar1;
  uint uVar2;
  char *pcVar3;
  int iVar4;
  _String_base *p_Var5;
  char *pcVar6;
  long lVar7;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  int extraout_ECX_01;
  undefined4 extraout_ECX_02;
  int extraout_ECX_03;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint extraout_EDX_03;
  undefined8 uVar8;
  _String_base local_64 [28];
  undefined1 local_48 [4];
  uint local_44;
  uint local_30;
  _String_base local_2c [4];
  uint local_28;
  undefined4 local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00513a38;
  local_10 = ExceptionList;
  pcVar3 = "-play";
  do {
    pcVar6 = pcVar3;
    pcVar3 = pcVar6 + 1;
  } while (*pcVar6 != '\0');
  ExceptionList = &local_10;
  uVar2 = String_Compare(param_1,0,*(uint *)((int)param_1 + 0x14),(_String_base *)"-play",
                         (uint)(pcVar6 + -0x531be4));
  if (uVar2 == 0) {
    *(undefined1 *)((int)this + 0x491) = 1;
    *(undefined1 *)((int)this + 0x490) = 0;
    ExceptionList = local_10;
    return;
  }
  pcVar3 = "-recnum";
  do {
    pcVar6 = pcVar3;
    pcVar3 = pcVar6 + 1;
  } while (*pcVar6 != '\0');
  uVar2 = String_Compare(param_1,0,*(uint *)((int)param_1 + 0x14),(_String_base *)&DAT_00531bdc,
                         (uint)(pcVar6 + -0x531bdc));
  if (uVar2 == 0) {
    if (*(uint *)(param_2 + 0x18) < 0x10) {
      pcVar3 = (char *)(param_2 + 4);
    }
    else {
      pcVar3 = *(char **)(param_2 + 4);
    }
    iVar4 = _atol(pcVar3);
    if (iVar4 < 1) {
      iVar4 = 5;
    }
    Algorithm_StableSort(extraout_ECX,extraout_EDX,iVar4,'\x01');
    p_Var5 = Intel_DisplayPopulationData
                       (extraout_ECX_00,(uint)local_48,(_String_base *)local_48,
                        (_String_base *)((int)this + 0x494),(_String_base *)"%d.dmo");
    local_8 = 0;
    if (*(uint *)(p_Var5 + 0x18) < 0x10) {
      p_Var5 = p_Var5 + 4;
    }
    else {
      p_Var5 = *(_String_base **)(p_Var5 + 4);
    }
    uVar8 = Sound_SetPosition(local_2c,p_Var5);
    local_8 = CONCAT31(local_8._1_3_,1);
    PowerUp_ProcessThunderstrike
              ((_String_base *)((int)this + 0x4b0),(uint)((ulonglong)uVar8 >> 0x20),
               (_String_base *)uVar8,0,0xffffffff);
    if (0xf < local_14) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler(local_28,extraout_EDX_00);
    }
    local_14 = 0xf;
    local_18 = 0;
    local_28 = local_28 & 0xffffff00;
    if (0xf < local_30) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler(extraout_ECX_01,local_44);
    }
  }
  else {
    pcVar3 = "-playnum";
    do {
      pcVar6 = pcVar3;
      pcVar3 = pcVar6 + 1;
    } while (*pcVar6 != '\0');
    uVar2 = String_Compare(param_1,0,*(uint *)((int)param_1 + 0x14),(_String_base *)"-playnum",
                           (uint)(pcVar6 + -0x531bd0));
    if (uVar2 == 0) {
      if (*(uint *)(param_2 + 0x18) < 0x10) {
        pcVar3 = (char *)(param_2 + 4);
      }
      else {
        pcVar3 = *(char **)(param_2 + 4);
      }
      lVar7 = _atol(pcVar3);
      param_2 = lVar7 - 1;
      if ((int)param_2 < 0) {
        param_2 = 0;
      }
      Algorithm_StableSort(extraout_ECX_02,extraout_EDX_01,param_2,'\0');
      p_Var5 = Intel_DisplayPopulationData
                         (local_48,param_2,(_String_base *)local_48,
                          (_String_base *)((int)this + 0x494),(_String_base *)"%d.dmo");
      local_8 = 2;
      if (*(uint *)(p_Var5 + 0x18) < 0x10) {
        p_Var5 = p_Var5 + 4;
      }
      else {
        p_Var5 = *(_String_base **)(p_Var5 + 4);
      }
      uVar8 = Sound_SetPosition(local_2c,p_Var5);
      local_8 = CONCAT31(local_8._1_3_,3);
      PowerUp_ProcessThunderstrike
                ((_String_base *)((int)this + 0x4b0),(uint)((ulonglong)uVar8 >> 0x20),
                 (_String_base *)uVar8,0,0xffffffff);
      if (0xf < local_14) {
                    /* WARNING: Subroutine does not return */
        System_ShutdownHandler(extraout_ECX_03,extraout_EDX_02);
      }
      local_14 = 0xf;
      local_18 = 0;
      local_28 = local_28 & 0xffffff00;
      if (0xf < local_30) {
                    /* WARNING: Subroutine does not return */
        System_ShutdownHandler(local_44,extraout_EDX_02);
      }
      *(undefined1 *)((int)this + 0x490) = 0;
      *(undefined1 *)((int)this + 0x491) = 1;
      ExceptionList = local_10;
      return;
    }
    bVar1 = String_EqualsCharArray(param_1,(_String_base *)"-record");
    if (!bVar1) {
      bVar1 = String_EqualsCharArray(param_1,(_String_base *)"-demofile");
      if (bVar1) {
        Level_InitializeZamblamia
                  ((_String_base *)((int)this + 0x4b0),param_2,(_String_base *)param_2);
        ExceptionList = local_10;
        return;
      }
      bVar1 = String_EqualsCharArray(param_1,(_String_base *)"-crash");
      if (bVar1) {
        DAT_00000000 = 0x21;
        ExceptionList = local_10;
        return;
      }
      bVar1 = String_EqualsCharArray(param_1,(_String_base *)"-screensaver");
      if (bVar1) {
        *(undefined1 *)((int)this + 0x314) = 1;
        ExceptionList = local_10;
        return;
      }
      p_Var5 = Survival_LoadConfiguration
                         (local_64,(_String_base *)"Invalid Command Line Param: ",(int)param_1);
                    /* WARNING: Load size is inaccurate */
      local_8 = 4;
      (**(code **)(*this + 0x70))(p_Var5);
      String_Destructor((int)local_64,extraout_EDX_03);
      Algorithm_EqualRange(this,(char *)0x0);
      ExceptionList = local_10;
      return;
    }
  }
  *(undefined1 *)((int)this + 0x490) = 1;
  *(undefined1 *)((int)this + 0x491) = 0;
  ExceptionList = local_10;
  return;
}


