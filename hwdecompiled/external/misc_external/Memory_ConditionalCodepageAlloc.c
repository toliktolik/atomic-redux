/*
 * Function: Memory_ConditionalCodepageAlloc
 * Address: 004ec78b
 * Category: memory
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


int __fastcall
Memory_ConditionalCodepageAlloc
          (undefined4 param_1,undefined2 param_2,undefined4 param_3,uint param_4)

{
  undefined4 uVar1;
  int iVar2;
  uint uVar3;
  int extraout_ECX;
  undefined8 uVar4;
  
  iVar2 = 0;
  uVar3 = 1;
  do {
    if (uVar3 == (param_4 & 0xfffffffb)) break;
    uVar3 = (&DAT_00546978)[iVar2];
    iVar2 = iVar2 + 1;
  } while (uVar3 != 0);
  if ((&DAT_00546974)[iVar2] != 0) {
    uVar1 = *(undefined4 *)(iVar2 * 4 + 0x569580);
    uVar4 = String_AllocateBuffer(uVar3,param_2);
    iVar2 = (int)uVar4;
    if (iVar2 != 0) {
      if ((param_4 & 4) == 0) {
        return iVar2;
      }
      uVar4 = Memory_DefragmentHeap((char)uVar1,(int)((ulonglong)uVar4 >> 0x20));
      if ((int)uVar4 == 0) {
        return iVar2;
      }
      Memory_AllocateBlock(extraout_ECX,(int)((ulonglong)uVar4 >> 0x20));
    }
  }
  return 0;
}


