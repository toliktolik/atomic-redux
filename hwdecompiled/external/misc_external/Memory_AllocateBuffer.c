/*
 * Function: Memory_AllocateBuffer
 * Address: 0047ff00
 * Category: memory
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void Memory_AllocateBuffer
               (int *param_1,int param_2,int param_3,undefined4 param_4,undefined4 param_5,
               void *param_6,uint *param_7,float *param_8)

{
  void *pvVar1;
  uint *puVar2;
  undefined4 *puVar3;
  locale *plVar4;
  int iVar5;
  undefined4 uVar6;
  int *piVar7;
  float10 fVar8;
  uint unaff_retaddr;
  undefined4 *in_stack_ffffffa4;
  undefined4 *in_stack_ffffffa8;
  char *local_1c;
  int local_18;
  uint local_14;
  void *local_10;
  undefined4 uStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  uStack_c = 0x5148c8;
  local_10 = ExceptionList;
  local_14 = DAT_00569f5c ^ unaff_retaddr;
  ExceptionList = &local_10;
  puVar3 = (undefined4 *)System_GetSystemInfo();
  *puVar3 = 0;
  plVar4 = (locale *)SexyWidget_ProcessInput(param_6,(int *)&param_6);
  local_8 = 0;
  iVar5 = Memory_ReallocateBuffer(&stack0xffffffa4,&param_2,&param_4,plVar4);
  fVar8 = CRuntime_StringToFloat(&stack0xffffffa4,&local_1c,iVar5);
  pvVar1 = param_6;
  local_8 = 0xffffffff;
  if (param_6 != (void *)0x0) {
    Threading_LockSectorByIndex(&local_18,0);
    iVar5 = *(int *)((int)pvVar1 + 4);
    if ((iVar5 != 0) && (iVar5 != -1)) {
      *(int *)((int)pvVar1 + 4) = iVar5 + -1;
    }
    puVar3 = (undefined4 *)((uint)pvVar1 & (*(int *)((int)pvVar1 + 4) != 0) - 1);
    Threading_UnlockSectorByIndex(&local_18);
    if (puVar3 != (undefined4 *)0x0) {
      (**(code **)*puVar3)(1);
    }
  }
  uVar6 = Graphics_LoadTexture(&param_2,&param_4);
  puVar2 = param_7;
  if ((char)uVar6 != '\0') {
    *param_7 = *param_7 | 1;
  }
  if (local_1c != &stack0xffffffa4) {
    piVar7 = (int *)System_GetSystemInfo();
    if (*piVar7 == 0) {
      *param_8 = (float)fVar8;
      goto LAB_0047ffeb;
    }
  }
  *puVar2 = *puVar2 | 2;
LAB_0047ffeb:
  *param_1 = param_2;
  param_1[1] = param_3;
  ExceptionList = local_10;
  Exception_SetMessage((void *)(local_14 ^ unaff_retaddr),in_stack_ffffffa4,in_stack_ffffffa8);
  return;
}


