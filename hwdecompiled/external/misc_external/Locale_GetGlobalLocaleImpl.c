/*
 * Function: Locale_GetGlobalLocaleImpl
 * Address: 004ebdbe
 * Category: memory
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

int Locale_GetGlobalLocaleImpl(void)

{
  _Locimp *this;
  int iVar1;
  int unaff_EBP;
  
  Assembly_BitShiftLocking();
  iVar1 = DAT_005a4820;
  if (DAT_005a4820 == 0) {
    Threading_LockSectorByIndex((void *)(unaff_EBP + -0x10),0);
    iVar1 = DAT_005a4820;
    *(undefined4 *)(unaff_EBP + -4) = 0;
    if (iVar1 == 0) {
      this = (_Locimp *)operator_new(0x34);
      *(_Locimp **)(unaff_EBP + -0x14) = this;
      *(undefined1 *)(unaff_EBP + -4) = 1;
      if (this == (_Locimp *)0x0) {
        iVar1 = 0;
      }
      else {
        iVar1 = std::locale::_Locimp::_Locimp(this,false);
      }
      *(undefined1 *)(unaff_EBP + -4) = 0;
      Global_SetCleanupHandler(iVar1);
      *(undefined4 *)(iVar1 + 0x10) = 0x3f;
      Background_UpdateParallaxLayers((void *)(iVar1 + 0x18),(_String_base *)&DAT_0052c61c);
      DAT_005a4824 = iVar1;
      RefCount_Increment(iVar1);
      _DAT_005a482c = DAT_005a4824;
    }
    *(undefined4 *)(unaff_EBP + -4) = 0xffffffff;
    Threading_UnlockSectorByIndex((int *)(unaff_EBP + -0x10));
  }
  ExceptionList = *(void **)(unaff_EBP + -0xc);
  return iVar1;
}


