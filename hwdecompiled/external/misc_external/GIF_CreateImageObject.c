/*
 * Function: GIF_CreateImageObject
 * Address: 004d4d70
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl GIF_CreateImageObject(uint *param_1,byte *param_2,byte *param_3)

{
  uint *puVar1;
  int iVar2;
  uint *puVar3;
  undefined4 uVar4;
  uint uVar5;
  int iVar6;
  byte bVar7;
  byte *pbVar8;
  byte *pbVar9;
  byte *pbVar10;
  int local_3c;
  int local_38;
  uint local_34;
  byte *local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  byte *local_1c;
  byte *local_18;
  byte *local_14;
  byte *local_10;
  byte *local_c;
  byte *local_8;
  
  puVar3 = param_1;
  puVar1 = param_1 + 7;
  local_c = *(byte **)param_2;
  local_8 = *(byte **)(param_2 + 4);
  local_10 = (byte *)param_1[0xd];
  if (local_10 < (byte *)param_1[0xc]) {
    local_14 = (byte *)param_1[0xc] + (-1 - (int)local_10);
  }
  else {
    local_14 = (byte *)(param_1[0xb] - (int)local_10);
  }
  uVar5 = *param_1;
  param_1 = (uint *)param_1[8];
  pbVar9 = (byte *)*puVar1;
  while (local_18 = pbVar9, uVar5 < 10) {
    switch((&switchD_004d4df8::switchdataD_004d5778)[uVar5]) {
    case (undefined *)0x4d4dff:
      for (; local_18 = pbVar9, pbVar9 < (byte *)0x3; pbVar9 = pbVar9 + 8) {
        if (local_8 == (byte *)0x0) {
          puVar3[8] = (uint)param_1;
          goto LAB_004d5504;
        }
        local_8 = local_8 + -1;
        param_3 = (byte *)0x0;
        param_1 = (uint *)((uint)param_1 | (uint)*local_c << ((byte)pbVar9 & 0x1f));
        local_c = local_c + 1;
      }
      puVar3[6] = (uint)param_1 & 1;
      switch(((uint)param_1 & 7) >> 1) {
      case 0:
        uVar5 = (uint)(pbVar9 + -3) & 7;
        param_1 = (uint *)(((uint)param_1 >> 3) >> (sbyte)uVar5);
        local_18 = pbVar9 + -3 + -uVar5;
        *puVar3 = 1;
        break;
      case 1:
        Audio_PlaySound(&local_2c,&local_28,&local_24,&local_20);
        uVar5 = Graphics_SetTransform((char)local_2c,(char)local_28,local_24,local_20,(int)param_2);
        puVar3[1] = uVar5;
        if (uVar5 != 0) {
          param_1 = (uint *)((uint)param_1 >> 3);
          local_18 = pbVar9 + -3;
          *puVar3 = 6;
          break;
        }
        goto LAB_004d56f1;
      case 2:
        param_1 = (uint *)((uint)param_1 >> 3);
        local_18 = pbVar9 + -3;
        *puVar3 = 3;
        break;
      case 3:
        *puVar3 = 9;
        *(char **)(param_2 + 0x18) = "invalid block type";
        puVar3[8] = (uint)param_1 >> 3;
        puVar3[7] = (uint)(pbVar9 + -3);
        *(byte **)(param_2 + 4) = local_8;
        param_3 = (byte *)0xfffffffd;
        goto LAB_004d4dc8;
      }
      break;
    case (undefined *)0x4d4ee7:
      for (; pbVar9 < (byte *)0x20; pbVar9 = pbVar9 + 8) {
        if (local_8 == (byte *)0x0) goto LAB_004d555d;
        local_8 = local_8 + -1;
        param_3 = (byte *)0x0;
        param_1 = (uint *)((uint)param_1 | (uint)*local_c << ((byte)pbVar9 & 0x1f));
        local_c = local_c + 1;
      }
      if (~(uint)param_1 >> 0x10 != ((uint)param_1 & 0xffff)) {
        *puVar3 = 9;
        *(char **)(param_2 + 0x18) = "invalid stored block lengths";
        param_3 = (byte *)0xfffffffd;
        goto LAB_004d4db9;
      }
      puVar3[1] = (uint)param_1 & 0xffff;
      local_18 = (byte *)0x0;
      param_1 = (uint *)0x0;
      if (puVar3[1] == 0) goto LAB_004d5061;
      *puVar3 = 2;
      break;
    case (undefined *)0x4d4f5c:
      if (local_8 == (byte *)0x0) {
LAB_004d555d:
        puVar3[8] = (uint)param_1;
LAB_004d5504:
        puVar3[7] = (uint)pbVar9;
        iVar6 = *(int *)param_2;
        *(byte **)param_2 = local_c;
        param_2[4] = 0;
        param_2[5] = 0;
        param_2[6] = 0;
        param_2[7] = 0;
        goto LAB_004d4dd1;
      }
      if (local_14 == (byte *)0x0) {
        local_14 = (byte *)0x0;
        if (local_10 == (byte *)puVar3[0xb]) {
          pbVar8 = (byte *)puVar3[0xc];
          pbVar10 = (byte *)puVar3[10];
          if (pbVar10 != pbVar8) {
            if (pbVar10 < pbVar8) {
              local_14 = pbVar8 + (-1 - (int)pbVar10);
            }
            else {
              local_14 = (byte *)puVar3[0xb] + -(int)pbVar10;
            }
            local_10 = pbVar10;
            if (local_14 != (byte *)0x0) goto LAB_004d5004;
          }
        }
        puVar3[0xd] = (uint)local_10;
        iVar6 = Audio_StopSound((int)puVar3,(int)param_2,(int)param_3);
        local_1c = (byte *)puVar3[0xc];
        local_10 = (byte *)puVar3[0xd];
        if (local_10 < local_1c) {
          local_14 = local_1c + (-1 - (int)local_10);
        }
        else {
          local_14 = (byte *)(puVar3[0xb] - (int)local_10);
        }
        local_30 = (byte *)puVar3[0xb];
        if (local_10 == local_30) {
          pbVar8 = (byte *)puVar3[10];
          if (pbVar8 != local_1c) {
            local_10 = pbVar8;
            if (pbVar8 < local_1c) {
              local_14 = local_1c + (-1 - (int)pbVar8);
            }
            else {
              local_14 = local_30 + -(int)pbVar8;
            }
          }
        }
        if (local_14 == (byte *)0x0) {
          puVar3[8] = (uint)param_1;
          puVar3[7] = (uint)pbVar9;
          *(byte **)(param_2 + 4) = local_8;
          *(byte **)(param_2 + 8) = local_c + (*(int *)(param_2 + 8) - *(int *)param_2);
          *(byte **)param_2 = local_c;
          puVar3[0xd] = (uint)local_10;
          Audio_StopSound((int)puVar3,(int)param_2,iVar6);
          return;
        }
      }
LAB_004d5004:
      param_3 = (byte *)0x0;
      pbVar9 = (byte *)puVar3[1];
      if (local_8 < (byte *)puVar3[1]) {
        pbVar9 = local_8;
      }
      if (local_14 < pbVar9) {
        pbVar9 = local_14;
      }
      pbVar8 = local_c;
      pbVar10 = local_10;
      for (uVar5 = (uint)pbVar9 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
        *(undefined4 *)pbVar10 = *(undefined4 *)pbVar8;
        pbVar8 = pbVar8 + 4;
        pbVar10 = pbVar10 + 4;
      }
      for (uVar5 = (uint)pbVar9 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
        *pbVar10 = *pbVar8;
        pbVar8 = pbVar8 + 1;
        pbVar10 = pbVar10 + 1;
      }
      local_c = local_c + (int)pbVar9;
      uVar5 = puVar3[1];
      local_8 = local_8 + -(int)pbVar9;
      local_10 = local_10 + (int)pbVar9;
      local_14 = local_14 + -(int)pbVar9;
      puVar3[1] = uVar5 - (int)pbVar9;
      if (uVar5 - (int)pbVar9 == 0) {
LAB_004d5061:
        *puVar3 = -(uint)(puVar3[6] != 0) & 7;
      }
      break;
    case (undefined *)0x4d5072:
      for (; pbVar9 < (byte *)0xe; pbVar9 = pbVar9 + 8) {
        if (local_8 == (byte *)0x0) goto LAB_004d5611;
        local_8 = local_8 + -1;
        param_3 = (byte *)0x0;
        param_1 = (uint *)((uint)param_1 | (uint)*local_c << ((byte)pbVar9 & 0x1f));
        local_c = local_c + 1;
      }
      puVar3[1] = (uint)param_1 & 0x3fff;
      if ((0x1d < ((uint)param_1 & 0x1f)) ||
         (uVar5 = ((uint)param_1 & 0x3fff) >> 5 & 0x1f, 0x1d < uVar5)) {
        *puVar3 = 9;
        *(char **)(param_2 + 0x18) = "too many length or distance symbols";
        goto switchD_004d4df8_caseD_4d55bd;
      }
      uVar5 = (**(code **)(param_2 + 0x20))
                        (*(undefined4 *)(param_2 + 0x28),uVar5 + 0x102 + ((uint)param_1 & 0x1f),4);
      puVar3[3] = uVar5;
      if (uVar5 != 0) {
        param_1 = (uint *)((uint)param_1 >> 0xe);
        pbVar9 = pbVar9 + -0xe;
        puVar3[2] = 0;
        *puVar3 = 4;
        goto switchD_004d4df8_caseD_4d5116;
      }
      puVar3[8] = (uint)param_1;
      puVar3[7] = (uint)pbVar9;
      *(byte **)(param_2 + 4) = local_8;
      param_3 = (byte *)0xfffffffc;
      goto LAB_004d4dc8;
    case (undefined *)0x4d5116:
switchD_004d4df8_caseD_4d5116:
      if (puVar3[2] < (puVar3[1] >> 10) + 4) {
        do {
          for (; pbVar9 < (byte *)0x3; pbVar9 = pbVar9 + 8) {
            if (local_8 == (byte *)0x0) {
LAB_004d5611:
              puVar3[8] = (uint)param_1;
              puVar3[7] = (uint)pbVar9;
              *(byte **)(param_2 + 8) = local_c + (*(int *)(param_2 + 8) - *(int *)param_2);
              *(byte **)param_2 = local_c;
              param_2[4] = 0;
              param_2[5] = 0;
              param_2[6] = 0;
              param_2[7] = 0;
              puVar3[0xd] = (uint)local_10;
              Audio_StopSound((int)puVar3,(int)param_2,(int)param_3);
              return;
            }
            local_8 = local_8 + -1;
            param_3 = (byte *)0x0;
            param_1 = (uint *)((uint)param_1 | (uint)*local_c << ((byte)pbVar9 & 0x1f));
            local_c = local_c + 1;
          }
          *(uint *)(puVar3[3] + *(int *)(&DAT_00542b00 + puVar3[2] * 4) * 4) = (uint)param_1 & 7;
          uVar5 = puVar3[2];
          param_1 = (uint *)((uint)param_1 >> 3);
          puVar3[2] = uVar5 + 1;
          pbVar9 = pbVar9 + -3;
        } while (uVar5 + 1 < (puVar3[1] >> 10) + 4);
      }
      uVar5 = puVar3[2];
      while (uVar5 < 0x13) {
        *(undefined4 *)(puVar3[3] + *(int *)(&DAT_00542b00 + puVar3[2] * 4) * 4) = 0;
        uVar5 = puVar3[2] + 1;
        puVar3[2] = uVar5;
      }
      puVar3[4] = 7;
      local_14 = (byte *)Audio_CreateSoundBuffer
                                   ((int *)puVar3[3],(int *)(puVar3 + 4),(int *)(puVar3 + 5),
                                    puVar3[9],(int)param_2);
      if (local_14 == (byte *)0x0) {
        puVar3[2] = 0;
        *puVar3 = 5;
        local_14 = (byte *)0x0;
switchD_004d4df8_caseD_4d5207:
        if (puVar3[2] < (puVar3[1] >> 5 & 0x1f) + 0x102 + (puVar3[1] & 0x1f)) {
          do {
            pbVar8 = (byte *)puVar3[4];
            if (pbVar9 < pbVar8) {
              do {
                if (local_8 == (byte *)0x0) goto LAB_004d5611;
                local_8 = local_8 + -1;
                bVar7 = (byte)pbVar9;
                pbVar9 = pbVar9 + 8;
                param_3 = (byte *)0x0;
                param_1 = (uint *)((uint)param_1 | (uint)*local_c << (bVar7 & 0x1f));
                pbVar8 = (byte *)puVar3[4];
                local_c = local_c + 1;
              } while (pbVar9 < pbVar8);
            }
            iVar6 = puVar3[5] + (*(uint *)(&DAT_005694c0 + (int)pbVar8 * 4) & (uint)param_1) * 8;
            bVar7 = *(byte *)(iVar6 + 1);
            local_14 = (byte *)(uint)bVar7;
            local_34 = *(uint *)(iVar6 + 4);
            if (local_34 < 0x10) {
              param_1 = (uint *)((uint)param_1 >> (bVar7 & 0x1f));
              pbVar9 = pbVar9 + -(int)local_14;
              *(uint *)(puVar3[3] + puVar3[2] * 4) = local_34;
              puVar3[2] = puVar3[2] + 1;
            }
            else {
              if (local_34 == 0x12) {
                local_1c = (byte *)0x7;
              }
              else {
                local_1c = (byte *)(local_34 - 0xe);
              }
              local_18 = (byte *)((uint)(local_34 == 0x12) * 8 + 3);
              local_30 = local_14 + (int)local_1c;
              for (; pbVar9 < local_30; pbVar9 = pbVar9 + 8) {
                if (local_8 == (byte *)0x0) {
                  puVar3[8] = (uint)param_1;
                  puVar3[7] = (uint)pbVar9;
                  iVar6 = *(int *)param_2;
                  *(byte **)param_2 = local_c;
                  param_2[4] = 0;
                  param_2[5] = 0;
                  param_2[6] = 0;
                  param_2[7] = 0;
                  goto LAB_004d4dd1;
                }
                local_8 = local_8 + -1;
                param_3 = (byte *)0x0;
                param_1 = (uint *)((uint)param_1 | (uint)*local_c << ((byte)pbVar9 & 0x1f));
                local_c = local_c + 1;
              }
              uVar5 = (uint)param_1 >> (bVar7 & 0x1f);
              local_18 = local_18 + (*(uint *)(&DAT_005694c0 + (int)local_1c * 4) & uVar5);
              param_1 = (uint *)(uVar5 >> ((byte)local_1c & 0x1f));
              pbVar9 = pbVar9 + -(int)(local_1c + (int)local_14);
              uVar5 = puVar3[2];
              if ((byte *)((puVar3[1] >> 5 & 0x1f) + 0x102 + (puVar3[1] & 0x1f)) < local_18 + uVar5)
              {
LAB_004d5671:
                (**(code **)(param_2 + 0x24))(*(undefined4 *)(param_2 + 0x28),puVar3[3]);
                *puVar3 = 9;
                *(char **)(param_2 + 0x18) = "invalid bit length repeat";
                puVar3[8] = (uint)param_1;
                puVar3[7] = (uint)pbVar9;
                iVar6 = *(int *)param_2;
                *(byte **)(param_2 + 4) = local_8;
                *(byte **)param_2 = local_c;
                *(byte **)(param_2 + 8) = local_c + (*(int *)(param_2 + 8) - iVar6);
                puVar3[0xd] = (uint)local_10;
                Audio_StopSound((int)puVar3,(int)param_2,-3);
                return;
              }
              if (local_34 == 0x10) {
                if (uVar5 == 0) goto LAB_004d5671;
                uVar4 = *(undefined4 *)((puVar3[3] - 4) + uVar5 * 4);
              }
              else {
                uVar4 = 0;
              }
              do {
                *(undefined4 *)(puVar3[3] + uVar5 * 4) = uVar4;
                uVar5 = uVar5 + 1;
                local_18 = local_18 + -1;
              } while (local_18 != (byte *)0x0);
              puVar3[2] = uVar5;
              local_18 = (byte *)0x0;
            }
          } while (puVar3[2] < (puVar3[1] >> 5 & 0x1f) + 0x102 + (puVar3[1] & 0x1f));
        }
        puVar3[5] = 0;
        local_18 = (byte *)0x9;
        local_1c = (byte *)0x6;
        local_14 = (byte *)Audio_LoadSound((puVar3[1] & 0x1f) + 0x101,(puVar3[1] >> 5 & 0x1f) + 1,
                                           (int *)puVar3[3],(int *)&local_18,(int *)&local_1c,
                                           &local_3c,&local_38,puVar3[9],(int)param_2);
        (**(code **)(param_2 + 0x24))(*(undefined4 *)(param_2 + 0x28),puVar3[3]);
        if (local_14 == (byte *)0x0) {
          uVar5 = Graphics_SetTransform
                            ((char)local_18,(char)local_1c,local_3c,local_38,(int)param_2);
          if (uVar5 == 0) {
LAB_004d56f1:
            param_3 = (byte *)0xfffffffc;
            goto LAB_004d4db9;
          }
          puVar3[1] = uVar5;
          *puVar3 = 6;
switchD_004d4df8_caseD_4d5450:
          puVar3[8] = (uint)param_1;
          puVar3[7] = (uint)pbVar9;
          iVar6 = *(int *)param_2;
          *(byte **)(param_2 + 4) = local_8;
          *(byte **)param_2 = local_c;
          *(byte **)(param_2 + 8) = local_c + (*(int *)(param_2 + 8) - iVar6);
          puVar3[0xd] = (uint)local_10;
          iVar6 = Graphics_SetMaterial((uint)puVar3,param_2,(int)param_3);
          if (iVar6 != 1) {
LAB_004d5747:
            Audio_StopSound((int)puVar3,(int)param_2,iVar6);
            return;
          }
          param_3 = (byte *)0x0;
          Audio_InitializeDirectSound(puVar3[1],(int)param_2);
          local_8 = *(byte **)(param_2 + 4);
          param_1 = (uint *)puVar3[8];
          local_c = *(byte **)param_2;
          local_18 = (byte *)puVar3[7];
          local_10 = (byte *)puVar3[0xd];
          if (local_10 < (byte *)puVar3[0xc]) {
            local_14 = (byte *)puVar3[0xc] + (-1 - (int)local_10);
          }
          else {
            local_14 = (byte *)(puVar3[0xb] - (int)local_10);
          }
          if (puVar3[6] == 0) {
            *puVar3 = 0;
            break;
          }
          *puVar3 = 7;
switchD_004d4df8_caseD_4d56fe:
          pbVar9 = local_18;
          puVar3[0xd] = (uint)local_10;
          iVar6 = Audio_StopSound((int)puVar3,(int)param_2,(int)param_3);
          local_10 = (byte *)puVar3[0xd];
          if ((byte *)puVar3[0xc] != local_10) {
            puVar3[8] = (uint)param_1;
            puVar3[7] = (uint)pbVar9;
            iVar2 = *(int *)param_2;
            *(byte **)(param_2 + 4) = local_8;
            *(byte **)param_2 = local_c;
            *(byte **)(param_2 + 8) = local_c + (*(int *)(param_2 + 8) - iVar2);
            puVar3[0xd] = (uint)local_10;
            goto LAB_004d5747;
          }
          *puVar3 = 8;
switchD_004d4df8_caseD_4d575f:
          puVar3[8] = (uint)param_1;
          puVar3[7] = (uint)pbVar9;
          *(byte **)(param_2 + 4) = local_8;
          param_3 = (byte *)0x1;
          goto LAB_004d4dc8;
        }
      }
      else {
        (**(code **)(param_2 + 0x24))(*(undefined4 *)(param_2 + 0x28),puVar3[3]);
      }
      if (local_14 == (byte *)0xfffffffd) {
        *puVar3 = 9;
      }
      puVar3[8] = (uint)param_1;
      puVar3[7] = (uint)pbVar9;
      iVar6 = *(int *)param_2;
      *(byte **)param_2 = local_c;
      *(byte **)(param_2 + 4) = local_8;
      param_3 = local_14;
      goto LAB_004d4dd1;
    case (undefined *)0x4d5207:
      goto switchD_004d4df8_caseD_4d5207;
    case (undefined *)0x4d5450:
      goto switchD_004d4df8_caseD_4d5450;
    case (undefined *)0x4d55bd:
switchD_004d4df8_caseD_4d55bd:
      puVar3[8] = (uint)param_1;
      puVar3[7] = (uint)pbVar9;
      iVar6 = *(int *)param_2;
      *(byte **)(param_2 + 4) = local_8;
      *(byte **)param_2 = local_c;
      *(byte **)(param_2 + 8) = local_c + (*(int *)(param_2 + 8) - iVar6);
      puVar3[0xd] = (uint)local_10;
      Audio_StopSound((int)puVar3,(int)param_2,-3);
      return;
    case (undefined *)0x4d56fe:
      goto switchD_004d4df8_caseD_4d56fe;
    case (undefined *)0x4d575f:
      goto switchD_004d4df8_caseD_4d575f;
    }
    pbVar9 = local_18;
    uVar5 = *puVar3;
  }
  param_3 = (byte *)0xfffffffe;
LAB_004d4db9:
  puVar3[7] = (uint)pbVar9;
  puVar3[8] = (uint)param_1;
  *(byte **)(param_2 + 4) = local_8;
LAB_004d4dc8:
  iVar6 = *(int *)param_2;
  *(byte **)param_2 = local_c;
LAB_004d4dd1:
  *(byte **)(param_2 + 8) = local_c + (*(int *)(param_2 + 8) - iVar6);
  puVar3[0xd] = (uint)local_10;
  Audio_StopSound((int)puVar3,(int)param_2,(int)param_3);
  return;
}


