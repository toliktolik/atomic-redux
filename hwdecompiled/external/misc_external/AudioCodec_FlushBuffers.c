/*
 * Function: AudioCodec_FlushBuffers
 * Address: 004b7db0
 * Category: audio
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __thiscall AudioCodec_FlushBuffers(void *this,undefined4 param_1)

{
  int iVar1;
  uint unaff_retaddr;
  undefined4 *puVar2;
  undefined4 *puVar3;
  tagMIXERCONTROLA local_1bc;
  tagMIXERCAPSA local_128;
  tagMIXERLINEA local_f8;
  void *local_50;
  undefined1 local_4c [4];
  tagMIXERLINECONTROLSA local_48;
  tMIXERCONTROLDETAILS local_30;
  HMIXEROBJ local_18;
  uint local_14;
  void *local_10;
  undefined4 uStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  uStack_c = 0x517133;
  local_10 = ExceptionList;
  local_14 = DAT_00569f5c ^ unaff_retaddr;
  ExceptionList = &local_10;
  local_50 = this;
  Dialog_ShowModal((undefined4 *)this);
  *(undefined ***)this = &PTR_Texture_LoadFromMemory_0053793c;
  local_8 = 0;
  *(undefined1 *)((int)this + 4) = param_1._3_1_;
  iVar1 = AudioCodec_Configure();
  *(int *)((int)this + 8) = iVar1;
  *(undefined1 *)(iVar1 + 0x41) = 1;
  *(int *)(*(int *)((int)this + 8) + 4) = *(int *)((int)this + 8);
  *(undefined4 *)*(undefined4 *)((int)this + 8) = *(undefined4 *)((int)this + 8);
  *(int *)(*(int *)((int)this + 8) + 8) = *(int *)((int)this + 8);
  *(undefined4 *)((int)this + 0xc) = 0;
  local_8 = CONCAT31(local_8._1_3_,1);
  Widget_KeyChar();
  mixerOpen((LPHMIXER)&local_18,0,0,0,0);
  mixerGetDevCapsA(0,&local_128,0x30);
  local_48.pamxctrl = &local_1bc;
  local_48.cbStruct = 0x18;
  local_48.cbmxctrl = 0x94;
  local_48.u.dwControlID = 0x50030001;
  local_f8.cbStruct = 0xa8;
  local_f8.dwComponentType = 0x1008;
  mixerGetLineInfoA(local_18,&local_f8,3);
  local_48.dwLineID = local_f8.dwLineID;
  mixerGetLineControlsA(local_18,&local_48,2);
  local_30.dwControlID = local_1bc.dwControlID;
  local_30.paDetails = local_4c;
  local_30.cbStruct = 0x18;
  local_30.cChannels = 1;
  local_30.u.hwndOwner = (HWND)0x0;
  local_30.cbDetails = 4;
  mixerGetControlDetailsA(local_18,&local_30,0);
  if (*(char *)(DAT_005a4380 + 8) == '\0') {
    puVar3 = (undefined4 *)0xffffffff;
    puVar2 = (undefined4 *)0x4b7f1f;
    (**(code **)(DAT_005a4380 + 0xc))(0xffffffff,0xac44,0,param_1);
  }
  else {
    puVar3 = (undefined4 *)0xac44;
    puVar2 = (undefined4 *)0x1;
    (**(code **)(DAT_005a4380 + 0x10))(1,0xac44,0,param_1,0);
    (**(code **)(DAT_005a4380 + 0x2c))(0,2000);
  }
  mixerSetControlDetails(local_18,&local_30,0);
  (**(code **)(DAT_005a4380 + 0x1c))();
  mixerClose((HMIXER)local_18);
  *(undefined4 *)((int)this + 0x10) = 0x28;
  ExceptionList = local_10;
  Exception_SetMessage((void *)(local_14 ^ unaff_retaddr),puVar2,puVar3);
  return;
}


