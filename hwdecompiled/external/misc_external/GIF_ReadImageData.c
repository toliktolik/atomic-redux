/*
 * Function: GIF_ReadImageData
 * Address: 004d4130
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


undefined4 __cdecl GIF_ReadImageData(uint *param_1,uint *param_2)

{
  undefined *puVar1;
  uint uVar2;
  uint uVar3;
  void *pvVar4;
  int iVar5;
  int iVar6;
  size_t extraout_ECX;
  size_t extraout_ECX_00;
  size_t extraout_ECX_01;
  size_t extraout_ECX_02;
  size_t extraout_ECX_03;
  size_t extraout_ECX_04;
  size_t _Size;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint extraout_EDX_03;
  uint extraout_EDX_04;
  uint extraout_EDX_05;
  uint *puVar7;
  uint local_8;
  
  puVar7 = param_2;
  for (iVar6 = 9; iVar6 != 0; iVar6 = iVar6 + -1) {
    *puVar7 = 0;
    puVar7 = puVar7 + 1;
  }
  puVar1 = (undefined *)GIF_SetTransparentIndex(param_1,0x18);
  _Size = extraout_ECX;
  uVar2 = extraout_EDX;
  if (puVar1 == &DAT_00564342) {
    uVar2 = GIF_SetTransparentIndex(param_1,0x10);
    *param_2 = uVar2;
    uVar3 = GIF_SetTransparentIndex(param_1,0x18);
    param_2[1] = uVar3;
    _Size = extraout_ECX_00;
    uVar2 = extraout_EDX_00;
    if (uVar3 != 0xffffffff) {
      uVar2 = GIF_SetTransparentIndex(param_1,1);
      if (uVar2 == 0) {
        pvVar4 = _malloc(param_2[1] << 2);
        param_2[2] = (uint)pvVar4;
        uVar2 = GIF_SetTransparentIndex(param_1,1);
        iVar6 = 0;
        if (uVar2 == 0) {
          if (0 < (int)param_2[1]) {
            do {
              uVar3 = GIF_SetTransparentIndex(param_1,5);
              _Size = extraout_ECX_03;
              uVar2 = extraout_EDX_03;
              if (uVar3 == 0xffffffff) goto LAB_004d436f;
              *(uint *)(param_2[2] + iVar6 * 4) = uVar3 + 1;
              iVar6 = iVar6 + 1;
            } while (iVar6 < (int)param_2[1]);
          }
        }
        else if (0 < (int)param_2[1]) {
          do {
            uVar2 = GIF_SetTransparentIndex(param_1,1);
            if (uVar2 == 0) {
              *(undefined4 *)(param_2[2] + iVar6 * 4) = 0;
            }
            else {
              uVar3 = GIF_SetTransparentIndex(param_1,5);
              _Size = extraout_ECX_02;
              uVar2 = extraout_EDX_02;
              if (uVar3 == 0xffffffff) goto LAB_004d436f;
              *(uint *)(param_2[2] + iVar6 * 4) = uVar3 + 1;
            }
            iVar6 = iVar6 + 1;
          } while (iVar6 < (int)param_2[1]);
        }
      }
      else {
        if (uVar2 != 1) {
          return 0xffffffff;
        }
        local_8 = GIF_SetTransparentIndex(param_1,5);
        pvVar4 = _malloc(param_2[1] << 2);
        param_2[2] = (uint)pvVar4;
        iVar6 = 0;
        if (0 < (int)param_2[1]) {
          do {
            local_8 = local_8 + 1;
            iVar5 = GIF_GetDisposalMethod(param_2[1] - iVar6);
            uVar3 = GIF_SetTransparentIndex(param_1,iVar5);
            _Size = extraout_ECX_01;
            uVar2 = extraout_EDX_01;
            if (uVar3 == 0xffffffff) goto LAB_004d436f;
            iVar5 = 0;
            if (0 < (int)uVar3) {
              do {
                if ((int)param_2[1] <= iVar6) break;
                *(uint *)(param_2[2] + iVar6 * 4) = local_8;
                iVar5 = iVar5 + 1;
                iVar6 = iVar6 + 1;
              } while (iVar5 < (int)uVar3);
            }
          } while (iVar6 < (int)param_2[1]);
        }
      }
      uVar3 = GIF_SetTransparentIndex(param_1,4);
      param_2[3] = uVar3;
      if (uVar3 == 0) {
        return 0;
      }
      _Size = extraout_ECX_04;
      uVar2 = extraout_EDX_04;
      if ((0 < (int)uVar3) && ((int)uVar3 < 3)) {
        uVar2 = GIF_SetTransparentIndex(param_1,0x20);
        param_2[4] = uVar2;
        uVar2 = GIF_SetTransparentIndex(param_1,0x20);
        param_2[5] = uVar2;
        uVar2 = GIF_SetTransparentIndex(param_1,4);
        param_2[6] = uVar2 + 1;
        uVar2 = GIF_SetTransparentIndex(param_1,1);
        param_2[7] = uVar2;
        iVar6 = 0;
        if (param_2[3] == 1) {
          iVar6 = GIF_QuantizeImage((int *)param_2);
        }
        else if (param_2[3] == 2) {
          iVar6 = param_2[1] * *param_2;
        }
        _Size = iVar6 * 4;
        pvVar4 = _malloc(_Size);
        param_2[8] = (uint)pvVar4;
        local_8 = 0;
        uVar2 = extraout_EDX_05;
        if (0 < iVar6) {
          do {
            uVar3 = GIF_SetTransparentIndex(param_1,param_2[6]);
            uVar2 = param_2[8];
            *(uint *)(uVar2 + local_8 * 4) = uVar3;
            local_8 = local_8 + 1;
          } while ((int)local_8 < iVar6);
        }
        if (iVar6 == 0) {
          return 0;
        }
        if (*(int *)((_Size - 4) + param_2[8]) != -1) {
          return 0;
        }
      }
    }
  }
LAB_004d436f:
  JPEG_ReadHeader(_Size,uVar2,param_2);
  return 0xffffffff;
}


