/*
 * Function: Algorithm_Sort
 * Address: 0045ba70
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __fastcall Algorithm_Sort(int param_1)

{
  char cVar1;
  int iVar2;
  int *piVar3;
  int *piVar4;
  undefined4 uVar5;
  int iVar6;
  int *piVar7;
  LPCSTR ****lpText;
  DWORD DVar8;
  int extraout_ECX;
  undefined4 extraout_ECX_00;
  int extraout_ECX_01;
  int extraout_ECX_02;
  undefined4 extraout_ECX_03;
  int extraout_ECX_04;
  undefined4 extraout_ECX_05;
  int extraout_ECX_06;
  undefined4 extraout_ECX_07;
  int extraout_ECX_08;
  undefined4 extraout_ECX_09;
  int extraout_ECX_10;
  int extraout_ECX_11;
  uint extraout_EDX;
  uint uVar9;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint extraout_EDX_03;
  uint extraout_EDX_04;
  uint extraout_EDX_05;
  uint extraout_EDX_06;
  uint extraout_EDX_07;
  uint unaff_retaddr;
  undefined4 local_ac [2];
  undefined1 local_a4 [4];
  uint local_a0;
  uint local_8c;
  undefined1 local_88 [4];
  LPCSTR ***local_84 [4];
  undefined4 local_74;
  uint local_70;
  int local_6c;
  int local_68;
  uint local_64;
  undefined1 local_5d;
  _String_base local_5c [4];
  uint local_58;
  undefined4 local_50;
  int local_4c [3];
  undefined1 local_40 [4];
  int *local_3c;
  undefined4 local_38;
  int local_34;
  _String_base local_30 [4];
  uint local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *pvStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_005139c5;
  pvStack_10 = ExceptionList;
  local_14 = DAT_00569f5c ^ unaff_retaddr;
  local_64 = 0;
  local_6c = 0;
  ExceptionList = &pvStack_10;
  local_34 = param_1;
  if (*(int *)(*(int *)(param_1 + 0x328) + 0x5c) != 0) {
    local_4c[0] = 0;
    local_4c[1] = 0;
    local_4c[2] = 0;
    local_50 = 0x4000;
    piVar7 = *(int **)(*(int *)(param_1 + 0x328) + 0x5c);
    ExceptionList = &pvStack_10;
    (**(code **)(*piVar7 + 0x5c))(piVar7,&local_50,&local_64,&local_6c);
  }
  piVar7 = (int *)**(int **)(param_1 + 0x3d8);
  local_40[0] = local_5d;
  local_3c = (int *)Tree_ClearAll();
  *(undefined1 *)((int)local_3c + 0x19) = 1;
  local_3c[1] = (int)local_3c;
  *local_3c = (int)local_3c;
  local_3c[2] = (int)local_3c;
  local_38 = 0;
  local_8 = 0;
  local_68 = 0;
  if (piVar7 != *(int **)(param_1 + 0x3d8)) {
    do {
      iVar6 = *(int *)(piVar7[3] + 0x20);
      if (iVar6 != 0) {
        local_68 = local_68 + *(int *)(iVar6 + 0x30);
        local_4c[1] = 0;
        local_4c[2] = 0;
        local_4c[0] = *(int *)(iVar6 + 0x3c);
        piVar4 = (int *)STL_String_SwapContents(local_40,local_ac,local_4c);
        iVar2 = *piVar4;
        *(int *)(iVar2 + 0x10) = *(int *)(iVar2 + 0x10) + 1;
        *(int *)(iVar2 + 0x14) = *(int *)(iVar2 + 0x14) + *(int *)(iVar6 + 0x30);
      }
      if (*(char *)((int)piVar7 + 0x11) == '\0') {
        piVar4 = (int *)piVar7[2];
        if (*(char *)((int)piVar4 + 0x11) == '\0') {
          cVar1 = *(char *)(*piVar4 + 0x11);
          piVar7 = piVar4;
          piVar4 = (int *)*piVar4;
          while (cVar1 == '\0') {
            cVar1 = *(char *)(*piVar4 + 0x11);
            piVar7 = piVar4;
            piVar4 = (int *)*piVar4;
          }
        }
        else {
          cVar1 = *(char *)(piVar7[1] + 0x11);
          piVar3 = (int *)piVar7[1];
          piVar4 = piVar7;
          while ((piVar7 = piVar3, cVar1 == '\0' && (piVar4 == (int *)piVar7[2]))) {
            cVar1 = *(char *)(piVar7[1] + 0x11);
            piVar3 = (int *)piVar7[1];
            piVar4 = piVar7;
          }
        }
      }
      param_1 = local_34;
    } while (piVar7 != *(int **)(local_34 + 0x3d8));
  }
  local_70 = 0xf;
  local_74 = 0;
  local_84[0] = (LPCSTR ***)((uint)local_84[0] & 0xffffff00);
  local_8 = CONCAT31(local_8._1_3_,1);
  uVar5 = Compression_ValidateHeader(param_1);
  if ((char)uVar5 == '\0') {
    Compression_GetDecompressedSize(param_1);
  }
  Compression_GetCompressedSize(param_1);
  iVar6 = Sound_SetPosition(local_30,"3D-Mode %s (3D is %s on this system)\r\n\r\n");
  local_8._0_1_ = 2;
  Enemy_UpdateAI(local_88,iVar6,0,0xffffffff);
  local_8._0_1_ = 1;
  if (0xf < local_18) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(extraout_ECX,local_2c);
  }
  Sound_CreateBuffer(local_a4,extraout_EDX,(_String_base *)local_a4,local_64 >> 10);
  uVar9 = local_64 - local_6c >> 10;
  local_8._0_1_ = 3;
  Sound_CreateBuffer(extraout_ECX_00,uVar9,local_30,uVar9);
  local_8._0_1_ = 4;
  iVar6 = Sound_SetPosition(local_5c,"Video Memory: %s/%s KB\r\n\r\n");
  local_8._0_1_ = 5;
  Enemy_UpdateAI(local_88,iVar6,0,0xffffffff);
  if (0xf < (uint)local_4c[2]) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(extraout_ECX_01,local_58);
  }
  local_4c[2] = 0xf;
  local_4c[1] = 0;
  local_58 = local_58 & 0xffffff00;
  if (0xf < local_18) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(extraout_ECX_01,extraout_EDX_00);
  }
  local_18 = 0xf;
  local_1c = 0;
  local_2c = local_2c & 0xffffff00;
  local_8._0_1_ = 1;
  if (0xf < local_8c) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(local_a0,extraout_EDX_00);
  }
  Sound_CreateBuffer(extraout_ECX_01,(uint)local_a4,(_String_base *)local_a4,
                     (int)(local_68 + (local_68 >> 0x1f & 0x3ffU)) >> 10);
  local_8._0_1_ = 6;
  iVar6 = Sound_SetPosition(local_30,"Texture Memory: %s KB\r\n");
  local_8._0_1_ = 7;
  Enemy_UpdateAI(local_88,iVar6,0,0xffffffff);
  if (0xf < local_18) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(local_2c,extraout_EDX_01);
  }
  local_18 = 0xf;
  local_1c = 0;
  local_2c = local_2c & 0xffffff00;
  local_8._0_1_ = 1;
  if (0xf < local_8c) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(extraout_ECX_02,local_a0);
  }
  local_4c[1] = 0;
  local_4c[2] = 0;
  local_4c[0] = 1;
  piVar7 = (int *)STL_String_SwapContents(local_40,local_ac,local_4c);
  Sound_CreateBuffer(extraout_ECX_03,(uint)local_a4,(_String_base *)local_a4,
                     (int)(*(int *)(*piVar7 + 0x14) + (*(int *)(*piVar7 + 0x14) >> 0x1f & 0x3ffU))
                     >> 10);
  local_8._0_1_ = 8;
  iVar6 = Sound_SetPosition(local_30,"A8R8G8B8: %d - %s KB\r\n");
  local_8._0_1_ = 9;
  Enemy_UpdateAI(local_88,iVar6,0,0xffffffff);
  if (0xf < local_18) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(local_2c,extraout_EDX_02);
  }
  local_18 = 0xf;
  local_1c = 0;
  local_2c = local_2c & 0xffffff00;
  local_8._0_1_ = 1;
  if (0xf < local_8c) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(extraout_ECX_04,local_a0);
  }
  local_4c[1] = 0;
  local_4c[2] = 0;
  local_4c[0] = 2;
  piVar7 = (int *)STL_String_SwapContents(local_40,local_ac,local_4c);
  Sound_CreateBuffer(extraout_ECX_05,(uint)local_a4,(_String_base *)local_a4,
                     (int)(*(int *)(*piVar7 + 0x14) + (*(int *)(*piVar7 + 0x14) >> 0x1f & 0x3ffU))
                     >> 10);
  local_8._0_1_ = 10;
  iVar6 = Sound_SetPosition(local_30,"A4R4G4B4: %d - %s KB\r\n");
  local_8._0_1_ = 0xb;
  Enemy_UpdateAI(local_88,iVar6,0,0xffffffff);
  if (0xf < local_18) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(local_2c,extraout_EDX_03);
  }
  local_18 = 0xf;
  local_1c = 0;
  local_2c = local_2c & 0xffffff00;
  local_8._0_1_ = 1;
  if (0xf < local_8c) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(extraout_ECX_06,local_a0);
  }
  local_4c[1] = 0;
  local_4c[2] = 0;
  local_4c[0] = 4;
  piVar7 = (int *)STL_String_SwapContents(local_40,local_ac,local_4c);
  Sound_CreateBuffer(extraout_ECX_07,(uint)local_a4,(_String_base *)local_a4,
                     (int)(*(int *)(*piVar7 + 0x14) + (*(int *)(*piVar7 + 0x14) >> 0x1f & 0x3ffU))
                     >> 10);
  local_8._0_1_ = 0xc;
  iVar6 = Sound_SetPosition(local_30,"R5G6B5: %d - %s KB\r\n");
  local_8._0_1_ = 0xd;
  Enemy_UpdateAI(local_88,iVar6,0,0xffffffff);
  if (0xf < local_18) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(local_2c,extraout_EDX_04);
  }
  local_18 = 0xf;
  local_1c = 0;
  local_2c = local_2c & 0xffffff00;
  local_8._0_1_ = 1;
  if (0xf < local_8c) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(extraout_ECX_08,local_a0);
  }
  local_4c[1] = 0;
  local_4c[2] = 0;
  local_4c[0] = 8;
  piVar7 = (int *)STL_String_SwapContents(local_40,local_ac,local_4c);
  Sound_CreateBuffer(extraout_ECX_09,(uint)local_a4,(_String_base *)local_a4,
                     (int)(*(int *)(*piVar7 + 0x14) + (*(int *)(*piVar7 + 0x14) >> 0x1f & 0x3ffU))
                     >> 10);
  local_8._0_1_ = 0xe;
  iVar6 = Sound_SetPosition(local_30,"Palette8: %d - %s KB\r\n");
  local_8 = CONCAT31(local_8._1_3_,0xf);
  Enemy_UpdateAI(local_88,iVar6,0,0xffffffff);
  iVar6 = local_34;
  if (0xf < local_18) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(local_2c,extraout_EDX_05);
  }
  local_18 = 0xf;
  local_1c = 0;
  local_2c = local_2c & 0xffffff00;
  if (0xf < local_8c) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(extraout_ECX_10,local_a0);
  }
  lpText = (LPCSTR ****)local_84[0];
  if (local_70 < 0x10) {
    lpText = local_84;
  }
  MessageBoxA(*(HWND *)(local_34 + 0x30c),(LPCSTR)lpText,"Memory Usage",0);
  DVar8 = timeGetTime();
  *(DWORD *)(iVar6 + 0x404) = DVar8;
  if (local_70 < 0x10) {
    local_70 = 0xf;
    local_74 = 0;
    local_84[0] = (LPCSTR ***)((uint)local_84[0] & 0xffffff00);
    local_8 = 0xffffffff;
    STL_String_GetMaxSize(local_40,&local_34,(int *)*local_3c,local_3c);
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(extraout_ECX_11,extraout_EDX_07);
  }
                    /* WARNING: Subroutine does not return */
  System_ShutdownHandler((int)local_84[0],extraout_EDX_06);
}


