/*
 * Function: Memory_CreateHook
 * Address: 004ad870
 * Category: memory
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


int Memory_CreateHook(void)

{
  _String_base _Var1;
  int iVar2;
  _String_base *p_Var3;
  int *piVar4;
  int extraout_ECX;
  uint extraout_EDX;
  _String_base *unaff_ESI;
  _String_base local_1c0 [196];
  undefined1 local_f4 [160];
  undefined1 local_54 [4];
  uint local_50;
  undefined4 local_40;
  uint local_3c;
  undefined1 local_38 [4];
  uint local_34;
  undefined4 local_24;
  uint local_20;
  undefined4 local_1c;
  int local_18;
  DWORD local_14;
  void *local_10;
  undefined4 uStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  uStack_c = 0x516676;
  local_10 = ExceptionList;
  local_3c = 0xf;
  local_40 = 0;
  local_50 = local_50 & 0xffffff00;
  p_Var3 = unaff_ESI;
  do {
    _Var1 = *p_Var3;
    p_Var3 = p_Var3 + 1;
  } while (_Var1 != (_String_base)0x0);
  ExceptionList = &local_10;
  String_Assign(local_54,unaff_ESI,(int)p_Var3 - (int)(unaff_ESI + 1));
  local_8 = 0;
  UI_CloseDialog(&DAT_005a3888,&local_18,local_54);
  local_8 = 0xffffffff;
  if (0xf < local_3c) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(extraout_ECX,local_50);
  }
  if (local_18 != DAT_005a388c) {
    ExceptionList = local_10;
    return local_18 + 0x28;
  }
  ExceptionHandler_VectorConstructorIterator
            (local_f4,0x10,10,(_func_void_void_ptr *)&LAB_004a36f0,Animation_ProcessNukeEffects);
  local_8 = 1;
  local_20 = 0xf;
  local_24 = 0;
  local_34 = local_34 & 0xffffff00;
  p_Var3 = unaff_ESI + 2;
  do {
    _Var1 = *p_Var3;
    p_Var3 = p_Var3 + 1;
  } while (_Var1 != (_String_base)0x0);
  String_Assign(local_38,unaff_ESI + 2,(int)p_Var3 - (int)(unaff_ESI + 3));
  local_8._0_1_ = 2;
  p_Var3 = Game_StringData_Constructor
                     (local_1c0,(uint)local_38,(_String_base *)local_38,
                      (undefined4 *)&stack0xffffff04);
  local_8._0_1_ = 3;
  piVar4 = (int *)STL_DoubleMap_FindOrInsert(&DAT_005a3888,&local_1c,p_Var3);
  iVar2 = *piVar4;
  local_8 = CONCAT31(local_8._1_3_,2);
  AnimationList_Clear((int)local_1c0);
  if (0xf < local_20) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(local_34,extraout_EDX);
  }
  local_20 = 0xf;
  local_24 = 0;
  local_34 = local_34 & 0xffffff00;
  VirtualProtect(unaff_ESI,5,4,&local_14);
  *unaff_ESI = (_String_base)0x0;
  *(int *)(unaff_ESI + 1) = iVar2 + 0x28;
  VirtualProtect(unaff_ESI,5,local_14,&local_14);
  local_8 = 0xffffffff;
  ExceptionHandler_VectorDestructorIterator(local_f4,0x10,10,Animation_ProcessNukeEffects);
  ExceptionList = local_10;
  return iVar2 + 0x28;
}


