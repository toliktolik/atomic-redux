/*
 * Function: GIF_ValidateFile
 * Address: 004d38d0
 * Category: system
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


undefined4 __cdecl GIF_ValidateFile(int *param_1,int param_2,int param_3,uint *param_4)

{
  longlong lVar1;
  int *piVar2;
  uint uVar3;
  int *piVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  int iVar8;
  uint uVar9;
  int iVar10;
  undefined8 uVar11;
  uint local_34;
  int local_2c;
  uint local_24;
  int local_20;
  uint local_1c;
  uint local_14;
  int local_c;
  int local_8;
  
  piVar2 = param_1;
  local_8 = 0;
  if ((param_1[3] != 1) && (param_1[3] != 2)) {
    return 0;
  }
  GIF_SetDisposalMethod(param_1[4]);
  uVar3 = GIF_SetDisposalMethod(param_1[5]);
  piVar4 = (int *)Assembly_DecompilationFailed(*param_1 * param_2,4);
  uVar5 = Assembly_DecompilationFailed(*param_1 * param_2,4);
  *param_4 = local_1c;
  if (param_1[3] == 1) {
    uVar11 = GIF_QuantizeImage(param_1);
    uVar7 = (uint)((ulonglong)uVar11 >> 0x20);
    local_c = 0;
    if (0 < param_1[1]) {
      do {
        if ((param_3 == 0) || (*(int *)(piVar2[2] + local_c * 4) != 0)) {
          iVar8 = *piVar2;
          local_34 = 0;
          local_20 = 1;
          param_1 = (int *)0x0;
          if (0 < iVar8) {
            do {
              uVar7 = *(uint *)(piVar2[8] + ((local_c / local_20) % (int)uVar11) * 4);
              uVar9 = (int)uVar7 >> 0x1f;
              uVar9 = (uVar7 ^ uVar9) - uVar9;
              iVar6 = GIF_GetDisposalMethod((uVar9 ^ (int)uVar9 >> 0x1f) - ((int)uVar9 >> 0x1f));
              iVar10 = uVar9 << (-((char)iVar6 + -0x1f) & 0x1fU);
              if ((uVar3 == 0) || (iVar10 == 0)) {
                lVar1 = 0;
              }
              else {
                local_14 = iVar6 + 1 + local_2c;
                lVar1 = (longlong)iVar10 * (longlong)(int)uVar3;
              }
              uVar7 = GIF_DitherImage(local_14,(uint)((ulonglong)lVar1 >> 0x20),local_1c);
              uVar7 = GIF_DitherImage(local_14,uVar7,local_34);
              if (piVar2[7] != 0) {
                local_34 = local_14;
              }
              if (param_3 == 0) {
                piVar4[(int)(iVar8 * local_8 + (int)param_1)] = uVar7;
                iVar8 = *piVar2 * local_8;
              }
              else {
                piVar4[(int)(*(int *)(param_3 + local_8 * 4) * iVar8 + (int)param_1)] = uVar7;
                iVar8 = *piVar2 * *(int *)(param_3 + local_8 * 4);
              }
              *(uint *)(uVar5 + (iVar8 + (int)param_1) * 4) = local_14;
              if ((int)*param_4 < (int)local_14) {
                *param_4 = local_14;
              }
              local_20 = local_20 * (int)uVar11;
              iVar8 = *piVar2;
              param_1 = (int *)((int)param_1 + 1);
              uVar7 = uVar5;
            } while ((int)param_1 < iVar8);
          }
          local_8 = local_8 + 1;
        }
        local_c = local_c + 1;
      } while (local_c < piVar2[1]);
    }
  }
  else {
    uVar7 = local_1c;
    if ((param_1[3] == 2) && (local_c = 0, 0 < param_1[1])) {
      do {
        if ((param_3 == 0) || (*(int *)(piVar2[2] + local_c * 4) != 0)) {
          iVar8 = *piVar2;
          local_24 = 0;
          param_1 = (int *)0x0;
          if (0 < iVar8) {
            do {
              uVar7 = *(uint *)(piVar2[8] + (int)(iVar8 * local_c + (int)param_1) * 4);
              uVar9 = (int)uVar7 >> 0x1f;
              uVar9 = (uVar7 ^ uVar9) - uVar9;
              iVar6 = GIF_GetDisposalMethod((uVar9 ^ (int)uVar9 >> 0x1f) - ((int)uVar9 >> 0x1f));
              iVar10 = uVar9 << (-((char)iVar6 + -0x1f) & 0x1fU);
              if ((uVar3 == 0) || (iVar10 == 0)) {
                lVar1 = 0;
              }
              else {
                local_14 = iVar6 + 1 + local_2c;
                lVar1 = (longlong)iVar10 * (longlong)(int)uVar3;
              }
              uVar7 = GIF_DitherImage(local_14,(uint)((ulonglong)lVar1 >> 0x20),local_1c);
              uVar7 = GIF_DitherImage(local_14,uVar7,local_24);
              if (piVar2[7] != 0) {
                local_24 = local_14;
              }
              if (param_3 == 0) {
                piVar4[(int)(iVar8 * local_8 + (int)param_1)] = uVar7;
                iVar8 = *piVar2 * local_8;
              }
              else {
                piVar4[(int)(*(int *)(param_3 + local_8 * 4) * iVar8 + (int)param_1)] = uVar7;
                iVar8 = *piVar2 * *(int *)(param_3 + local_8 * 4);
              }
              *(uint *)(uVar5 + (iVar8 + (int)param_1) * 4) = local_14;
              if ((int)*param_4 < (int)local_14) {
                *param_4 = local_14;
              }
              iVar8 = *piVar2;
              param_1 = (int *)((int)param_1 + 1);
              uVar7 = uVar5;
            } while ((int)param_1 < iVar8);
          }
          local_8 = local_8 + 1;
        }
        local_c = local_c + 1;
      } while (local_c < piVar2[1]);
    }
  }
  uVar3 = *piVar2 * param_2;
  iVar8 = 0;
  if (0 < (int)uVar3) {
    iVar6 = uVar5 - (int)piVar4;
    do {
      iVar10 = *(int *)(iVar6 + (int)piVar4);
      uVar3 = *param_4;
      if (iVar10 < (int)uVar3) {
        uVar3 = uVar3 - iVar10;
        *piVar4 = *piVar4 >> ((byte)uVar3 & 0x1f);
      }
      uVar7 = *piVar2 * param_2;
      iVar8 = iVar8 + 1;
      piVar4 = piVar4 + 1;
    } while (iVar8 < (int)uVar7);
  }
                    /* WARNING: Subroutine does not return */
  System_ShutdownHandler(uVar3,uVar7);
}


