/*
 * Function: _memchr
 * Address: 004fc030
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* Library Function - Single Match
    _memchr
   
   Library: Visual Studio */

void * __cdecl _memchr(void *_Buf,int _Val,size_t _MaxCount)

{
  uint uVar1;
  uint uVar2;
  uint *puVar3;
  char cVar4;
  uint uVar5;
  bool bVar6;
  
  if (_MaxCount != 0) {
    uVar5 = _Val & 0xff;
    uVar2 = (uint)_Buf & 3;
    while (uVar2 != 0) {
                    /* WARNING: Load size is inaccurate */
      uVar2 = *_Buf;
      _Buf = (void *)((int)_Buf + 1);
      if ((char)uVar2 == (char)_Val) goto LAB_004fc0c6;
      _MaxCount = _MaxCount - 1;
      if (_MaxCount == 0) {
        return (void *)0x0;
      }
      uVar2 = (uint)_Buf & 3;
    }
    uVar2 = _MaxCount - 4;
    if (3 < _MaxCount) {
      uVar5 = uVar5 * 0x1010101;
      puVar3 = (uint *)_Buf;
      do {
        _Buf = puVar3 + 1;
        if (((*puVar3 ^ uVar5 ^ 0xffffffff ^ (*puVar3 ^ uVar5) + 0x7efefeff) & 0x81010100) != 0) {
          uVar1 = *puVar3;
          cVar4 = (char)uVar5;
          if ((char)uVar1 == cVar4) {
            return puVar3;
          }
          if ((char)(uVar1 >> 8) == cVar4) {
            return (char *)((int)puVar3 + 1);
          }
          if ((char)(uVar1 >> 0x10) == cVar4) {
            return (char *)((int)puVar3 + 2);
          }
          if ((char)(uVar1 >> 0x18) == cVar4) goto LAB_004fc0c6;
        }
        bVar6 = 3 < uVar2;
        uVar2 = uVar2 - 4;
        puVar3 = (uint *)_Buf;
      } while (bVar6);
    }
    for (_MaxCount = uVar2 + 4; (void *)_MaxCount != (void *)0x0; _MaxCount = _MaxCount + -1) {
                    /* WARNING: Load size is inaccurate */
      uVar2 = *_Buf;
      _Buf = (void *)((int)_Buf + 1);
      if ((char)uVar2 == (char)uVar5) {
LAB_004fc0c6:
        return (char *)((int)_Buf + -1);
      }
    }
  }
  return (void *)_MaxCount;
}


