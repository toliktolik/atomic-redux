/*
 * Function: STL_String_Resize
 * Address: 00455ef0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void STL_String_Resize(HWND param_1,HKEY param_2,HKEY param_3)

{
  BYTE BVar1;
  HWND pHVar2;
  _String_base *p_Var3;
  LSTATUS LVar4;
  BYTE *pBVar5;
  char *_Str;
  long lVar6;
  int extraout_ECX;
  int extraout_ECX_00;
  int extraout_ECX_01;
  _String_base *extraout_EDX;
  uint extraout_EDX_00;
  uint uVar7;
  _String_base *extraout_EDX_01;
  uint extraout_EDX_02;
  uint extraout_EDX_03;
  int iVar8;
  uint unaff_retaddr;
  undefined4 *in_stack_fffffb7c;
  undefined4 *in_stack_fffffb80;
  BYTE local_284 [512];
  _String_base local_84 [28];
  undefined1 local_68 [4];
  LPCSTR **local_64 [5];
  uint local_50;
  undefined1 local_4c [4];
  LPCSTR **local_48 [5];
  uint local_34;
  _String_base local_30 [4];
  uint local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_005134a0;
  local_10 = ExceptionList;
  local_14 = DAT_00569f5c ^ unaff_retaddr;
  ExceptionList = &local_10;
  if (param_2 != (HKEY)0x10) {
    if (param_2 == (HKEY)0x110) {
      ExceptionList = &local_10;
      pHVar2 = GetDlgItem(param_1,100);
      p_Var3 = Survival_LoadConfiguration(local_30,(_String_base *)"SOFTWARE\\",DAT_0056da10 + 0x5c)
      ;
      local_8 = 0;
      Sound_SetFrequency(local_4c,extraout_EDX_01,(_String_base *)local_4c,p_Var3);
      if (0xf < local_18) {
                    /* WARNING: Subroutine does not return */
        System_ShutdownHandler(extraout_ECX,local_2c);
      }
      local_18 = 0xf;
      local_1c = 0;
      local_2c = local_2c & 0xffffff00;
      if (local_34 < 0x10) {
        local_48[0] = (LPCSTR **)local_48;
      }
      LVar4 = RegOpenKeyExA((HKEY)0x80000002,(LPCSTR)local_48[0],0,0x2001f,&param_3);
      iVar8 = extraout_ECX_00;
      uVar7 = extraout_EDX_02;
      if (LVar4 == 0) {
        param_1 = (HWND)0x3e8;
        param_2 = (HKEY)0x1;
        LVar4 = RegQueryValueExA(param_3,"DemoJumpTime",(LPDWORD)0x0,(LPDWORD)&param_2,
                                 &stack0xfffffb7c,(LPDWORD)&param_1);
        if (LVar4 == 0) {
          (&stack0xfffffb7c)[(int)param_1] = 0;
          SetWindowTextA(pHVar2,&stack0xfffffb7c);
          SendMessageA(pHVar2,0xb1,0,-1);
        }
        RegCloseKey(param_3);
        iVar8 = extraout_ECX_01;
        uVar7 = extraout_EDX_03;
      }
      if (0xf < local_34) {
                    /* WARNING: Subroutine does not return */
        System_ShutdownHandler(iVar8,uVar7);
      }
      goto LAB_0045619a;
    }
    if ((param_2 != (HKEY)0x111) || ((uint)param_3 >> 0x10 != 0)) goto LAB_0045619a;
    ExceptionList = &local_10;
    if ((short)param_3 == 1) {
      ExceptionList = &local_10;
      pHVar2 = GetDlgItem(param_1,100);
      GetWindowTextA(pHVar2,(LPSTR)local_284,500);
      p_Var3 = Survival_LoadConfiguration(local_84,(_String_base *)"SOFTWARE\\",DAT_0056da10 + 0x5c)
      ;
      local_8 = 1;
      Sound_SetFrequency(local_68,extraout_EDX,(_String_base *)local_68,p_Var3);
      String_Destructor((int)local_84,extraout_EDX_00);
      if (local_50 < 0x10) {
        local_64[0] = (LPCSTR **)local_64;
      }
      LVar4 = RegOpenKeyExA((HKEY)0x80000002,(LPCSTR)local_64[0],0,0x2001f,&param_2);
      if (LVar4 == 0) {
        pBVar5 = local_284;
        do {
          BVar1 = *pBVar5;
          pBVar5 = pBVar5 + 1;
        } while (BVar1 != '\0');
        RegSetValueExA(param_2,"DemoJumpTime",0,1,local_284,
                       (DWORD)(pBVar5 + (1 - (int)(local_284 + 1))));
        RegCloseKey(param_2);
      }
      iVar8 = 0;
      _Str = (char *)func_0x004fd49e(local_284,&DAT_00531738);
      while (_Str != (char *)0x0) {
        lVar6 = _atol(_Str);
        iVar8 = iVar8 * 0x3c + lVar6;
        _Str = (char *)func_0x004fd49e(0,&DAT_00531738);
      }
      uVar7 = *(int *)(DAT_0056da10 + 0x4ec) - ((iVar8 + 1) * 1000) / *(int *)(DAT_0056da10 + 0x3e4)
      ;
      *(uint *)(DAT_0056da10 + 0x424) = uVar7;
      String_Destructor((int)local_68,uVar7);
    }
  }
  EndDialog(param_1,0);
LAB_0045619a:
  ExceptionList = local_10;
  Exception_SetMessage((void *)(local_14 ^ unaff_retaddr),in_stack_fffffb7c,in_stack_fffffb80);
  return;
}


