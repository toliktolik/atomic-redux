/*
 * Function: STL_Vector_PopBack
 * Address: 00454560
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __thiscall
STL_Vector_PopBack(void *this,_String_base *param_1,LPDWORD param_2,LPBYTE param_3,LPDWORD param_4)

{
  uint uVar1;
  _String_base *p_Var2;
  LSTATUS LVar3;
  LPCSTR ***ppppCVar4;
  undefined4 extraout_ECX;
  int extraout_ECX_00;
  int extraout_ECX_01;
  int extraout_ECX_02;
  int extraout_ECX_03;
  int iVar5;
  int extraout_ECX_04;
  _String_base *extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint extraout_EDX_03;
  uint extraout_EDX_04;
  uint extraout_EDX_05;
  uint extraout_EDX_06;
  uint extraout_EDX_07;
  uint extraout_EDX_08;
  void *pvVar6;
  uint unaff_retaddr;
  undefined4 *in_stack_ffffff74;
  undefined4 *in_stack_ffffff78;
  uint local_74;
  _String_base local_70 [4];
  uint local_6c;
  undefined4 local_5c;
  uint local_58;
  _String_base local_54 [4];
  LPCSTR **local_50 [5];
  uint local_3c;
  _String_base local_38 [4];
  LPCSTR **local_34 [4];
  undefined4 local_24;
  uint local_20;
  HKEY local_1c;
  char local_18 [4];
  uint local_14;
  void *local_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8._0_1_ = 0xff;
  local_8._1_3_ = 0xffffff;
  puStack_c = &DAT_00513276;
  local_10 = ExceptionList;
  local_14 = DAT_00569f5c ^ unaff_retaddr;
  if (*(int *)((int)this + 0x70) != 0) {
    if (*(char *)((int)this + 0x491) == '\0') {
      ExceptionList = &local_10;
      p_Var2 = Survival_LoadConfiguration(local_70,(_String_base *)"SOFTWARE\\",(int)this + 0x5c);
      local_8 = 0;
      Sound_SetFrequency(extraout_ECX,extraout_EDX,local_54,p_Var2);
      if (0xf < local_58) {
                    /* WARNING: Subroutine does not return */
        System_ShutdownHandler(local_6c,extraout_EDX_00);
      }
      local_20 = 0xf;
      local_24 = 0;
      local_34[0] = (LPCSTR **)((uint)local_34[0] & 0xffffff00);
      local_8._0_1_ = 3;
      local_18[0] = '\\';
      uVar1 = XML_GetElementValue(param_1,local_18,0xffffffff,1);
      if (uVar1 == 0xffffffff) {
        PowerUp_ProcessThunderstrike(local_38,extraout_EDX_01,param_1,0,0xffffffff);
      }
      else {
        p_Var2 = GameMenu_ProcessRegistrationScreen
                           (param_1,(_String_base *)&stack0xffffff74,0,uVar1);
        local_8._0_1_ = 4;
        p_Var2 = Survival_LoadConfiguration(local_70,(_String_base *)&DAT_0053162c,(int)p_Var2);
        local_8._0_1_ = 5;
        Enemy_UpdateAI(local_54,(int)p_Var2,0,0xffffffff);
        if (0xf < local_58) {
                    /* WARNING: Subroutine does not return */
          System_ShutdownHandler(extraout_ECX_00,local_6c);
        }
        local_58 = 0xf;
        local_5c = 0;
        local_6c = local_6c & 0xffffff00;
        local_8._0_1_ = 3;
        if (0xf < local_74) {
                    /* WARNING: Subroutine does not return */
          System_ShutdownHandler(extraout_ECX_00,extraout_EDX_02);
        }
        p_Var2 = GameMenu_ProcessRegistrationScreen
                           (param_1,(_String_base *)&stack0xffffff74,uVar1 + 1,0xffffffff);
        local_8._0_1_ = 6;
        PowerUp_ProcessThunderstrike(local_38,extraout_EDX_03,p_Var2,0,0xffffffff);
        local_8._0_1_ = 3;
        if (0xf < local_74) {
                    /* WARNING: Subroutine does not return */
          System_ShutdownHandler(extraout_ECX_01,(uint)in_stack_ffffff78);
        }
      }
      ppppCVar4 = (LPCSTR ***)local_50[0];
      if (local_3c < 0x10) {
        ppppCVar4 = local_50;
      }
      LVar3 = RegOpenKeyExA((HKEY)0x80000002,(LPCSTR)ppppCVar4,0,0x20019,&local_1c);
      iVar5 = extraout_ECX_02;
      uVar1 = extraout_EDX_04;
      if (LVar3 == 0) {
        ppppCVar4 = (LPCSTR ***)local_34[0];
        if (local_20 < 0x10) {
          ppppCVar4 = local_34;
        }
        LVar3 = RegQueryValueExA(local_1c,(LPCSTR)ppppCVar4,(LPDWORD)0x0,param_2,param_3,param_4);
        if (LVar3 == 0) {
          if (*(char *)((int)this + 0x490) != '\0') {
            Threading_TerminateThread((int)this);
            pvVar6 = (void *)((int)this + 0x4cc);
            BitStream_WriteBits(pvVar6,0,1);
            BitStream_WriteBits(pvVar6,0xb,5);
            BitStream_WriteBits(pvVar6,1,1);
            BitStream_WriteLong(pvVar6,*param_2);
            BitStream_WriteLong(pvVar6,*param_4);
            BitStream_WriteBuffer(pvVar6,(int)param_3,*param_4);
          }
          RegCloseKey(local_1c);
          String_Destructor((int)local_38,extraout_EDX_05);
          String_Destructor((int)local_54,extraout_EDX_06);
          goto LAB_00454878;
        }
        RegCloseKey(local_1c);
        iVar5 = extraout_ECX_03;
        uVar1 = extraout_EDX_07;
      }
      if (*(char *)((int)this + 0x490) != '\0') {
        Threading_TerminateThread((int)this);
        pvVar6 = (void *)((int)this + 0x4cc);
        BitStream_WriteBits(pvVar6,0,1);
        BitStream_WriteBits(pvVar6,0xb,5);
        BitStream_WriteBits(pvVar6,0,1);
        iVar5 = extraout_ECX_04;
        uVar1 = extraout_EDX_08;
      }
      if (0xf < local_20) {
                    /* WARNING: Subroutine does not return */
        System_ShutdownHandler((int)local_34[0],uVar1);
      }
      local_20 = 0xf;
      local_24 = 0;
      local_34[0] = (LPCSTR **)((uint)local_34[0] & 0xffffff00);
      if (0xf < local_3c) {
                    /* WARNING: Subroutine does not return */
        System_ShutdownHandler(iVar5,(uint)local_50[0]);
      }
    }
    else if (*(char *)((int)this + 0x492) == '\0') {
      ExceptionList = &local_10;
      Threading_WaitForThread((int)this);
      *(undefined1 *)((int)this + 0x4fc) = 1;
      pvVar6 = (void *)((int)this + 0x4cc);
      uVar1 = String_FindSubstring(pvVar6,1,'\0');
      if (uVar1 != 0) {
        uVar1 = Array_Initialize((int)pvVar6);
        *param_2 = uVar1;
        uVar1 = Array_Initialize((int)pvVar6);
        *param_4 = uVar1;
        Array_Resize(pvVar6,(int)param_3,uVar1);
      }
    }
  }
LAB_00454878:
  ExceptionList = local_10;
  Exception_SetMessage((void *)(local_14 ^ unaff_retaddr),in_stack_ffffff74,in_stack_ffffff78);
  return;
}


