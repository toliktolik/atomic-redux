/*
 * Function: STL_String_CompareNoCase
 * Address: 00456db0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __thiscall STL_String_CompareNoCase(void *this,facet *param_1)

{
  uint uVar1;
  int iVar2;
  facet *pfVar3;
  char cVar4;
  uint *puVar5;
  void *pvVar6;
  undefined4 *puVar7;
  uint *puVar8;
  uint local_8;
  
  pfVar3 = param_1;
  cVar4 = (**(code **)(*(int *)param_1 + 4))();
  if (cVar4 != '\0') {
    *(undefined4 *)((int)this + 0x3c) = 0;
    return;
  }
  *(facet **)((int)this + 0x3c) = pfVar3;
  puVar8 = (uint *)((int)this + 0x58);
  puVar5 = (uint *)STL_Map_LowerBound(&local_8,puVar8,pfVar3);
  uVar1 = *puVar8;
  if (uVar1 != *puVar5) {
    Threading_LockSectorByIndex(&param_1,0);
    iVar2 = *(int *)(uVar1 + 4);
    if ((iVar2 != 0) && (iVar2 != -1)) {
      *(int *)(uVar1 + 4) = iVar2 + -1;
    }
    puVar7 = (undefined4 *)(uVar1 & (*(int *)(uVar1 + 4) != 0) - 1);
    Threading_UnlockSectorByIndex((int *)&param_1);
    if (puVar7 != (undefined4 *)0x0) {
      (**(code **)*puVar7)(1);
    }
    uVar1 = *puVar5;
    *puVar8 = uVar1;
    Threading_LockSectorByIndex(&param_1,0);
    if (*(int *)(uVar1 + 4) != -1) {
      *(int *)(uVar1 + 4) = *(int *)(uVar1 + 4) + 1;
    }
    Threading_UnlockSectorByIndex((int *)&param_1);
  }
  if (local_8 != 0) {
    Threading_LockSectorByIndex(&param_1,0);
    iVar2 = *(int *)(local_8 + 4);
    if ((iVar2 != 0) && (iVar2 != -1)) {
      *(int *)(local_8 + 4) = iVar2 + -1;
    }
    puVar7 = (undefined4 *)(local_8 & (*(int *)(local_8 + 4) != 0) - 1);
    Threading_UnlockSectorByIndex((int *)&param_1);
    if (puVar7 != (undefined4 *)0x0) {
      (**(code **)*puVar7)(1);
    }
  }
  SexyAppFramework_InitializeDirectDraw((int)this);
  if (*(int *)((int)this + 0x48) == 0) {
    pvVar6 = operator_new(0x1c);
    if (pvVar6 != (void *)0x0) {
      *(undefined4 *)((int)pvVar6 + 0x18) = 0xf;
      *(undefined4 *)((int)pvVar6 + 0x14) = 0;
      *(undefined1 *)((int)pvVar6 + 4) = 0;
      *(void **)((int)this + 0x48) = pvVar6;
      return;
    }
    *(undefined4 *)((int)this + 0x48) = 0;
  }
  return;
}


