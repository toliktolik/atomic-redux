/*
 * Function: STL_Queue_Pop
 * Address: 004f2e7d
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void STL_Queue_Pop(void)

{
  int *piVar1;
  undefined1 *_Src;
  char cVar2;
  undefined4 *puVar3;
  bool bVar4;
  wint_t wVar5;
  facet *this;
  uint uVar6;
  undefined2 extraout_var;
  undefined2 extraout_var_00;
  size_t sVar7;
  undefined2 extraout_var_01;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint uVar8;
  uint extraout_EDX_03;
  uint extraout_EDX_04;
  uint extraout_EDX_05;
  uint extraout_EDX_06;
  char *pcVar9;
  int unaff_EBP;
  int iVar10;
  size_t sVar11;
  undefined4 uVar12;
  char *pcVar13;
  undefined4 uVar14;
  undefined8 uVar15;
  undefined4 *in_stack_ffffffc8;
  undefined4 *in_stack_ffffffcc;
  
  Assembly_BitShiftLocking();
  *(uint *)(unaff_EBP + -0x10) = DAT_00569f5c ^ *(uint *)(unaff_EBP + 4);
  cVar2 = **(char **)(unaff_EBP + 0x1c);
  if ((cVar2 == '+') || (cVar2 == '-')) {
    *(undefined4 *)(unaff_EBP + -0x18) = 1;
  }
  else if ((cVar2 == '0') &&
          ((cVar2 = (*(char **)(unaff_EBP + 0x1c))[1], cVar2 == 'x' || (cVar2 == 'X')))) {
    *(undefined4 *)(unaff_EBP + -0x18) = 2;
  }
  else {
    *(undefined4 *)(unaff_EBP + -0x18) = 0;
  }
  SexyWidget_ProcessInput(*(void **)(unaff_EBP + 0x14),(int *)(unaff_EBP + -0x20));
  *(undefined4 *)(unaff_EBP + -4) = 0;
  this = Log_FlushBuffer();
  *(undefined4 *)(unaff_EBP + -4) = 0xffffffff;
  SmartPointer_Destructor((uint *)(unaff_EBP + -0x20));
  Runtime_FreeBlock(this,unaff_EBP + -0x44);
  iVar10 = *(int *)this;
  *(undefined4 *)(unaff_EBP + -4) = 1;
  uVar15 = (**(code **)(iVar10 + 8))();
  uVar8 = (uint)((ulonglong)uVar15 >> 0x20);
  pcVar13 = *(char **)(unaff_EBP + -0x40);
  *(int *)(unaff_EBP + -0x20) = (int)uVar15;
  pcVar9 = pcVar13;
  if (*(uint *)(unaff_EBP + -0x2c) < 0x10) {
    pcVar9 = (char *)(unaff_EBP + -0x40);
  }
  bVar4 = '\0' < *pcVar9;
  if (bVar4) {
    if (*(uint *)(unaff_EBP + -0x2c) < 0x10) {
      pcVar13 = (char *)(unaff_EBP + -0x40);
    }
    iVar10 = *(int *)(unaff_EBP + 0x20);
    bVar4 = false;
    while (((cVar2 = *pcVar13, cVar2 != '\x7f' && ('\0' < cVar2)) &&
           ((uint)(int)cVar2 < (uint)(iVar10 - *(int *)(unaff_EBP + -0x18))))) {
      iVar10 = iVar10 - cVar2;
      _Src = (undefined1 *)(iVar10 + *(int *)(unaff_EBP + 0x1c));
      STL_MemoryCopy((void *)(iVar10 + 1 + *(int *)(unaff_EBP + 0x1c)),_Src,
                     (*(int *)(unaff_EBP + 0x20) - iVar10) + 1);
      *(int *)(unaff_EBP + 0x20) = *(int *)(unaff_EBP + 0x20) + 1;
      *_Src = 0x2c;
      if ('\0' < pcVar13[1]) {
        pcVar13 = pcVar13 + 1;
      }
      bVar4 = true;
      uVar8 = extraout_EDX;
    }
  }
  uVar6 = *(uint *)(*(int *)(unaff_EBP + 0x14) + 0x14);
  if (((int)uVar6 < 1) || (uVar6 <= *(uint *)(unaff_EBP + 0x20))) {
    *(undefined4 *)(unaff_EBP + -0x14) = 0;
  }
  else {
    *(uint *)(unaff_EBP + -0x14) = uVar6 - *(int *)(unaff_EBP + 0x20);
  }
  uVar6 = *(uint *)(*(int *)(unaff_EBP + 0x14) + 0xc) & 0x1c0;
  if (uVar6 != 0x40) {
    if (uVar6 != 0x100) {
      iVar10 = *(int *)(unaff_EBP + -0x14);
      *(undefined4 *)(unaff_EBP + -0x1c) = *(undefined4 *)(unaff_EBP + 0xc);
      *(undefined4 *)(unaff_EBP + -0x18) = *(undefined4 *)(unaff_EBP + 0x10);
      for (; iVar10 != 0; iVar10 = iVar10 + -1) {
        Timer_Create((void *)(unaff_EBP + -0x1c),*(undefined4 *)(unaff_EBP + 0x18));
        uVar8 = extraout_EDX_00;
      }
      uVar12 = *(undefined4 *)(unaff_EBP + -0x1c);
      uVar14 = *(undefined4 *)(unaff_EBP + -0x18);
      *(undefined4 *)(unaff_EBP + -0x14) = 0;
      goto LAB_004f3039;
    }
    iVar10 = *(int *)(unaff_EBP + -0x18);
    pcVar9 = *(char **)(unaff_EBP + 0x1c);
    *(undefined4 *)(unaff_EBP + -0x28) = *(undefined4 *)(unaff_EBP + 0xc);
    *(undefined4 *)(unaff_EBP + -0x24) = *(undefined4 *)(unaff_EBP + 0x10);
    for (; iVar10 != 0; iVar10 = iVar10 + -1) {
      wVar5 = _btowc((int)*pcVar9);
      Timer_Create((void *)(unaff_EBP + -0x28),CONCAT22(extraout_var,wVar5));
      pcVar9 = pcVar9 + 1;
      uVar8 = extraout_EDX_01;
    }
    *(int *)(unaff_EBP + 0x1c) = *(int *)(unaff_EBP + 0x1c) + *(int *)(unaff_EBP + -0x18);
    *(int *)(unaff_EBP + 0x20) = *(int *)(unaff_EBP + 0x20) - *(int *)(unaff_EBP + -0x18);
    iVar10 = *(int *)(unaff_EBP + -0x14);
    *(undefined4 *)(unaff_EBP + 0xc) = *(undefined4 *)(unaff_EBP + -0x28);
    *(undefined4 *)(unaff_EBP + 0x10) = *(undefined4 *)(unaff_EBP + -0x24);
    for (; iVar10 != 0; iVar10 = iVar10 + -1) {
      Timer_Create((void *)(unaff_EBP + 0xc),*(undefined4 *)(unaff_EBP + 0x18));
      uVar8 = extraout_EDX_02;
    }
    *(undefined4 *)(unaff_EBP + -0x14) = 0;
  }
  uVar14 = *(undefined4 *)(unaff_EBP + 0x10);
  uVar12 = *(undefined4 *)(unaff_EBP + 0xc);
LAB_004f3039:
  if (bVar4) {
    while( true ) {
      sVar7 = _strcspn(*(char **)(unaff_EBP + 0x1c),",");
      *(undefined4 *)(unaff_EBP + 0x10) = *(undefined4 *)(unaff_EBP + 0x1c);
      *(undefined4 *)(unaff_EBP + -0x28) = uVar12;
      *(undefined4 *)(unaff_EBP + -0x24) = uVar14;
      uVar8 = extraout_EDX_05;
      for (sVar11 = sVar7; sVar11 != 0; sVar11 = sVar11 - 1) {
        wVar5 = _btowc((int)**(char **)(unaff_EBP + 0x10));
        Timer_Create((void *)(unaff_EBP + -0x28),CONCAT22(extraout_var_01,wVar5));
        *(int *)(unaff_EBP + 0x10) = *(int *)(unaff_EBP + 0x10) + 1;
        uVar8 = extraout_EDX_06;
      }
      *(int *)(unaff_EBP + 0x1c) = *(int *)(unaff_EBP + 0x1c) + sVar7;
      piVar1 = (int *)(unaff_EBP + 0x20);
      *piVar1 = *piVar1 - sVar7;
      uVar12 = *(undefined4 *)(unaff_EBP + -0x28);
      uVar14 = *(undefined4 *)(unaff_EBP + -0x24);
      if (*piVar1 == 0) break;
      if (*(short *)(unaff_EBP + -0x20) != 0) {
        *(undefined4 *)(unaff_EBP + -0x1c) = uVar12;
        *(undefined4 *)(unaff_EBP + -0x18) = uVar14;
        Timer_Create((void *)(unaff_EBP + -0x1c),*(undefined4 *)(unaff_EBP + -0x20));
        uVar12 = *(undefined4 *)(unaff_EBP + -0x1c);
        uVar14 = *(undefined4 *)(unaff_EBP + -0x18);
      }
      *(int *)(unaff_EBP + 0x1c) = *(int *)(unaff_EBP + 0x1c) + 1;
      *(int *)(unaff_EBP + 0x20) = *(int *)(unaff_EBP + 0x20) + -1;
    }
  }
  else {
    pcVar9 = *(char **)(unaff_EBP + 0x1c);
    *(undefined4 *)(unaff_EBP + 0xc) = uVar12;
    iVar10 = *(int *)(unaff_EBP + 0x20);
    *(undefined4 *)(unaff_EBP + 0x10) = uVar14;
    for (; iVar10 != 0; iVar10 = iVar10 + -1) {
      wVar5 = _btowc((int)*pcVar9);
      Timer_Create((void *)(unaff_EBP + 0xc),CONCAT22(extraout_var_00,wVar5));
      pcVar9 = pcVar9 + 1;
      uVar8 = extraout_EDX_03;
    }
    uVar12 = *(undefined4 *)(unaff_EBP + 0xc);
    uVar14 = *(undefined4 *)(unaff_EBP + 0x10);
  }
  *(undefined4 *)(*(int *)(unaff_EBP + 0x14) + 0x14) = 0;
  *(undefined4 *)(unaff_EBP + 0xc) = uVar12;
  iVar10 = *(int *)(unaff_EBP + -0x14);
  *(undefined4 *)(unaff_EBP + 0x10) = uVar14;
  for (; iVar10 != 0; iVar10 = iVar10 + -1) {
    Timer_Create((void *)(unaff_EBP + 0xc),*(undefined4 *)(unaff_EBP + 0x18));
    uVar8 = extraout_EDX_04;
  }
  puVar3 = *(undefined4 **)(unaff_EBP + 8);
  *puVar3 = *(undefined4 *)(unaff_EBP + 0xc);
  puVar3[1] = *(undefined4 *)(unaff_EBP + 0x10);
  String_Reset(unaff_EBP + -0x44,uVar8,'\x01');
  ExceptionList = *(void **)(unaff_EBP + -0xc);
  Exception_SetMessage
            ((void *)(*(uint *)(unaff_EBP + -0x10) ^ *(uint *)(unaff_EBP + 4)),in_stack_ffffffc8,
             in_stack_ffffffcc);
  return;
}


