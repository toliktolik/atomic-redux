/*
 * Function: PNG_ProcessInterlacing
 * Address: 004c3670
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl PNG_ProcessInterlacing(byte *param_1,undefined4 *param_2)

{
  uint *puVar1;
  byte bVar2;
  uint uVar3;
  
  if ((*(int *)(param_1 + 0xe4) == 0) && (param_1[0x124] == 0)) {
    ImageDecoder_AllocateBuffers((int)param_1);
  }
  if ((param_1[0x123] != 0) && ((param_1[0x70] & 2) != 0)) {
    switch(param_1[0x124]) {
    case 0:
      if ((param_1[0xe4] & 7) != 0) {
LAB_004c36d0:
        ImageDecoder_RotateImage((uint)param_1);
        return;
      }
      break;
    case 1:
      if (((param_1[0xe4] & 7) != 0) || (*(uint *)(param_1 + 200) < 5)) {
        ImageDecoder_RotateImage((uint)param_1);
        return;
      }
      break;
    case 2:
      if (((byte)*(undefined4 *)(param_1 + 0xe4) & 7) != 4) {
        ImageDecoder_RotateImage((uint)param_1);
        return;
      }
      break;
    case 3:
      if (((param_1[0xe4] & 3) != 0) || (*(uint *)(param_1 + 200) < 3)) {
        ImageDecoder_RotateImage((uint)param_1);
        return;
      }
      break;
    case 4:
      if (((byte)*(undefined4 *)(param_1 + 0xe4) & 3) != 2) {
        ImageDecoder_RotateImage((uint)param_1);
        return;
      }
      break;
    case 5:
      if (((param_1[0xe4] & 1) != 0) || (*(uint *)(param_1 + 200) < 2)) {
        ImageDecoder_RotateImage((uint)param_1);
        return;
      }
      break;
    case 6:
      if ((param_1[0xe4] & 1) == 0) goto LAB_004c36d0;
    }
  }
  param_1[0x109] = param_1[0x128];
  param_1[0x108] = param_1[0x126];
  bVar2 = param_1[0x128] * param_1[299];
  param_1[0x10b] = bVar2;
  uVar3 = (uint)bVar2 * *(uint *)(param_1 + 0xd4) + 7 >> 3;
  puVar1 = (uint *)(param_1 + 0x100);
  *puVar1 = *(uint *)(param_1 + 0xd4);
  *(uint *)(param_1 + 0x104) = uVar3;
  param_1[0x10a] = param_1[299];
  CPU_Instruction14(param_1,(undefined4 *)(*(int *)(param_1 + 0xec) + 1),param_2,uVar3);
  if ((((param_1[0x123] != 0) && (param_1[0x124] < 6)) && ((param_1[0x70] & 2) != 0)) &&
     (ImageDecoder_SetupDimensions
                (puVar1,(undefined4 *)(*(int *)(param_1 + 0xec) + 1),(uint)param_1[0x124]),
     *puVar1 == 0)) {
    ImageDecoder_RotateImage((uint)param_1);
    return;
  }
  if (*(int *)(param_1 + 0x70) != 0) {
    PNG_ValidateCRC((int)param_1);
  }
  ImageDecoder_Finalize(param_1,(byte *)puVar1);
  if (*(code **)(param_1 + 0x19c) != (code *)0x0) {
    (**(code **)(param_1 + 0x19c))(param_1,*(undefined4 *)(param_1 + 0xe4),param_1[0x124]);
  }
  return;
}


