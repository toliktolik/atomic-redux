/*
 * Function: Unwind@00513d7c
 * Address: 00513d7c
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Instruction at (ram,0x00513d4d) overlaps instruction at (ram,0x00513d4a)
    */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

uint __fastcall Unwind_00513d7c(int param_1,uint *param_2,int param_3,undefined1 *param_4)

{
  uint *puVar1;
  char *pcVar2;
  byte bVar3;
  code *pcVar4;
  undefined1 *puVar5;
  byte bVar6;
  undefined1 uVar7;
  undefined1 *puVar8;
  uint uVar9;
  undefined1 **ppuVar10;
  undefined4 *puVar11;
  undefined4 in_EAX;
  int iVar12;
  byte *pbVar13;
  undefined2 uVar14;
  uint unaff_EBP;
  undefined4 *unaff_ESI;
  undefined1 *unaff_EDI;
  bool bVar15;
  byte in_AF;
  undefined8 uVar16;
  
  puVar5 = param_4;
  uVar14 = SUB42(param_2,0);
  uVar7 = in(uVar14);
  pbVar13 = (byte *)((int)unaff_ESI * 9 + -0x3d45eaa4);
  bVar3 = *pbVar13;
  bVar6 = *pbVar13;
  *pbVar13 = *pbVar13 - 0x37;
  from_bcd(*(unkbyte10 *)(unaff_EDI + 0x2f));
  *(uint **)CONCAT31((int3)((uint)in_EAX >> 8),uVar7) = param_2;
  pbVar13 = (byte *)(param_1 + -1);
  if (pbVar13 != (byte *)0x0) {
    uVar9 = in(uVar14);
    if (0x36 < bVar3) {
      puVar11 = unaff_ESI + 1;
      bVar6 = (byte)*unaff_ESI;
      bVar3 = 9 < (bVar6 & 0xf) | in_AF;
      bVar6 = bVar6 + bVar3 * '\x06';
      puVar8 = (undefined1 *)
               CONCAT31((int3)((uint)*unaff_ESI >> 8),
                        bVar6 + (0x90 < (bVar6 & 0xf0) | bVar3 * (0xf9 < bVar6)) * '`');
      pcVar2 = (char *)(param_1 + -0x653918ca);
      *pcVar2 = *pcVar2 + -0x50;
      param_4 = puVar8;
      if ((POPCOUNT(*pcVar2) & 1U) != 0) {
        *param_2 = *param_2 ^ 0x44;
        uVar9 = ((uint)unaff_EDI | 0x58) + 0x34d2d045;
        pcVar4 = (code *)swi(4);
        if (SBORROW4((uint)unaff_EDI | 0x58,-0x34d2d045)) {
          uVar16 = (*pcVar4)(puVar5);
          param_2 = (uint *)((ulonglong)uVar16 >> 0x20);
          uVar9 = (uint)uVar16;
        }
        out((short)CONCAT31((int3)((uint)((int)param_2 + 1) >> 8),0x23),(char)uVar9);
        return uVar9;
      }
    }
    else {
      if (SCARRY1(bVar6,-0x37)) {
        *pbVar13 = *pbVar13 ^ (byte)((uint)param_2 >> 8);
        ppuVar10 = &param_4;
        unaff_ESI = unaff_ESI + 1;
        puVar1 = (uint *)((uVar9 & 0xffffffef) - 0x76);
        *puVar1 = *puVar1 ^ 0x44560a35;
        in_AF = ((uint)&param_4 & 0x1000) != 0;
        bVar15 = ((uint)&param_4 & 0x100) != 0;
        param_4 = &stack0x0000000c;
      }
      else {
        out(0x88,unaff_EBP);
        uRambea64ca7 = (undefined1)unaff_EBP;
        if (0x36 >= bVar3) {
          return unaff_EBP;
        }
        bVar15 = false;
        ppuVar10 = (undefined1 **)(unaff_EBP ^ 0x9e44560a);
      }
      bVar3 = 9 < ((byte)ppuVar10 & 0xf) | in_AF;
      bVar6 = (byte)ppuVar10 + bVar3 * -6;
      puVar11 = (undefined4 *)
                CONCAT31((int3)((uint)ppuVar10 >> 8),
                         bVar6 + (0x9f < bVar6 |
                                 (pbVar13 < *(byte **)(puVar5 + -0x2ca38901) ||
                                 (uint)((int)pbVar13 - *(int *)(puVar5 + -0x2ca38901)) <
                                 (uint)bVar15) | bVar3 * (bVar6 < 6)) * -0x60);
      puVar8 = (undefined1 *)CONCAT31((int3)((uint)unaff_ESI >> 8),puVar5[(uint)unaff_ESI & 0xff]);
    }
    *(undefined1 **)(puVar8 + 0x49) =
         puVar5 + (uint)((undefined4 *)0x3e24d811 < puVar11) + *(int *)(puVar8 + 0x49);
    uRam44b2ab51 = SUB41(puVar8,0);
    pcVar4 = (code *)swi(1);
    uVar9 = (*pcVar4)();
    return uVar9;
  }
  iVar12 = in(uVar14);
  if (param_3 == 1) {
    *unaff_EDI = *(undefined1 *)unaff_ESI;
    do {
                    /* WARNING: Do nothing block with infinite loop */
    } while( true );
  }
  bVar6 = (byte)(iVar12 + -1);
  bVar3 = 9 < (bVar6 & 0xf) | in_AF;
  bVar6 = bVar6 + bVar3 * -6;
  return CONCAT31((int3)((uint)(iVar12 + -1) >> 8),
                  bVar6 + (0x9f < bVar6 | bVar3 * (bVar6 < 6)) * -0x60) + 0xd7bd3135;
}


