/*
 * Function: JPEG_DecodeImageData
 * Address: 004de510
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


uint __cdecl JPEG_DecodeImageData(int param_1,int param_2)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  undefined4 local_44;
  undefined4 local_40;
  uint local_3c;
  int local_38;
  int local_34;
  int local_30 [4];
  int local_20;
  int local_1c;
  undefined2 *local_18;
  int *local_14;
  int *local_10;
  int local_c;
  int local_8;
  
  iVar6 = *(int *)(param_1 + 0x198);
  local_1c = iVar6;
  if (((*(int *)(param_1 + 0xfc) != 0) && (*(int *)(iVar6 + 0x24) == 0)) &&
     (uVar1 = JPEG_ProcessNewScanline(), (char)uVar1 == '\0')) {
    return uVar1;
  }
  if (*(char *)(iVar6 + 8) == '\0') {
    local_44 = **(undefined4 **)(param_1 + 0x18);
    local_40 = (*(undefined4 **)(param_1 + 0x18))[1];
    iVar3 = *(int *)(iVar6 + 0x10);
    local_30[0] = *(int *)(iVar6 + 0x14);
    local_30[1] = *(undefined4 *)(iVar6 + 0x18);
    local_30[3] = *(undefined4 *)(iVar6 + 0x20);
    uVar1 = *(uint *)(iVar6 + 0xc);
    local_34 = param_1;
    local_30[2] = *(undefined4 *)(iVar6 + 0x1c);
    local_8 = 0;
    if (0 < *(int *)(param_1 + 0x140)) {
      local_10 = (int *)(iVar6 + 0x70);
      local_14 = (int *)(param_1 + 0x144);
      do {
        iVar6 = *local_10;
        local_18 = *(undefined2 **)(param_2 + local_8 * 4);
        iVar5 = local_10[-10];
        local_c = iVar6;
        if (iVar3 < 8) {
          uVar2 = Compression_FillBitBuffer(&local_44,uVar1,iVar3,0);
          if ((char)uVar2 == '\0') goto LAB_004de8fb;
          iVar3 = local_38;
          uVar1 = local_3c;
          if (7 < local_38) goto LAB_004de5f3;
          iVar4 = 1;
LAB_004de61c:
          uVar2 = Compression_DecodeHuffmanSymbol(&local_44,uVar1,iVar3,iVar5,iVar4);
          iVar3 = local_38;
          uVar1 = local_3c;
          uVar7 = uVar2;
          if ((int)uVar2 < 0) goto LAB_004de8fb;
        }
        else {
LAB_004de5f3:
          uVar2 = (int)uVar1 >> ((char)iVar3 - 8U & 0x1f) & 0xff;
          iVar4 = *(int *)(iVar5 + 0x90 + uVar2 * 4);
          if (iVar4 == 0) {
            iVar4 = 9;
            goto LAB_004de61c;
          }
          iVar3 = iVar3 - iVar4;
          uVar7 = (uint)*(byte *)(uVar2 + 0x490 + iVar5);
        }
        uVar2 = uVar7;
        if (uVar7 != 0) {
          if ((iVar3 < (int)uVar7) &&
             (uVar2 = Compression_FillBitBuffer(&local_44,uVar1,iVar3,uVar7), iVar3 = local_38,
             uVar1 = local_3c, (char)uVar2 == '\0')) {
LAB_004de8fb:
            return uVar2 & 0xffffff00;
          }
          iVar3 = iVar3 - uVar7;
          uVar2 = (1 << ((byte)uVar7 & 0x1f)) - 1U & (int)uVar1 >> ((byte)iVar3 & 0x1f);
          iVar6 = local_c;
          if ((int)uVar2 < *(int *)(&DAT_00543870 + uVar7 * 4)) {
            uVar2 = *(int *)(&DAT_005438b0 + uVar7 * 4) + uVar2;
          }
        }
        iVar5 = local_1c;
        if (*(char *)(local_8 + 0x98 + local_1c) != '\0') {
          iVar4 = *local_14;
          local_30[iVar4] = local_30[iVar4] + uVar2;
          *local_18 = (short)local_30[iVar4];
        }
        iVar4 = 1;
        if (*(char *)(local_8 + 0xa2 + iVar5) == '\0') {
          do {
            if (iVar3 < 8) {
              uVar2 = Compression_FillBitBuffer(&local_44,uVar1,iVar3,0);
              if ((char)uVar2 == '\0') goto LAB_004de8fb;
              iVar3 = local_38;
              uVar1 = local_3c;
              if (7 < local_38) goto LAB_004de803;
              iVar5 = 1;
LAB_004de82c:
              uVar2 = Compression_DecodeHuffmanSymbol(&local_44,uVar1,iVar3,iVar6,iVar5);
              iVar3 = local_38;
              uVar1 = local_3c;
              if ((int)uVar2 < 0) goto LAB_004de8fb;
            }
            else {
LAB_004de803:
              uVar2 = (int)uVar1 >> ((char)iVar3 - 8U & 0x1f) & 0xff;
              iVar5 = *(int *)(iVar6 + 0x90 + uVar2 * 4);
              if (iVar5 == 0) {
                iVar5 = 9;
                goto LAB_004de82c;
              }
              uVar2 = (uint)*(byte *)(uVar2 + 0x490 + iVar6);
              iVar3 = iVar3 - iVar5;
            }
            iVar5 = (int)uVar2 >> 4;
            uVar7 = uVar2 & 0xf;
            if (uVar7 == 0) {
              if (iVar5 != 0xf) break;
            }
            else {
              if ((iVar3 < (int)uVar7) &&
                 (uVar2 = Compression_FillBitBuffer(&local_44,uVar1,iVar3,uVar7), iVar3 = local_38,
                 uVar1 = local_3c, (char)uVar2 == '\0')) goto LAB_004de8fb;
              iVar3 = iVar3 - uVar7;
            }
            iVar4 = iVar4 + iVar5 + 1;
          } while (iVar4 < 0x40);
        }
        else {
          do {
            if (iVar3 < 8) {
              uVar2 = Compression_FillBitBuffer(&local_44,uVar1,iVar3,0);
              if ((char)uVar2 == '\0') goto LAB_004de8fb;
              iVar3 = local_38;
              uVar1 = local_3c;
              if (7 < local_38) goto LAB_004de6ff;
              iVar5 = 1;
LAB_004de728:
              uVar2 = Compression_DecodeHuffmanSymbol(&local_44,uVar1,iVar3,iVar6,iVar5);
              iVar3 = local_38;
              uVar1 = local_3c;
              if ((int)uVar2 < 0) goto LAB_004de8fb;
            }
            else {
LAB_004de6ff:
              uVar2 = (int)uVar1 >> ((char)iVar3 - 8U & 0x1f) & 0xff;
              iVar5 = *(int *)(iVar6 + 0x90 + uVar2 * 4);
              if (iVar5 == 0) {
                iVar5 = 9;
                goto LAB_004de728;
              }
              uVar2 = (uint)*(byte *)(uVar2 + 0x490 + iVar6);
              iVar3 = iVar3 - iVar5;
            }
            uVar7 = uVar2 & 0xf;
            if (uVar7 == 0) {
              if ((int)uVar2 >> 4 != 0xf) break;
              iVar4 = iVar4 + 0xf;
            }
            else {
              local_20 = iVar4 + ((int)uVar2 >> 4);
              if ((iVar3 < (int)uVar7) &&
                 (uVar2 = Compression_FillBitBuffer(&local_44,uVar1,iVar3,uVar7), iVar3 = local_38,
                 uVar1 = local_3c, (char)uVar2 == '\0')) goto LAB_004de8fb;
              iVar3 = iVar3 - uVar7;
              uVar2 = (1 << (sbyte)uVar7) - 1U & (int)uVar1 >> ((byte)iVar3 & 0x1f);
              if ((int)uVar2 < *(int *)(&DAT_00543870 + uVar7 * 4)) {
                uVar2 = *(int *)(&DAT_005438b0 + uVar7 * 4) + uVar2;
              }
              local_18[(&DAT_00542c30)[local_20]] = (short)uVar2;
              iVar6 = local_c;
              iVar4 = local_20;
            }
            iVar4 = iVar4 + 1;
          } while (iVar4 < 0x40);
        }
        local_10 = local_10 + 1;
        local_8 = local_8 + 1;
        local_14 = local_14 + 1;
        iVar6 = local_1c;
      } while (local_8 < *(int *)(param_1 + 0x140));
    }
    **(undefined4 **)(param_1 + 0x18) = local_44;
    *(undefined4 *)(*(int *)(param_1 + 0x18) + 4) = local_40;
    *(uint *)(iVar6 + 0xc) = uVar1;
    *(int *)(iVar6 + 0x14) = local_30[0];
    *(int *)(iVar6 + 0x10) = iVar3;
    *(int *)(iVar6 + 0x18) = local_30[1];
    *(int *)(iVar6 + 0x1c) = local_30[2];
    *(int *)(iVar6 + 0x20) = local_30[3];
  }
  iVar3 = *(int *)(iVar6 + 0x24) + -1;
  *(int *)(iVar6 + 0x24) = iVar3;
  return CONCAT31((int3)((uint)iVar3 >> 8),1);
}


