/*
 * Function: Process_GetExitCode
 * Address: 004e3360
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


undefined4 __cdecl Process_GetExitCode(int *param_1,int param_2)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  int *piVar8;
  uint *puVar9;
  uint *puVar10;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  int *piVar11;
  int iVar12;
  int *piVar13;
  undefined4 *puVar14;
  int local_24;
  int local_1c;
  uint *local_18;
  int *local_8;
  
  iVar1 = *(int *)(param_1[0x12] + 4);
  piVar2 = *(int **)(param_1[0x12] + 0x48);
  iVar3 = *(int *)(iVar1 + 0x1c);
  piVar13 = *(int **)(param_2 + 4);
  uVar4 = *(uint *)(iVar3 + param_1[8] * 4);
  param_1[10] = uVar4;
  local_18 = (uint *)&stack0xffffffc0;
  System_LoadLibrary(*(undefined4 *)(iVar1 + 4));
  System_LoadLibrary(extraout_ECX);
  System_LoadLibrary(extraout_ECX_00);
  System_LoadLibrary(extraout_ECX_01);
  iVar12 = 0;
  if (0 < *(int *)(iVar1 + 4)) {
    local_8 = piVar13;
    do {
      local_8 = local_8 + 1;
      uVar7 = (**(code **)(*(int *)(*(int *)(param_2 + 0x10) + *local_8 * 4) + 0x10))
                        (param_1,*(undefined4 *)(*(int *)(param_2 + 8) + *local_8 * 4));
      *local_18 = uVar7;
      *local_18 = (uint)(uVar7 != 0);
      puVar14 = *(undefined4 **)(*param_1 + iVar12 * 4);
      for (uVar7 = (uVar4 << 2) >> 3; uVar7 != 0; uVar7 = uVar7 - 1) {
        *puVar14 = 0;
        puVar14 = puVar14 + 1;
      }
      for (uVar7 = (uVar4 << 2) >> 1 & 3; uVar7 != 0; uVar7 = uVar7 - 1) {
        *(undefined1 *)puVar14 = 0;
        puVar14 = (undefined4 *)((int)puVar14 + 1);
      }
      local_18 = local_18 + 1;
      iVar12 = iVar12 + 1;
    } while (iVar12 < *(int *)(iVar1 + 4));
  }
  local_8 = (int *)0x0;
  if (0 < piVar13[0x123]) {
    piVar8 = piVar13 + 0x224;
    do {
      if ((*(int *)(&stack0xffffffc0 + piVar8[-0x100] * 4) != 0) ||
         (*(int *)(&stack0xffffffc0 + *piVar8 * 4) != 0)) {
        *(undefined4 *)(&stack0xffffffc0 + piVar8[-0x100] * 4) = 1;
        *(undefined4 *)(&stack0xffffffc0 + *piVar8 * 4) = 1;
      }
      local_8 = (int *)((int)local_8 + 1);
      piVar8 = piVar8 + 1;
    } while ((int)local_8 < piVar13[0x123]);
  }
  local_8 = (int *)0x0;
  if (0 < *piVar13) {
    do {
      local_1c = 0;
      if (0 < *(int *)(iVar1 + 4)) {
        iVar12 = 0;
        puVar9 = (uint *)&stack0xffffffc0;
        local_18 = (uint *)piVar13;
        do {
          local_18 = (uint *)((int *)local_18 + 1);
          puVar10 = puVar9;
          if ((int *)*local_18 == local_8) {
            local_1c = local_1c + 1;
            puVar10 = puVar9 + 1;
            *puVar9 = (uint)(*(int *)(&stack0xffffffc0 + iVar12 * 4) != 0);
            *puVar9 = *(uint *)(*param_1 + iVar12 * 4);
          }
          iVar12 = iVar12 + 1;
          puVar9 = puVar10;
        } while (iVar12 < *(int *)(iVar1 + 4));
      }
      (**(code **)(*(int *)(*(int *)(param_2 + 0x14) + (int)local_8 * 4) + 0x10))
                (param_1,*(undefined4 *)(*(int *)(param_2 + 0xc) + (int)local_8 * 4),
                 &stack0xffffffc0,&stack0xffffffc0,local_1c);
      local_8 = (int *)((int)local_8 + 1);
    } while ((int)local_8 < *piVar13);
  }
  local_1c = piVar13[0x123];
  if (-1 < local_1c + -1) {
    piVar8 = piVar13 + local_1c + 0x223;
    do {
      piVar11 = *(int **)(*param_1 + piVar8[-0x100] * 4);
      if (0 < (int)uVar4 / 2) {
        iVar12 = *(int *)(*param_1 + *piVar8 * 4) - (int)piVar11;
        local_24 = (int)uVar4 / 2;
        do {
          iVar5 = *piVar11;
          iVar6 = *(int *)(iVar12 + (int)piVar11);
          if (iVar5 < 1) {
            if (iVar6 < 1) {
              *(int *)(iVar12 + (int)piVar11) = iVar5;
              *piVar11 = iVar5 - iVar6;
            }
            else {
              *(int *)(iVar12 + (int)piVar11) = iVar6 + iVar5;
            }
          }
          else if (iVar6 < 1) {
            *(int *)(iVar12 + (int)piVar11) = iVar5;
            *piVar11 = iVar6 + iVar5;
          }
          else {
            *(int *)(iVar12 + (int)piVar11) = iVar5 - iVar6;
          }
          piVar11 = piVar11 + 1;
          local_24 = local_24 + -1;
        } while (local_24 != 0);
      }
      piVar8 = piVar8 + -1;
      local_1c = local_1c + -1;
    } while (local_1c != 0);
  }
  iVar12 = 0;
  if (0 < *(int *)(iVar1 + 4)) {
    do {
      piVar13 = piVar13 + 1;
      (**(code **)(*(int *)(*(int *)(param_2 + 0x10) + *piVar13 * 4) + 0x14))
                (param_1,*(undefined4 *)(*(int *)(param_2 + 8) + *piVar13 * 4),
                 *(undefined4 *)(&stack0xffffffc0 + iVar12 * 4),
                 *(undefined4 *)(*param_1 + iVar12 * 4));
      iVar12 = iVar12 + 1;
    } while (iVar12 < *(int *)(iVar1 + 4));
  }
  iVar12 = 0;
  if (0 < *(int *)(iVar1 + 4)) {
    do {
      piVar13 = *(int **)(*param_1 + iVar12 * 4);
      Audio_DecompressMP3Frame(uVar4,piVar13,piVar13);
      iVar12 = iVar12 + 1;
    } while (iVar12 < *(int *)(iVar1 + 4));
  }
  iVar12 = 0;
  if (*(int *)(iVar1 + 4) < 1) {
    DAT_005a47b4 = DAT_005a47b4 + *(int *)(iVar1 + 4);
    return 0;
  }
  do {
    puVar14 = *(undefined4 **)(*param_1 + iVar12 * 4);
    if (*(int *)(&stack0xffffffc0 + iVar12 * 4) == 0) {
      uVar7 = uVar4;
      if (0 < (int)uVar4) {
        for (; uVar7 != 0; uVar7 = uVar7 - 1) {
          *puVar14 = 0;
          puVar14 = puVar14 + 1;
        }
      }
    }
    else {
      GIF_ProcessImageScale(puVar14,piVar2,iVar3,param_1[7],param_1[8],param_1[9]);
    }
    iVar12 = iVar12 + 1;
  } while (iVar12 < *(int *)(iVar1 + 4));
  DAT_005a47b4 = DAT_005a47b4 + *(int *)(iVar1 + 4);
  return 0;
}


