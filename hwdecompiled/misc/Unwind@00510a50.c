/*
 * Function: Unwind@00510a50
 * Address: 00510a50
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x00510a58) overlaps instruction at (ram,0x00510a57)
    */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Removing unreachable block (ram,0x00510a90) */
/* WARNING: Removing unreachable block (ram,0x00510a93) */
/* WARNING: Removing unreachable block (ram,0x00510a98) */

undefined4 __fastcall Unwind_00510a50(int param_1,uint *param_2)

{
  int *piVar1;
  uint *puVar2;
  char cVar3;
  undefined4 *puVar4;
  undefined1 uVar5;
  code *pcVar6;
  uint uVar7;
  undefined4 in_EAX;
  undefined4 uVar8;
  byte bVar10;
  char *extraout_ECX;
  char *pcVar9;
  ushort uVar11;
  byte bVar12;
  int unaff_EBX;
  byte *pbVar13;
  undefined4 *unaff_ESI;
  undefined1 *unaff_EDI;
  undefined2 in_ES;
  byte in_AF;
  char in_ZF;
  float10 extraout_ST0;
  float10 in_ST0;
  undefined8 uVar14;
  
  pcVar9 = (char *)(param_1 + -1);
  bVar10 = (byte)in_EAX;
  if (pcVar9 == (char *)0x0 || in_ZF == '\0') {
    if ((char)(bVar10 + 0x48) < '\0') {
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    bVar10 = 9 < (bVar10 & 0xf) | in_AF;
    do {
      *(double *)((int)param_2 + -0x4edf071f) = (double)in_ST0;
      pcVar6 = (code *)swi(0xbc);
      uVar14 = (*pcVar6)();
      param_2 = (uint *)((ulonglong)uVar14 >> 0x20);
      piVar1 = (int *)((int)(unaff_ESI + 0x19) + (int)extraout_ECX);
      *piVar1 = (int)(extraout_ECX + *piVar1);
      uVar11 = (ushort)((ulonglong)uVar14 >> 0x20);
      if (*piVar1 < 0) {
        bVar10 = 9 < ((byte)uVar14 & 0xf) | bVar10;
        uVar7 = CONCAT31((int3)((ulonglong)uVar14 >> 8),(byte)uVar14 + bVar10 * -6) & 0xffffff0f;
        out(*(undefined1 *)unaff_ESI,uVar11);
        *(undefined2 *)
         (CONCAT22((short)(uVar7 >> 0x10),
                   CONCAT11((char)((ulonglong)uVar14 >> 8) - bVar10,(char)uVar7)) + -0x17) = in_ES;
        halt_baddata();
      }
      pcVar9 = (char *)((int)unaff_ESI + 0x26475c9a);
      cVar3 = *pcVar9;
      *pcVar9 = *pcVar9 + '\x01';
      if (SCARRY1(cVar3,'\x01') != *pcVar9 < '\0') {
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      }
      puVar4 = unaff_ESI + 1;
      uVar8 = *unaff_ESI;
      unaff_ESI = puVar4;
      in_ST0 = extraout_ST0;
    } while (SCARRY1(cVar3,'\x01'));
    if ((POPCOUNT(*pcVar9) & 1U) == 0) {
      *(double *)(unaff_EDI + 0x76) = (double)extraout_ST0;
      puVar2 = (uint *)((int)param_2 + (int)puVar4 * 8 + 0x5c010a0f);
      uVar7 = *puVar2;
      pbVar13 = (byte *)(unaff_EBX + 0x2329ca7a + (uint)CARRY4((uint)puVar4,*puVar2));
      *pbVar13 = *pbVar13 | (byte)uVar8;
      bVar10 = (byte)((uint)extraout_ECX >> 8);
      bVar12 = (byte)((ulonglong)uVar14 >> 0x28);
      pcVar9 = (char *)CONCAT22((short)((uint)extraout_ECX >> 0x10),
                                CONCAT11(bVar10 - bVar12,(char)extraout_ECX));
      if (CONCAT31((int3)((uint)pcVar9 >> 8),((char)extraout_ECX - *pcVar9) - (bVar10 < bVar12)) !=
          1) {
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      }
      pcVar9 = (char *)((int)puVar4 + uVar7 + 0x5f);
      *pcVar9 = *pcVar9 + bVar12;
      uVar5 = in(uVar11 & 0xff00 ^ 0x14);
      *unaff_EDI = uVar5;
      uRam4cd68eab = 0x4cd68eaf;
      uRam4cd68ea7 = 0x4cd68eab;
      uVar8 = in((short)((int)&stack0x00000001 >> 0x1f));
      *(undefined4 *)(unaff_EDI + *(int *)(unaff_EDI + 0x49) + -1) = uVar8;
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    uVar8 = 0x4cd68ea7;
    DAT_9b842832 = DAT_9b842832 + (char)((ulonglong)uVar14 >> 0x20);
    *param_2 = *param_2 | (uint)extraout_ECX;
    pcVar9 = extraout_ECX;
  }
  else {
    uVar8 = CONCAT22((short)((uint)in_EAX >> 0x10),CONCAT11(0x67,bVar10));
    *param_2 = *param_2 | (uint)pcVar9;
  }
  return CONCAT31((int3)((uint)uVar8 >> 8),(char)uVar8 - *pcVar9);
}


