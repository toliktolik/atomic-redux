/*
 * Function: Font_LoadDescriptor
 * Address: 00495550
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __thiscall Font_LoadDescriptor(void *this,undefined4 param_1,_String_base *param_2)

{
  byte bVar1;
  int iVar2;
  bool bVar3;
  bool bVar4;
  char *pcVar5;
  char cVar6;
  char *pcVar7;
  _String_base *p_Var8;
  int *piVar9;
  uint uVar10;
  undefined4 extraout_ECX;
  int extraout_ECX_00;
  int extraout_ECX_01;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint extraout_EDX_03;
  uint unaff_retaddr;
  undefined4 *in_stack_fffffdd0;
  undefined4 *in_stack_fffffdd4;
  _String_base local_130 [4];
  int local_12c;
  uint local_118;
  uint local_114;
  uint auStack_110 [9];
  int aiStack_ec [15];
  int local_b0;
  undefined **local_ac [13];
  undefined1 local_78 [4];
  uint local_74;
  undefined4 local_64;
  uint local_60;
  _String_base local_5c [4];
  uint local_58;
  undefined4 local_48;
  uint local_44;
  _String_base local_40 [4];
  uint local_3c;
  int local_2c;
  uint local_28;
  undefined4 local_24;
  int local_20;
  void *local_1c;
  char local_18;
  char local_17;
  char local_16;
  char local_15;
  uint local_14;
  void *local_10;
  undefined4 uStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  uStack_c = 0x5153fe;
  local_10 = ExceptionList;
  local_14 = DAT_00569f5c ^ unaff_retaddr;
  local_1c = this;
  if (*(char *)((int)this + 4) == '\0') {
    ExceptionList = &local_10;
    *(undefined4 *)((int)this + 0xc) = param_1;
    local_18 = '\0';
    local_20 = 0;
    pcVar5 = "";
    do {
      pcVar7 = pcVar5;
      pcVar5 = pcVar7 + 1;
    } while (*pcVar7 != '\0');
    String_Assign((_String_base *)((int)this + 0x170),(_String_base *)&DAT_0052c7cf,
                  (uint)(pcVar7 + -0x52c7cf));
    p_Var8 = Survival_LoadConfiguration
                       (local_130,(_String_base *)"Font Descriptor Error in ",(int)param_2);
    local_8 = 0;
    p_Var8 = Intel_DisplayPopulationData
                       (extraout_ECX,(uint)local_78,(_String_base *)local_78,p_Var8,
                        (_String_base *)&DAT_00531704);
    local_8 = CONCAT31(local_8._1_3_,1);
    PowerUp_ProcessThunderstrike
              ((_String_base *)((int)local_1c + 0x154),extraout_EDX,p_Var8,0,0xffffffff);
    if (0xf < local_60) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler(extraout_ECX_00,extraout_EDX_00);
    }
    local_60 = 0xf;
    local_64 = 0;
    local_74 = local_74 & 0xffffff00;
    local_8 = 0xffffffff;
    if (0xf < local_118) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler(local_12c,extraout_EDX_00);
    }
    if (*(uint *)(param_2 + 0x18) < 0x10) {
      p_Var8 = param_2 + 4;
    }
    else {
      p_Var8 = *(_String_base **)(param_2 + 4);
    }
    SexyFramework_SetWidgetBounds(&local_114,(int)p_Var8,1,1);
    local_8._0_1_ = 2;
    local_8._1_3_ = 0;
    if (local_b0 == 0) {
      local_8 = 0xffffffff;
      D3D_ResetTransform((int)local_ac);
      local_ac[0] = &PTR_IOSBase_DestructorWrapper_00531324;
      IOStream_RefCountDestructor((ios_base *)local_ac);
    }
    else {
      PowerUp_ProcessThunderstrike
                ((_String_base *)((int)local_1c + 0x138),extraout_EDX_01,param_2,0,0xffffffff);
      if ((*(uint *)((int)auStack_110 + *(int *)(local_114 + 4)) & 1) == 0) {
        do {
          local_28 = 0xf;
          local_2c = 0;
          local_3c = local_3c & 0xffffff00;
          local_8._0_1_ = 3;
          local_16 = '\0';
          local_17 = '\x01';
          bVar3 = false;
          local_15 = '\0';
          bVar4 = false;
          Database_CommitTransaction(&local_114,&local_24,1);
          bVar1 = *(byte *)((int)auStack_110 + *(int *)(local_114 + 4));
          uVar10 = local_114;
          while ((bVar1 & 6) == 0) {
            cVar6 = (char)local_24;
            if (cVar6 != '\r') {
              if (cVar6 == '\n') {
                local_20 = local_20 + 1;
              }
              if (local_17 != '\0') {
                if (((cVar6 == ' ') || (cVar6 == '\t')) || (cVar6 == '\n')) goto LAB_004957ed;
                if (cVar6 == '#') {
                  local_16 = '\x01';
                }
                local_17 = '\0';
              }
              if (cVar6 == '\n') {
                local_17 = '\x01';
                if (local_16 == '\0') goto LAB_004957cb;
                local_16 = '\0';
              }
              else if (local_16 == '\0') {
                if (cVar6 == '\\') {
                  if ((!bVar3) && (local_15 == '\0')) goto LAB_004957cb;
                  if (!bVar4) {
                    bVar4 = true;
                    goto LAB_004957ed;
                  }
LAB_004957d0:
                  Memory_AllocateSound(local_40,1,(_String_base)0x5c);
                  bVar4 = false;
                }
                else if (cVar6 == '\'') {
                  if (local_15 != '\0') goto LAB_004957cb;
                  if (bVar4) goto LAB_004957d0;
                  bVar3 = !bVar3;
                }
                else {
                  if (cVar6 == '\"') {
                    if (!bVar3) {
                      if (bVar4) goto LAB_004957d0;
                      local_15 = local_15 == '\0';
                      goto LAB_004957e2;
                    }
                  }
                  else if (((cVar6 == ';') && (!bVar3)) && (local_15 == '\0')) break;
LAB_004957cb:
                  if (bVar4) goto LAB_004957d0;
                }
LAB_004957e2:
                Memory_AllocateSound(local_40,1,SUB41(local_24,0));
              }
            }
LAB_004957ed:
            Database_CommitTransaction(&local_114,&local_24,1);
            uVar10 = *(uint *)(local_114 + 4);
            bVar1 = *(byte *)((int)auStack_110 + uVar10);
          }
          if (local_2c != 0) {
            Exception_Release(&stack0xfffffdd0,"Line %d:\r\n\r\n");
            p_Var8 = Survival_LoadConfiguration
                               (local_5c,(_String_base *)&stack0xfffffdd0,(int)local_40);
            local_8._0_1_ = 4;
            PowerUp_ProcessThunderstrike
                      ((_String_base *)((int)this + 0x170),extraout_EDX_02,p_Var8,0,0xffffffff);
            local_8._0_1_ = 3;
            if (0xf < local_44) {
                    /* WARNING: Subroutine does not return */
              System_ShutdownHandler(extraout_ECX_01,local_58);
            }
            local_44 = 0xf;
            local_48 = 0;
            local_58 = local_58 & 0xffffff00;
            cVar6 = Text_ParseNextToken(local_1c,(undefined4 *)local_40);
            uVar10 = extraout_EDX_03;
            if (cVar6 == '\0') {
              local_18 = '\x01';
              local_8._0_1_ = 2;
              if (0xf < local_28) {
                    /* WARNING: Subroutine does not return */
                System_ShutdownHandler(local_3c,extraout_EDX_03);
              }
              local_28 = 0xf;
              local_2c = 0;
              local_3c = local_3c & 0xffffff00;
              break;
            }
          }
          local_8._0_1_ = 2;
          if (0xf < local_28) {
                    /* WARNING: Subroutine does not return */
            System_ShutdownHandler(local_3c,uVar10);
          }
          local_28 = 0xf;
          local_2c = 0;
          local_3c = local_3c & 0xffffff00;
        } while ((*(byte *)((int)auStack_110 + *(int *)(local_114 + 4)) & 1) == 0);
      }
      piVar9 = HTTP_EncodeURL((int *)(auStack_110 + 1));
      if (piVar9 == (int *)0x0) {
        iVar2 = *(int *)(local_114 + 4);
        uVar10 = *(uint *)((int)auStack_110 + iVar2) | 2;
        if (*(int *)((int)aiStack_ec + iVar2) == 0) {
          uVar10 = *(uint *)((int)auStack_110 + iVar2) | 6;
        }
        std::ios_base::clear((ios_base *)((int)auStack_110 + iVar2 + -4),uVar10,false);
      }
      *(bool *)((int)local_1c + 4) = local_18 == '\0';
      local_8 = 0xffffffff;
      D3D_ResetTransform((int)local_ac);
      local_ac[0] = &PTR_IOSBase_DestructorWrapper_00531324;
      IOStream_RefCountDestructor((ios_base *)local_ac);
    }
  }
  ExceptionList = local_10;
  Exception_SetMessage((void *)(local_14 ^ unaff_retaddr),in_stack_fffffdd0,in_stack_fffffdd4);
  return;
}


