/*
 * Function: JPEG_DecodeACCoefficients
 * Address: 004ded70
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


uint __cdecl JPEG_DecodeACCoefficients(int param_1,int *param_2)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  undefined4 local_34;
  undefined4 local_30;
  uint local_2c;
  int local_28;
  int local_24;
  int local_20;
  undefined4 local_1c;
  int local_18;
  int local_14;
  int local_10;
  int local_c;
  int local_8;
  
  local_10 = *(int *)(param_1 + 0x170);
  iVar3 = *(int *)(param_1 + 0x198);
  local_1c = *(undefined4 *)(param_1 + 0x178);
  local_14 = iVar3;
  if (((*(int *)(param_1 + 0xfc) != 0) && (*(int *)(iVar3 + 0x28) == 0)) &&
     (uVar1 = JPEG_ProcessNewScanlineSequential(), (char)uVar1 == '\0')) {
LAB_004def55:
    return uVar1 & 0xffffff00;
  }
  if (*(char *)(iVar3 + 8) == '\0') {
    if (*(int *)(iVar3 + 0x14) != 0) {
      *(int *)(iVar3 + 0x14) = *(int *)(iVar3 + 0x14) + -1;
      iVar2 = *(int *)(iVar3 + 0x28) + -1;
      *(int *)(iVar3 + 0x28) = iVar2;
      return CONCAT31((int3)((uint)iVar2 >> 8),1);
    }
    local_24 = param_1;
    local_34 = **(undefined4 **)(param_1 + 0x18);
    local_30 = (*(undefined4 **)(param_1 + 0x18))[1];
    local_20 = *param_2;
    local_c = *(int *)(iVar3 + 0x3c);
    uVar4 = *(uint *)(iVar3 + 0xc);
    iVar2 = *(int *)(iVar3 + 0x10);
    local_8 = *(int *)(param_1 + 0x16c);
    local_18 = 0;
    if (local_8 <= local_10) {
      do {
        if (iVar2 < 8) {
          uVar1 = Compression_FillBitBuffer(&local_34,uVar4,iVar2,0);
          if ((char)uVar1 == '\0') goto LAB_004def55;
          iVar2 = local_28;
          uVar4 = local_2c;
          if (7 < local_28) goto LAB_004dee52;
          iVar3 = 1;
LAB_004dee7e:
          uVar1 = Compression_DecodeHuffmanSymbol(&local_34,uVar4,iVar2,local_c,iVar3);
          iVar2 = local_28;
          uVar4 = local_2c;
          if ((int)uVar1 < 0) goto LAB_004def55;
        }
        else {
LAB_004dee52:
          uVar1 = (int)uVar4 >> ((char)iVar2 - 8U & 0x1f) & 0xff;
          iVar3 = *(int *)(local_c + 0x90 + uVar1 * 4);
          if (iVar3 == 0) {
            iVar3 = 9;
            goto LAB_004dee7e;
          }
          uVar1 = (uint)*(byte *)(uVar1 + 0x490 + local_c);
          iVar2 = iVar2 - iVar3;
        }
        iVar3 = (int)uVar1 >> 4;
        uVar5 = uVar1 & 0xf;
        if (uVar5 == 0) {
          if (iVar3 != 0xf) {
            iVar6 = 1 << ((byte)iVar3 & 0x1f);
            if (iVar3 != 0) {
              if ((iVar2 < iVar3) &&
                 (uVar1 = Compression_FillBitBuffer(&local_34,uVar4,iVar2,iVar3), iVar2 = local_28,
                 uVar4 = local_2c, (char)uVar1 == '\0')) goto LAB_004def55;
              iVar2 = iVar2 - iVar3;
              iVar6 = iVar6 + ((int)uVar4 >> ((byte)iVar2 & 0x1f) & iVar6 - 1U);
            }
            local_18 = iVar6 + -1;
            iVar3 = local_14;
            break;
          }
          local_8 = local_8 + 0xf;
        }
        else {
          local_8 = local_8 + iVar3;
          if ((iVar2 < (int)uVar5) &&
             (uVar1 = Compression_FillBitBuffer(&local_34,uVar4,iVar2,uVar5), iVar2 = local_28,
             uVar4 = local_2c, (char)uVar1 == '\0')) goto LAB_004def55;
          iVar2 = iVar2 - uVar5;
          uVar1 = (1 << (sbyte)uVar5) - 1U & (int)uVar4 >> ((byte)iVar2 & 0x1f);
          if ((int)uVar1 < *(int *)(&DAT_005438f0 + uVar5 * 4)) {
            uVar1 = *(int *)(&DAT_00543930 + uVar5 * 4) + uVar1;
          }
          *(short *)(local_20 + (&DAT_00542c30)[local_8] * 2) =
               (short)(uVar1 << ((byte)local_1c & 0x1f));
        }
        local_8 = local_8 + 1;
        iVar3 = local_14;
      } while (local_8 <= local_10);
    }
    **(undefined4 **)(param_1 + 0x18) = local_34;
    *(undefined4 *)(*(int *)(param_1 + 0x18) + 4) = local_30;
    *(int *)(iVar3 + 0x10) = iVar2;
    *(uint *)(iVar3 + 0xc) = uVar4;
    *(int *)(iVar3 + 0x14) = local_18;
  }
  iVar2 = *(int *)(iVar3 + 0x28) + -1;
  *(int *)(iVar3 + 0x28) = iVar2;
  return CONCAT31((int3)((uint)iVar2 >> 8),1);
}


