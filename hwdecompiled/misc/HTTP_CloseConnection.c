/*
 * Function: HTTP_CloseConnection
 * Address: 004e1c20
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __thiscall HTTP_CloseConnection(void *this,int param_1,int param_2,int param_3)

{
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  short *psVar4;
  void *this_00;
  int iVar5;
  int *piVar6;
  uint unaff_retaddr;
  undefined4 *in_stack_fffffe70;
  undefined4 *in_stack_fffffe74;
  byte local_90 [128];
  int local_10;
  int local_c;
  uint local_8;
  
  local_8 = DAT_00569f5c ^ unaff_retaddr;
  local_c = *(int *)(*(int *)(param_1 + 0x1a8) + 0x18);
  local_10 = (param_3 >> 2) * 0x20 + 4;
  iVar5 = (param_2 >> 2) * 0x20 + 4;
  this_00 = (void *)(((int)this >> 3) * 0x20 + 2);
  iVar1 = HTTP_GetResponse(this_00,iVar5,local_10,(int)&stack0xfffffe70);
  HTTP_ParseHeaders(param_1,iVar5,(int)this_00,local_10,iVar1,(int)&stack0xfffffe70,local_90);
  pbVar3 = local_90;
  piVar6 = (int *)(local_c + (param_2 >> 2) * 0x10);
  param_2 = 4;
  do {
    iVar5 = 8;
    iVar1 = (((int)this >> 3) * 0x100 + (param_3 >> 2) * 4) * 2;
    do {
      psVar4 = (short *)(*piVar6 + iVar1);
      iVar1 = iVar1 + 0x40;
      *psVar4 = *pbVar3 + 1;
      psVar4[1] = pbVar3[1] + 1;
      pbVar2 = pbVar3 + 3;
      psVar4[2] = pbVar3[2] + 1;
      pbVar3 = pbVar3 + 4;
      iVar5 = iVar5 + -1;
      psVar4[3] = *pbVar2 + 1;
    } while (iVar5 != 0);
    piVar6 = piVar6 + 1;
    param_2 = param_2 + -1;
  } while (param_2 != 0);
  Exception_SetMessage((void *)(local_8 ^ unaff_retaddr),in_stack_fffffe70,in_stack_fffffe74);
  return;
}


