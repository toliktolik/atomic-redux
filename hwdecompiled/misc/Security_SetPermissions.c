/*
 * Function: Security_SetPermissions
 * Address: 004e3b10
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


undefined4 __cdecl
Security_SetPermissions(int param_1,int *param_2,int param_3,int param_4,undefined *param_5)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  int *piVar7;
  int iVar8;
  int local_24;
  int local_1c;
  int local_18;
  int local_10;
  int local_c;
  int local_8;
  
  piVar1 = (int *)*param_2;
  iVar2 = *(int *)param_2[5];
  iVar3 = piVar1[2];
  iVar4 = (piVar1[1] - *piVar1) / iVar3;
  System_LoadLibrary(piVar1);
  iVar8 = 0;
  if (0 < param_4) {
    do {
      iVar5 = CPU_ProcessData12(param_1,((iVar4 + -1 + iVar2) / iVar2) * 4);
      *(int *)(&stack0xffffffc0 + iVar8 * 4) = iVar5;
      iVar8 = iVar8 + 1;
    } while (iVar8 < param_4);
  }
  local_c = 0;
  if (0 < param_2[3]) {
    do {
      iVar8 = 0;
      local_10 = 0;
      if (0 < iVar4) {
        local_1c = 0;
        do {
          if ((local_c == 0) && (iVar5 = 0, 0 < param_4)) {
            do {
              uVar6 = GIF_GetImagePointer(param_2[5],(uint *)(param_1 + 4));
              if (uVar6 == 0xffffffff) {
                return 0;
              }
              *(undefined4 *)(local_1c + *(int *)(&stack0xffffffc0 + iVar5 * 4)) =
                   *(undefined4 *)(param_2[8] + uVar6 * 4);
              if (*(int *)(local_1c + *(int *)(&stack0xffffffc0 + iVar5 * 4)) == 0) {
                return 0;
              }
              iVar5 = iVar5 + 1;
              iVar8 = local_10;
            } while (iVar5 < param_4);
          }
          local_8 = 0;
          if (0 < iVar2) {
            local_18 = iVar8 * iVar3;
            do {
              piVar7 = (int *)&stack0xffffffc0;
              if (iVar4 <= iVar8) break;
              local_24 = 0;
              if (0 < param_4) {
                iVar5 = param_3 - (int)piVar7;
                do {
                  iVar8 = *(int *)(*(int *)(local_1c + *piVar7) + local_8 * 4);
                  if ((((piVar1[iVar8 + 5] & 1 << ((byte)local_c & 0x1f)) != 0) &&
                      (iVar8 = *(int *)(*(int *)(param_2[6] + iVar8 * 4) + local_c * 4), iVar8 != 0)
                      ) && (iVar8 = (*(code *)param_5)(iVar8,*(int *)(iVar5 + (int)piVar7) +
                                                             (*piVar1 + local_18) * 4,param_1 + 4,
                                                       iVar3,0xfffffff8), iVar8 == -1)) {
                    return 0;
                  }
                  local_24 = local_24 + 1;
                  piVar7 = piVar7 + 1;
                  iVar8 = local_10;
                } while (local_24 < param_4);
              }
              local_8 = local_8 + 1;
              local_18 = local_18 + iVar3;
              iVar8 = iVar8 + 1;
              local_10 = iVar8;
            } while (local_8 < iVar2);
          }
          local_1c = local_1c + 4;
        } while (iVar8 < iVar4);
      }
      local_c = local_c + 1;
    } while (local_c < param_2[3]);
  }
  return 0;
}


