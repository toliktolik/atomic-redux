/*
 * Function: PixelFormat_ConvertYUVToRGB
 * Address: 004c1290
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __cdecl PixelFormat_ConvertYUVToRGB(uint *param_1)

{
  ushort *puVar1;
  char *pcVar2;
  char cVar3;
  byte bVar4;
  byte bVar5;
  ushort uVar6;
  undefined3 uVar7;
  undefined2 uVar8;
  uint *puVar9;
  byte bVar10;
  short sVar11;
  int iVar12;
  undefined4 extraout_ECX;
  uint extraout_ECX_00;
  uint extraout_ECX_01;
  uint extraout_ECX_02;
  byte *pbVar13;
  uint extraout_ECX_03;
  uint extraout_ECX_04;
  uint extraout_ECX_05;
  uint extraout_ECX_06;
  uint extraout_ECX_07;
  uint uVar14;
  uint *extraout_EDX;
  uint *puVar15;
  int iVar16;
  int iVar17;
  uint uVar18;
  ulonglong uVar19;
  ulonglong uVar20;
  ulonglong uVar21;
  double local_24;
  uint uStack_18;
  byte bStack_8;
  byte bStack_7;
  byte bStack_6;
  
  puVar9 = param_1;
  bVar5 = *(byte *)((int)param_1 + 0x126);
  uVar18 = param_1[0x1c];
  if ((uVar18 & 0x100) != 0) {
    if ((bVar5 & 2) == 0) {
      switch(*(undefined1 *)((int)param_1 + 0x127)) {
      case 1:
        sVar11 = (short)param_1[0x50] * 0xff;
        *(short *)(param_1 + 0x50) = sVar11;
        break;
      case 2:
        sVar11 = (short)param_1[0x50] * 0x55;
        *(short *)(param_1 + 0x50) = sVar11;
        break;
      default:
        goto switchD_004c12cf_caseD_3;
      case 4:
        sVar11 = (short)param_1[0x50] * 0x11;
        *(short *)(param_1 + 0x50) = sVar11;
        break;
      case 8:
      case 0x10:
        sVar11 = (short)param_1[0x50];
      }
      *(short *)((int)param_1 + 0x13e) = sVar11;
      *(short *)(param_1 + 0x4f) = sVar11;
      *(short *)((int)param_1 + 0x13a) = sVar11;
    }
    else if (bVar5 == 3) {
      pbVar13 = (byte *)((uint)(byte)param_1[0x4e] * 3 + param_1[0x45]);
      *(ushort *)((int)param_1 + 0x13a) = (ushort)*pbVar13;
      *(ushort *)(param_1 + 0x4f) = (ushort)pbVar13[1];
      *(ushort *)((int)param_1 + 0x13e) = (ushort)pbVar13[2];
      if (((uVar18 & 0x80000) != 0) && ((uVar18 & 0x1000) == 0)) {
        uVar6 = *(ushort *)((int)param_1 + 0x11a);
        iVar17 = 0;
        if (uVar6 != 0) {
          do {
            pcVar2 = (char *)(param_1[0x62] + iVar17);
            iVar17 = iVar17 + 1;
            *pcVar2 = -1 - *pcVar2;
          } while (iVar17 < (int)(uint)uVar6);
        }
      }
    }
  }
switchD_004c12cf_caseD_3:
  *(uint *)((int)param_1 + 0x142) = param_1[0x4e];
  *(uint *)((int)param_1 + 0x146) = param_1[0x4f];
  *(short *)((int)param_1 + 0x14a) = (short)param_1[0x50];
  if ((param_1[0x1c] & 0x602000) == 0) {
    if (((char)param_1[0x1c] < '\0') && (bVar5 == 3)) {
      uVar6 = *(ushort *)((int)param_1 + 0x11a);
      puVar15 = param_1 + 0x45;
      uVar18 = param_1[0x4f];
      param_1._0_2_ = CONCAT11((byte)uVar18,*(undefined1 *)((int)param_1 + 0x13a));
      uVar8 = param_1._0_2_;
      bVar10 = *(byte *)((int)puVar9 + 0x13e);
      iVar17 = 0;
      param_1 = (uint *)(uint)CONCAT12(bVar10,param_1._0_2_);
      if (uVar6 != 0) {
        pbVar13 = (byte *)(*puVar15 + 2);
        do {
          bVar4 = *(byte *)(iVar17 + puVar9[0x62]);
          if (bVar4 == 0) {
            *(undefined2 *)(pbVar13 + -2) = uVar8;
            *pbVar13 = bVar10;
          }
          else if (bVar4 != 0xff) {
            uVar14 = (0xff - (uint)bVar4) * ((uint)param_1 & 0xff) + 0x80 +
                     (uint)pbVar13[-2] * (uint)bVar4 & 0xffff;
            pbVar13[-2] = (byte)((uVar14 >> 8) + uVar14 >> 8);
            uVar14 = (0xff - (uint)*(byte *)(iVar17 + puVar9[0x62])) * (uint)(byte)uVar18 + 0x80 +
                     (uint)pbVar13[-1] * (uint)*(byte *)(iVar17 + puVar9[0x62]) & 0xffff;
            pbVar13[-1] = (byte)((uVar14 >> 8) + uVar14 >> 8);
            uVar14 = (0xff - (uint)*(byte *)(iVar17 + puVar9[0x62])) * (uint)bVar10 + 0x80 +
                     (uint)*pbVar13 * (uint)*(byte *)(iVar17 + puVar9[0x62]) & 0xffff;
            *pbVar13 = (byte)((uVar14 >> 8) + uVar14 >> 8);
          }
          iVar17 = iVar17 + 1;
          pbVar13 = pbVar13 + 3;
        } while (iVar17 < (int)(uint)uVar6);
      }
    }
    goto LAB_004c178f;
  }
  PixelFormat_ConvertRGBToYUV(param_1);
  if (-1 < (char)param_1[0x1c]) {
    if (bVar5 == 3) {
      uVar18 = (uint)(ushort)param_1[0x46];
      if (uVar18 != 0) {
        pbVar13 = (byte *)(param_1[0x45] + 2);
        do {
          pbVar13[-2] = *(byte *)((uint)pbVar13[-2] + param_1[0x59]);
          pbVar13[-1] = *(byte *)((uint)pbVar13[-1] + param_1[0x59]);
          *pbVar13 = *(byte *)((uint)*pbVar13 + param_1[0x59]);
          pbVar13 = pbVar13 + 3;
          uVar18 = uVar18 - 1;
        } while (uVar18 != 0);
      }
    }
    goto LAB_004c178f;
  }
  if (bVar5 != 3) {
    uVar18 = CONCAT31((int3)((uint)extraout_ECX >> 8),*(byte *)((int)param_1 + 0x127));
    puVar15 = (uint *)((1 << (*(byte *)((int)param_1 + 0x127) & 0x1f)) + -1);
    if ((bVar5 & 2) == 0) {
      Math_ProcessFloatPrecision(uVar18,puVar15);
      uVar19 = Math_FloatToUInt64();
      *(short *)((int)param_1 + 0x14a) = (short)uVar19;
      Math_ProcessFloatPrecision(extraout_ECX_07,(uint *)(uVar19 >> 0x20));
      uVar19 = Math_FloatToUInt64();
      *(short *)(param_1 + 0x50) = (short)uVar19;
    }
    else {
      Math_ProcessFloatPrecision(uVar18,puVar15);
      uVar19 = Math_FloatToUInt64();
      *(short *)(param_1 + 0x51) = (short)uVar19;
      Math_ProcessFloatPrecision((uint)(ushort)param_1[0x4f],(uint *)(uVar19 >> 0x20));
      uVar19 = Math_FloatToUInt64();
      *(short *)((int)param_1 + 0x146) = (short)uVar19;
      Math_ProcessFloatPrecision(extraout_ECX_03,(uint *)(uint)*(ushort *)((int)param_1 + 0x13e));
      uVar19 = Math_FloatToUInt64();
      *(short *)(param_1 + 0x52) = (short)uVar19;
      Math_ProcessFloatPrecision(extraout_ECX_04,(uint *)(uVar19 >> 0x20));
      uVar19 = Math_FloatToUInt64();
      *(short *)((int)param_1 + 0x13a) = (short)uVar19;
      Math_ProcessFloatPrecision(extraout_ECX_05,(uint *)(uVar19 >> 0x20));
      uVar19 = Math_FloatToUInt64();
      *(short *)(param_1 + 0x4f) = (short)uVar19;
      Math_ProcessFloatPrecision(extraout_ECX_06,(uint *)(uVar19 >> 0x20));
      uVar19 = Math_FloatToUInt64();
      *(short *)((int)param_1 + 0x13e) = (short)uVar19;
    }
    goto LAB_004c178f;
  }
  uVar6 = (ushort)param_1[0x46];
  cVar3 = (char)param_1[0x4c];
  uVar18 = param_1[0x45];
  if (cVar3 == '\x02') {
    puVar1 = (ushort *)((int)param_1 + 0x13a);
    uVar14 = param_1[0x59];
    puVar15 = param_1 + 0x4f;
    param_1._0_2_ =
         CONCAT11(*(undefined1 *)((ushort)*puVar15 + uVar14),*(undefined1 *)(uVar14 + *puVar1));
    bVar10 = *(byte *)(*(ushort *)((int)puVar9 + 0x13e) + uVar14);
    uVar14 = puVar9[0x5b];
    uVar7 = CONCAT12(*(undefined1 *)(uVar14 + *(ushort *)((int)puVar9 + 0x13e)),
                     CONCAT11(*(undefined1 *)(uVar14 + (ushort)*puVar15),
                              *(undefined1 *)(uVar14 + *puVar1)));
  }
  else {
    if (cVar3 == '\x01') {
LAB_004c14b7:
      local_24 = 1.0;
    }
    else if (cVar3 == '\x02') {
      local_24 = (double)((float)_DAT_0052a0f0 / ((float)param_1[0x58] * (float)param_1[0x57]));
    }
    else {
      if (cVar3 != '\x03') goto LAB_004c14b7;
      local_24 = (double)((float)_DAT_0052a0f0 / ((float)param_1[0x58] * (float)param_1[0x4d]));
    }
    if (ABS(local_24 - _DAT_0052a0f0) < _DAT_0052d040 ==
        (NAN(ABS(local_24 - _DAT_0052a0f0)) || NAN(_DAT_0052d040))) {
      Math_ProcessFloatPrecision((uint)uVar6,extraout_EDX);
      uVar19 = Math_FloatToUInt64();
      Math_ProcessFloatPrecision((uint)(ushort)param_1[0x4f],(uint *)(uVar19 >> 0x20));
      uVar20 = Math_FloatToUInt64();
      puVar1 = (ushort *)((int)param_1 + 0x13e);
      param_1._0_2_ = CONCAT11((char)uVar20,(char)uVar19);
      Math_ProcessFloatPrecision(extraout_ECX_00,(uint *)(uint)*puVar1);
      uVar19 = Math_FloatToUInt64();
      puVar15 = (uint *)(uVar19 >> 0x20);
      bVar10 = (byte)uVar19;
      uVar14 = extraout_ECX_01;
    }
    else {
      uVar14 = (uint)CONCAT11((char)(uVar6 >> 8),(char)param_1[0x4f]);
      bVar10 = *(byte *)((int)param_1 + 0x13e);
      puVar15 = (uint *)CONCAT31((int3)((uint)extraout_EDX >> 8),bVar10);
      param_1._0_2_ = CONCAT11((char)param_1[0x4f],*(undefined1 *)((int)param_1 + 0x13a));
    }
    Math_ProcessFloatPrecision(uVar14,puVar15);
    uVar19 = Math_FloatToUInt64();
    Math_ProcessFloatPrecision((uint)(ushort)puVar9[0x4f],(uint *)(uVar19 >> 0x20));
    uVar20 = Math_FloatToUInt64();
    Math_ProcessFloatPrecision(extraout_ECX_02,(uint *)(uint)*(ushort *)((int)puVar9 + 0x13e));
    uVar21 = Math_FloatToUInt64();
    uVar7 = CONCAT12((char)uVar21,CONCAT11((char)uVar20,(char)uVar19));
  }
  uStack_18 = (uint)uVar6;
  iVar17 = 0;
  if (uVar6 != 0) {
    pbVar13 = (byte *)(uVar18 + 2);
    do {
      if ((iVar17 < (int)(uint)*(ushort *)((int)puVar9 + 0x11a)) &&
         (bVar4 = *(byte *)(iVar17 + puVar9[0x62]), bVar4 != 0xff)) {
        if (bVar4 == 0) {
          *(undefined2 *)(pbVar13 + -2) = param_1._0_2_;
          *pbVar13 = bVar10;
        }
        else {
          bStack_8 = (byte)uVar7;
          uVar18 = (uint)*(byte *)((uint)pbVar13[-2] + puVar9[0x5b]) * (uint)bVar4 + 0x80 +
                   (0xff - (uint)bVar4) * (uint)bStack_8 & 0xffff;
          pbVar13[-2] = *(byte *)(((int)((uVar18 >> 8) + uVar18) >> 8 & 0xffU) + puVar9[0x5a]);
          bStack_7 = (byte)((uint3)uVar7 >> 8);
          uVar18 = (uint)*(byte *)((uint)pbVar13[-1] + puVar9[0x5b]) *
                   (uint)*(byte *)(puVar9[0x62] + iVar17) + 0x80 +
                   (0xff - (uint)*(byte *)(puVar9[0x62] + iVar17)) * (uint)bStack_7 & 0xffff;
          pbVar13[-1] = *(byte *)(((int)((uVar18 >> 8) + uVar18) >> 8 & 0xffU) + puVar9[0x5a]);
          bStack_6 = (byte)((uint3)uVar7 >> 0x10);
          uVar18 = (uint)*(byte *)((uint)*pbVar13 + puVar9[0x5b]) *
                   (uint)*(byte *)(puVar9[0x62] + iVar17) + 0x80 +
                   (0xff - (uint)*(byte *)(puVar9[0x62] + iVar17)) * (uint)bStack_6 & 0xffff;
          *pbVar13 = *(byte *)(((int)((uVar18 >> 8) + uVar18) >> 8 & 0xffU) + puVar9[0x5a]);
        }
      }
      else {
        pbVar13[-2] = *(byte *)((uint)pbVar13[-2] + puVar9[0x59]);
        pbVar13[-1] = *(byte *)((uint)pbVar13[-1] + puVar9[0x59]);
        *pbVar13 = *(byte *)((uint)*pbVar13 + puVar9[0x59]);
      }
      iVar17 = iVar17 + 1;
      pbVar13 = pbVar13 + 3;
    } while (iVar17 < (int)uStack_18);
  }
LAB_004c178f:
  if (((puVar9[0x1c] & 8) != 0) && (bVar5 == 3)) {
    iVar16 = 8 - (uint)(byte)puVar9[0x5f];
    param_1 = (uint *)(8 - (uint)*(byte *)((int)puVar9 + 0x17d));
    iVar17 = 8 - (uint)*(byte *)((int)puVar9 + 0x17e);
    iVar12 = 0;
    if ((iVar16 < 0) || (8 < iVar16)) {
      iVar16 = 0;
    }
    if (((int)param_1 < 0) || (8 < (int)param_1)) {
      param_1 = (uint *)0x0;
    }
    if ((iVar17 < 0) || (8 < iVar17)) {
      iVar17 = 0;
    }
    if ((ushort)puVar9[0x46] != 0) {
      uVar18 = (uint)(ushort)puVar9[0x46];
      do {
        *(byte *)(iVar12 + puVar9[0x45]) = *(byte *)(iVar12 + puVar9[0x45]) >> ((byte)iVar16 & 0x1f)
        ;
        pbVar13 = (byte *)(iVar12 + 1 + puVar9[0x45]);
        *pbVar13 = *pbVar13 >> ((byte)param_1 & 0x1f);
        pbVar13 = (byte *)(iVar12 + 2 + puVar9[0x45]);
        uStack_18._0_1_ = (byte)iVar17;
        *pbVar13 = *pbVar13 >> ((byte)uStack_18 & 0x1f);
        iVar12 = iVar12 + 3;
        uVar18 = uVar18 - 1;
      } while (uVar18 != 0);
    }
  }
  return;
}


