/*
 * Function: License_GetFeatures
 * Address: 004e3ff0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


uint * __cdecl License_GetFeatures(int param_1,uint *param_2)

{
  uint *puVar1;
  uint uVar2;
  uint uVar3;
  uint *puVar4;
  int iVar5;
  uint *puVar6;
  int iVar7;
  int local_18;
  int local_10;
  uint *local_c;
  uint *local_8;
  
  iVar7 = *(int *)(param_1 + 0x1c);
  local_10 = 0;
  uVar3 = 0xffffffff;
  puVar1 = (uint *)Assembly_DecompilationFailed(1,0x448);
  uVar2 = GIF_SetTransparentIndex(param_2,5);
  *puVar1 = uVar2;
  iVar5 = 0;
  local_8 = puVar1;
  if (0 < (int)uVar2) {
    do {
      local_8 = local_8 + 1;
      uVar2 = GIF_SetTransparentIndex(param_2,4);
      *local_8 = uVar2;
      if ((int)uVar3 < (int)uVar2) {
        uVar3 = uVar2;
      }
      iVar5 = iVar5 + 1;
    } while (iVar5 < (int)*puVar1);
  }
  local_8 = (uint *)0x0;
  if (0 < (int)(uVar3 + 1)) {
    local_c = puVar1 + 0x50;
    puVar4 = puVar1 + 0x40;
    do {
      uVar2 = GIF_SetTransparentIndex(param_2,3);
      puVar4[-0x20] = uVar2 + 1;
      uVar2 = GIF_SetTransparentIndex(param_2,2);
      puVar4[-0x10] = uVar2;
      if ((int)uVar2 < 0) {
LAB_004e4206:
        License_ValidateKey(puVar1);
        return (uint *)0x0;
      }
      if (uVar2 != 0) {
        uVar2 = GIF_SetTransparentIndex(param_2,8);
        *puVar4 = uVar2;
      }
      if (((int)*puVar4 < 0) || (*(int *)(iVar7 + 0x1c) <= (int)*puVar4)) goto LAB_004e4206;
      local_18 = 0;
      puVar6 = local_c;
      if (0 < 1 << ((byte)puVar4[-0x10] & 0x1f)) {
        do {
          uVar2 = GIF_SetTransparentIndex(param_2,8);
          uVar2 = uVar2 - 1;
          *puVar6 = uVar2;
          if (((int)uVar2 < -1) || (*(int *)(iVar7 + 0x1c) <= (int)uVar2)) goto LAB_004e4206;
          local_18 = local_18 + 1;
          puVar6 = puVar6 + 1;
        } while (local_18 < 1 << ((byte)puVar4[-0x10] & 0x1f));
      }
      local_8 = (uint *)((int)local_8 + 1);
      local_c = local_c + 8;
      puVar4 = puVar4 + 1;
    } while ((int)local_8 < (int)(uVar3 + 1));
  }
  uVar3 = GIF_SetTransparentIndex(param_2,2);
  puVar1[0xd0] = uVar3 + 1;
  uVar3 = GIF_SetTransparentIndex(param_2,4);
  iVar7 = 0;
  local_8 = (uint *)0x0;
  local_c = puVar1;
  if (0 < (int)*puVar1) {
    do {
      local_c = local_c + 1;
      local_10 = local_10 + puVar1[*local_c + 0x20];
      if (iVar7 < local_10) {
        puVar4 = puVar1 + iVar7 + 0xd3;
        do {
          uVar2 = GIF_SetTransparentIndex(param_2,uVar3);
          *puVar4 = uVar2;
          if (((int)uVar2 < 0) || (1 << ((byte)uVar3 & 0x1f) <= (int)uVar2)) goto LAB_004e4206;
          iVar7 = iVar7 + 1;
          puVar4 = puVar4 + 1;
        } while (iVar7 < local_10);
      }
      local_8 = (uint *)((int)local_8 + 1);
    } while ((int)local_8 < (int)*puVar1);
  }
  puVar1[0xd1] = 0;
  puVar1[0xd2] = 1 << ((byte)uVar3 & 0x1f);
  return puVar1;
}


