/*
 * Function: Debug_WriteTrace
 * Address: 00493010
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


uint __fastcall Debug_WriteTrace(void *param_1,uint param_2,int param_3,undefined1 *param_4)

{
  uint uVar1;
  _String_base *p_Var2;
  uint uVar3;
  undefined1 *puVar4;
  int extraout_ECX;
  int extraout_ECX_00;
  undefined1 *puVar5;
  uint extraout_EDX;
  uint extraout_EDX_00;
  _String_base *p_Var6;
  uint uVar7;
  undefined4 in_stack_ffffffb0;
  char *in_stack_ffffffb4;
  undefined1 local_24 [4];
  _String_base *local_20;
  undefined1 *local_1c;
  undefined4 local_18;
  undefined1 *local_14;
  void *local_10;
  undefined4 uStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  uStack_c = 0x5150e8;
  local_10 = ExceptionList;
  uVar7 = 0;
  if (*(int *)(param_4 + 4) != 0) {
    ExceptionList = &local_10;
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler((int)param_1,param_2);
  }
  ExceptionList = &local_10;
  *(undefined4 *)(param_4 + 4) = 0;
  *(undefined4 *)(param_4 + 8) = 0;
  *(undefined4 *)(param_4 + 0xc) = 0;
  local_20 = (_String_base *)0x0;
  local_1c = (undefined1 *)0x0;
  local_18 = 0;
  local_8 = 0;
  uVar3 = Exception_CleanupResources(param_1,param_3,local_24);
  p_Var2 = local_20;
  p_Var6 = local_20;
  if ((char)uVar3 == '\0') {
    puVar4 = local_1c;
    puVar5 = param_4;
    if (local_20 == (_String_base *)0x0) {
      ExceptionList = local_10;
      return uVar3 & 0xffffff00;
    }
LAB_004930fe:
    Background_ProcessGroundLayer((int)puVar4,(uint)puVar5,(int)p_Var2,(int)local_1c);
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(extraout_ECX,extraout_EDX);
  }
  do {
    if (p_Var2 == (_String_base *)0x0) {
LAB_00493141:
      ExceptionList = local_10;
      return CONCAT31((int3)(uVar3 >> 8),1);
    }
    uVar1 = ((int)local_1c - (int)p_Var2) / 0x1c;
    uVar3 = -((int)local_1c - (int)p_Var2 >> 0x1f);
    if (uVar1 <= uVar7) {
      if (p_Var2 != (_String_base *)0x0) {
        Background_ProcessGroundLayer((int)local_24,(uint)local_1c,(int)p_Var2,(int)local_1c);
                    /* WARNING: Subroutine does not return */
        System_ShutdownHandler(extraout_ECX_00,extraout_EDX_00);
      }
      goto LAB_00493141;
    }
    local_14 = &stack0xffffffb0;
    in_stack_ffffffb4 = (char *)((uint)in_stack_ffffffb4 & 0xffffff00);
    PowerUp_ProcessThunderstrike((_String_base *)&stack0xffffffb0,uVar1,p_Var6,0,0xffffffff);
    uVar3 = String_Length(in_stack_ffffffb0,in_stack_ffffffb4);
    if ((char)uVar3 == '\0') {
      puVar4 = local_24;
      puVar5 = local_1c;
      goto LAB_004930fe;
    }
    uVar3 = Vector_PushBack_4ByteObjects(param_4,&param_3);
    uVar7 = uVar7 + 1;
    p_Var6 = p_Var6 + 0x1c;
  } while( true );
}


