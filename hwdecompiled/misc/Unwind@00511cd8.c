/*
 * Function: Unwind@00511cd8
 * Address: 00511cd8
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Instruction at (ram,0x00511cf4) overlaps instruction at (ram,0x00511cf3)
    */
/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Removing unreachable block (ram,0x00511cfd) */
/* WARNING: Removing unreachable block (ram,0x00511ca7) */
/* WARNING: Removing unreachable block (ram,0x00511d07) */
/* WARNING: Removing unreachable block (ram,0x00511d09) */
/* WARNING: Removing unreachable block (ram,0x00511cf4) */

uint * __thiscall Unwind_00511cd8(void *this,undefined4 param_1,undefined1 param_2)

{
  char *pcVar1;
  byte *pbVar2;
  byte bVar3;
  byte bVar4;
  char cVar5;
  longlong lVar6;
  code *pcVar7;
  undefined4 in_EAX;
  uint uVar8;
  int iVar9;
  uint *puVar10;
  undefined1 *puVar11;
  ushort uVar12;
  byte bVar14;
  uint uVar13;
  byte *unaff_EBX;
  undefined4 *unaff_EBP;
  undefined4 *unaff_ESI;
  undefined4 *puVar15;
  undefined1 *unaff_EDI;
  undefined2 in_ES;
  bool bVar16;
  byte in_AF;
  bool bVar17;
  byte in_TF;
  byte in_IF;
  byte in_NT;
  undefined8 uVar18;
  int unaff_retaddr;
  
  uVar8 = CONCAT31((int3)((uint)in_EAX >> 8),(byte)in_EAX & *unaff_EBX) | 0xffffffe4;
  uVar13 = unaff_retaddr + *(int *)(uVar8 + 0xbb121456) & *(uint *)((int)this + -0x31e1e4f7);
  if (uVar13 != 0) {
    unaff_EDI = unaff_EDI + 1;
    goto code_r0x00511cf3;
  }
  while( true ) {
    bVar17 = (uVar8 & 0x42b206aa) == 0;
    bVar16 = (POPCOUNT(uVar8 & 0xaa) & 1U) == 0;
    if (bVar16) break;
code_r0x00511cf3:
    iVar9 = in(0x3c);
    this = (void *)CONCAT22((short)((uint)this >> 0x10),
                            CONCAT11((byte)((uint)this >> 8) | (byte)(uVar13 >> 8),(char)this));
    uVar8 = iVar9 - 1;
    param_1._0_1_ = (undefined1)in_ES;
    param_1._1_1_ = (undefined1)((ushort)in_ES >> 8);
  }
  uVar8 = (uint)(in_NT & 1) * 0x4000 | (uint)(in_IF & 1) * 0x200 | (uint)(in_TF & 1) * 0x100;
  uVar12 = (ushort)uVar8 | (ushort)bVar17 * 0x40 | (ushort)(in_AF & 1) * 0x10 | (ushort)bVar16 * 4;
  puVar11 = unaff_EDI;
  if (!bVar17) {
    in(uVar12);
    if (bVar17) {
      pcVar7 = (code *)swi(0xed);
      uVar18 = (*pcVar7)();
      puVar10 = (uint *)((int)uVar18 + -0x27);
      *puVar10 = *puVar10 >> 1;
      pcVar1 = (char *)((int)((ulonglong)uVar18 >> 0x20) + -3);
      *pcVar1 = *pcVar1 - (char)((ulonglong)uVar18 >> 0x20);
      puVar15 = &param_1;
      cVar5 = '\x11';
      do {
        unaff_EBP = unaff_EBP + -1;
        puVar15 = puVar15 + -1;
        *puVar15 = *unaff_EBP;
        cVar5 = cVar5 + -1;
      } while ('\0' < cVar5);
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    puVar11 = (undefined1 *)in(uVar12);
    DAT_2f25b79e = SUB41(puVar11,0);
    puVar15 = unaff_ESI + 1;
    out(*unaff_ESI,uVar12);
    pbVar2 = (byte *)((int)this + 0x6ca3fc09);
    bVar3 = *pbVar2;
    bVar14 = (byte)(uVar8 >> 8);
    bVar4 = *pbVar2 + bVar14;
    *pbVar2 = bVar4 + (unaff_EDI + 5 < unaff_ESI);
    if ((CARRY1(bVar3,bVar14) || CARRY1(bVar4,unaff_EDI + 5 < unaff_ESI)) || *pbVar2 == 0)
    goto LAB_00511db0;
    uVar13 = 0x779c532c;
    puVar11 = unaff_EDI + 6;
  }
  iVar9 = in((short)uVar13);
  lVar6 = (longlong)*(int *)(iVar9 + 0x1202757) * -0x3e;
  puVar15 = (undefined4 *)lVar6;
  if (((int)puVar15 != lVar6) != (int)(uVar13 + 1) < 0) {
                    /* WARNING: Could not recover jumptable at 0x00511d52. Too many branches */
                    /* WARNING: Treating indirect jump as call */
    puVar10 = (uint *)(**(code **)((int)this + -0x2c))();
    return puVar10;
  }
LAB_00511db0:
  in(0x88);
  *puVar11 = *(undefined1 *)puVar15;
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}


