/*
 * Function: D3D_SetupBlendModes
 * Address: 00485eb0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


undefined4 __fastcall D3D_SetupBlendModes(int param_1)

{
  char *pcVar1;
  int iVar2;
  char *pcVar3;
  undefined4 uVar4;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  _String_base local_4c [4];
  uint local_48;
  undefined4 local_38;
  uint local_34;
  undefined4 local_30 [5];
  int local_1c;
  undefined1 *local_14;
  void *local_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  puStack_c = &DAT_00514cc0;
  local_10 = ExceptionList;
  local_14 = &stack0xffffffa8;
  local_8 = 0;
  ExceptionList = &local_10;
  local_1c = param_1;
  iVar2 = (**(code **)(**(int **)(param_1 + 0x18) + 0x14))(*(int **)(param_1 + 0x18));
  D3D_ValidateRenderTarget(iVar2,(_String_base *)&DAT_0052c7cf);
  iVar2 = (**(code **)(**(int **)(param_1 + 0x18) + 0x28))
                    (*(int **)(param_1 + 0x18),0,0,1,0xff000000,0x3f800000,0);
  D3D_ValidateRenderTarget(iVar2,(_String_base *)"Clear");
  iVar2 = (**(code **)(**(int **)(param_1 + 0x18) + 0x50))(*(int **)(param_1 + 0x18),0x1b,1);
  D3D_ValidateRenderTarget(iVar2,(_String_base *)"D3DRENDERSTATE_ALPHABLENDENABLE, TRUE");
  iVar2 = (**(code **)(**(int **)(param_1 + 0x18) + 0x50))(*(int **)(param_1 + 0x18),0x13,5);
  D3D_ValidateRenderTarget(iVar2,(_String_base *)"D3DRENDERSTATE_SRCBLEND, D3DBLEND_SRCALPHA");
  iVar2 = (**(code **)(**(int **)(param_1 + 0x18) + 0x50))(*(int **)(param_1 + 0x18),0x14,6);
  D3D_ValidateRenderTarget(iVar2,(_String_base *)"D3DRENDERSTATE_DESTBLEND, D3DBLEND_INVSRCALPHA");
  iVar2 = (**(code **)(**(int **)(param_1 + 0x18) + 0x50))(*(int **)(param_1 + 0x18),0x16,1);
  D3D_ValidateRenderTarget(iVar2,(_String_base *)"D3DRENDERSTATE_CULLMODE, D3DCULL_NONE");
  DirectX_ValidateDisplayMode(local_30,extraout_EDX,0x40,0x40);
  local_8 = CONCAT31(local_8._1_3_,1);
  Graphics_RenderCheckerboard(local_30);
  D3D_CreateVertexBuffer
            (local_30,*(_String_base **)(param_1 + 0x18),*(_String_base **)(param_1 + 0xc),-2,-2,
             0xffffffff);
  (**(code **)(**(int **)(param_1 + 0x18) + 0x18))(*(int **)(param_1 + 0x18));
  D3D_ProcessRenderState(param_1);
  Graphics_ValidateTexture(local_30,extraout_EDX_00);
  local_8 = 0xffffffff;
  iVar2 = Image_CountOpaquePixels((void *)(param_1 + 0x30),0x3e,0x3e,0,0);
  if (iVar2 == 0) {
    ExceptionList = local_10;
    return 1;
  }
  local_34 = 0xf;
  local_38 = 0;
  local_48 = local_48 & 0xffffff00;
  pcVar1 = "Clip problem detected.";
  do {
    pcVar3 = pcVar1;
    pcVar1 = pcVar3 + 1;
  } while (*pcVar3 != '\0');
  String_Assign(local_4c,(_String_base *)"Clip problem detected.",(uint)(pcVar3 + -0x533824));
  local_8 = 3;
  uVar4 = D3D_SetRenderTarget(param_1,extraout_EDX_01,local_4c);
  if (0xf < local_34) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(local_48,extraout_EDX_02);
  }
  ExceptionList = local_10;
  return uVar4;
}


