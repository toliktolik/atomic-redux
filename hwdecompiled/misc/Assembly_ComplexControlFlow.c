/*
 * Function: Assembly_ComplexControlFlow
 * Address: 004fea50
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x004feadd) overlaps instruction at (ram,0x004feadc)
    */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall Assembly_ComplexControlFlow(undefined4 param_1,double *param_2,undefined4 param_3)

{
  int *piVar1;
  double dVar2;
  longlong lVar3;
  code *pcVar4;
  uint uVar5;
  undefined1 uVar6;
  byte bVar7;
  uint uVar8;
  uint in_EAX;
  int iVar9;
  undefined4 uVar10;
  int extraout_ECX;
  undefined2 uVar11;
  short extraout_DX;
  short sVar12;
  short extraout_DX_00;
  int unaff_EBX;
  byte *pbVar14;
  byte *pbVar15;
  undefined1 *puVar17;
  undefined1 *puVar18;
  undefined1 *puVar19;
  int unaff_EBP;
  undefined1 *unaff_ESI;
  byte *unaff_EDI;
  byte *pbVar20;
  undefined2 in_ES;
  undefined2 in_SS;
  undefined1 in_CF;
  bool bVar21;
  byte in_AF;
  undefined1 in_ZF;
  char cVar22;
  float10 in_ST0;
  float10 extraout_ST0;
  float10 in_ST6;
  undefined8 uVar23;
  char *unaff_retaddr;
  char *pcVar24;
  byte *pbStack_23;
  undefined1 *puStack_1f;
  int iStack_1b;
  int iStack_13;
  undefined4 uStack_f;
  undefined4 uStack_b;
  undefined4 uStack_7;
  undefined2 uStack_3;
  undefined1 uStack_1;
  double *pdVar13;
  byte bVar16;
  
  _DAT_cdbefb09 = in_EAX;
  pcVar24 = unaff_retaddr;
code_r0x004fea51:
  while( true ) {
    cVar22 = (char)unaff_EBX;
    pbVar14 = (byte *)CONCAT31((int3)(CONCAT22((short)((uint)unaff_EBX >> 0x10),
                                               CONCAT11(0x93,cVar22)) >> 8),
                               cVar22 << 3 | (byte)(CONCAT11(in_CF,cVar22) >> 6));
    out(0xeb,_DAT_cdbefb09);
    if ((bool)in_ZF) {
      return;
    }
    uVar8 = _DAT_cdbefb09 + 0xde400ae6;
    if (uVar8 == 0) break;
    in_ST0 = (float10)*(double *)(unaff_ESI + 0x74) / in_ST0;
    pbVar20 = (byte *)(uint)((byte)uVar8 < 0x67);
    in_CF = pbVar14 < (byte *)0x598cdaf6 || pbVar14 + -0x598cdaf6 < pbVar20;
    unaff_EBX = (int)(pbVar14 + -0x598cdaf6) - (int)pbVar20;
    in_ZF = unaff_EBX == 0;
    _DAT_cdbefb09 = uVar8;
  }
  do {
    while( true ) {
      *unaff_EDI = (byte)uVar8;
      piVar1 = (int *)(uVar8 + 0xf + (int)param_2 * 8);
      *piVar1 = (int)&param_3 + *piVar1;
      uVar6 = SUB41(param_2,0);
      uVar11 = CONCAT11((char)unaff_retaddr,uVar6);
      pdVar13 = (double *)CONCAT22((short)((uint)param_2 >> 0x10),uVar11);
      unaff_EDI[1] = (byte)uVar8;
      uVar10 = in(uVar11);
      pbVar20 = unaff_EDI + 6;
      unaff_ESI = unaff_ESI + 4;
      uVar8 = (uint)(short)(ushort)uVar10;
      param_3._0_1_ = (undefined1)in_ES;
      param_3._1_1_ = (undefined1)((ushort)in_ES >> 8);
      bVar7 = (byte)pbVar14;
      bVar16 = (byte)((uint)pbVar14 >> 8) ^ bVar7;
      pbVar15 = (byte *)CONCAT22((short)((uint)pbVar14 >> 0x10),CONCAT11(bVar16,bVar7));
      if ((POPCOUNT(bVar16) & 1U) != 0) {
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      }
      if (bVar16 != 0) break;
      *pbVar20 = *pbVar20 >> 1 | *pbVar20 << 7;
      param_2 = pdVar13;
      pbVar14 = pbVar15;
      unaff_EDI = pbVar20;
    }
    unaff_retaddr = unaff_retaddr + -1;
    if (unaff_retaddr != (char *)0x0 && bVar16 == 0) {
      out(uVar11,(char)uVar10);
      uVar5 = *(uint *)(((uint)unaff_ESI ^ *(uint *)pdVar13) + 0xc27dd1d3) & 0x3aecde55;
      unaff_ESI = (undefined1 *)CONCAT13((undefined1)param_3,(int3)((uint)pcVar24 >> 8));
      param_3._0_1_ = (undefined1)((uint)pbVar14 >> 0x18);
      if (unaff_retaddr != (char *)0x0) {
        do {
                    /* WARNING: Do nothing block with infinite loop */
        } while( true );
      }
LAB_004fead8:
      uVar10 = in(uVar11);
      *(undefined4 *)pbVar20 = uVar10;
      bVar21 = false;
      pdVar13 = (double *)CONCAT31((int3)((uint)pdVar13 >> 8),0xb2);
      pbVar20 = unaff_EDI + 10;
      if (-1 < (int)uVar5) {
        if (uVar5 != 0) {
          sRama56f5d47 = (short)ROUND(in_ST0);
                    /* WARNING: Bad instruction - Truncating control flow here */
          halt_baddata();
        }
        func_0x3598834e();
        sVar12 = extraout_DX + -1;
        if (unaff_EDI + 10 < pbVar15) {
          pcVar4 = (code *)swi(1);
          (*pcVar4)();
          return;
        }
        puVar17 = (undefined1 *)(unaff_EBP + 4);
        pcVar4 = (code *)swi(4);
        puVar18 = (undefined1 *)(unaff_EBP + 4);
        if (SBORROW4((int)&uStack_3,1)) {
          (*pcVar4)();
          puVar18 = puVar17;
          sVar12 = extraout_DX_00;
        }
        out(*unaff_ESI,sVar12);
        puVar19 = puVar18 + 4;
        pcVar4 = (code *)swi(0x12);
        (*pcVar4)();
        *(undefined2 *)(puVar19 + -4) = in_SS;
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      }
    }
    else {
      dVar2 = *pdVar13;
      uStack_7 = CONCAT13(uVar6,(undefined3)uStack_7);
      uStack_1 = (undefined1)((uint)param_2 >> 0x18);
      piVar1 = (int *)segment(in_SS,(short)unaff_EBP + 0x57ed);
      iVar9 = *piVar1;
      pbVar14 = (byte *)(unaff_EBP + -1);
      bVar16 = (byte)((int)unaff_retaddr - iVar9);
      bVar21 = CARRY1(*pbVar14,bVar16);
      *pbVar14 = *pbVar14 + bVar16;
      uVar8 = (uint)(short)((ushort)uVar10 & 0x9e13 ^ 0xe1);
      unaff_retaddr = (char *)(((int)unaff_retaddr - iVar9) + -1);
      if (unaff_retaddr == (char *)0x0 || *pbVar14 != 0) {
        uStack_b._3_1_ = SUB41(unaff_retaddr,0);
        uStack_7._0_3_ = (undefined3)((uint)unaff_retaddr >> 8);
        uStack_7 = CONCAT13(uVar6,(undefined3)uStack_7);
        uStack_f = (double *)CONCAT13(bVar7,(undefined3)uStack_f);
        uStack_b._0_3_ = (undefined3)((uint)pbVar15 >> 8);
        in_ST0 = (in_ST0 - (float10)dVar2) * (float10)*pdVar13;
        unaff_retaddr =
             (char *)CONCAT22((short)((uint)unaff_retaddr >> 0x10),CONCAT11(0xa6,uStack_b._3_1_));
        uVar8 = uVar8 - 1;
        uVar5 = uVar8;
        goto LAB_004fead8;
      }
      unaff_EBP = unaff_EBP + -1;
    }
    while( true ) {
      *(char *)((int)pdVar13 + -0x6644da35) =
           *(char *)((int)pdVar13 + -0x6644da35) + (char)uVar8 + bVar21;
      uVar8 = *(uint *)(&stack0x00000001 + (int)*(undefined6 *)unaff_retaddr * 2);
      cVar22 = (char)((uint6)*(undefined6 *)unaff_retaddr >> 8) == *unaff_retaddr;
      uStack_3 = 0xeaf6;
      uStack_1 = 0x4f;
      uVar23 = func_0x3aa150c3();
      if (extraout_ECX == 1 || cVar22 == '\0') break;
      unaff_retaddr =
           (char *)CONCAT31((int3)((uint)uStack_b >> 8),
                            (byte)uStack_b | *(byte *)(uStack_7 + 0xa29811d5));
      bVar21 = false;
      bVar7 = (byte)uStack_7 | 0xf0;
      uVar8 = uStack_7 | 0xf0;
      uVar23 = CONCAT44(uStack_f,uStack_7);
      unaff_EBP = iStack_1b;
      unaff_ESI = puStack_1f;
      if (bVar7 == 0) {
        in_ZF = extraout_ST0 == in_ST6;
        in_CF = extraout_ST0 < in_ST6;
        in_AF = 0;
        in_ST0 = extraout_ST0 * (float10)*(int *)(unaff_retaddr + iStack_13 * 2 + -0x2c3f6c49);
        uVar6 = in((short)uStack_f);
        _DAT_cdbefb09 = CONCAT31((int3)(uStack_7 >> 8),uVar6);
        param_2 = uStack_f;
        unaff_EBX = iStack_13;
        unaff_EDI = pbStack_23;
        pcVar24 = (char *)0x0;
        goto code_r0x004fea51;
      }
      if (-1 < (char)bVar7) {
        pbVar20 = pbStack_23 + 1;
        goto LAB_004fea93;
      }
      pbVar20 = (byte *)CONCAT22(param_3._2_2_,CONCAT11(param_3._1_1_,(undefined1)param_3));
      pdVar13 = uStack_f;
    }
    unaff_retaddr = (char *)(extraout_ECX + -2);
    unaff_ESI = (undefined1 *)((uint)unaff_ESI ^ uVar8);
    if (unaff_retaddr == (char *)0x0 || cVar22 == '\0') {
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
LAB_004fea93:
    in_AF = 9 < ((byte)uVar23 & 0xf) | in_AF;
    uVar8 = CONCAT31((int3)((ulonglong)uVar23 >> 8),(byte)uVar23 + in_AF * -6) & 0xffffff0f;
    iVar9 = CONCAT22((short)(uVar8 >> 0x10),
                     CONCAT11((char)((ulonglong)uVar23 >> 8) - in_AF,(char)uVar8));
    lVar3 = (longlong)*(int *)(iVar9 + 0xf) * -0x32;
    pbVar14 = (byte *)lVar3;
    unaff_EBP = unaff_EBP + 2;
    uVar8 = iVar9 + -0x1162b195 + (uint)((int)pbVar14 != lVar3);
    param_2 = (double *)((ulonglong)uVar23 >> 0x20);
    unaff_EDI = pbVar20 + -1;
    in_ST0 = extraout_ST0;
    pcVar24 = (char *)0x0;
  } while( true );
}


