/*
 * Function: Particle_ProcessWater
 * Address: 00437940
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall Particle_ProcessWater(int param_1)

{
  ushort *puVar1;
  bool bVar2;
  double dVar3;
  void *this;
  uint uVar4;
  int iVar5;
  ulonglong uVar6;
  undefined4 in_stack_ffffffc0;
  undefined4 in_stack_ffffffc4;
  void *local_10;
  undefined4 uStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  uStack_c = 0x51206b;
  local_10 = ExceptionList;
  dVar3 = *(double *)(param_1 + 0x78) + _DAT_0052a0e8;
  bVar2 = _DAT_005302e0 <= dVar3;
  ExceptionList = &local_10;
  *(double *)(param_1 + 0x78) = dVar3;
  if (bVar2) {
    *(double *)(param_1 + 0x78) = dVar3 - _DAT_005302e0;
  }
  if (0 < *(int *)(param_1 + 0x84)) {
    *(int *)(param_1 + 0x84) = *(int *)(param_1 + 0x84) + -5;
  }
  if (*(int *)(param_1 + 0x84) < 0) {
    *(undefined4 *)(param_1 + 0x84) = 0;
  }
  uVar6 = Math_FloatToUInt64();
  uVar4 = (int)(uint)uVar6 >> 0x1f;
  if ((((int)(((uint)uVar6 ^ uVar4) - uVar4) < 5) && (*(char *)(param_1 + 0x74) == '\0')) &&
     (*(int *)(*(int *)(param_1 + 0x50) + 0x958) == 0)) {
    in_stack_ffffffc4 = *(undefined4 *)(param_1 + 0x14);
    in_stack_ffffffc0 = *(undefined4 *)(param_1 + 0x10);
    TextEffect_CreateFloatingText
              (*(void **)(*(int *)(param_1 + 0x4c) + 0x2fc),*(undefined4 *)(param_1 + 8),
               *(undefined4 *)(param_1 + 0xc),in_stack_ffffffc0,in_stack_ffffffc4,
               *(undefined4 *)(param_1 + 0x18),*(undefined4 *)(param_1 + 0x1c),
               *(undefined4 *)(param_1 + 0x20),*(undefined4 *)(param_1 + 0x24),
               *(undefined4 *)(param_1 + 0x70));
    *(undefined1 *)(param_1 + 0x74) = 1;
  }
  if (*(int **)(param_1 + 0x8c) != (int *)0x0) {
    iVar5 = **(int **)(param_1 + 0x8c);
    Math_FloatToUInt64();
    (**(code **)(iVar5 + 0x18))();
    uVar6 = Math_FloatToUInt64();
    uVar4 = (int)(uint)uVar6 >> 0x1f;
    if ((int)(((uint)uVar6 ^ uVar4) - uVar4) < 0x141) {
      (**(code **)(**(int **)(param_1 + 0x8c) + 0x14))();
    }
    else {
      (**(code **)(**(int **)(param_1 + 0x8c) + 0x14))();
    }
  }
  if (*(int *)(param_1 + 0x34) != 0xff) goto LAB_00437bfa;
  dVar3 = *(double *)(param_1 + 0x40) * _DAT_0052c968;
  *(undefined4 *)(param_1 + 0x84) = 0xff;
  if ((dVar3 <= *(double *)(param_1 + 0x58)) || (*(int *)(param_1 + 0x88) != 0)) {
    if ((*(double *)(param_1 + 0x58) < *(double *)(param_1 + 0x40) * _DAT_0052a0e8) &&
       (*(int *)(param_1 + 0x88) == 1)) {
      iVar5 = **(int **)(*(int *)(param_1 + 0x4c) + 0x5c);
      Math_FloatToUInt64();
      goto LAB_00437b36;
    }
    if ((*(double *)(param_1 + 0x58) < *(double *)(param_1 + 0x40) * _DAT_0052c668) &&
       (*(int *)(param_1 + 0x88) == 2)) {
      iVar5 = **(int **)(*(int *)(param_1 + 0x4c) + 0x5c);
      Math_FloatToUInt64();
      goto LAB_00437b36;
    }
  }
  else {
    iVar5 = **(int **)(*(int *)(param_1 + 0x4c) + 0x5c);
    Math_FloatToUInt64();
LAB_00437b36:
    (**(code **)(iVar5 + 0xb8))();
    *(int *)(param_1 + 0x88) = *(int *)(param_1 + 0x88) + 1;
  }
  if ((((*(char *)(param_1 + 0x90) == '\0') &&
       (iVar5 = *(int *)(param_1 + 0x50),
       (*(byte *)(*(int *)(iVar5 + 0xb40) * 0x60 + *(int *)(iVar5 + 0x148c) + 0x42) & 2) == 0)) &&
      ((*(byte *)(iVar5 + 0xb3e) & 4) == 0)) &&
     ((*(int *)(iVar5 + 0x958) == 0 && (*(char *)(*(int *)(param_1 + 0x4c) + 0x327) == '\0')))) {
    this = operator_new(0x128);
    local_8 = 0;
    if (this != (void *)0x0) {
      Level_InitializeDictastroika
                (&stack0xffffffc0,
                 "Don\'t shoot the white helicopters! They are your allies and will supply you with important powerups!"
                );
      TipDialog_Constructor
                (this,*(int *)(*(int *)(param_1 + 0x4c) + 0x5c),in_stack_ffffffc0,in_stack_ffffffc4)
      ;
    }
    local_8 = 0xffffffff;
    (**(code **)(**(int **)(param_1 + 0x50) + 0x100))();
    puVar1 = (ushort *)(*(int *)(param_1 + 0x50) + 0xb3e);
    *puVar1 = *puVar1 | 4;
  }
  *(undefined1 *)(param_1 + 0x90) = 1;
LAB_00437bfa:
  Boss_ProcessWreckerWarWrecker(param_1);
  if ((*(double *)(param_1 + 8) < _DAT_0052e648 !=
       (NAN(*(double *)(param_1 + 8)) || NAN(_DAT_0052e648))) ||
     (_DAT_0052d4f0 < *(double *)(param_1 + 8))) {
    *(int *)(*(int *)(param_1 + 0x4c) + 0x1bc) = *(int *)(*(int *)(param_1 + 0x4c) + 0x1bc) + -1;
    Boss_BattleshipCannonSystem(param_1);
  }
  ExceptionList = local_10;
  return;
}


