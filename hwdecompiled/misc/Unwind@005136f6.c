/*
 * Function: Unwind@005136f6
 * Address: 005136f6
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x005137bd) overlaps instruction at (ram,0x005137bc)
    */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: This function may have set the stack pointer */
/* WARNING: Removing unreachable block (ram,0x005137a7) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall Unwind_005136f6(int param_1,undefined4 param_2)

{
  int iVar1;
  uint *puVar2;
  char cVar3;
  longlong lVar4;
  code *pcVar5;
  char cVar6;
  int in_EAX;
  uint uVar8;
  uint uVar9;
  undefined1 *puVar10;
  undefined1 *puVar11;
  int iVar12;
  uint3 uVar13;
  uint unaff_EBX;
  undefined1 *puVar14;
  int unaff_EBP;
  uint *puVar15;
  uint *puVar16;
  uint *unaff_EDI;
  undefined2 in_GS;
  int in_GS_OFFSET;
  bool bVar17;
  undefined8 uVar18;
  int unaff_retaddr;
  char cVar7;
  
  while( true ) {
    uVar8 = CONCAT31((int3)((uint)in_EAX >> 8),DAT_86e8faf8);
    uVar9 = uVar8 + 0x3fe0dde;
    out(0x37,(char)uVar9);
    if ((POPCOUNT(uVar9 & 0xff) & 1U) == 0) {
      *(char *)((int)unaff_EDI + 0x455ecffb) =
           *(char *)((int)unaff_EDI + 0x455ecffb) << ((byte)param_1 & 0x1f);
      pcVar5 = (code *)swi(3);
      (*pcVar5)();
      return;
    }
    bVar17 = uVar9 < 0xcfce3368 || uVar8 + 0x342fda76 < (uint)(uVar8 < 0xfc01f222);
    puVar10 = (undefined1 *)((uVar8 + 0x342fda76) - (uint)(uVar8 < 0xfc01f222));
    puVar15 = (uint *)*(undefined6 *)(unaff_EBP + -0x26c63085);
    iVar12 = param_1 + -1;
    if (iVar12 == 0 || puVar10 != (undefined1 *)0x0) {
      *(byte *)unaff_EDI = (char)*unaff_EDI << 3 | (byte)(CONCAT11(bVar17,(char)*unaff_EDI) >> 6);
    }
    else {
      cVar7 = (char)(puVar10 + 1);
      cVar3 = cVar7 + -0x19;
      cVar6 = cVar3 + bVar17;
      puVar10 = (undefined1 *)CONCAT31((int3)((uint)(puVar10 + 1) >> 8),cVar6);
      if (cVar6 == '\0' || (SCARRY1(cVar7,-0x19) != SCARRY1(cVar3,bVar17)) != cVar6 < '\0') {
        pcVar5 = (code *)swi(3);
        (*pcVar5)();
        return;
      }
    }
    puVar2 = unaff_EDI + 1;
    puVar16 = puVar15 + 1;
    if (*unaff_EDI < *puVar15) break;
    if (iVar12 != 0) {
      *(char *)puVar2 = (char)puVar10;
      uVar8 = (uint)puVar10 & 0xff;
      while (DAT_6b92f4d3 = (char)uVar8 + 'G', !SCARRY1((char)uVar8,'G')) {
        out(0x83,DAT_6b92f4d3);
        uVar8 = _DAT_23f137e9;
      }
      pcVar5 = (code *)swi(3);
      (*pcVar5)();
      return;
    }
    LOCK();
    *(int *)(unaff_EBP + 0x3f49635) = unaff_retaddr;
    UNLOCK();
    in_EAX = (uint)(uint3)((uint3)((uint)puVar10 >> 8) ^ 0x273d29) << 8;
    out(*(undefined4 *)((int)puVar15 + 5),(short)param_2);
    param_1 = 0;
    unaff_EDI = puVar2;
  }
  LOCK();
  iVar1 = *(int *)(puVar10 + (int)&stack0x00000000);
  *(int *)(puVar10 + (int)&stack0x00000000) = iVar12;
  UNLOCK();
  if (-1 < (char)((char)puVar10 + -0x17)) {
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  unaff_EDI[iVar1 * 2 + 0x5684ac5] = unaff_EDI[iVar1 * 2 + 0x5684ac5] ^ unaff_EBX;
  *(char *)puVar2 = (char)*puVar2 + '\x01';
  if ((char)*puVar2 == '\0') {
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  uVar13 = (uint3)((uint)param_2 >> 8) ^
           (uint3)((uint)*(undefined4 *)((int)puVar15 + 0x78eb58b9) >> 8);
  puVar11 = (undefined1 *)CONCAT22((short)((uint)puVar2 >> 0x10),in_GS);
  if (iVar1 == 0) {
    puVar11 = &DAT_72650b0e;
  }
  else {
    puVar16 = (uint *)((uint)puVar16 | *(uint *)(iVar1 + 0x2c));
    if ((int)puVar16 < 1) {
      lVar4 = (longlong)*(int *)((int)puVar16 + 0x35) * -0x16;
      puVar14 = puVar11 + -4;
      *(uint **)(puVar11 + -4) = puVar16;
      if (SBORROW4(CONCAT31(uVar13,0x7b),1)) {
        pcVar5 = (code *)swi(0x94);
        uVar18 = (*pcVar5)();
        puVar15 = (uint *)(in_GS_OFFSET + (int)((ulonglong)uVar18 >> 0x20) + 0x1b);
        *puVar15 = *puVar15 & (uint)uVar18;
        return;
      }
      puVar11 = (undefined1 *)CONCAT31((int3)((uint)&stack0x00000000 >> 8),-((int)lVar4 != lVar4));
      bVar17 = *(undefined1 **)(puVar11 + unaff_retaddr + -0xd) < puVar14;
      goto code_r0x00513845;
    }
  }
  puVar15 = (uint *)(CONCAT31(uVar13,'{' - *(byte *)((int)puVar16 + 0xc5a212bfU)) + -0x2a);
  uVar8 = (uint)(0x7b < *(byte *)((int)puVar16 + 0xc5a212bfU));
  bVar17 = 0xcd79bc6 < *puVar15 || CARRY4(*puVar15 + 0xf3286439,uVar8);
  *puVar15 = *puVar15 + 0xf3286439 + uVar8;
code_r0x00513845:
  uVar8 = *(uint *)(puVar11 + -0x79);
  *(uint *)(puVar11 + -0x79) = uVar8 << 5 | (uint)(CONCAT14(bVar17,uVar8) >> 0x1c);
  *puVar10 = (char)puVar11;
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}


