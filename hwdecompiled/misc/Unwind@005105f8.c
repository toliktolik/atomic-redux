/*
 * Function: Unwind@005105f8
 * Address: 005105f8
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x00510661) overlaps instruction at (ram,0x00510660)
    */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Removing unreachable block (ram,0x0051059c) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

float10 __fastcall Unwind_005105f8(uint param_1,uint param_2)

{
  uint uVar1;
  byte bVar2;
  char cVar3;
  code *pcVar4;
  undefined4 uVar5;
  byte bVar6;
  undefined1 uVar7;
  undefined4 in_EAX;
  uint uVar8;
  int iVar10;
  int iVar11;
  undefined4 extraout_ECX;
  undefined4 extraout_EDX;
  char unaff_BL;
  int iVar13;
  undefined4 *puVar14;
  int unaff_EBP;
  uint uVar15;
  uint unaff_ESI;
  undefined4 *puVar16;
  char *pcVar17;
  char *unaff_EDI;
  undefined2 in_GS;
  bool bVar18;
  byte in_AF;
  float10 in_ST0;
  float10 fVar19;
  uint uVar9;
  undefined4 *puVar12;
  
  *unaff_EDI = unaff_BL + '\x01';
  iVar13 = *(int *)(param_1 * 3 + -0xb) * -0xb;
  bVar2 = 9 < ((byte)in_EAX & 0xf) | in_AF;
  uVar8 = CONCAT31((int3)((uint)in_EAX >> 8),(byte)in_EAX + bVar2 * '\x06') & 0xffffff0f;
  uVar9 = CONCAT22((short)(uVar8 >> 0x10),CONCAT11((char)((uint)in_EAX >> 8) + bVar2,(char)uVar8));
  bVar6 = (byte)param_1 & 0x1f;
  puVar16 = (undefined4 *)(unaff_ESI >> bVar6 | unaff_ESI << 0x20 - bVar6);
  bVar18 = (param_1 & 0x1f) != 0;
  uVar8 = (uint)(byte)(!bVar18 & bVar2 | (bVar18 && (int)puVar16 < 0));
  uVar1 = uVar9 + 0x6ecfd3b4;
  iVar10 = uVar1 + uVar8;
  uVar15 = unaff_EBP + 1;
  if (param_1 != 1 && uVar15 == 0) {
    puVar16 = (undefined4 *)0xae4ed630;
  }
  else {
    iVar11 = CONCAT22((short)((uint)&stack0x00000000 >> 0x10),0xe300);
    if (param_1 != 2 && uVar15 == 0) {
      if (uVar9 < 0x91302c4c && !CARRY4(uVar1,uVar8)) {
        *(double *)(unaff_EBP + -0x7b) = (double)in_ST0;
        *(undefined2 *)(unaff_EDI + iVar11 + -0x1699a8ba) = in_GS;
      }
      else {
        in(0x91);
      }
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    uVar7 = in((short)param_2);
    puVar12 = (undefined4 *)CONCAT31((int3)((uint)iVar11 >> 8),uVar7);
    if ((POPCOUNT(uVar15 & 0xff) & 1U) == 0) {
      puVar16 = (undefined4 *)(iVar10 + -4);
      *(undefined4 **)(iVar10 + -4) = puVar12;
      cVar3 = '\x10';
      do {
        puVar12 = puVar12 + -1;
        puVar16 = puVar16 + -1;
        *puVar16 = *puVar12;
        cVar3 = cVar3 + -1;
      } while ('\0' < cVar3);
      *(int *)(iVar10 + -0x48) = iVar10 + -4;
      *unaff_EDI = (char)uVar15;
      return (float10)*(float *)(unaff_EBP + 0x5a6f376a) - in_ST0;
    }
    param_2 = param_2 | 0x5200;
    bVar18 = unaff_EDI < (char *)(param_1 - 2);
    unaff_EDI = *(char **)(iVar10 + 1);
    if (iVar10 == -1) {
      pcVar17 = (char *)*(undefined6 *)(unaff_EBP + -0x10e711ca);
      if (bVar18) {
        puVar14 = (undefined4 *)0x0;
        _DAT_00000000 = 0x5106d2;
        func_0x98609d29();
        uVar5 = *puVar14;
        unaff_EDI[1] = *pcVar17;
        *puVar14 = uVar5;
        puVar14[-1] = extraout_ECX;
        puVar14[-2] = extraout_EDX;
        puVar14[-3] = iVar13;
        puVar14[-4] = puVar14 + 1;
        puVar14[-5] = uVar15;
        puVar14[-6] = pcVar17 + 1;
        puVar14[-7] = unaff_EDI + 2;
        pcVar4 = (code *)swi(1);
        fVar19 = (float10)(*pcVar4)();
        return fVar19;
      }
      _DAT_00000000 = param_2;
      pcVar4 = (code *)swi(0x15);
      (*pcVar4)();
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
  }
  *(undefined4 *)unaff_EDI = *puVar16;
  *(char *)(puVar16 + -0x146c4a73) = (char)((uint)iVar13 >> 8);
  LOCK();
  *(uint *)(CONCAT22((short)(param_2 >> 0x10),
                     CONCAT11((byte)(param_2 >> 8) & (byte)param_2,(byte)param_2)) + 0x7c739aee) =
       uVar15;
  UNLOCK();
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}


