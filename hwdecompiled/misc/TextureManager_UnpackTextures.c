/*
 * Function: TextureManager_UnpackTextures
 * Address: 004bb6d0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl TextureManager_UnpackTextures(void *param_1,byte *param_2)

{
  void *pvVar1;
  char *pcVar2;
  char *pcVar3;
  byte *pbVar4;
  uint uVar5;
  byte *pbVar6;
  uint uVar7;
  int iVar8;
  uint extraout_ECX;
  int extraout_ECX_00;
  uint extraout_ECX_01;
  int extraout_ECX_02;
  byte *extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint extraout_EDX_03;
  uint extraout_EDX_04;
  uint extraout_EDX_05;
  int iVar9;
  int iVar10;
  uint unaff_retaddr;
  undefined4 *in_stack_00002112;
  undefined4 *in_stack_00002116;
  undefined4 uVar11;
  _String_base local_70 [4];
  uint local_6c;
  int local_5c;
  uint local_58;
  undefined4 local_54 [5];
  undefined4 local_40 [5];
  undefined4 local_2c [5];
  undefined4 local_18;
  uint local_14;
  void *local_10;
  undefined4 uStack_c;
  undefined4 local_8;
  
  uStack_c = 0x517380;
  local_10 = ExceptionList;
  local_14 = DAT_00569f5c ^ unaff_retaddr;
  iVar9 = 0;
  local_18 = 0;
  local_58 = 0xf;
  local_5c = 0;
  local_6c = local_6c & 0xffffff00;
  local_8 = 0;
  ExceptionList = &local_10;
  if (0 < *(int *)(param_2 + 0x14)) {
    pbVar6 = param_2 + 4;
    ExceptionList = &local_10;
    do {
      uVar5 = *(uint *)(param_2 + 0x18);
      pbVar4 = pbVar6;
      if (0xf < uVar5) {
        pbVar4 = *(byte **)pbVar6;
      }
      if (pbVar4[iVar9] != 0x20) {
        pbVar4 = pbVar6;
        if (0xf < uVar5) {
          pbVar4 = *(byte **)pbVar6;
        }
        if (pbVar4[iVar9] == 0x31) {
          pcVar2 = "L";
          do {
            pcVar3 = pcVar2;
            pcVar2 = pcVar3 + 1;
          } while (*pcVar3 != '\0');
          Enemy_ProcessSatelliteLogic
                    (local_70,(_String_base *)&DAT_00537b04,(uint)(pcVar3 + -0x537b04));
        }
        else {
          pbVar4 = pbVar6;
          if (0xf < uVar5) {
            pbVar4 = *(byte **)pbVar6;
          }
          if (pbVar4[iVar9] == 0x30) {
LAB_004bb7be:
            uVar11 = 0x51;
          }
          else {
            pbVar4 = pbVar6;
            if (0xf < uVar5) {
              pbVar4 = *(byte **)pbVar6;
            }
            if (pbVar4[iVar9] == 0x6f) goto LAB_004bb7be;
            pbVar4 = pbVar6;
            if (0xf < uVar5) {
              pbVar4 = *(byte **)pbVar6;
            }
            if (pbVar4[iVar9] == 0x4f) goto LAB_004bb7be;
            uVar5 = Assembly_BitwiseShiftOperation((byte)uVar5,param_2);
            local_18 = CONCAT31(local_18._1_3_,(char)uVar5);
            uVar11 = local_18;
          }
          Memory_AllocateSound(local_70,1,SUB41(uVar11,0));
        }
      }
      iVar9 = iVar9 + 1;
    } while (iVar9 < *(int *)(param_2 + 0x14));
  }
  Texture_CopyToBuffer(local_2c);
  iVar9 = 0;
  local_8._0_1_ = 1;
  uVar5 = extraout_ECX;
  pbVar6 = extraout_EDX;
  if (0 < local_5c) {
    do {
      if (*(uint *)(pbVar6 + 0x18) < 0x10) {
        pbVar6 = pbVar6 + 4;
      }
      else {
        pbVar6 = *(byte **)(pbVar6 + 4);
      }
      uVar7 = Assembly_BitwiseShiftOperation((byte)uVar5,(byte *)(int)(char)pbVar6[iVar9]);
      uVar5 = uVar7 & 0xff;
      if ((uint)(local_5c - iVar9) % 6 == 0) {
        if ((char)uVar7 != '-') {
          TextureManager_Initialize(param_1,0);
          uVar5 = extraout_EDX_01;
          goto LAB_004bb7fe;
        }
      }
      else {
        iVar10 = -1;
        iVar8 = 0;
        do {
          if (PTR_s_234679ACDEFGHJKLMNPQRTUVWXYZ_0056798c[iVar8] == (char)uVar7) {
            iVar10 = iVar8;
          }
          iVar8 = iVar8 + 1;
        } while (iVar8 < 0x1c);
        if (iVar10 == -1) {
          TextureManager_Initialize(param_1,0);
          Texture_Constructor(local_2c,extraout_EDX_04);
          iVar9 = extraout_ECX_02;
          uVar5 = extraout_EDX_05;
          pvVar1 = ExceptionList;
          ExceptionList = local_10;
          goto joined_r0x004bb90a;
        }
        TextureManager_Initialize(local_40,0x1c);
        local_8._0_1_ = 2;
        TextureManager_PackTextures(local_2c,local_40);
        local_8._0_1_ = 1;
        Texture_Constructor(local_40,extraout_EDX_02);
        TextureManager_Initialize(local_54,iVar10);
        local_8._0_1_ = 3;
        TextureManager_PreloadTextures(local_2c,local_54);
        local_8._0_1_ = 1;
        Texture_Constructor(local_54,extraout_EDX_03);
        uVar5 = extraout_ECX_01;
      }
      iVar9 = iVar9 + 1;
      pbVar6 = param_2;
    } while (iVar9 < local_5c);
  }
  TextureManager_Shutdown(param_1,(int)local_2c);
  uVar5 = extraout_EDX_00;
LAB_004bb7fe:
  Texture_Constructor(local_2c,uVar5);
  iVar9 = extraout_ECX_00;
  uVar5 = local_6c;
  pvVar1 = ExceptionList;
  ExceptionList = local_10;
joined_r0x004bb90a:
  local_10 = ExceptionList;
  if (0xf < local_58) {
    ExceptionList = pvVar1;
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(iVar9,uVar5);
  }
  Exception_SetMessage((void *)(local_14 ^ unaff_retaddr),in_stack_00002112,in_stack_00002116);
  return;
}


