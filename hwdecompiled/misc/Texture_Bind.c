/*
 * Function: Texture_Bind
 * Address: 004b8490
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __fastcall Texture_Bind(undefined4 param_1,undefined2 param_2,uint param_3)

{
  byte *pbVar1;
  byte bVar2;
  undefined1 uVar3;
  int3 extraout_var;
  int3 extraout_var_00;
  int3 extraout_var_01;
  int3 extraout_var_02;
  int iVar4;
  int3 extraout_var_04;
  int3 extraout_var_05;
  undefined4 *puVar5;
  int iVar6;
  int3 extraout_var_06;
  undefined4 *puVar7;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  undefined4 extraout_ECX_04;
  uint extraout_ECX_05;
  uint extraout_ECX_06;
  uint extraout_ECX_07;
  uint extraout_ECX_08;
  undefined4 extraout_ECX_09;
  undefined4 extraout_ECX_10;
  undefined4 uVar8;
  uint extraout_ECX_11;
  uint extraout_ECX_12;
  uint extraout_ECX_13;
  uint uVar9;
  uint extraout_ECX_14;
  undefined4 extraout_ECX_15;
  undefined4 extraout_ECX_16;
  undefined4 extraout_ECX_17;
  byte *pbVar10;
  uint extraout_ECX_18;
  int extraout_ECX_19;
  undefined4 extraout_ECX_20;
  undefined4 extraout_ECX_21;
  undefined4 *extraout_ECX_22;
  undefined4 *extraout_ECX_23;
  undefined2 uVar11;
  undefined2 extraout_DX;
  undefined2 extraout_DX_00;
  undefined2 extraout_DX_01;
  undefined2 extraout_DX_02;
  undefined2 extraout_DX_03;
  undefined2 extraout_DX_04;
  undefined2 extraout_DX_05;
  undefined2 extraout_DX_06;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint extraout_EDX_03;
  uint extraout_EDX_04;
  uint extraout_EDX_05;
  uint extraout_EDX_06;
  uint uVar12;
  uint extraout_EDX_07;
  undefined4 extraout_EDX_08;
  undefined4 *puVar13;
  void *pvVar14;
  byte *pbVar15;
  void *pvVar16;
  undefined1 *puVar17;
  uint uVar18;
  undefined8 uVar19;
  undefined6 uVar20;
  uint unaff_retaddr;
  undefined4 *in_stack_00008836;
  undefined4 *in_stack_0000883a;
  byte local_714 [1676];
  undefined1 local_88 [4];
  undefined1 local_84 [4];
  undefined4 *local_80;
  undefined1 local_78 [4];
  uint local_74;
  int local_70;
  undefined4 *local_6c;
  undefined4 *local_68;
  undefined4 *local_64;
  byte *local_60;
  byte *local_58;
  undefined1 *local_54;
  int local_50;
  byte *local_4c;
  undefined4 *local_48;
  int local_44;
  int local_40;
  undefined4 *local_3c;
  undefined4 *local_38;
  int local_34;
  char local_2d;
  void *local_2c;
  byte *local_28;
  byte local_21;
  undefined1 *local_20;
  short local_1c;
  int local_18;
  undefined1 local_11;
  short local_10 [3];
  byte local_9;
  uint local_8;
  int3 extraout_var_03;
  
  local_8 = DAT_00569f5c ^ unaff_retaddr;
  uVar20 = String_AllocateBuffer(param_1,param_2);
  iVar6 = (int)uVar20;
  pvVar14 = (void *)0x0;
  local_40 = iVar6;
  if (iVar6 == 0) {
LAB_004b8515:
    Exception_SetMessage((void *)(local_8 ^ unaff_retaddr),in_stack_00008836,in_stack_0000883a);
    return;
  }
  Memory_GetHeapInfo(extraout_ECX,(short)((uint6)uVar20 >> 0x20));
  uVar20 = Assembly_EmptyFunction();
  uVar11 = (undefined2)((uint6)uVar20 >> 0x20);
  uVar8 = extraout_ECX_00;
  if ((int)uVar20 != 0) {
    uVar20 = Assembly_EmptyFunction();
    uVar11 = (undefined2)((uint6)uVar20 >> 0x20);
    uVar8 = extraout_ECX_01;
    if ((int)uVar20 != 0) goto LAB_004b8515;
  }
  local_2c = (void *)0x0;
  local_28 = (byte *)0x0;
  Memory_GetHeapInfo(uVar8,uVar11);
  Memory_GetHeapInfo(local_88,extraout_DX);
  Memory_GetHeapInfo(extraout_ECX_02,(short)&local_9);
  Memory_GetHeapInfo(extraout_ECX_03,extraout_DX_00);
  Memory_GetHeapInfo((int)&param_3 + 3,extraout_DX_01);
  uVar12 = (uint)local_9;
  uVar18 = extraout_EDX;
  if ((char)local_9 < '\0') {
    pvVar14 = (void *)(1 << (local_9 & 7) + 1);
    local_2c = pvVar14;
    local_28 = (byte *)operator_new((int)pvVar14 * 3);
    if (local_28 == (byte *)0x0) goto LAB_004b884c;
    Memory_GetHeapInfo(extraout_ECX_04,(short)local_28);
    uVar12 = extraout_ECX_05;
    uVar18 = extraout_EDX_00;
  }
  local_74 = 0xffffffff;
  do {
    uVar19 = Memory_GetHeapInfo(uVar12,(short)uVar18);
    uVar18 = (uint)((ulonglong)uVar19 >> 0x20);
    if (((int)uVar19 == 0) || (param_3._3_1_ == ';')) {
      Memory_AllocateBlock(extraout_ECX_06,uVar18);
      goto LAB_004b884c;
    }
    uVar12 = extraout_ECX_06;
    pvVar16 = pvVar14;
    if (param_3._3_1_ == '!') {
      Memory_GetHeapInfo((int)&param_3 + 3,(short)((ulonglong)uVar19 >> 0x20));
      uVar12 = extraout_ECX_07;
      if (param_3._3_1_ == -7) {
        do {
          uVar3 = Texture_HasAlpha(uVar12,(short)local_714,iVar6,(short)local_714);
          uVar12 = extraout_ECX_18;
        } while (CONCAT31(extraout_var_05,uVar3) != 0 && -1 < extraout_var_05);
        uVar18 = extraout_EDX_07;
        pvVar16 = local_2c;
        if ((local_714[0] & 1) != 0) {
          local_74 = (uint)local_714[3];
          pvVar16 = pvVar14;
        }
      }
      else if (param_3._3_1_ == -2) {
        local_20 = (undefined1 *)0x0;
        uVar3 = Texture_HasAlpha(local_714,extraout_DX_02,iVar6,(short)local_714);
        iVar4 = CONCAT31(extraout_var_03,uVar3);
        uVar12 = extraout_ECX_13;
        uVar18 = extraout_EDX_04;
        pvVar16 = local_2c;
        if (iVar4 != 0 && -1 < extraout_var_03) {
          do {
            if (local_20 == (undefined1 *)0x0) {
              local_20 = (undefined1 *)operator_new(iVar4 + 1);
              uVar18 = extraout_EDX_05;
              if (local_20 != (undefined1 *)0x0) {
                *local_20 = 0;
              }
            }
            local_714[iVar4] = 0;
            pbVar10 = local_714;
            do {
              bVar2 = *pbVar10;
              uVar18 = CONCAT31((int3)(uVar18 >> 8),bVar2);
              pbVar10 = pbVar10 + 1;
            } while (bVar2 != 0);
            uVar12 = (int)pbVar10 - (int)local_714;
            pbVar10 = local_20 + -1;
            do {
              pbVar15 = pbVar10 + 1;
              pbVar10 = pbVar10 + 1;
            } while (*pbVar15 != 0);
            pbVar15 = local_714;
            for (uVar9 = uVar12 >> 2; uVar9 != 0; uVar9 = uVar9 - 1) {
              *(undefined4 *)pbVar10 = *(undefined4 *)pbVar15;
              pbVar15 = pbVar15 + 4;
              pbVar10 = pbVar10 + 4;
            }
            for (uVar12 = uVar12 & 3; uVar12 != 0; uVar12 = uVar12 - 1) {
              *pbVar10 = *pbVar15;
              pbVar15 = pbVar15 + 1;
              pbVar10 = pbVar10 + 1;
            }
            uVar3 = Texture_HasAlpha(0,(short)uVar18,iVar6,(short)local_714);
            iVar4 = CONCAT31(extraout_var_04,uVar3);
            uVar18 = extraout_EDX_06;
          } while (iVar4 != 0 && -1 < extraout_var_04);
          uVar12 = extraout_ECX_14;
          pvVar16 = local_2c;
          if (local_20 != (undefined1 *)0x0) {
                    /* WARNING: Subroutine does not return */
            System_ShutdownHandler((int)local_20,extraout_EDX_06);
          }
        }
      }
      else if (param_3._3_1_ == -1) {
        uVar3 = Texture_HasAlpha(extraout_ECX_07,extraout_DX_02,iVar6,(short)local_714);
        uVar8 = extraout_ECX_09;
        if (CONCAT31(extraout_var_00,uVar3) != 0 && -1 < extraout_var_00) {
          Assembly_EmptyFunction();
          uVar8 = extraout_ECX_10;
        }
        uVar3 = Texture_HasAlpha(uVar8,(short)local_714,iVar6,(short)local_714);
        uVar12 = extraout_ECX_11;
        uVar18 = extraout_EDX_02;
        pvVar16 = local_2c;
        if (CONCAT31(extraout_var_01,uVar3) != 0 && -1 < extraout_var_01) {
          do {
            uVar3 = Texture_HasAlpha(uVar12,(short)uVar18,iVar6,(short)local_714);
            uVar12 = extraout_ECX_12;
            uVar18 = extraout_EDX_03;
            pvVar16 = pvVar14;
          } while (CONCAT31(extraout_var_02,uVar3) != 0 && -1 < extraout_var_02);
        }
      }
      else {
        do {
          uVar3 = Texture_HasAlpha(uVar12,(short)local_714,iVar6,(short)local_714);
          uVar12 = extraout_ECX_08;
          uVar18 = extraout_EDX_01;
        } while (CONCAT31(extraout_var,uVar3) != 0 && -1 < extraout_var);
      }
    }
    pvVar14 = pvVar16;
  } while (param_3._3_1_ != ',');
  Memory_GetHeapInfo(local_78,(short)uVar18);
  Memory_GetHeapInfo(extraout_ECX_15,(short)local_84);
  Memory_GetHeapInfo(extraout_ECX_16,extraout_DX_03);
  Memory_GetHeapInfo(local_10,extraout_DX_04);
  Memory_GetHeapInfo(extraout_ECX_17,(short)&local_9);
  if ((char)local_9 < '\0') {
    pvVar16 = (void *)(1 << (local_9 & 7) + 1);
  }
  local_2c = operator_new((int)pvVar16 * 4);
  local_2d = (local_9 & 0x40) == 0x40;
  if ((local_1c != 0) && (local_10[0] != 0)) {
    if ((char)local_9 < '\0') {
      pbVar10 = (byte *)operator_new((int)pvVar16 * 3);
      local_4c = pbVar10;
      Memory_CompactHeap(extraout_ECX_19,extraout_EDX_08);
      Memory_GetHeapInfo(extraout_ECX_20,extraout_DX_05);
      uVar12 = 0;
      if (0 < (int)pvVar16) {
        do {
          bVar2 = *pbVar10;
          pbVar15 = pbVar10 + 1;
          pbVar1 = pbVar10 + 2;
          pbVar10 = pbVar10 + 3;
          *(uint *)((int)local_2c + uVar12 * 4) =
               ((bVar2 | 0xffffff00) << 8 | (uint)*pbVar15) << 8 | (uint)*pbVar1;
          uVar12 = uVar12 + 1;
        } while ((int)uVar12 < (int)pvVar16);
      }
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler((int)pbVar10,uVar12);
    }
    uVar12 = 0;
    pbVar10 = local_28;
    if (0 < (int)pvVar16) {
      do {
        bVar2 = *pbVar10;
        pbVar15 = pbVar10 + 1;
        pbVar1 = pbVar10 + 2;
        pbVar10 = pbVar10 + 3;
        *(uint *)((int)local_2c + uVar12 * 4) =
             ((bVar2 | 0xffffff00) << 8 | (uint)*pbVar15) << 8 | (uint)*pbVar1;
        uVar12 = uVar12 + 1;
      } while ((int)uVar12 < (int)pvVar16);
    }
    if (local_28 != (byte *)0x0) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler((int)pbVar10,uVar12);
    }
    local_60 = (byte *)operator_new(0x100);
    puVar5 = (undefined4 *)operator_new(0x2000);
    local_64 = puVar5;
    local_20 = (undefined1 *)operator_new(0x1000);
    local_54 = (undefined1 *)operator_new(0x1001);
    Memory_GetHeapInfo(extraout_ECX_21,(short)local_40);
    puVar17 = local_54;
    local_68 = (undefined4 *)(1 << (local_21 & 0x1f));
    local_3c = (undefined4 *)(local_21 + 1);
    iVar6 = 0;
    uVar12 = (int)local_68 + 2;
    uVar18 = (1 << ((byte)local_3c & 0x1f)) - 1;
    local_38 = (undefined4 *)0xffffffff;
    if (0 < (int)local_68) {
      do {
        *(undefined2 *)((int)puVar5 + iVar6 * 2) = 0;
        *(char *)(iVar6 + (int)local_20) = (char)iVar6;
        iVar6 = iVar6 + 1;
      } while (iVar6 < (int)local_68);
    }
    local_48 = (undefined4 *)0x0;
    local_34 = 0;
    param_3 = param_3 & 0xffffff;
    local_44 = 0;
    local_11 = 0;
    local_18 = 0;
    local_28 = (byte *)0x0;
    local_4c = (byte *)operator_new((int)local_10[0] * (int)local_1c * 4);
    local_58 = (byte *)0x0;
    local_70 = 0;
    puVar5 = extraout_ECX_22;
    if (0 < local_10[0]) {
      do {
        local_6c = (undefined4 *)((int)local_4c + local_1c * local_18 * 4);
        local_50 = 0;
        puVar5 = local_6c;
        if (0 < local_1c) {
          do {
            if (puVar17 == local_54) {
              if (local_34 < (int)local_3c) {
                if (local_44 == 0) {
                  Memory_CompactHeap((int)local_3c,local_40);
                  uVar3 = Texture_HasAlpha(local_40,extraout_DX_06,local_40,(short)local_60);
                  local_44 = CONCAT31(extraout_var_06,uVar3);
                  puVar5 = extraout_ECX_23;
                  if (local_44 == 0 || extraout_var_06 < 0) break;
                  local_58 = local_60;
                }
                puVar5 = (undefined4 *)
                         ((int)local_48 + ((uint)*local_58 << ((byte)local_34 & 0x1f)));
                local_34 = local_34 + 8;
                local_58 = local_58 + 1;
                local_44 = local_44 + -1;
                local_48 = puVar5;
              }
              else {
                puVar13 = (undefined4 *)((uint)local_48 >> ((byte)local_3c & 0x1f));
                puVar7 = (undefined4 *)((uint)local_48 & uVar18);
                local_34 = local_34 - (int)local_3c;
                puVar5 = local_3c;
                local_48 = puVar13;
                if (((int)uVar12 < (int)puVar7) ||
                   (puVar5 = (undefined4 *)((int)local_68 + 1), puVar7 == puVar5)) break;
                if (puVar7 == local_68) {
                  puVar5 = (undefined4 *)(local_21 + 1);
                  uVar12 = (int)local_68 + 2;
                  local_38 = (undefined4 *)0xffffffff;
                  uVar18 = (1 << ((byte)puVar5 & 0x1f)) - 1;
                  local_3c = puVar5;
                }
                else {
                  if (local_38 != (undefined4 *)0xffffffff) {
                    puVar13 = puVar7;
                    if ((int)uVar12 <= (int)puVar7) {
                      *puVar17 = local_11;
                      puVar17 = puVar17 + 1;
                      puVar13 = local_38;
                    }
                    for (; (int)local_68 <= (int)puVar13;
                        puVar13 = (undefined4 *)(int)*(short *)((int)local_64 + (int)puVar13 * 2)) {
                      *puVar17 = *(undefined1 *)((int)puVar13 + (int)local_20);
                      puVar17 = puVar17 + 1;
                      puVar5 = local_64;
                    }
                    local_11 = *(undefined1 *)((int)puVar13 + (int)local_20);
                    local_80 = puVar7;
                    if ((int)uVar12 < 0x1000) {
                      *puVar17 = local_11;
                      *(undefined2 *)((int)local_64 + uVar12 * 2) = local_38._0_2_;
                      puVar17 = puVar17 + 1;
                      *(undefined1 *)(uVar12 + (int)local_20) = local_11;
                      uVar12 = uVar12 + 1;
                      local_38 = puVar7;
                      if (((uVar12 & uVar18) == 0) && ((int)uVar12 < 0x1000)) {
                        local_3c = (undefined4 *)((int)local_3c + 1);
                        uVar18 = uVar18 + uVar12;
                      }
                      goto LAB_004b8b11;
                    }
                    break;
                  }
                  puVar5 = (undefined4 *)
                           CONCAT31((int3)((uint)puVar5 >> 8),
                                    *(undefined1 *)((int)puVar7 + (int)local_20));
                  *puVar17 = *(undefined1 *)((int)puVar7 + (int)local_20);
                  puVar17 = puVar17 + 1;
                  local_11 = SUB41(puVar7,0);
                  local_38 = puVar7;
                }
              }
            }
            else {
LAB_004b8b11:
              bVar2 = puVar17[-1];
              puVar17 = puVar17 + -1;
              *local_6c = *(undefined4 *)((int)local_2c + (uint)bVar2 * 4);
              if (bVar2 == local_74) {
                *local_6c = 0;
              }
              local_50 = local_50 + 1;
              puVar5 = local_6c + 1;
              local_6c = puVar5;
            }
          } while (local_50 < local_1c);
        }
        if (local_2d == '\0') {
          local_18 = local_18 + 1;
        }
        else if (local_28 == (byte *)0x1) {
          puVar5 = (undefined4 *)(int)local_10[0];
          local_18 = local_18 + 8;
          if ((int)puVar5 <= local_18) {
            local_18 = 2;
            local_28 = (byte *)0x2;
          }
        }
        else if (local_28 == (byte *)0x2) {
          local_18 = local_18 + 4;
          if (local_10[0] <= local_18) {
            local_28 = (byte *)0x3;
            local_18 = 1;
          }
        }
        else if (local_28 == (byte *)0x3) {
          local_18 = local_18 + 2;
        }
        else {
          puVar5 = (undefined4 *)(int)local_10[0];
          local_18 = local_18 + 8;
          if ((int)puVar5 <= local_18) {
            local_28 = (byte *)((int)local_28 + 1);
            local_18 = 4;
          }
        }
        if (local_50 < local_1c) break;
        puVar5 = (undefined4 *)(int)local_10[0];
        local_70 = local_70 + 1;
      } while (local_70 < (int)puVar5);
    }
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler((int)puVar5,(uint)local_54);
  }
LAB_004b884c:
  Exception_SetMessage((void *)(local_8 ^ unaff_retaddr),in_stack_00008836,in_stack_0000883a);
  return;
}


