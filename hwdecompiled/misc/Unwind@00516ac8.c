/*
 * Function: Unwind@00516ac8
 * Address: 00516ac8
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x00516ba7) overlaps instruction at (ram,0x00516ba5)
    */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: This function may have set the stack pointer */
/* WARNING: Removing unreachable block (ram,0x00516bad) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall Unwind_00516ac8(int param_1,undefined4 param_2)

{
  byte *pbVar1;
  uint *puVar2;
  uint uVar3;
  code *pcVar4;
  byte bVar5;
  byte bVar6;
  undefined1 uVar7;
  byte bVar8;
  short sVar9;
  int iVar10;
  int *piVar12;
  undefined4 uVar13;
  uint uVar14;
  byte extraout_CL;
  char cVar15;
  undefined4 extraout_EDX;
  int iVar17;
  undefined4 extraout_EDX_00;
  int unaff_EBX;
  undefined1 *puVar18;
  undefined2 *puVar19;
  undefined4 *puVar20;
  int *unaff_ESI;
  int unaff_EDI;
  undefined2 in_CS;
  byte in_AF;
  char cVar21;
  undefined1 in_XMM0 [16];
  undefined8 uVar22;
  undefined2 unaff_retaddr;
  int iVar11;
  undefined2 uVar16;
  
  *(int *)(param_1 + 0x6c) = *(int *)(param_1 + 0x6c) + unaff_EDI;
  cVar15 = (char)param_2;
  uVar16 = CONCAT11(0x94,cVar15);
  iVar17 = CONCAT22((short)((uint)param_2 >> 0x10),uVar16);
  iVar10 = in(0x21);
  bVar5 = (byte)param_1;
  iVar11 = CONCAT31((int3)(CONCAT22((short)((uint)param_1 >> 0x10),CONCAT11(bVar5 / 0xe0,bVar5)) >>
                          8),bVar5 % 0xe0);
  piVar12 = (int *)(iVar11 + -1);
  uVar13 = in(uVar16);
  *(undefined1 *)(iVar17 + -0x33) = 0x8e;
  bVar5 = 9 < (DAT_014e0da7 & 0xf) | in_AF;
  bVar6 = DAT_014e0da7 + bVar5 * -6;
  *piVar12 = *piVar12 + 1;
  if (iVar10 != 1 &&
      CONCAT31((int3)((uint)uVar13 >> 8),
               bVar6 + (0x9f < bVar6 | piVar12 < (int *)0xc242aaf3 | bVar5 * (bVar6 < 6)) * -0x60)
      == 1) {
    *unaff_ESI = *unaff_ESI + CONCAT31((int3)((uint)iVar17 >> 8),cVar15 << 7) +
                 (uint)((char)(cVar15 << 6) < '\0');
    *piVar12 = *unaff_ESI;
    in(0xa8);
    in(0xa7);
    pcVar4 = (code *)swi(1);
    (*pcVar4)(piVar12);
    return;
  }
  iVar10 = in(uVar16);
  *piVar12 = iVar10;
  pbVar1 = (byte *)(unaff_EBX + 0x29);
  bVar6 = *pbVar1;
  *pbVar1 = *pbVar1 << 1 | (char)bVar6 < '\0';
  if ((char)bVar6 < '\0') {
    puVar18 = &DAT_28e4eeac;
    _DAT_28e4eeac = 0x516b62;
    _DAT_28e4eeb0 = in_CS;
    sVar9 = func_0xf2d46d46();
    uVar7 = in((short)extraout_EDX);
    iVar10 = CONCAT31(0xffffbb,uVar7);
    iVar11 = CONCAT31((int3)((uint)extraout_EDX >> 8),(byte)extraout_EDX | *(byte *)(iVar11 + 4));
    puVar2 = (uint *)(sVar9 + -0x28 + iVar10 * 2);
    uVar3 = *puVar2;
    cVar21 = SCARRY4(*puVar2,(int)(puVar18 + -1));
    *puVar2 = (uint)(puVar18 + (*puVar2 - 1));
    iVar17 = iVar11 << 3;
    bVar6 = iVar11 << 2 < 0;
    cVar15 = iVar17 < 0;
    uVar7 = iVar17 == 0;
    puVar19 = (undefined2 *)(puVar18 + -5);
    *(undefined4 *)(puVar18 + -5) = 0x516b93;
    uVar22 = func_0xf01a9c10();
    uVar13 = (undefined4)((ulonglong)uVar22 >> 0x20);
    if (cVar21 == cVar15) {
      cVar15 = (char)uVar22 + 's';
      cVar21 = SCARRY1((char)uVar22,'s') != SCARRY1(cVar15,bVar6);
      bVar8 = cVar15 + bVar6;
      bVar6 = 9 < (bVar8 & 0xf) | bVar5;
      uVar14 = CONCAT31((int3)((ulonglong)uVar22 >> 8),bVar8 + bVar6 * -6) & 0xffffff0f;
      bVar5 = (byte)uVar14;
      out((short)((ulonglong)uVar22 >> 0x20),
          CONCAT22((short)(uVar14 >> 0x10),CONCAT11((char)((ulonglong)uVar22 >> 8) - bVar6,bVar5)));
      puVar20 = (undefined4 *)((int)puVar19 + -4);
      puVar19 = (undefined2 *)((int)puVar19 + -4);
      *puVar20 = uVar13;
      uVar7 = bVar5 % 0x90 == 0;
    }
    pcVar4 = (code *)swi(4);
    if (cVar21 == '\x01') {
      (*pcVar4)();
      uVar13 = extraout_EDX_00;
    }
    if (!(bool)bVar6 && !(bool)uVar7) {
      minps(in_XMM0,*(undefined1 (*) [16])
                     ((iVar10 << (extraout_CL & 0x1f) |
                      (uint)(CONCAT14(CARRY4(uVar3,(uint)(puVar18 + -1)),iVar10) >>
                            0x21 - (extraout_CL & 0x1f))) + 0x71176dd9));
      *puVar19 = unaff_retaddr;
      _DAT_3d5b66e4 = in((short)uVar13);
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    uRam1eadb372 = in((short)uVar13);
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}


