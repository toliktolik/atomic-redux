/*
 * Function: Assembly_LoopingConstruct
 * Address: 004feea8
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x004fef66) overlaps instruction at (ram,0x004fef64)
    */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall Assembly_LoopingConstruct(undefined4 *param_1,undefined4 param_2)

{
  byte *pbVar1;
  uint uVar2;
  code *pcVar3;
  byte bVar4;
  byte bVar5;
  char cVar6;
  ushort uVar7;
  uint uVar8;
  undefined4 uVar10;
  undefined4 *puVar11;
  undefined4 *extraout_ECX;
  int iVar12;
  int extraout_ECX_00;
  undefined2 uVar13;
  int extraout_EDX;
  byte bVar15;
  undefined4 **unaff_EBX;
  uint unaff_EBP;
  undefined4 *unaff_ESI;
  undefined4 *puVar16;
  undefined1 *puVar17;
  uint *unaff_EDI;
  uint *puVar18;
  undefined2 in_CS;
  undefined2 in_SS;
  undefined2 in_DS;
  undefined1 in_CF;
  bool bVar19;
  byte in_AF;
  undefined1 uVar20;
  undefined8 uVar21;
  int iStackY_81;
  undefined4 *puStack_4;
  undefined4 *puVar9;
  int iVar14;
  
  while( true ) {
    bVar4 = in((short)param_2);
    puVar18 = unaff_EDI;
    while (param_1 = (undefined4 *)((int)param_1 + 1), (bool)in_CF || param_1 == (undefined4 *)0x0)
    {
      puVar18 = (uint *)0xec9a76ce;
    }
    puStack_4 = param_1;
    bVar4 = 9 < ((bVar4 | 199) & 0xf) | in_AF;
    *(undefined4 *)((int)unaff_EBX + -4) = 0xb1cf728f;
    uVar13 = CONCAT11(0x69,(char)param_2);
    iVar14 = CONCAT22((short)((uint)param_2 >> 0x10),uVar13);
    uRamcdacfef4 = in(uVar13);
    if (param_1 != (undefined4 *)0x0) {
      pcVar3 = (code *)swi(1);
      (*pcVar3)();
      return;
    }
    unaff_EDI = (uint *)((int)puVar18 + 2);
    cVar6 = '\f' - *(byte *)((int)puVar18 + 1);
    in_AF = bVar4 | 1;
    uVar8 = CONCAT31(0xe3ca00,in_AF * '\x06' + '\f') & 0xffffff0f;
    uVar7 = CONCAT11(((cVar6 < '\0') << 7 | (cVar6 == '\0') << 6 | bVar4 << 4 |
                      ((POPCOUNT(cVar6) & 1U) == 0) << 2 | 2 | 0xc < *(byte *)((int)puVar18 + 1)) +
                     in_AF,(char)uVar8);
    puVar11 = (undefined4 *)CONCAT22((short)(uVar8 >> 0x10),uVar7);
    if (cVar6 >= '\0') break;
    unaff_ESI = (undefined4 *)((int)unaff_ESI + -1);
    pbVar1 = (byte *)((int)puVar18 + 0x81);
    bVar4 = *pbVar1;
    bVar15 = (byte)((uint)&puStack_4 >> 8);
    *pbVar1 = *pbVar1 + bVar15;
    uVar10 = in(0x9d);
    uVar21 = CONCAT44(iVar14,uVar10);
    bVar5 = (byte)uVar10;
    iVar12 = 0;
    if (!CARRY1(bVar4,bVar15) && *pbVar1 != 0) {
      while (iVar12 != 0) {
        iVar12 = iVar12 + -1;
        uVar8 = in(uVar13);
        *unaff_EDI = uVar8;
        unaff_EDI = unaff_EDI + 1;
      }
      pcVar3 = (code *)swi(1);
      bRam1d3bbc2e = bVar5;
      puStack_4 = unaff_ESI;
      (*pcVar3)(&puStack_4,&puStack_4,iVar14,0,CONCAT31((int3)((uint)uVar10 >> 8),bVar5 + 0xb7));
      return;
    }
    in_CF = bVar5 < 0xbf;
    uVar20 = bVar5 == 0xbf;
    pcVar3 = (code *)swi(4);
    if (SBORROW1(bVar5,-0x41)) {
      uVar21 = (*pcVar3)();
      param_1 = extraout_ECX;
    }
    param_2 = (undefined4)((ulonglong)uVar21 >> 0x20);
    unaff_EBX = &puStack_4;
    if ((bool)in_CF || (bool)uVar20) {
      bVar4 = 9 < ((byte)uVar21 & 0xf) | in_AF;
      uVar8 = CONCAT31((int3)((ulonglong)uVar21 >> 8),(byte)uVar21 + bVar4 * '\x06') & 0xffffff0f;
      out((short)((ulonglong)uVar21 >> 0x20),
          CONCAT22((short)(uVar8 >> 0x10),
                   CONCAT11((char)((ulonglong)uVar21 >> 8) + bVar4,(char)uVar8)));
      pcVar3 = (code *)swi(1);
      puStack_4 = &puStack_4;
      (*pcVar3)();
      return;
    }
  }
  if (cVar6 != '\0') {
    *(int *)((int)unaff_ESI + -0x5e) = *(int *)((int)unaff_ESI + -0x5e) - (uint)in_AF;
    bVar19 = *(char *)CONCAT31((int3)((uint)&puStack_4 >> 8),(char)&puStack_4 + -0x36) != '\0';
    puVar16 = unaff_ESI;
    goto LAB_004fef64_2;
  }
  *(undefined2 *)((int)puVar18 + -0x5b95b056) = *(undefined2 *)((int)puVar18 + -0x5b95b056);
  puVar18 = (uint *)(CONCAT31((int3)((uint)puVar11 >> 8),
                              *(undefined1 *)((int)&puStack_4 + (uVar7 & 0xff))) + 0x25623088);
  *puVar18 = *puVar18 ^ (uint)&stack0x00000000;
  puVar16 = (undefined4 *)((int)unaff_ESI + 1);
  uVar20 = *(undefined1 *)unaff_ESI;
  uVar8 = (uint)uRam4f44f13f >> 8;
  *(byte *)(unaff_ESI + 7) = *(byte *)(unaff_ESI + 7) | (byte)unaff_EDI;
  puStack_4 = (undefined4 *)CONCAT22(puStack_4._2_2_,in_SS);
  *(char *)unaff_EDI = *(char *)unaff_EDI + -0x4e;
  DAT_3acac382 = 0;
  unaff_ESI = (undefined4 *)((int)&puStack_4 - iStackY_81);
  unaff_EBP = 0;
  DAT_1b77f437 = (undefined1)in_SS;
  puVar11 = puStack_4;
  unaff_EDI = (uint *)CONCAT31((int3)uVar8,uVar20);
code_r0x004fef6f:
  cVar6 = -(*(uint *)((uint)puVar16 | *(uint *)((int)unaff_ESI + 0x12)) < *unaff_EDI);
  puVar9 = (undefined4 *)CONCAT31((int3)((uint)iVar14 >> 8),cVar6);
  puVar18 = unaff_EDI + 2;
  uVar8 = in((short)puVar11);
  unaff_EDI[1] = uVar8;
  out(0x42,cVar6);
  do {
    puStack_4 = (undefined4 *)CONCAT22(puStack_4._2_2_,in_CS);
    in_CS = 0x98c9;
    uVar13 = 0x4f;
    uVar10 = func_0x7153a95c();
    unaff_ESI = (undefined4 *)0x0;
    unaff_EBP = unaff_EBP ^ *(uint *)((int)puVar9 + 0x3d);
    puVar16 = (undefined4 *)((int)puVar9 + 1);
    out(*(undefined1 *)puVar9,(short)((int)uVar10 >> 0x1f));
    puVar18 = (uint *)((int)puVar18 + (-1 - _DAT_00000000));
    out(0x2c,(char)uVar10);
    uVar21 = func_0x0956cc26(CONCAT22(uVar13,in_DS));
    iVar14 = (int)((ulonglong)uVar21 >> 0x20);
    bVar19 = false;
    bVar4 = (byte)uVar21 & 0xf9;
    puVar11 = (undefined4 *)((uint)uVar21 & 0xfffffff9);
    if (-1 < (char)bVar4) {
      do {
                    /* WARNING: Do nothing block with infinite loop */
      } while( true );
    }
    unaff_EDI = puVar18;
    if ((POPCOUNT((int)puStack_4 + 1U & 0xff) & 1U) == 0) {
      out((short)((ulonglong)uVar21 >> 0x20),bVar4);
      cVar6 = (char)((uint)puVar11 >> 8) == *(char *)(unaff_EBP + 0x8741e2a9);
      in_AF = 9 < ((byte)puVar11 & 0xf) | in_AF;
      bVar4 = in_AF == 0;
      pcVar3 = (code *)((int)puStack_4 + 0x1f);
      puStack_4 = (undefined4 *)CONCAT22(puStack_4._2_2_,in_CS);
      (*pcVar3)();
      iVar14 = extraout_EDX;
      if (extraout_ECX_00 == 1 || cVar6 == '\0') {
        puVar17 = (undefined1 *)
                  CONCAT22((short)((uint)puVar16 >> 0x10),
                           (ushort)puVar16 +
                           (ushort)bVar4 * (((ushort)puVar18 & 3) - ((ushort)puVar16 & 3)));
        pbVar1 = (byte *)(extraout_EDX + -0x49);
        bVar4 = *pbVar1;
        *pbVar1 = *pbVar1 - (byte)extraout_EDX;
        out(0x45,0x71);
        *(int *)((int)puVar18 + -0x26) =
             (*(int *)((int)puVar18 + -0x26) + 0xd) - (uint)(bVar4 < (byte)extraout_EDX);
        uVar8 = in((short)extraout_EDX);
        *puVar18 = uVar8;
        puVar18 = (uint *)((int)puVar18 + 0x30e148ba);
        *puVar18 = *puVar18 >> 7 | *puVar18 << 0x19;
        out(*puVar17,(short)extraout_EDX);
        iRam4d77002d = iRam4d77002d - (int)&stack0x00000004;
        puStack_4 = (undefined4 *)0x4ff013;
        (*(code *)0xc8f29a6a)();
        *(undefined1 *)(extraout_EDX + 4) = puVar17[6];
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      }
    }
    else {
LAB_004fef64_2:
      puVar18 = (uint *)((int)puVar11 + 0x37a2955d);
      uVar8 = *puVar18;
      uVar2 = *puVar18;
      *puVar18 = (uVar2 + 0xc) - (uint)bVar19;
      if ((uVar8 < 0xfffffff4 || uVar2 + 0xc < (uint)bVar19) || *puVar18 == 0)
      goto code_r0x004fef6f;
      puVar16 = (undefined4 *)((int)puVar16 + 1);
      puVar18 = (uint *)((int)unaff_EDI + 1);
      cVar6 = in((short)iVar14);
      *(char *)unaff_EDI = cVar6;
    }
    puVar9 = puVar16 + 1;
    out(*puVar16,(short)iVar14);
    puStack_4 = (undefined4 *)0x4fef9d;
    func_0x1ad52633();
  } while( true );
}


