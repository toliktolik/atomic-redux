/*
 * Function: ImageDecoder_HandleTransparency
 * Address: 004cdc80
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __fastcall
ImageDecoder_HandleTransparency
          (byte *param_1,byte *param_2,byte *param_3,byte *param_4,int param_5,uint param_6,
          int param_7)

{
  void *this;
  char *pcVar1;
  undefined4 *in_stack_fffffff0;
  undefined4 *in_stack_fffffff4;
  
  this = DAT_00569f5c;
  if (param_7 == 3) {
    if ((0 < (int)param_6) &&
       (param_2 = (byte *)(uint)*(ushort *)(param_3 + 0x118), (int)param_6 <= (int)param_2)) {
      ImageDecoder_ProcessHeader((uint)param_3,(byte *)&DAT_00567d54,param_4,param_6);
      Exception_SetMessage(this,in_stack_fffffff0,in_stack_fffffff4);
      return;
    }
    pcVar1 = "Invalid number of transparent colors specified";
    param_1 = param_3;
  }
  else {
    if (param_7 == 0) {
      Renderer_ClearBuffers(&stack0xfffffff0,(uint)*(ushort *)(param_5 + 8));
      ImageDecoder_ProcessHeader((uint)param_3,(byte *)&DAT_00567d54,&stack0xfffffff0,2);
      Exception_SetMessage(this,in_stack_fffffff0,in_stack_fffffff4);
      return;
    }
    if (param_7 == 2) {
      Renderer_ClearBuffers(&stack0xfffffff0,(uint)*(ushort *)(param_5 + 2));
      Renderer_ClearBuffers(&stack0xfffffff2,(uint)*(ushort *)(param_5 + 4));
      Renderer_ClearBuffers(&stack0xfffffff4,(uint)*(ushort *)(param_5 + 6));
      ImageDecoder_ProcessHeader((uint)param_3,(byte *)&DAT_00567d54,&stack0xfffffff0,6);
      Exception_SetMessage(this,in_stack_fffffff0,in_stack_fffffff4);
      return;
    }
    pcVar1 = "Can\'t write tRNS with an alpha channel";
    param_2 = param_3;
  }
  CPU_Instruction21(param_1,param_2,(uint)param_3,pcVar1);
  Exception_SetMessage(this,in_stack_fffffff0,in_stack_fffffff4);
  return;
}


