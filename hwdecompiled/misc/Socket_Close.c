/*
 * Function: Socket_Close
 * Address: 004e1df0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl Socket_Close(int param_1,int param_2,int *param_3,byte *param_4)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  short *psVar10;
  int iVar11;
  void *this;
  int iVar12;
  int iVar13;
  uint uVar14;
  int iVar15;
  uint uVar16;
  int iVar17;
  int iVar18;
  uint uVar19;
  int iVar20;
  byte *local_4c;
  int local_38;
  int local_34;
  int local_30;
  int local_2c;
  int *local_28;
  int local_24;
  int local_20;
  int local_1c;
  undefined1 *local_14;
  int local_10;
  
  iVar1 = *(int *)(param_1 + 0x5c);
  iVar2 = *(int *)(param_1 + 0x1a8);
  iVar3 = *(int *)(iVar2 + 0x18);
  iVar4 = *(int *)(param_1 + 0x120);
  piVar5 = *(int **)(param_1 + 0x74);
  iVar6 = *piVar5;
  iVar7 = piVar5[1];
  iVar8 = piVar5[2];
  iVar9 = *(int *)(iVar2 + 0x28);
  if (0 < (int)param_4) {
    local_28 = param_3;
    local_4c = param_4;
    do {
      param_4 = *(byte **)((param_2 - (int)param_3) + (int)local_28);
      local_14 = (undefined1 *)*local_28;
      if (*(char *)(iVar2 + 0x24) == '\0') {
        psVar10 = *(short **)(iVar2 + 0x20);
        local_38 = 1;
        local_10 = 3;
        *(undefined1 *)(iVar2 + 0x24) = 1;
      }
      else {
        param_4 = param_4 + iVar1 * 3 + -3;
        local_14 = local_14 + iVar1 + -1;
        psVar10 = (short *)(*(int *)(iVar2 + 0x20) + (iVar1 * 3 + 3) * 2);
        local_38 = -1;
        local_10 = -3;
        *(undefined1 *)(iVar2 + 0x24) = 0;
      }
      iVar15 = 0;
      iVar18 = 0;
      iVar13 = 0;
      local_34 = 0;
      local_30 = 0;
      local_2c = 0;
      local_24 = 0;
      local_24._0_2_ = 0;
      local_20 = 0;
      local_20._0_2_ = 0;
      local_1c = 0;
      local_1c._0_2_ = 0;
      for (iVar11 = iVar1; iVar11 != 0; iVar11 = iVar11 + -1) {
        uVar16 = (uint)*(byte *)(*(int *)(iVar9 + (psVar10[local_10] + 8 + iVar15 >> 4) * 4) +
                                 (uint)*param_4 + iVar4);
        uVar19 = (uint)*(byte *)(*(int *)(iVar9 + (psVar10[local_10 + 1] + 8 + iVar18 >> 4) * 4) +
                                 (uint)param_4[1] + iVar4);
        uVar14 = (uint)*(byte *)(*(int *)(iVar9 + (psVar10[local_10 + 2] + 8 + iVar13 >> 4) * 4) +
                                 (uint)param_4[2] + iVar4);
        this = (void *)((int)uVar19 >> 2);
        iVar12 = (int)uVar14 >> 3;
        iVar13 = (int)this * 0x20 + iVar12;
        iVar18 = (int)uVar16 >> 3;
        iVar15 = *(int *)(iVar3 + iVar18 * 4);
        if (*(short *)(iVar15 + iVar13 * 2) == 0) {
          HTTP_CloseConnection(this,param_1,iVar18,iVar12);
        }
        iVar15 = *(ushort *)(iVar15 + iVar13 * 2) - 1;
        *local_14 = (char)iVar15;
        iVar17 = uVar16 - *(byte *)(iVar15 + iVar6);
        iVar12 = uVar14 - *(byte *)(iVar15 + iVar8);
        iVar20 = uVar19 - *(byte *)(iVar15 + iVar7);
        *psVar10 = (short)iVar17 * 3 + (short)local_1c;
        local_1c = local_2c + iVar17 * 5;
        iVar15 = iVar17 * 7;
        psVar10[1] = (short)local_20 + (short)iVar20 * 3;
        local_20 = local_30 + iVar20 * 5;
        iVar18 = iVar20 * 7;
        psVar10[2] = (short)local_24 + (short)iVar12 * 3;
        local_24 = local_34 + iVar12 * 5;
        iVar13 = iVar12 * 7;
        param_4 = param_4 + local_10;
        psVar10 = psVar10 + local_10;
        local_14 = local_14 + local_38;
        local_34 = iVar12;
        local_30 = iVar20;
        local_2c = iVar17;
      }
      *psVar10 = (short)local_1c;
      psVar10[1] = (short)local_20;
      psVar10[2] = (short)local_24;
      local_28 = local_28 + 1;
      local_4c = local_4c + -1;
    } while (local_4c != (byte *)0x0);
  }
  return;
}


