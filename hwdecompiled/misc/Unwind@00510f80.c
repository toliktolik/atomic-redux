/*
 * Function: Unwind@00510f80
 * Address: 00510f80
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Instruction at (ram,0x00510f84) overlaps instruction at (ram,0x00510f83)
    */
/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Removing unreachable block (ram,0x005112ea) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

longlong * __fastcall Unwind_00510f80(int param_1,int param_2,undefined4 *param_3)

{
  char *pcVar1;
  longlong *plVar2;
  uint uVar3;
  code *pcVar4;
  byte bVar5;
  ushort uVar6;
  undefined4 in_EAX;
  undefined3 uVar12;
  uint uVar7;
  longlong *plVar8;
  undefined4 *puVar9;
  undefined4 uVar10;
  short sVar13;
  uint uVar11;
  char cVar14;
  uint *puVar15;
  int iVar16;
  int extraout_ECX;
  undefined1 *extraout_ECX_00;
  undefined2 uVar17;
  int extraout_EDX;
  uint *unaff_EBX;
  int iVar18;
  byte *pbVar19;
  undefined4 **ppuVar20;
  int unaff_EBP;
  undefined4 *unaff_ESI;
  uint *puVar21;
  undefined1 *puVar22;
  int *piVar23;
  int *piVar24;
  uint *puVar25;
  undefined4 *puVar26;
  undefined2 in_CS;
  undefined2 in_SS;
  byte bVar27;
  byte in_AF;
  bool bVar28;
  bool bVar29;
  byte bVar30;
  undefined2 in_FPUControlWord;
  undefined2 in_FPUStatusWord;
  undefined2 in_FPUTagWord;
  undefined2 in_FPULastInstructionOpcode;
  undefined4 in_FPUDataPointer;
  undefined4 in_FPUInstructionPointer;
  float10 in_ST0;
  undefined8 uVar31;
  uint *unaff_retaddr;
  uint auStack_34 [7];
  undefined1 auStack_18 [4];
  int aiStack_14 [3];
  undefined4 *puStack_8;
  
  bVar30 = 0;
  bVar27 = (byte)in_EAX;
  bVar5 = bVar27 + 0x1d;
  plVar8 = (longlong *)
           CONCAT31((int3)((uint)in_EAX >> 8),*(undefined1 *)((int)unaff_EBX + (uint)bVar5));
  if (bVar5 != 0) {
    *(longlong **)((int)plVar8 + 0x4fef7b84) = plVar8;
    return plVar8;
  }
  piVar23 = (int *)0xb5df0e68;
  if (param_1 != 0) {
    *(char *)(unaff_EBP + -0x66bbcf8b) =
         *(char *)(unaff_EBP + -0x66bbcf8b) + (byte)unaff_EBX + (bVar27 < 0xe3);
    *plVar8 = (longlong)in_ST0;
    out((short)param_2,(char)uRam74d7e32c + (char)((uint)uRam74d7e32c >> 8) * -0x59 & 0x8f);
    return (longlong *)0xb0918183;
  }
  puVar25 = unaff_ESI + 1;
  out(*unaff_ESI,(short)param_2);
  puVar15 = (uint *)0x0;
  iVar16 = unaff_EBP;
  puVar21 = puVar25;
  if (bVar5 == 0 || (char)bVar27 < -0x1d) {
    uVar7 = 0;
    if (!SBORROW1(bVar27,-0x1d)) {
      pcVar4 = (code *)swi(1);
      plVar8 = (longlong *)(*pcVar4)();
      return plVar8;
    }
  }
  else {
    while( true ) {
      uVar12 = (undefined3)((uint)plVar8 >> 8);
      unaff_EBP = CONCAT22((short)((uint)iVar16 >> 0x10),(short)CONCAT31(uVar12,(char)*puVar21));
      bVar5 = 9 < ((byte)iVar16 & 0xf) | in_AF;
      uVar7 = CONCAT31(uVar12,(byte)iVar16 + bVar5 * '\x06') & 0xffff000f;
      uVar7 = CONCAT22((short)(uVar7 >> 0x10),
                       CONCAT11((char)((uint)iVar16 >> 8) + bVar5,(char)uVar7)) ^ 0x9d7255ef;
      param_2 = param_2 - unaff_EBX[-0xe4e16e1];
      uVar6 = (short)(char)uVar7 * (short)*(char *)(uVar7 + 0x70087d84);
      puVar21 = (uint *)((int)puVar21 + (1 - *(int *)((int)unaff_EBX + 0x2fd7f182)));
      in_AF = (uVar6 & 0x1000) != 0;
      plVar8 = (longlong *)in((short)param_2);
      in_CS = *(undefined2 *)((int)puVar15 + 0x5f);
      puVar25 = unaff_EBX;
      if ((uVar6 & 0x8000) != 0) {
        do {
          piVar24 = piVar23;
          if (puVar15 == (uint *)0x0) goto code_r0x0051102d;
          puVar15 = (uint *)((int)puVar15 + -1);
          piVar24 = piVar23 + 1;
          plVar2 = (longlong *)*piVar23;
          piVar23 = piVar24;
          if (plVar8 == plVar2) goto code_r0x0051102d;
        } while( true );
      }
      bVar28 = (byte)((byte)unaff_EBX[-0xaaade85] & (byte)unaff_EBX) == 0;
      if (puVar15 == (uint *)0x1 || bVar28) break;
      puVar15 = (uint *)((int)puVar15 + -2);
      iVar16 = unaff_EBP;
      if (puVar15 == (uint *)0x0 || !bVar28) {
        pbVar19 = (byte *)((int)plVar8 + -1);
        *pbVar19 = *pbVar19 | 0x41;
        out(*puVar21,(short)param_2);
        iVar16 = CONCAT22((short)((uint)puVar15 >> 0x10),CONCAT11(0xa1,(char)puVar15));
        if (iVar16 == 1 || ((uint)pbVar19 & 0xb5df0e68) == 0) {
          LOCK();
          *(uint *)(unaff_EBP + 0x49) = _DAT_ade3a7f2 | 0x44;
          UNLOCK();
          *(undefined2 *)(iVar16 + -0x45) = in_FPUControlWord;
          *(undefined2 *)(iVar16 + -0x41) = in_FPUStatusWord;
          *(undefined2 *)(iVar16 + -0x3d) = in_FPUTagWord;
          *(undefined4 *)(iVar16 + -0x31) = in_FPUDataPointer;
          *(undefined4 *)(iVar16 + -0x39) = in_FPUInstructionPointer;
          *(undefined2 *)(iVar16 + -0x33) = in_FPULastInstructionOpcode;
          do {
                    /* WARNING: Do nothing block with infinite loop */
          } while( true );
        }
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      }
    }
    param_2 = CONCAT31((int3)((uint)param_2 >> 8),0x40);
    if (bVar28) {
      *unaff_EBX = *unaff_EBX << 0x16 | *unaff_EBX >> 10;
      bVar28 = (*unaff_EBX & 1) != 0;
      goto code_r0x0051107c;
    }
    uVar7 = (uint)unaff_EBX & *(uint *)((int)plVar8 + -0x79);
    piVar23 = (int *)0xb5df0e69;
    puVar25 = (uint *)((int)puVar21 + 1);
    uRamb5df0e68 = CONCAT31(uRamb5df0e68._1_3_,(char)*puVar21);
    plVar8 = (longlong *)((uint)plVar8 & 0x1f5c2d1b);
  }
  puVar21 = (uint *)((int)puVar25 + 1);
  plVar8 = (longlong *)CONCAT31((int3)((uint)plVar8 >> 8),(char)*puVar25);
  puVar15 = (uint *)CONCAT31((int3)(uVar7 >> 8),(byte)uVar7 | *(byte *)((int)piVar23 + -0x5d2f6db5))
  ;
  while( true ) {
    puVar25 = unaff_EBX;
    piVar24 = piVar23 + (uint)bVar30 * -2 + 1;
code_r0x0051102d:
    puVar22 = (undefined1 *)((int)puVar21 + -1);
    *puVar15 = *puVar15 & (uint)&stack0x00000000;
    uVar7 = *puVar15;
    pcVar1 = (char *)((int)puVar15 + (int)puVar22);
    *pcVar1 = *pcVar1 << ((byte)puVar15 & 0x1f);
    bVar28 = ((uint)puVar15 & 0x1f) != 0;
    if ((bVar28 || uVar7 != 0) && (!bVar28 || *pcVar1 != '\0')) break;
    bVar28 = CARRY4((uint)puVar22,(uint)puVar22);
    puVar21 = (uint *)((int)puVar22 * 2);
    unaff_EBX = puVar15;
    piVar23 = piVar24;
code_r0x0051107c:
    bVar5 = (byte)((uint)unaff_EBX >> 8);
    bVar27 = (byte)((uint)puVar25 >> 8);
    *(char *)(param_2 + 3) =
         *(char *)(param_2 + 3) + (byte)puVar25 +
         (CARRY1(bVar5,bVar27) || CARRY1(bVar5 + bVar27,bVar28));
    *(byte *)((int)puVar25 + -0x29) = *(byte *)((int)puVar25 + -0x29) | 0x31;
    pbVar19 = (byte *)((int)puVar25 + 0x452ba48e);
    bVar5 = (byte)unaff_retaddr & 7;
    *pbVar19 = *pbVar19 << bVar5 | *pbVar19 >> 8 - bVar5;
    if (((uint)unaff_retaddr & 0x1f) != 0 && (*pbVar19 & 1) != 0) {
      do {
                    /* WARNING: Do nothing block with infinite loop */
      } while( true );
    }
    bVar30 = 1;
    bVar5 = (byte)puVar25 ^ (byte)param_2;
    unaff_EBX = (uint *)CONCAT31((int3)((uint)puVar25 >> 8),bVar5);
    puVar15 = unaff_retaddr;
    if (-1 < (char)bVar5) {
      *(char *)piVar23 = (char)plVar8;
      uVar12 = (undefined3)((uint)plVar8 >> 8);
      puVar9 = (undefined4 *)CONCAT31(uVar12,0xef);
      bVar28 = CARRY4((uint)unaff_EBX,*(uint *)((int)puVar9 + -0x27ed69aa));
      iVar18 = (int)unaff_EBX + *(uint *)((int)puVar9 + -0x27ed69aa);
      bVar29 = iVar18 == 0;
      iVar16 = (int)unaff_retaddr + -1;
      bVar5 = (byte)iVar16;
      if (iVar16 == 0 || bVar29) {
        iVar18 = CONCAT31(uVar12,*(undefined1 *)(iVar18 + 0xef));
        out((short)param_2,iVar18);
        _DAT_dc8fc793 = iVar18;
        *(int *)((int)piVar23 + -1) = iVar18;
        pbVar19 = (byte *)CONCAT31((int3)(CONCAT22((short)((uint)iVar16 >> 0x10),
                                                   CONCAT11((byte)((uint)iVar16 >> 8) |
                                                            *(byte *)(unaff_EBP + -99),bVar5)) >> 8)
                                   ,bVar5 + 0x42);
        do {
          pbVar19 = (byte *)CONCAT31((int3)((uint)pbVar19 >> 8),(char)pbVar19 + -0x40);
          iVar18 = CONCAT31((int3)((uint)iVar18 >> 8),0xb9);
        } while (iVar18 == 0);
        *pbVar19 = *pbVar19 | (byte)param_2;
        *(byte **)((int)piVar23 + -5) = pbVar19;
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      }
      out((short)param_2,0xef);
      *(int *)((int)piVar23 + -1) = (int)puVar9;
      if (bVar28) {
        in_CS = 0xb69c;
        puStack_8 = (undefined4 *)0x511101;
        uVar31 = func_0xf5d6dec8();
        iVar16 = extraout_ECX;
        if (!bVar28 && !bVar29) {
          bVar5 = (byte)extraout_ECX;
          pbVar19 = (byte *)(iVar18 + 0x5f + (int)puVar21 * 2);
          cVar14 = bVar5 - *pbVar19;
          if (*pbVar19 <= bVar5 && cVar14 != '\0') {
            piVar23 = (int *)(CONCAT31((int3)(CONCAT22((short)((uint)extraout_ECX >> 0x10),
                                                       CONCAT11((char)((uint)extraout_ECX >> 8) +
                                                                (char)((ulonglong)uVar31 >> 0x28) +
                                                                bVar28,bVar5)) >> 8),cVar14) +
                             0x9e2709b);
            *piVar23 = *piVar23 + -0x1500fcf4;
            *puVar9 = *param_3;
            return (longlong *)(param_3 + -1);
          }
          return (longlong *)uVar31;
        }
      }
      else {
        piVar23[-0x115a7601] = piVar23[-0x115a7601] << (bVar5 & 0x1f);
        uVar10 = in(0xce);
        uVar31 = CONCAT44(param_2,uVar10);
      }
      DAT_be6586a5 = (undefined1)uVar31;
      uVar7 = *puVar21;
      pbVar19 = &stack0x0000005f + (int)(puVar21 + -1) * 2;
      bVar5 = *pbVar19;
      bVar27 = (byte)((uint)iVar16 >> 8);
      *pbVar19 = *pbVar19 + bVar27;
      if (!CARRY1(bVar5,bVar27)) {
        puVar9 = (undefined4 *)(uVar7 & 0xcf837056);
        *(char *)(puVar21 + -0xc) = (char)puVar21[-0xc] + (char)iVar16;
        *(int *)((int)puVar21 + -0x73) = (int)(*(int *)((int)puVar21 + -0x73) + (int)(puVar21 + -1))
        ;
        *(undefined4 **)((int)piVar23 + -5) = puVar9;
        iVar16 = (int)((ulonglong)uVar31 >> 0x20) * 0x69;
        *(char *)(iVar16 + -2) = (char)iVar16;
        uVar10 = GlobalDescriptorTableRegister();
        *(undefined4 *)(iVar18 + -2) = uVar10;
        puVar25 = (uint *)((int)piVar23 + -0xd);
        uVar10 = in((short)((ulonglong)uVar31 >> 0x20));
        *(undefined4 *)((int)piVar23 + -9) = uVar10;
        puStack_8 = (undefined4 *)CONCAT22(puStack_8._2_2_,in_SS);
        bVar27 = (byte)(iVar18 + 1);
        pbVar19 = (byte *)CONCAT22((short)((uint)(iVar18 + 1) >> 0x10),CONCAT11(0xd3,bVar27));
        uVar10 = in(0xc2d8);
        pbVar19[(unaff_EBP + 1) * 2 + 0x55] = pbVar19[(unaff_EBP + 1) * 2 + 0x55] + 0xae;
        bVar5 = (byte)((uint)uVar10 >> 8);
        sVar13 = (short)((uint)uVar10 >> 0x10);
        cVar14 = bVar5 - *pbVar19;
        if (-1 < cVar14) {
          iVar16 = (int)sVar13 >> 0xf;
          if (cVar14 != '\0' && (char)*pbVar19 <= (char)bVar5) {
            *(char *)((int)puVar9 + 0x56) = *(char *)((int)puVar9 + 0x56) >> 1;
                    /* WARNING: Bad instruction - Truncating control flow here */
            halt_baddata();
          }
          uVar7 = CONCAT22(sVar13,CONCAT11(cVar14,(char)uVar10)) + *(int *)(pbVar19 + -0x29) +
                  (uint)(bVar5 < *pbVar19);
          *puVar25 = *puVar25 | 0xffffffe7;
          puVar22 = (undefined1 *)register0x00000010;
          if (-1 < (int)*puVar25) {
            pbVar19 = (byte *)CONCAT31((int3)((uint)pbVar19 >> 8),
                                       bVar27 | *(byte *)((int)&stack0x00000000 * 2 + 0x2a617254));
            puVar9 = (undefined4 *)CONCAT22((short)((uint)(unaff_EBP + 1) >> 0x10),in_CS);
            puStack_8 = (undefined4 *)((int)piVar23 + -0xe);
            *(char *)puVar25 = (char)uVar7;
            if (&stack0x00000000 != (undefined1 *)0x1 && (uVar7 & 0xdc) != 0) {
              pbVar19 = pbVar19 + 1;
            }
            puVar25 = (uint *)(uVar7 + 0x71d0f4cb);
            ppuVar20 = &puStack_8;
            cVar14 = '\x13';
            puVar26 = puStack_8;
            do {
              puVar26 = puVar26 + -1;
              ppuVar20 = ppuVar20 + -1;
              *ppuVar20 = (undefined4 *)*puVar26;
              cVar14 = cVar14 + -1;
            } while ('\0' < cVar14);
            bVar27 = (longlong)(int)((longlong)iVar16 * 0x44) != (longlong)iVar16 * 0x44;
            func_0x76848269();
            in(0xbd);
            bVar5 = (byte)extraout_ECX_00 & 0x1f;
            cVar14 = *(char *)puVar25;
            *(char *)puVar25 = *(char *)puVar25 << bVar5;
            bVar28 = ((uint)extraout_ECX_00 & 0x1f) != 0;
            *(byte **)pbVar19 =
                 pbVar19 + (uint)(byte)(!bVar28 & bVar27 |
                                       (bVar28 && (char)(cVar14 << bVar5 - 1) < '\0')) +
                           *(int *)pbVar19;
            puVar22 = extraout_ECX_00;
            iVar16 = extraout_EDX;
          }
          uVar17 = (undefined2)iVar16;
          uVar11 = in(uVar17);
          puVar21 = (uint *)CONCAT31((int3)((uint)puVar22 >> 8),0x60);
          uVar10 = in(uVar17);
          uVar3 = (uint)((uVar11 & 0x100) != 0);
          uVar7 = *puVar21;
          puVar22 = &stack0x00000000 + *puVar21;
          *(undefined4 *)(puVar22 + (uVar3 - 4)) = uVar10;
          *(undefined4 *)(puVar22 + (uVar3 - 8)) = uVar10;
          *(uint **)(puVar22 + (uVar3 - 0xc)) = puVar21;
          *(int *)(puVar22 + (uVar3 - 0x10)) = iVar16;
          *(byte **)(puVar22 + (uVar3 - 0x14)) = pbVar19;
          *(undefined1 **)(puVar22 + (uVar3 - 0x18)) = puVar22 + (uVar3 - 4);
          *(uint *)(puVar22 + (uVar3 - 0x1c)) = uVar11;
          *(undefined4 **)(puVar22 + (uVar3 - 0x20)) = puVar9;
          *(uint **)(puVar22 + (uVar3 - 0x24)) = puVar25;
          puVar26 = (undefined4 *)((uint)puVar25 ^ *(uint *)((int)puVar25 + 1));
          *(uint *)(puVar22 + (uVar3 - 0x28)) =
               CONCAT22((short)((uint)uVar10 >> 0x10),
                        CONCAT11(((int)(puVar22 + uVar3) < 0) << 7 |
                                 (puVar22 + uVar3 == (undefined1 *)0x0) << 6 |
                                 ((uVar11 & 0x1000) != 0) << 4 |
                                 ((POPCOUNT((uint)(puVar22 + uVar3) & 0xff) & 1U) == 0) << 2 | 2U |
                                 (CARRY4((uint)&stack0x00000000,uVar7) ||
                                 CARRY4((uint)puVar22,uVar3)),(char)uVar10));
          pbVar19[-0x3c] = pbVar19[-0x3c] - (char)((uint)iVar16 >> 8);
          *(undefined4 *)(puVar22 + (uVar3 - 0x2c)) = 0xffffffaf;
          uVar10 = in(0xa6);
          *(char *)(iVar16 + -0x66) = *(char *)(iVar16 + -0x66) - (char)((uint)uVar10 >> 8);
          out(uVar17,(char)uVar10);
          DAT_af3c70c7 = DAT_af3c70c7 | (byte)iVar16;
          uVar10 = in((short)(iVar16 + 1));
          DAT_10984e34 = DAT_10984e34 + '\x01';
          DAT_09247a77 = (undefined1)uVar10;
          iVar16 = -*(int *)(((iVar16 + 1) - (int)puVar26) + -0x5d914a3a);
          *(undefined4 *)(puVar22 + iVar16 + uVar3 + -0x30) = 0xb5d7fe81;
          *(undefined4 **)(puVar22 + iVar16 + uVar3 + -0x34) = puVar9;
          *puVar26 = *puVar9;
                    /* WARNING: Bad instruction - Truncating control flow here */
          halt_baddata();
        }
      }
      pcVar4 = (code *)swi(3);
      plVar8 = (longlong *)(*pcVar4)();
      return plVar8;
    }
  }
  *(byte *)((int)puVar15 + -0x65) = *(byte *)((int)puVar15 + -0x65) | (byte)param_2;
  pcVar4 = (code *)swi(1);
  plVar8 = (longlong *)(*pcVar4)();
  return plVar8;
}


