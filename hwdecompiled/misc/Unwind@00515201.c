/*
 * Function: Unwind@00515201
 * Address: 00515201
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Removing unreachable block (ram,0x0051517d) */
/* WARNING: Removing unreachable block (ram,0x0051518a) */
/* WARNING: Removing unreachable block (ram,0x4dcad7dd) */

ulonglong Unwind_00515201(void)

{
  uint *puVar1;
  int iVar2;
  char cVar3;
  uint *puVar4;
  uint *puVar5;
  bool bVar6;
  char *pcVar7;
  undefined1 uVar8;
  byte bVar9;
  ushort uVar10;
  int in_EAX;
  uint uVar12;
  undefined3 uVar14;
  uint uVar13;
  sbyte sVar15;
  int extraout_ECX;
  int iVar16;
  int unaff_EBX;
  undefined1 *puVar17;
  int unaff_EBP;
  int *piVar18;
  char *pcVar19;
  char *unaff_EDI;
  char *pcVar20;
  char in_CF;
  byte in_AF;
  undefined1 in_OF;
  unkbyte10 in_ST6;
  ulonglong uVar21;
  undefined2 uStack_4;
  char *pcVar11;
  
  uVar21 = (**(code **)(in_EAX + -0x683facc1))();
  iVar16 = (int)(uVar21 >> 0x20);
  if (extraout_ECX != 1) {
    if (!(bool)in_OF) {
      return uVar21;
    }
    return CONCAT44(iVar16,(int)uVar21 + 1);
  }
  *(char *)(unaff_EBX + 0x30) = (*(char *)(unaff_EBX + 0x30) - (char)(uVar21 >> 0x20)) - in_CF;
  *(byte *)(unaff_EBX + -0x14) = *(byte *)(unaff_EBX + -0x14) ^ (byte)(uVar21 >> 0x28);
  uStack_4 = (undefined2)unaff_EBX;
  pcVar19 = (char *)0x1dbd04e3;
  uVar8 = in(0x99);
  pcVar11 = (char *)CONCAT31((int3)((uint)((int)uVar21 + 1) >> 8),uVar8);
  uVar13 = 1;
  while( true ) {
    piVar18 = (int *)(uVar13 + 0x36);
    *piVar18 = *piVar18 - unaff_EBP;
    iVar2 = *piVar18;
    piVar18 = (int *)(pcVar19 + 0x53);
    sVar15 = (sbyte)uVar13;
    *piVar18 = *piVar18 >> sVar15;
    bVar6 = (uVar13 & 0x1f) != 0;
    if (!bVar6 && iVar2 == 0 || bVar6 && *piVar18 == 0) {
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    in_AF = 9 < ((byte)pcVar11 & 0xf) | in_AF;
    cVar3 = (char)((uint)pcVar11 >> 8);
    puVar5 = (uint *)(unaff_EDI + 4);
    puVar4 = (uint *)(pcVar19 + 5);
    piVar18 = (int *)(unaff_EBP - 1U ^ *puVar4);
    uVar12 = CONCAT31(CONCAT21(cVar3 >> 7,cVar3 + in_AF),*pcVar19) ^ 0xb3e2a5d9;
    *(int *)(uVar12 + 0xc50b6b97) = *(int *)(uVar12 + 0xc50b6b97) + uVar13;
    *(byte *)puVar5 = (byte)*puVar5 & (byte)((uint)unaff_EBX >> 8);
    uVar14 = (undefined3)(uVar12 >> 8);
    bVar9 = in(0x1e);
    puVar1 = (uint *)(CONCAT31(uVar14,bVar9) + -0x25c9712b);
    *puVar1 = *puVar1 >> 1;
    iVar16 = (CONCAT31((int3)((uint)iVar16 >> 8),(char)iVar16 + -0x6f) - *(int *)((int)piVar18 + 10)
             ) + -1;
    out(0x3c,bVar9);
    unaff_EBX = unaff_EBX + -1 + CONCAT31(uVar14,bVar9);
    ffree(in_ST6);
    puRam27a589d1 = puVar5;
    if (CONCAT11(0xbc,sVar15) == 0) break;
    unaff_EBP = *piVar18;
    *(undefined2 *)piVar18 = uStack_4;
    iVar16 = CONCAT31((int3)((uint)iVar16 >> 8),*(undefined1 *)(unaff_EBX + 0x2bd0eaeb));
    *puVar5 = *puVar4;
    pcVar11 = pcVar19 + 9;
    pcVar7 = unaff_EDI + 8;
    do {
      pcVar20 = pcVar7;
      pcVar19 = pcVar11 + 1;
      cVar3 = *pcVar11;
      pcVar11 = pcVar19;
      pcVar7 = pcVar20 + 1;
    } while (*pcVar20 <= cVar3);
    if (SBORROW1(cVar3,*pcVar20)) {
      puVar17 = (undefined1 *)0x422f6737;
      iVar16 = iVar16 + -1;
      uVar10 = (ushort)CONCAT31(uVar14,bVar9) ^ 0x14;
      if (CONCAT11(0xbc,sVar15) != 0) {
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      }
      goto LAB_005152d5;
    }
    in_AF = 9 < (bVar9 & 0xf) | in_AF;
    bVar9 = bVar9 + in_AF * '\x06';
    uVar13 = CONCAT11((char)((uint)unaff_EBX >> 8),sVar15) | 0xbc00;
    pcVar11 = (char *)CONCAT22((short)(uVar12 >> 0x10),
                               (ushort)(byte)(bVar9 + (0x90 < (bVar9 & 0xf0) |
                                                      in_AF * (0xf9 < bVar9)) * '`' +
                                             (char)(uVar12 >> 8) * '\t'));
    unaff_EDI = pcVar20 + 6;
    if (pcVar11 < *(char **)(pcVar20 + 2) || pcVar11 == *(char **)(pcVar20 + 2)) {
      *pcVar11 = *pcVar11 + '\x01';
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
  }
  uVar13 = CONCAT31(uVar14,bVar9 ^ bRam560d8960);
  out(0xbe,uVar13);
  bVar9 = (bVar9 ^ bRam560d8960) + 0x2a;
  uRam6313a706 = (undefined1)unaff_EBX;
  in_AF = 9 < (bVar9 & 0xf) | in_AF;
  bVar9 = bVar9 + in_AF * '\x06';
  uRam27a589cd = 0x34;
  puVar17 = (undefined1 *)0x27a589d1;
  pcVar11 = pcVar19 + 6;
  if ((char)(byte)*puVar5 < (char)*puVar4) {
    if ((char)(byte)*puVar5 <= (char)*puVar4) {
      pcVar19[-0x1d2a9bd9] = pcVar19[-0x1d2a9bd9] ^ (byte)((uint)iVar16 >> 8);
      puVar17 = (undefined1 *)0x27a589f1;
      iVar16 = iRam27a589e5;
      piVar18 = piRam27a589d9;
    }
    DAT_f90d9182 = SUB41(piVar18,0);
    out(0x6b,DAT_f90d9182);
    DAT_e68987fb = DAT_e68987fb << 1;
    *(undefined4 *)(puVar17 + -4) = 0xffffffdb;
    return CONCAT44(iVar16 + 1,piVar18) & 0xffffffffdfbeb05c;
  }
  DAT_c7db89d1 = DAT_c7db89d1 |
                 bVar9 + (0x90 < (bVar9 & 0xf0) | 0x789dc3d5 < uVar13 | in_AF * (0xf9 < bVar9)) *
                         'a' + 0xb8;
  uVar10 = 0x4ce5;
LAB_005152d5:
  DAT_fe699a47 = (undefined1)uVar10;
  *(undefined2 *)(puVar17 + -4) = uStack_4;
  out(*pcVar11,(short)iVar16);
  *(int *)(puVar17 + -8) = (int)(short)uVar10;
  return CONCAT44(iVar16,(int)(short)uVar10);
}


