/*
 * Function: Network_CleanupExpiredConnections
 * Address: 004af440
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Removing unreachable block (ram,0x004af547) */

void __fastcall Network_CleanupExpiredConnections(undefined4 *param_1)

{
  int iVar1;
  bool bVar2;
  undefined1 *puVar3;
  int extraout_ECX;
  undefined2 extraout_DX;
  uint extraout_EDX;
  uint uVar4;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  int *piVar5;
  int *piVar6;
  uint unaff_retaddr;
  undefined1 *puVar7;
  undefined4 *in_stack_ffffffc8;
  undefined4 *in_stack_ffffffcc;
  uint uVar8;
  undefined1 local_15;
  uint local_14;
  void *local_10;
  undefined4 uStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  uStack_c = 0x516848;
  local_10 = ExceptionList;
  local_14 = DAT_00569f5c ^ unaff_retaddr;
  ExceptionList = &local_10;
  Network_ProcessClientMessages(param_1);
  if ((undefined4 *)param_1[0x14c] == (undefined4 *)0x0) {
    piVar5 = (int *)0x0;
  }
  else {
    piVar5 = *(int **)param_1[0x14c];
  }
  uVar4 = extraout_EDX;
  if (piVar5 != (int *)param_1[0x14c]) {
    do {
      uVar8 = (uint)in_stack_ffffffcc & 0xffffff00;
      PowerUp_ProcessThunderstrike
                ((_String_base *)&stack0xffffffc8,uVar4,(_String_base *)(piVar5 + 2),0,0xffffffff);
      local_8 = 0;
      bVar2 = Math_ClampToRange(DAT_0056da10,extraout_DX);
      if (bVar2) {
        piVar6 = (int *)*piVar5;
        if (piVar5 != (int *)param_1[0x14c]) {
          *(int **)piVar5[1] = piVar6;
          iVar1 = *piVar5;
          uVar4 = piVar5[1];
          *(uint *)(iVar1 + 4) = uVar4;
          if (0xf < (uint)piVar5[8]) {
                    /* WARNING: Subroutine does not return */
            System_ShutdownHandler(iVar1,uVar4);
          }
          puVar7 = &local_15;
          piVar5[8] = 0xf;
          local_15 = 0;
          piVar5[7] = 0;
          puVar3 = (undefined1 *)String_GetDataPointer((int)(piVar5 + 2));
          Utility_CopyByte(puVar3,puVar7);
                    /* WARNING: Subroutine does not return */
          System_ShutdownHandler(extraout_ECX,extraout_EDX_01);
        }
      }
      else {
        piVar6 = (int *)*piVar5;
      }
      local_8 = 0xffffffff;
      in_stack_ffffffcc = (undefined4 *)(uVar8 & 0xffffff00);
      uVar4 = extraout_EDX_00;
      piVar5 = piVar6;
    } while (piVar6 != (int *)param_1[0x14c]);
  }
  ExceptionList = local_10;
  Exception_SetMessage((void *)(local_14 ^ unaff_retaddr),in_stack_ffffffc8,in_stack_ffffffcc);
  return;
}


