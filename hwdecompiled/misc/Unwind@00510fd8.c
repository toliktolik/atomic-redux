/*
 * Function: Unwind@00510fd8
 * Address: 00510fd8
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x0051126f) overlaps instruction at (ram,0x0051126e)
    */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Removing unreachable block (ram,0x005112ea) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 * __fastcall Unwind_00510fd8(uint *param_1,int param_2,undefined4 *param_3)

{
  int *piVar1;
  char *pcVar2;
  code *pcVar3;
  ushort uVar4;
  uint in_EAX;
  uint uVar5;
  undefined4 *puVar6;
  undefined3 uVar9;
  undefined4 uVar7;
  short sVar10;
  uint uVar8;
  char cVar11;
  uint uVar12;
  int iVar13;
  int extraout_ECX;
  undefined1 *extraout_ECX_00;
  uint *puVar14;
  int extraout_EDX;
  byte bVar15;
  uint *unaff_EBX;
  int iVar16;
  byte *pbVar17;
  undefined4 **ppuVar18;
  int unaff_EBP;
  undefined1 *unaff_ESI;
  uint *puVar19;
  undefined1 *puVar20;
  uint *unaff_EDI;
  undefined4 *puVar21;
  undefined2 uVar22;
  undefined2 in_SS;
  bool bVar23;
  bool bVar24;
  byte bVar25;
  undefined2 in_FPUControlWord;
  undefined2 in_FPUStatusWord;
  undefined2 in_FPUTagWord;
  undefined2 in_FPULastInstructionOpcode;
  undefined4 in_FPUDataPointer;
  undefined4 in_FPUInstructionPointer;
  undefined8 uVar26;
  uint *unaff_retaddr;
  uint auStack_34 [7];
  undefined1 auStack_18 [4];
  int aiStack_14 [3];
  undefined4 *puStack_8;
  
  bVar25 = 0;
  while( true ) {
    param_2 = param_2 - unaff_EBX[-0xe4e16e1];
    uVar4 = (short)(char)(in_EAX ^ 0x9d7255ef) *
            (short)*(char *)((in_EAX ^ 0x9d7255ef) + 0x70087d84);
    puVar19 = (uint *)(unaff_ESI + -*(int *)((int)unaff_EBX + 0x2fd7f182));
    uVar5 = in((short)param_2);
    uVar22 = *(undefined2 *)((int)param_1 + 0x5f);
    if ((uVar4 & 0x8000) != 0) {
      do {
        puVar14 = unaff_EDI;
        if (param_1 == (uint *)0x0) goto code_r0x0051102d;
        param_1 = (uint *)((int)param_1 + -1);
        puVar14 = unaff_EDI + 1;
        uVar12 = *unaff_EDI;
        unaff_EDI = puVar14;
        if (uVar5 == uVar12) goto code_r0x0051102d;
      } while( true );
    }
    bVar23 = (byte)((byte)unaff_EBX[-0xaaade85] & (byte)unaff_EBX) == 0;
    uVar9 = (undefined3)(uVar5 >> 8);
    if (param_1 == (uint *)0x1 || bVar23) break;
    param_1 = (uint *)((int)param_1 + -2);
    if (param_1 == (uint *)0x0 || !bVar23) {
      pbVar17 = (byte *)(uVar5 - 1);
      *pbVar17 = *pbVar17 | 0x41;
      out(*puVar19,(short)param_2);
      iVar13 = CONCAT22((short)((uint)param_1 >> 0x10),CONCAT11(0xa1,(char)param_1));
      if (iVar13 == 1 || ((uint)pbVar17 & (uint)unaff_EDI) == 0) {
        LOCK();
        *(uint *)(unaff_EBP + 0x49) = _DAT_ade3a7f2 | 0x44;
        UNLOCK();
        *(undefined2 *)(iVar13 + -0x45) = in_FPUControlWord;
        *(undefined2 *)(iVar13 + -0x41) = in_FPUStatusWord;
        *(undefined2 *)(iVar13 + -0x3d) = in_FPUTagWord;
        *(undefined4 *)(iVar13 + -0x31) = in_FPUDataPointer;
        *(undefined4 *)(iVar13 + -0x39) = in_FPUInstructionPointer;
        *(undefined2 *)(iVar13 + -0x33) = in_FPULastInstructionOpcode;
        do {
                    /* WARNING: Do nothing block with infinite loop */
        } while( true );
      }
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    unaff_ESI = (undefined1 *)((int)puVar19 + 1);
    bVar23 = 9 < ((byte)unaff_EBP & 0xf) || (uVar4 & 0x1000) != 0;
    uVar5 = CONCAT31(uVar9,(byte)unaff_EBP + bVar23 * '\x06') & 0xffff000f;
    in_EAX = CONCAT22((short)(uVar5 >> 0x10),
                      CONCAT11((char)((uint)unaff_EBP >> 8) + bVar23,(char)uVar5));
    unaff_EBP = CONCAT22((short)((uint)unaff_EBP >> 0x10),(short)CONCAT31(uVar9,(char)*puVar19));
  }
  param_2 = CONCAT31((int3)((uint)param_2 >> 8),0x40);
  if (bVar23) {
    *unaff_EBX = *unaff_EBX << 0x16 | *unaff_EBX >> 10;
    bVar23 = (*unaff_EBX & 1) != 0;
    param_1 = unaff_retaddr;
    puVar14 = unaff_EDI;
    goto code_r0x0051107c;
  }
  uVar12 = (uint)unaff_retaddr & *(uint *)(uVar5 - 0x79);
  puVar14 = (uint *)((int)unaff_EDI + 1);
  puVar20 = (undefined1 *)((int)puVar19 + 1);
  *(char *)unaff_EDI = (char)*puVar19;
  puVar19 = (uint *)((int)puVar19 + 2);
  uVar5 = CONCAT31(uVar9,*puVar20) & 0x1f5c2dff;
  param_1 = (uint *)CONCAT31((int3)(uVar12 >> 8),(byte)uVar12 | (byte)unaff_EDI[-0x174bdb6d]);
  while( true ) {
    puVar14 = puVar14 + (uint)bVar25 * -2 + 1;
code_r0x0051102d:
    puVar20 = (undefined1 *)((int)puVar19 + -1);
    *param_1 = *param_1 & (uint)&stack0x00000000;
    uVar12 = *param_1;
    pcVar2 = (char *)((int)param_1 + (int)puVar20);
    *pcVar2 = *pcVar2 << ((byte)param_1 & 0x1f);
    bVar23 = ((uint)param_1 & 0x1f) != 0;
    if ((bVar23 || uVar12 != 0) && (!bVar23 || *pcVar2 != '\0')) break;
    bVar23 = CARRY4((uint)puVar20,(uint)puVar20);
    puVar19 = (uint *)((int)puVar20 * 2);
code_r0x0051107c:
    bVar25 = (byte)((uint)param_1 >> 8);
    bVar15 = (byte)((uint)unaff_EBX >> 8);
    *(char *)(param_2 + 3) =
         *(char *)(param_2 + 3) + (byte)unaff_EBX +
         (CARRY1(bVar25,bVar15) || CARRY1(bVar25 + bVar15,bVar23));
    *(byte *)((int)unaff_EBX + -0x29) = *(byte *)((int)unaff_EBX + -0x29) | 0x31;
    pbVar17 = (byte *)((int)unaff_EBX + 0x452ba48e);
    bVar25 = (byte)unaff_retaddr & 7;
    *pbVar17 = *pbVar17 << bVar25 | *pbVar17 >> 8 - bVar25;
    if (((uint)unaff_retaddr & 0x1f) != 0 && (*pbVar17 & 1) != 0) {
      do {
                    /* WARNING: Do nothing block with infinite loop */
      } while( true );
    }
    bVar25 = 1;
    bVar15 = (byte)unaff_EBX ^ (byte)param_2;
    unaff_EBX = (uint *)CONCAT31((int3)((uint)unaff_EBX >> 8),bVar15);
    param_1 = unaff_retaddr;
    if (-1 < (char)bVar15) {
      *(char *)puVar14 = (char)uVar5;
      uVar9 = (undefined3)(uVar5 >> 8);
      puVar6 = (undefined4 *)CONCAT31(uVar9,0xef);
      bVar23 = CARRY4((uint)unaff_EBX,*(uint *)((int)puVar6 + -0x27ed69aa));
      iVar16 = (int)unaff_EBX + *(uint *)((int)puVar6 + -0x27ed69aa);
      bVar24 = iVar16 == 0;
      iVar13 = (int)unaff_retaddr + -1;
      bVar25 = (byte)iVar13;
      if (iVar13 == 0 || bVar24) {
        iVar16 = CONCAT31(uVar9,*(undefined1 *)(iVar16 + 0xef));
        out((short)param_2,iVar16);
        _DAT_dc8fc793 = iVar16;
        *(int *)((int)puVar14 + -1) = iVar16;
        pbVar17 = (byte *)CONCAT31((int3)(CONCAT22((short)((uint)iVar13 >> 0x10),
                                                   CONCAT11((byte)((uint)iVar13 >> 8) |
                                                            *(byte *)(unaff_EBP + -99),bVar25)) >> 8
                                         ),bVar25 + 0x42);
        do {
          pbVar17 = (byte *)CONCAT31((int3)((uint)pbVar17 >> 8),(char)pbVar17 + -0x40);
          iVar16 = CONCAT31((int3)((uint)iVar16 >> 8),0xb9);
        } while (iVar16 == 0);
        *pbVar17 = *pbVar17 | (byte)param_2;
        *(byte **)((int)puVar14 + -5) = pbVar17;
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      }
      out((short)param_2,0xef);
      *(int *)((int)puVar14 + -1) = (int)puVar6;
      if (bVar23) {
        uVar22 = 0xb69c;
        puStack_8 = (undefined4 *)0x511101;
        uVar26 = func_0xf5d6dec8();
        iVar13 = extraout_ECX;
        if (!bVar23 && !bVar24) {
          bVar25 = (byte)extraout_ECX;
          pbVar17 = (byte *)(iVar16 + 0x5f + (int)puVar19 * 2);
          cVar11 = bVar25 - *pbVar17;
          if (*pbVar17 <= bVar25 && cVar11 != '\0') {
            piVar1 = (int *)(CONCAT31((int3)(CONCAT22((short)((uint)extraout_ECX >> 0x10),
                                                      CONCAT11((char)((uint)extraout_ECX >> 8) +
                                                               (char)((ulonglong)uVar26 >> 0x28) +
                                                               bVar23,bVar25)) >> 8),cVar11) +
                            0x9e2709b);
            *piVar1 = *piVar1 + -0x1500fcf4;
            *puVar6 = *param_3;
            return param_3 + -1;
          }
          return (undefined4 *)uVar26;
        }
      }
      else {
        puVar14[-0x115a7601] = puVar14[-0x115a7601] << (bVar25 & 0x1f);
        uVar7 = in(0xce);
        uVar26 = CONCAT44(param_2,uVar7);
      }
      DAT_be6586a5 = (undefined1)uVar26;
      uVar5 = *puVar19;
      pbVar17 = &stack0x0000005f + (int)(puVar19 + -1) * 2;
      bVar25 = *pbVar17;
      bVar15 = (byte)((uint)iVar13 >> 8);
      *pbVar17 = *pbVar17 + bVar15;
      if (!CARRY1(bVar25,bVar15)) {
        puVar6 = (undefined4 *)(uVar5 & 0xcf837056);
        *(char *)(puVar19 + -0xc) = (char)puVar19[-0xc] + (char)iVar13;
        *(int *)((int)puVar19 + -0x73) = (int)(*(int *)((int)puVar19 + -0x73) + (int)(puVar19 + -1))
        ;
        *(undefined4 **)((int)puVar14 + -5) = puVar6;
        iVar13 = (int)((ulonglong)uVar26 >> 0x20) * 0x69;
        *(char *)(iVar13 + -2) = (char)iVar13;
        uVar7 = GlobalDescriptorTableRegister();
        *(undefined4 *)(iVar16 + -2) = uVar7;
        puVar19 = (uint *)((int)puVar14 + -0xd);
        uVar7 = in((short)((ulonglong)uVar26 >> 0x20));
        *(undefined4 *)((int)puVar14 + -9) = uVar7;
        puStack_8 = (undefined4 *)CONCAT22(puStack_8._2_2_,in_SS);
        bVar15 = (byte)(iVar16 + 1);
        pbVar17 = (byte *)CONCAT22((short)((uint)(iVar16 + 1) >> 0x10),CONCAT11(0xd3,bVar15));
        uVar7 = in(0xc2d8);
        pbVar17[(unaff_EBP + 1) * 2 + 0x55] = pbVar17[(unaff_EBP + 1) * 2 + 0x55] + 0xae;
        bVar25 = (byte)((uint)uVar7 >> 8);
        sVar10 = (short)((uint)uVar7 >> 0x10);
        cVar11 = bVar25 - *pbVar17;
        if (-1 < cVar11) {
          iVar13 = (int)sVar10 >> 0xf;
          if (cVar11 != '\0' && (char)*pbVar17 <= (char)bVar25) {
            *(char *)((int)puVar6 + 0x56) = *(char *)((int)puVar6 + 0x56) >> 1;
                    /* WARNING: Bad instruction - Truncating control flow here */
            halt_baddata();
          }
          uVar5 = CONCAT22(sVar10,CONCAT11(cVar11,(char)uVar7)) + *(int *)(pbVar17 + -0x29) +
                  (uint)(bVar25 < *pbVar17);
          *puVar19 = *puVar19 | 0xffffffe7;
          puVar20 = (undefined1 *)register0x00000010;
          if (-1 < (int)*puVar19) {
            pbVar17 = (byte *)CONCAT31((int3)((uint)pbVar17 >> 8),
                                       bVar15 | *(byte *)((int)&stack0x00000000 * 2 + 0x2a617254));
            puVar6 = (undefined4 *)CONCAT22((short)((uint)(unaff_EBP + 1) >> 0x10),uVar22);
            puStack_8 = (undefined4 *)((int)puVar14 + -0xe);
            *(char *)puVar19 = (char)uVar5;
            if (&stack0x00000000 != (undefined1 *)0x1 && (uVar5 & 0xdc) != 0) {
              pbVar17 = pbVar17 + 1;
            }
            puVar19 = (uint *)(uVar5 + 0x71d0f4cb);
            ppuVar18 = &puStack_8;
            cVar11 = '\x13';
            puVar21 = puStack_8;
            do {
              puVar21 = puVar21 + -1;
              ppuVar18 = ppuVar18 + -1;
              *ppuVar18 = (undefined4 *)*puVar21;
              cVar11 = cVar11 + -1;
            } while ('\0' < cVar11);
            bVar15 = (longlong)(int)((longlong)iVar13 * 0x44) != (longlong)iVar13 * 0x44;
            func_0x76848269();
            in(0xbd);
            bVar25 = (byte)extraout_ECX_00 & 0x1f;
            cVar11 = *(char *)puVar19;
            *(char *)puVar19 = *(char *)puVar19 << bVar25;
            bVar23 = ((uint)extraout_ECX_00 & 0x1f) != 0;
            *(byte **)pbVar17 =
                 pbVar17 + (uint)(byte)(!bVar23 & bVar15 |
                                       (bVar23 && (char)(cVar11 << bVar25 - 1) < '\0')) +
                           *(int *)pbVar17;
            puVar20 = extraout_ECX_00;
            iVar13 = extraout_EDX;
          }
          uVar22 = (undefined2)iVar13;
          uVar8 = in(uVar22);
          puVar14 = (uint *)CONCAT31((int3)((uint)puVar20 >> 8),0x60);
          uVar7 = in(uVar22);
          uVar12 = (uint)((uVar8 & 0x100) != 0);
          uVar5 = *puVar14;
          puVar20 = &stack0x00000000 + *puVar14;
          *(undefined4 *)(puVar20 + (uVar12 - 4)) = uVar7;
          *(undefined4 *)(puVar20 + (uVar12 - 8)) = uVar7;
          *(uint **)(puVar20 + (uVar12 - 0xc)) = puVar14;
          *(int *)(puVar20 + (uVar12 - 0x10)) = iVar13;
          *(byte **)(puVar20 + (uVar12 - 0x14)) = pbVar17;
          *(undefined1 **)(puVar20 + (uVar12 - 0x18)) = puVar20 + (uVar12 - 4);
          *(uint *)(puVar20 + (uVar12 - 0x1c)) = uVar8;
          *(undefined4 **)(puVar20 + (uVar12 - 0x20)) = puVar6;
          *(uint **)(puVar20 + (uVar12 - 0x24)) = puVar19;
          puVar21 = (undefined4 *)((uint)puVar19 ^ *(uint *)((int)puVar19 + 1));
          *(uint *)(puVar20 + (uVar12 - 0x28)) =
               CONCAT22((short)((uint)uVar7 >> 0x10),
                        CONCAT11(((int)(puVar20 + uVar12) < 0) << 7 |
                                 (puVar20 + uVar12 == (undefined1 *)0x0) << 6 |
                                 ((uVar8 & 0x1000) != 0) << 4 |
                                 ((POPCOUNT((uint)(puVar20 + uVar12) & 0xff) & 1U) == 0) << 2 | 2U |
                                 (CARRY4((uint)&stack0x00000000,uVar5) ||
                                 CARRY4((uint)puVar20,uVar12)),(char)uVar7));
          pbVar17[-0x3c] = pbVar17[-0x3c] - (char)((uint)iVar13 >> 8);
          *(undefined4 *)(puVar20 + (uVar12 - 0x2c)) = 0xffffffaf;
          uVar7 = in(0xa6);
          *(char *)(iVar13 + -0x66) = *(char *)(iVar13 + -0x66) - (char)((uint)uVar7 >> 8);
          out(uVar22,(char)uVar7);
          DAT_af3c70c7 = DAT_af3c70c7 | (byte)iVar13;
          uVar7 = in((short)(iVar13 + 1));
          DAT_10984e34 = DAT_10984e34 + '\x01';
          DAT_09247a77 = (undefined1)uVar7;
          iVar13 = -*(int *)(((iVar13 + 1) - (int)puVar21) + -0x5d914a3a);
          *(undefined4 *)(puVar20 + iVar13 + uVar12 + -0x30) = 0xb5d7fe81;
          *(undefined4 **)(puVar20 + iVar13 + uVar12 + -0x34) = puVar6;
          *puVar21 = *puVar6;
                    /* WARNING: Bad instruction - Truncating control flow here */
          halt_baddata();
        }
      }
      pcVar3 = (code *)swi(3);
      puVar6 = (undefined4 *)(*pcVar3)();
      return puVar6;
    }
  }
  *(byte *)((int)param_1 + -0x65) = *(byte *)((int)param_1 + -0x65) | (byte)param_2;
  pcVar3 = (code *)swi(1);
  puVar6 = (undefined4 *)(*pcVar3)();
  return puVar6;
}


