/*
 * Function: Crypto_GenerateKey
 * Address: 004e2be0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl Crypto_GenerateKey(int param_1,int param_2,undefined4 *param_3,int param_4)

{
  byte bVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  uint uVar9;
  int iVar10;
  int *piVar11;
  short *psVar12;
  byte *pbVar13;
  uint uVar14;
  int iVar15;
  char *pcVar16;
  int local_2c;
  int local_20;
  int local_1c;
  undefined4 *local_18;
  int local_10;
  
  uVar2 = *(uint *)(param_1 + 0x5c);
  iVar3 = *(int *)(param_1 + 0x120);
  iVar4 = *(int *)(param_1 + 100);
  iVar5 = *(int *)(param_1 + 0x1a8);
  if (0 < param_4) {
    local_18 = param_3;
    local_2c = param_4;
    do {
      Memory_ZeroFill((undefined4 *)*local_18,uVar2);
      param_4 = 0;
      if (0 < iVar4) {
        piVar11 = (int *)(iVar5 + 0x44);
        do {
          pcVar16 = (char *)*local_18;
          pbVar13 = (byte *)(*(int *)((param_2 - (int)param_3) + (int)local_18) + param_4);
          if (*(char *)(iVar5 + 0x54) == '\0') {
            psVar12 = (short *)*piVar11;
            iVar15 = 1;
            local_20 = iVar4;
          }
          else {
            pcVar16 = pcVar16 + (uVar2 - 1);
            pbVar13 = pbVar13 + (uVar2 - 1) * iVar4;
            iVar15 = -1;
            psVar12 = (short *)(*piVar11 + 2 + uVar2 * 2);
            local_20 = -iVar4;
          }
          iVar6 = *(int *)(*(int *)(iVar5 + 0x18) + param_4 * 4);
          iVar7 = *(int *)(*(int *)(iVar5 + 0x10) + param_4 * 4);
          iVar8 = 0;
          local_10 = 0;
          local_10._0_2_ = 0;
          local_1c = 0;
          for (uVar14 = uVar2; uVar14 != 0; uVar14 = uVar14 - 1) {
            uVar9 = (uint)*(byte *)((uint)*pbVar13 + iVar3 + (psVar12[iVar15] + 8 + iVar8 >> 4));
            bVar1 = *(byte *)(uVar9 + iVar6);
            *pcVar16 = *pcVar16 + bVar1;
            iVar10 = uVar9 - *(byte *)((uint)bVar1 + iVar7);
            *psVar12 = (short)local_10 + (short)iVar10 * 3;
            local_10 = local_1c + iVar10 * 5;
            iVar8 = iVar10 * 7;
            pbVar13 = pbVar13 + local_20;
            pcVar16 = pcVar16 + iVar15;
            psVar12 = psVar12 + iVar15;
            local_1c = iVar10;
          }
          *psVar12 = (short)local_10;
          param_4 = param_4 + 1;
          piVar11 = piVar11 + 1;
        } while (param_4 < iVar4);
      }
      local_18 = local_18 + 1;
      local_2c = local_2c + -1;
      *(bool *)(iVar5 + 0x54) = *(char *)(iVar5 + 0x54) == '\0';
    } while (local_2c != 0);
  }
  return;
}


