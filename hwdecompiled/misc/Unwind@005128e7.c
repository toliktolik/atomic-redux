/*
 * Function: Unwind@005128e7
 * Address: 005128e7
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Removing unreachable block (ram,0x00512936) */
/* WARNING: Removing unreachable block (ram,0x0051294f) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall Unwind_005128e7(int param_1,int param_2)

{
  char *pcVar1;
  byte *pbVar2;
  byte bVar3;
  byte bVar4;
  char cVar5;
  undefined1 uVar6;
  uint in_EAX;
  uint uVar7;
  int iVar8;
  byte bVar9;
  int iVar10;
  undefined2 uVar11;
  uint unaff_EBX;
  uint uVar12;
  int unaff_EBP;
  byte *unaff_ESI;
  uint *unaff_EDI;
  bool bVar13;
  
  uVar11 = (undefined2)param_2;
  out(uVar11,in_EAX);
  uVar12 = unaff_EBX & *(uint *)(&stack0xffffffe0 + unaff_EBP * 4);
  *unaff_ESI = (byte)uVar12;
  bVar3 = *unaff_ESI;
  bVar9 = (byte)param_1;
  *unaff_ESI = *unaff_ESI + bVar9;
  uVar6 = *(undefined1 *)(uVar12 + (in_EAX & 0xff));
  iVar10 = CONCAT22((short)((uint)param_1 >> 0x10),
                    CONCAT11(*(undefined1 *)(param_1 + 0x59cc2f26),bVar9));
  pbVar2 = (byte *)(unaff_EBP + -0x37 + iVar10);
  bVar4 = *pbVar2;
  *pbVar2 = *pbVar2 << 1 | CARRY1(bVar3,bVar9);
  uVar7 = CONCAT31((int3)(in_EAX >> 8),uVar6) + 0x65d3a876 + (uint)((char)bVar4 < '\0');
  iVar8 = CONCAT31((int3)(uVar7 >> 8),*(undefined1 *)(uVar12 + (uVar7 & 0xff)));
  pcVar1 = (char *)(uVar12 - 0x29);
  cVar5 = *pcVar1;
  *pcVar1 = *pcVar1 << 1;
  uVar7 = iVar10 - 1;
  pbVar2 = *(byte **)(unaff_ESI + -0x55477b3b);
  out(uVar11,iVar8);
  if (uVar7 == 0 || iVar10 < 1) {
    if ((POPCOUNT(uVar7 & 0xff) & 1U) == 0) {
      out(0x30,iVar8);
      goto LAB_00512966;
    }
    in(uVar11);
    bVar13 = (byte)param_2 < *pbVar2;
  }
  else {
    param_2 = (iVar8 + -0x5f3366d) - (uint)(cVar5 < '\0');
    unaff_ESI[0x2e6c204a] = unaff_ESI[0x2e6c204a] + (char)(uVar7 >> 8);
    pbVar2 = (byte *)((int)unaff_EDI + 1);
    *(byte *)unaff_EDI = *unaff_ESI;
    register0x00000010 = (BADSPACEBASE *)unaff_EDI[2];
    bVar13 = (byte)param_2 < *pbVar2;
    unaff_EBX = uVar7;
  }
  unaff_EDI = (uint *)(pbVar2 + 1);
  iVar8 = param_2;
  uVar7 = unaff_EBX;
  param_2 = (int)register0x00000010 + *(int *)register0x00000010 + (uint)bVar13;
  if (SCARRY4((int)register0x00000010,*(int *)register0x00000010) !=
      SCARRY4((int)register0x00000010 + *(int *)register0x00000010,(uint)bVar13)) {
    return;
  }
LAB_00512966:
  pbVar2 = (byte *)((int)unaff_EDI + uVar7 + 4);
  _DAT_6bf01d05 = iVar8;
  *pbVar2 = (*pbVar2 - (char)param_2) -
            (CONCAT31((int3)((uint)iVar8 >> 8),DAT_bfaa5f7b) < *unaff_EDI);
  return;
}


