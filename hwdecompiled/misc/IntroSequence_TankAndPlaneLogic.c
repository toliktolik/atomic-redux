/*
 * Function: IntroSequence_TankAndPlaneLogic
 * Address: 00420e10
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall IntroSequence_TankAndPlaneLogic(void *param_1)

{
  double dVar1;
  void *pvVar2;
  undefined4 *puVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  float10 fVar7;
  ulonglong uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  double dVar11;
  undefined4 uVar12;
  undefined1 uVar13;
  undefined4 uVar14;
  void *local_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_00510f46;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if (*(int *)((int)param_1 + 0x378) == 400) {
    ExceptionList = &local_10;
    pvVar2 = operator_new(0x70);
    local_8 = 0;
    if (pvVar2 == (void *)0x0) {
      puVar3 = (undefined4 *)0x0;
    }
    else {
      puVar3 = Wave_ProcessLevel9(pvVar2,(int)param_1);
    }
    *(undefined4 **)((int)param_1 + 0x38c) = puVar3;
    puVar3[4] = 0;
    puVar3[5] = 0x40618000;
    local_8 = 0xffffffff;
    *(undefined1 *)(*(int *)((int)param_1 + 0x38c) + 0x30) = 0;
    *(undefined4 *)(*(int *)((int)param_1 + 0x38c) + 100) = 0;
    iVar4 = *(int *)((int)param_1 + 0x38c);
    *(undefined4 *)(iVar4 + 0x18) = 0;
    *(undefined4 *)(iVar4 + 0x1c) = 0x40000000;
    iVar4 = Boss_ProcessApeKommieKong(*(int *)((int)param_1 + 0x38c));
    *(double *)(*(int *)((int)param_1 + 0x38c) + 8) = (double)(-300 - iVar4 / 2);
  }
  if (*(int *)((int)param_1 + 0x378) == 600) {
    pvVar2 = operator_new(0x78);
    local_8 = 1;
    if (pvVar2 == (void *)0x0) {
      puVar3 = (undefined4 *)0x0;
    }
    else {
      puVar3 = Score_CalculateBonusPoints(pvVar2,(int)param_1);
    }
    *(undefined4 **)((int)param_1 + 0x390) = puVar3;
    puVar3[4] = 0;
    puVar3[5] = 0x40618000;
    local_8 = 0xffffffff;
    *(undefined1 *)(*(int *)((int)param_1 + 0x390) + 0x30) = 0;
    *(undefined4 *)(*(int *)((int)param_1 + 0x390) + 100) = 0;
    iVar4 = *(int *)((int)param_1 + 0x390);
    *(undefined4 *)(iVar4 + 0x18) = 0;
    *(undefined4 *)(iVar4 + 0x1c) = 0x40000000;
    iVar4 = Boss_ProcessApeKommieKong(*(int *)((int)param_1 + 0x390));
    *(double *)(*(int *)((int)param_1 + 0x390) + 8) = (double)(-300 - iVar4 / 2);
  }
  if (*(int *)((int)param_1 + 0x38c) != 0) {
    uVar8 = Math_FloatToUInt64();
    uVar6 = (int)(uint)uVar8 >> 0x1f;
    if (((int)(((uint)uVar8 ^ uVar6) - uVar6) < 2) && (*(int *)((int)param_1 + 0x220) == 0)) {
      iVar4 = *(int *)((int)param_1 + 0x38c);
      uVar13 = *(undefined1 *)(iVar4 + 0x30);
      uVar12 = *(undefined4 *)(iVar4 + 0x24);
      uVar14 = *(undefined4 *)(iVar4 + 0x20);
      uVar10 = *(undefined4 *)(iVar4 + 0x1c);
      uVar9 = *(undefined4 *)(iVar4 + 0x18);
      Boss_ProcessEyebot(iVar4);
      uVar8 = Math_FloatToUInt64();
      iVar4 = (int)uVar8;
      uVar8 = Math_FloatToUInt64();
      SexyWidget_HandleKeyboardEvents(param_1,(int)uVar8,iVar4,uVar9,uVar10,uVar14,uVar12,uVar13);
    }
    iVar4 = *(int *)((int)param_1 + 0x38c);
    iVar5 = Boss_ProcessApeKommieKong(iVar4);
    dVar1 = (double)(iVar5 / 2 + 300);
    dVar11 = *(double *)(iVar4 + 8);
    if (dVar1 < dVar11 != (NAN(dVar1) || NAN(dVar11))) {
      Boss_BattleshipCannonSystem(*(int *)((int)param_1 + 0x38c));
      *(undefined4 *)((int)param_1 + 0x38c) = 0;
    }
  }
  iVar4 = *(int *)((int)param_1 + 0x390);
  if (iVar4 != 0) {
    uVar8 = Math_FloatToUInt64();
    uVar6 = (int)(uint)uVar8 >> 0x1f;
    dVar11 = (double)(int)(((uint)uVar8 ^ uVar6) - uVar6);
    if ((dVar11 < _DAT_0052d4e0 != (NAN(dVar11) || NAN(_DAT_0052d4e0))) &&
       (*(int *)((int)param_1 + 0x1f0) == 0)) {
      uVar14 = 0;
      uVar12 = 0;
      fVar7 = (float10)fpatan((float10)*(double *)((int)param_1 + 0x90) -
                              (float10)*(double *)(iVar4 + 8),
                              (float10)*(int *)((int)param_1 + 0x98) -
                              (float10)*(double *)(iVar4 + 0x10));
      dVar11 = (double)(fVar7 + (float10)_DAT_0052d4d8);
      Boss_ProcessEyebot(iVar4);
      uVar8 = Math_FloatToUInt64();
      iVar4 = (int)uVar8;
      uVar8 = Math_FloatToUInt64();
      Projectile_CreateWithVelocity(param_1,(int)uVar8,iVar4,dVar11,(double)CONCAT44(uVar14,uVar12))
      ;
      *(undefined4 *)(*(int *)((int)param_1 + 0x390) + 0x74) = 5;
    }
    iVar4 = *(int *)((int)param_1 + 0x390);
    iVar5 = Boss_ProcessApeKommieKong(iVar4);
    dVar1 = (double)(iVar5 / 2 + 300);
    dVar11 = *(double *)(iVar4 + 8);
    if (dVar1 < dVar11 != (NAN(dVar1) || NAN(dVar11))) {
      Boss_BattleshipCannonSystem(*(int *)((int)param_1 + 0x390));
      *(undefined4 *)((int)param_1 + 0x390) = 0;
    }
  }
  iVar4 = *(int *)((int)param_1 + 0x378);
  if ((iVar4 == 0x226) || (iVar4 == 0x30c)) {
    *(undefined1 *)((int)param_1 + 0x128) = 1;
  }
  else {
    *(undefined1 *)((int)param_1 + 0x128) = 0;
  }
  if ((799 < iVar4) && (iVar4 < 0x370)) {
    fsin((float10)(iVar4 + -800) * (float10)_DAT_0052d4d0);
    uVar8 = Math_FloatToUInt64();
    *(int *)((int)param_1 + 0x60) = (int)uVar8;
  }
  if (1000 < iVar4) {
    *(undefined4 *)((int)param_1 + 0x378) = 0;
    *(undefined4 *)((int)param_1 + 0x374) = 2;
    *(undefined4 *)((int)param_1 + 0x60) = 0x140;
    *(undefined4 *)((int)param_1 + 0x390) = 0;
    *(undefined4 *)((int)param_1 + 0x38c) = 0;
  }
  ExceptionList = local_10;
  return;
}


