/*
 * Function: Locale_AdvancedFormatter
 * Address: 00414e00
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __thiscall
Locale_AdvancedFormatter
          (void *this,uint *param_1,uint param_2,uint param_3,void *param_4,undefined4 param_5,
          uint param_6)

{
  byte ****ppppbVar1;
  uint uVar2;
  uint uVar3;
  locale *plVar4;
  facet *this_00;
  _String_base *p_Var5;
  int iVar6;
  int extraout_ECX;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint uVar7;
  uint extraout_EDX_01;
  uint uVar8;
  undefined4 *puVar9;
  void *pvVar10;
  uint unaff_retaddr;
  undefined4 *in_stack_ffffff84;
  undefined4 *in_stack_ffffff88;
  uint local_64;
  undefined1 local_60 [4];
  uint local_5c;
  undefined4 local_4c;
  uint local_48;
  _String_base local_44 [4];
  byte ***local_40 [4];
  uint local_30;
  uint local_2c;
  uint local_28;
  uint local_24;
  uint local_20;
  uint local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined4 uStack_c;
  uint local_8;
  
  pvVar10 = param_4;
  local_8 = 0xffffffff;
  uStack_c = 0x5104ee;
  local_10 = ExceptionList;
  local_14 = DAT_00569f5c ^ unaff_retaddr;
  local_18 = 0;
  if ((*(uint *)((int)param_4 + 0xc) & 0x4000) == 0) {
                    /* WARNING: Load size is inaccurate */
    ExceptionList = &local_10;
    (**(code **)(*this + 0x1c))(param_1,param_2,param_3,param_4,param_5,param_6 & 0xff);
  }
  else {
    ExceptionList = &local_10;
    plVar4 = (locale *)SexyWidget_ProcessInput(param_4,(int *)&local_20);
    local_8 = 0;
    this_00 = Renderer_SetModelViewMatrix(plVar4);
    local_8 = 0xffffffff;
    if (local_20 != 0) {
      Threading_LockSectorByIndex(&local_24,0);
      iVar6 = *(int *)(local_20 + 4);
      if ((iVar6 != 0) && (iVar6 != -1)) {
        *(int *)(local_20 + 4) = iVar6 + -1;
      }
      puVar9 = (undefined4 *)(~-(uint)(*(int *)(local_20 + 4) != 0) & local_20);
      Threading_UnlockSectorByIndex((int *)&local_24);
      pvVar10 = param_4;
      if (puVar9 != (undefined4 *)0x0) {
        (**(code **)*puVar9)(1);
        pvVar10 = param_4;
      }
    }
    if ((char)param_6 == '\0') {
      p_Var5 = (_String_base *)Renderer_InitializeViewport(this_00,local_60);
      uVar8 = 2;
      uVar7 = extraout_EDX_00;
    }
    else {
      p_Var5 = (_String_base *)Renderer_SetProjectionMatrix(this_00,&stack0xffffff84);
      uVar8 = 1;
      uVar7 = extraout_EDX;
    }
    local_2c = 0xf;
    local_30 = 0;
    local_40[0] = (byte ***)((uint)local_40[0] & 0xffffff00);
    local_18 = uVar8;
    local_8 = uVar8;
    PowerUp_ProcessThunderstrike(local_44,uVar7,p_Var5,0,0xffffffff);
    if ((uVar8 & 2) != 0) {
      uVar8 = uVar8 & 0xfffffffd;
      if (0xf < local_48) {
                    /* WARNING: Subroutine does not return */
        System_ShutdownHandler(extraout_ECX,local_5c);
      }
      local_48 = 0xf;
      local_4c = 0;
      local_5c = local_5c & 0xffffff00;
    }
    local_8 = 4;
    if ((uVar8 & 1) != 0) {
      if (0xf < local_64) {
                    /* WARNING: Subroutine does not return */
        System_ShutdownHandler(extraout_ECX,extraout_EDX_01);
      }
      in_stack_ffffff88 = (undefined4 *)((uint)in_stack_ffffff88 & 0xffffff00);
    }
    uVar7 = *(uint *)((int)pvVar10 + 0x14);
    if (((int)uVar7 < 1) || (uVar7 <= local_30)) {
      iVar6 = 0;
    }
    else {
      iVar6 = uVar7 - local_30;
    }
    if ((*(uint *)((int)param_4 + 0xc) & 0x1c0) != 0x40) {
      local_28 = param_2;
      local_24 = param_3;
      uVar2 = local_28;
      uVar3 = local_24;
      uVar7 = param_2;
      uVar8 = param_3;
      for (; param_3 = uVar3, param_2 = uVar2, local_28 = param_2, local_24 = param_3, iVar6 != 0;
          iVar6 = iVar6 + -1) {
        param_2 = uVar7;
        param_3 = uVar8;
        Character_OutputValidator(&local_28,(byte)param_5);
        uVar2 = local_28;
        uVar3 = local_24;
        uVar7 = param_2;
        uVar8 = param_3;
      }
      iVar6 = 0;
    }
    ppppbVar1 = (byte ****)local_40[0];
    uVar7 = local_30;
    if (local_2c < 0x10) {
      ppppbVar1 = local_40;
    }
    for (; uVar7 != 0; uVar7 = uVar7 - 1) {
      Character_OutputValidator(&param_2,*(byte *)ppppbVar1);
      ppppbVar1 = (byte ****)((int)ppppbVar1 + 1);
    }
    *(undefined4 *)((int)param_4 + 0x14) = 0;
    local_1c = param_2;
    local_18 = param_3;
    for (; iVar6 != 0; iVar6 = iVar6 + -1) {
      Character_OutputValidator(&local_1c,(byte)param_5);
    }
    param_1[1] = local_18;
    *param_1 = local_1c;
    if (0xf < local_2c) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler((int)local_40[0],local_1c);
    }
  }
  ExceptionList = local_10;
  Exception_SetMessage((void *)(local_14 ^ unaff_retaddr),in_stack_ffffff84,in_stack_ffffff88);
  return;
}


