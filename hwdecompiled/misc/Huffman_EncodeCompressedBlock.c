/*
 * Function: Huffman_EncodeCompressedBlock
 * Address: 004dbb60
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl Huffman_EncodeCompressedBlock(int param_1,int param_2)

{
  ushort uVar1;
  int in_EAX;
  byte bVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  uint uVar10;
  
  uVar3 = 0;
  if (*(int *)(in_EAX + 0x1698) != 0) {
    do {
      uVar10 = (uint)*(ushort *)(*(int *)(in_EAX + 0x169c) + uVar3 * 2);
      uVar8 = (uint)*(byte *)(uVar3 + *(int *)(in_EAX + 0x1690));
      uVar3 = uVar3 + 1;
      if (uVar10 == 0) {
        uVar10 = (uint)*(ushort *)(param_1 + 2 + uVar8 * 4);
        iVar4 = *(int *)(in_EAX + 0x16b4);
        if ((int)(0x10 - uVar10) < iVar4) {
          uVar1 = *(ushort *)(param_1 + uVar8 * 4);
          *(ushort *)(in_EAX + 0x16b0) =
               *(ushort *)(in_EAX + 0x16b0) | uVar1 << ((byte)iVar4 & 0x1f);
          *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
               *(undefined1 *)(in_EAX + 0x16b0);
          iVar6 = *(int *)(in_EAX + 0x14) + 1;
          *(int *)(in_EAX + 0x14) = iVar6;
          *(undefined1 *)(iVar6 + *(int *)(in_EAX + 8)) = *(undefined1 *)(in_EAX + 0x16b1);
          iVar6 = *(int *)(in_EAX + 0x16b4);
          *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
          *(uint *)(in_EAX + 0x16b4) = iVar6 + -0x10 + uVar10;
          *(ushort *)(in_EAX + 0x16b0) = uVar1 >> (0x10U - (char)iVar6 & 0x1f);
        }
        else {
          *(ushort *)(in_EAX + 0x16b0) =
               *(ushort *)(in_EAX + 0x16b0) |
               *(short *)(param_1 + uVar8 * 4) << ((byte)iVar4 & 0x1f);
          iVar4 = iVar4 + uVar10;
LAB_004dbee1:
          *(int *)(in_EAX + 0x16b4) = iVar4;
        }
      }
      else {
        uVar7 = (uint)(byte)(&DAT_00543680)[uVar8];
        uVar5 = (uint)*(ushort *)(param_1 + 0x406 + uVar7 * 4);
        bVar2 = (byte)*(int *)(in_EAX + 0x16b4);
        if ((int)(0x10 - uVar5) < *(int *)(in_EAX + 0x16b4)) {
          uVar1 = *(ushort *)(param_1 + 0x404 + uVar7 * 4);
          *(ushort *)(in_EAX + 0x16b0) = *(ushort *)(in_EAX + 0x16b0) | uVar1 << (bVar2 & 0x1f);
          *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
               *(undefined1 *)(in_EAX + 0x16b0);
          iVar6 = *(int *)(in_EAX + 0x14) + 1;
          *(int *)(in_EAX + 0x14) = iVar6;
          *(undefined1 *)(iVar6 + *(int *)(in_EAX + 8)) = *(undefined1 *)(in_EAX + 0x16b1);
          iVar6 = *(int *)(in_EAX + 0x16b4);
          *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
          *(uint *)(in_EAX + 0x16b4) = iVar6 + -0x10 + uVar5;
          *(ushort *)(in_EAX + 0x16b0) = uVar1 >> (0x10U - (char)iVar6 & 0x1f);
        }
        else {
          *(ushort *)(in_EAX + 0x16b0) =
               *(ushort *)(in_EAX + 0x16b0) |
               *(short *)(param_1 + 0x404 + uVar7 * 4) << (bVar2 & 0x1f);
          *(uint *)(in_EAX + 0x16b4) = *(int *)(in_EAX + 0x16b4) + uVar5;
        }
        iVar6 = *(int *)(&DAT_00542e38 + uVar7 * 4);
        if (iVar6 != 0) {
          iVar9 = uVar8 - *(int *)(&DAT_00543780 + uVar7 * 4);
          iVar4 = *(int *)(in_EAX + 0x16b4);
          if (0x10 - iVar6 < iVar4) {
            *(ushort *)(in_EAX + 0x16b0) =
                 *(ushort *)(in_EAX + 0x16b0) | (ushort)(iVar9 << ((byte)iVar4 & 0x1f));
            *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
                 *(undefined1 *)(in_EAX + 0x16b0);
            iVar4 = *(int *)(in_EAX + 0x14) + 1;
            *(int *)(in_EAX + 0x14) = iVar4;
            *(undefined1 *)(iVar4 + *(int *)(in_EAX + 8)) = *(undefined1 *)(in_EAX + 0x16b1);
            iVar4 = *(int *)(in_EAX + 0x16b4);
            *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
            *(int *)(in_EAX + 0x16b4) = iVar4 + -0x10 + iVar6;
            *(ushort *)(in_EAX + 0x16b0) = (ushort)iVar9 >> (0x10U - (char)iVar4 & 0x1f);
          }
          else {
            *(ushort *)(in_EAX + 0x16b0) =
                 *(ushort *)(in_EAX + 0x16b0) | (ushort)(iVar9 << ((byte)iVar4 & 0x1f));
            *(int *)(in_EAX + 0x16b4) = iVar4 + iVar6;
          }
        }
        uVar8 = uVar10 - 1;
        if (uVar8 < 0x100) {
          bVar2 = (&DAT_0054347f)[uVar10];
        }
        else {
          bVar2 = (&DAT_00543580)[uVar8 >> 7];
        }
        uVar10 = (uint)bVar2;
        uVar5 = (uint)*(ushort *)(param_2 + 2 + uVar10 * 4);
        iVar6 = *(int *)(in_EAX + 0x16b4);
        if ((int)(0x10 - uVar5) < iVar6) {
          uVar1 = *(ushort *)(param_2 + uVar10 * 4);
          *(ushort *)(in_EAX + 0x16b0) =
               *(ushort *)(in_EAX + 0x16b0) | uVar1 << ((byte)iVar6 & 0x1f);
          *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
               *(undefined1 *)(in_EAX + 0x16b0);
          iVar6 = *(int *)(in_EAX + 0x14) + 1;
          *(int *)(in_EAX + 0x14) = iVar6;
          *(undefined1 *)(iVar6 + *(int *)(in_EAX + 8)) = *(undefined1 *)(in_EAX + 0x16b1);
          iVar6 = *(int *)(in_EAX + 0x16b4);
          *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
          *(uint *)(in_EAX + 0x16b4) = iVar6 + -0x10 + uVar5;
          *(ushort *)(in_EAX + 0x16b0) = uVar1 >> (0x10U - (char)iVar6 & 0x1f);
        }
        else {
          *(ushort *)(in_EAX + 0x16b0) =
               *(ushort *)(in_EAX + 0x16b0) |
               *(short *)(param_2 + uVar10 * 4) << ((byte)iVar6 & 0x1f);
          *(uint *)(in_EAX + 0x16b4) = iVar6 + uVar5;
        }
        iVar6 = *(int *)(&DAT_00542eb0 + uVar10 * 4);
        if (iVar6 != 0) {
          iVar9 = uVar8 - *(int *)(&DAT_005437f8 + uVar10 * 4);
          iVar4 = *(int *)(in_EAX + 0x16b4);
          if (iVar4 <= 0x10 - iVar6) {
            *(ushort *)(in_EAX + 0x16b0) =
                 *(ushort *)(in_EAX + 0x16b0) | (ushort)(iVar9 << ((byte)iVar4 & 0x1f));
            iVar4 = iVar4 + iVar6;
            goto LAB_004dbee1;
          }
          *(ushort *)(in_EAX + 0x16b0) =
               *(ushort *)(in_EAX + 0x16b0) | (ushort)(iVar9 << ((byte)iVar4 & 0x1f));
          *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) =
               *(undefined1 *)(in_EAX + 0x16b0);
          iVar4 = *(int *)(in_EAX + 0x14) + 1;
          *(int *)(in_EAX + 0x14) = iVar4;
          *(undefined1 *)(iVar4 + *(int *)(in_EAX + 8)) = *(undefined1 *)(in_EAX + 0x16b1);
          iVar4 = *(int *)(in_EAX + 0x16b4);
          *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
          *(int *)(in_EAX + 0x16b4) = iVar4 + -0x10 + iVar6;
          *(ushort *)(in_EAX + 0x16b0) = (ushort)iVar9 >> (0x10U - (char)iVar4 & 0x1f);
        }
      }
    } while (uVar3 < *(uint *)(in_EAX + 0x1698));
  }
  uVar3 = (uint)*(ushort *)(param_1 + 0x402);
  iVar6 = *(int *)(in_EAX + 0x16b4);
  if (iVar6 <= (int)(0x10 - uVar3)) {
    *(ushort *)(in_EAX + 0x16b0) =
         *(ushort *)(in_EAX + 0x16b0) | *(short *)(param_1 + 0x400) << ((byte)iVar6 & 0x1f);
    *(uint *)(in_EAX + 0x16b4) = iVar6 + uVar3;
    *(uint *)(in_EAX + 0x16ac) = (uint)*(ushort *)(param_1 + 0x402);
    return;
  }
  uVar1 = *(ushort *)(param_1 + 0x400);
  *(ushort *)(in_EAX + 0x16b0) = *(ushort *)(in_EAX + 0x16b0) | uVar1 << ((byte)iVar6 & 0x1f);
  *(undefined1 *)(*(int *)(in_EAX + 8) + *(int *)(in_EAX + 0x14)) = *(undefined1 *)(in_EAX + 0x16b0)
  ;
  iVar6 = *(int *)(in_EAX + 0x14) + 1;
  *(int *)(in_EAX + 0x14) = iVar6;
  *(undefined1 *)(iVar6 + *(int *)(in_EAX + 8)) = *(undefined1 *)(in_EAX + 0x16b1);
  iVar6 = *(int *)(in_EAX + 0x16b4);
  *(int *)(in_EAX + 0x14) = *(int *)(in_EAX + 0x14) + 1;
  *(uint *)(in_EAX + 0x16b4) = iVar6 + -0x10 + uVar3;
  *(ushort *)(in_EAX + 0x16b0) = uVar1 >> (0x10U - (char)iVar6 & 0x1f);
  *(uint *)(in_EAX + 0x16ac) = (uint)*(ushort *)(param_1 + 0x402);
  return;
}


