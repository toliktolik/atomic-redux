/*
 * Function: Crypto_Decrypt
 * Address: 004e2ad0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl Crypto_Decrypt(int param_1,int param_2,int *param_3,int param_4)

{
  byte *pbVar1;
  byte *pbVar2;
  byte bVar3;
  int iVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  byte *pbVar14;
  int iVar15;
  uint uVar16;
  int iVar17;
  char *pcVar18;
  int local_c;
  int *local_8;
  
  iVar4 = *(int *)(param_1 + 0x1a8);
  piVar5 = *(int **)(iVar4 + 0x18);
  iVar6 = *(int *)(param_1 + 0x5c);
  iVar7 = *piVar5;
  iVar8 = piVar5[1];
  iVar9 = piVar5[2];
  if (0 < param_4) {
    local_8 = param_3;
    local_c = param_4;
    do {
      pbVar14 = *(byte **)((param_2 - (int)param_3) + (int)local_8);
      iVar10 = *(int *)(iVar4 + 0x30);
      pcVar18 = (char *)*local_8;
      iVar11 = *(int *)(iVar4 + 0x3c);
      iVar12 = *(int *)(iVar4 + 0x38);
      iVar15 = iVar10 * 0x40;
      iVar13 = *(int *)(iVar4 + 0x34);
      uVar16 = 0;
      for (iVar17 = iVar6; iVar17 != 0; iVar17 = iVar17 + -1) {
        bVar3 = *pbVar14;
        pbVar1 = pbVar14 + 1;
        pbVar2 = pbVar14 + 2;
        pbVar14 = pbVar14 + 3;
        *pcVar18 = *(char *)(*(int *)(iVar13 + iVar15 + uVar16 * 4) + (uint)bVar3 + iVar7) +
                   *(char *)(*(int *)(iVar12 + iVar15 + uVar16 * 4) + (uint)*pbVar1 + iVar8) +
                   *(char *)(*(int *)(iVar11 + iVar15 + uVar16 * 4) + (uint)*pbVar2 + iVar9);
        pcVar18 = pcVar18 + 1;
        uVar16 = uVar16 + 1 & 0xf;
      }
      *(uint *)(iVar4 + 0x30) = iVar10 + 1U & 0xf;
      local_8 = local_8 + 1;
      local_c = local_c + -1;
    } while (local_c != 0);
  }
  return;
}


