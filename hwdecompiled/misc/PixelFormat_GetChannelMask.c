/*
 * Function: PixelFormat_GetChannelMask
 * Address: 004c0780
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl PixelFormat_GetChannelMask(int *param_1,int param_2,int param_3)

{
  int *piVar1;
  int *piVar2;
  byte bVar3;
  int *piVar4;
  undefined1 *puVar5;
  undefined1 *puVar6;
  byte *pbVar7;
  int iVar8;
  char *pcVar9;
  ushort uVar10;
  byte *pbVar11;
  
  piVar2 = param_1;
  piVar1 = (int *)*param_1;
  if ((char)param_1[2] == '\0') {
    if (param_3 == 0) {
      uVar10 = 0;
    }
    else {
      uVar10 = *(ushort *)(param_3 + 8);
    }
    bVar3 = *(byte *)((int)param_1 + 9);
    if (bVar3 < 8) {
      if (bVar3 == 1) {
        uVar10 = uVar10 * 0xff;
        pcVar9 = (char *)((int)piVar1 + param_2 + -1);
        pbVar7 = (byte *)(((int)piVar1 - 1U >> 3) + param_2);
        iVar8 = 7 - ((int)piVar1 - 1U & 7);
        for (piVar4 = piVar1; piVar4 != (int *)0x0; piVar4 = (int *)((int)piVar4 + -1)) {
          *pcVar9 = -((*pbVar7 >> ((byte)iVar8 & 0x1f) & 1) != 0);
          if (iVar8 == 7) {
            iVar8 = 0;
            pbVar7 = pbVar7 + -1;
          }
          else {
            iVar8 = iVar8 + 1;
          }
          pcVar9 = pcVar9 + -1;
        }
      }
      else if (bVar3 == 2) {
        uVar10 = uVar10 * 0x55;
        pbVar11 = (byte *)(((int)piVar1 - 1U >> 2) + param_2);
        pbVar7 = (byte *)((int)piVar1 + param_2 + -1);
        iVar8 = (3 - ((int)piVar1 - 1U & 3)) * 2;
        for (piVar4 = piVar1; piVar4 != (int *)0x0; piVar4 = (int *)((int)piVar4 + -1)) {
          bVar3 = *pbVar11 >> ((byte)iVar8 & 0x1f) & 3;
          *pbVar7 = ((bVar3 << 2 | bVar3) << 2 | bVar3) << 2 | bVar3;
          if (iVar8 == 6) {
            iVar8 = 0;
            pbVar11 = pbVar11 + -1;
          }
          else {
            iVar8 = iVar8 + 2;
          }
          pbVar7 = pbVar7 + -1;
        }
      }
      else if (bVar3 == 4) {
        uVar10 = uVar10 * 0x11;
        pbVar11 = (byte *)(((int)piVar1 - 1U >> 1) + param_2);
        pbVar7 = (byte *)((int)piVar1 + param_2 + -1);
        iVar8 = ((int)piVar1 - 1U & 1) * -4 + 4;
        for (piVar4 = piVar1; piVar4 != (int *)0x0; piVar4 = (int *)((int)piVar4 + -1)) {
          bVar3 = *pbVar11 >> ((byte)iVar8 & 0x1f) & 0xf;
          *pbVar7 = bVar3 << 4 | bVar3;
          if (iVar8 == 4) {
            iVar8 = 0;
            pbVar11 = pbVar11 + -1;
          }
          else {
            iVar8 = 4;
          }
          pbVar7 = pbVar7 + -1;
        }
      }
      *(undefined1 *)((int)param_1 + 9) = 8;
      *(undefined1 *)((int)param_1 + 0xb) = 8;
      param_1[1] = (int)piVar1;
    }
    if (param_3 == 0) {
      return;
    }
    if (*(char *)((int)param_1 + 9) == '\b') {
      pbVar7 = (byte *)((int)piVar1 + param_2 + -1);
      puVar5 = (undefined1 *)(param_2 + -1 + (int)piVar1 * 2);
      piVar4 = piVar1;
      if (piVar1 != (int *)0x0) {
        do {
          param_1 = piVar4;
          if (*pbVar7 == uVar10) {
            *puVar5 = 0;
          }
          else {
            *puVar5 = 0xff;
          }
          puVar5[-1] = *pbVar7;
          puVar5 = puVar5 + -2;
          pbVar7 = pbVar7 + -1;
          piVar4 = (int *)((int)param_1 + -1);
        } while ((int *)((int)param_1 + -1) != (int *)0x0);
        *(undefined1 *)(piVar2 + 2) = 4;
        *(undefined1 *)((int)piVar2 + 10) = 2;
        bVar3 = *(char *)((int)piVar2 + 9) << 1;
        goto LAB_004c0b17;
      }
    }
    else if (*(char *)((int)param_1 + 9) == '\x10') {
      puVar5 = (undefined1 *)(param_1[1] + -1 + param_2);
      puVar6 = (undefined1 *)(param_2 + -1 + param_1[1] * 2);
      for (piVar4 = piVar1; piVar4 != (int *)0x0; piVar4 = (int *)((int)piVar4 + -1)) {
        if (CONCAT11(puVar5[-1],*puVar5) == uVar10) {
          *puVar6 = 0;
          puVar6[-1] = 0;
        }
        else {
          *puVar6 = 0xff;
          puVar6[-1] = 0xff;
        }
        puVar6[-2] = *puVar5;
        puVar6[-3] = puVar5[-1];
        puVar6 = puVar6 + -4;
        puVar5 = puVar5 + -2;
      }
    }
    *(undefined1 *)(param_1 + 2) = 4;
    *(undefined1 *)((int)param_1 + 10) = 2;
    bVar3 = *(char *)((int)param_1 + 9) << 1;
  }
  else {
    if ((char)param_1[2] != '\x02') {
      return;
    }
    if (param_3 == 0) {
      return;
    }
    if (*(char *)((int)param_1 + 9) == '\b') {
      pbVar7 = (byte *)(param_1[1] + -1 + param_2);
      puVar5 = (undefined1 *)(param_2 + -1 + (int)piVar1 * 4);
      for (piVar4 = piVar1; piVar4 != (int *)0x0; piVar4 = (int *)((int)piVar4 + -1)) {
        if ((((ushort)pbVar7[-2] == *(ushort *)(param_3 + 2)) &&
            ((ushort)pbVar7[-1] == *(ushort *)(param_3 + 4))) &&
           ((ushort)*pbVar7 == *(ushort *)(param_3 + 6))) {
          *puVar5 = 0;
        }
        else {
          *puVar5 = 0xff;
        }
        puVar5[-1] = *pbVar7;
        puVar5[-2] = pbVar7[-1];
        puVar5[-3] = pbVar7[-2];
        puVar5 = puVar5 + -4;
        pbVar7 = pbVar7 + -3;
      }
    }
    else if (*(char *)((int)param_1 + 9) == '\x10') {
      puVar5 = (undefined1 *)(param_1[1] + -1 + param_2);
      puVar6 = (undefined1 *)(param_2 + -1 + (int)piVar1 * 8);
      for (piVar4 = piVar1; piVar4 != (int *)0x0; piVar4 = (int *)((int)piVar4 + -1)) {
        if (((CONCAT11(puVar5[-5],puVar5[-4]) == *(short *)(param_3 + 2)) &&
            (CONCAT11(puVar5[-3],puVar5[-2]) == *(short *)(param_3 + 4))) &&
           (CONCAT11(puVar5[-1],*puVar5) == *(short *)(param_3 + 6))) {
          *puVar6 = 0;
          puVar6[-1] = 0;
        }
        else {
          *puVar6 = 0xff;
          puVar6[-1] = 0xff;
        }
        puVar6[-2] = *puVar5;
        puVar6[-3] = puVar5[-1];
        puVar6[-4] = puVar5[-2];
        puVar6[-5] = puVar5[-3];
        puVar6[-6] = puVar5[-4];
        puVar6[-7] = puVar5[-5];
        puVar6 = puVar6 + -8;
        puVar5 = puVar5 + -6;
      }
    }
    *(undefined1 *)(param_1 + 2) = 6;
    *(undefined1 *)((int)param_1 + 10) = 4;
    bVar3 = *(char *)((int)param_1 + 9) << 2;
  }
LAB_004c0b17:
  *(byte *)((int)piVar2 + 0xb) = bVar3;
  piVar2[1] = (uint)bVar3 * (int)piVar1 >> 3;
  return;
}


