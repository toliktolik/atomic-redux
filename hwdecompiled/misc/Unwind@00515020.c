/*
 * Function: Unwind@00515020
 * Address: 00515020
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x0051502c) overlaps instruction at (ram,0x00515028)
    */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Removing unreachable block (ram,0x00515104) */
/* WARNING: Removing unreachable block (ram,0x0051510e) */
/* WARNING: Removing unreachable block (ram,0x00515195) */
/* WARNING: Removing unreachable block (ram,0x0051511f) */
/* WARNING: Removing unreachable block (ram,0x0051512d) */
/* WARNING: Removing unreachable block (ram,0x0051502c) */
/* WARNING: Removing unreachable block (ram,0x00515085) */
/* WARNING: Removing unreachable block (ram,0x00515155) */
/* WARNING: Removing unreachable block (ram,0x00515083) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined1  [10] __fastcall Unwind_00515020(undefined4 param_1,uint param_2)

{
  uint uVar1;
  uint uVar2;
  byte bVar3;
  undefined1 uVar4;
  ushort uVar5;
  int *in_EAX;
  uint uVar6;
  int *piVar7;
  byte bVar8;
  int extraout_ECX;
  int iVar9;
  uint extraout_EDX;
  uint *unaff_EBX;
  int iVar10;
  uint unaff_EBP;
  int unaff_ESI;
  uint uVar11;
  uint *unaff_EDI;
  uint *puVar12;
  undefined2 uVar13;
  undefined2 in_SS;
  bool bVar14;
  bool bVar15;
  char cVar16;
  undefined1 auVar17 [10];
  unkbyte10 Var18;
  undefined4 uStack_d;
  undefined4 uStack_9;
  undefined1 uStack_5;
  undefined1 uStack_4;
  undefined1 uStack_3;
  undefined1 uStack_2;
  undefined1 uStack_1;
  
  uVar11 = unaff_ESI + *in_EAX;
  uVar6 = (uint)in_EAX & 0x7de6697d;
  uStack_3 = (undefined1)((uint)unaff_EDI >> 8);
  uStack_2 = (undefined1)((uint)unaff_EDI >> 0x10);
  uStack_1 = (undefined1)((uint)unaff_EDI >> 0x18);
  uVar5 = (ushort)(byte)((char)uVar6 + (char)(uVar6 >> 8) * -0x2d);
  uVar6 = CONCAT22((short)(uVar6 >> 0x10),uVar5);
  auVar17 = (undefined1  [10])from_bcd(*(unkbyte10 *)((int)unaff_EDI + -0x3a7e05d3));
  uVar13 = SUB42(unaff_EDI,0);
  if ((POPCOUNT(uVar5) & 1U) != 0) {
    return auVar17;
  }
  *unaff_EDI = uVar6;
  Var18 = *(unkbyte10 *)(unaff_EBP + 0x371d9219);
  bVar14 = _DAT_9f09b811 < param_2;
  _DAT_9f09b811 = _DAT_9f09b811 - param_2;
  uVar1 = (uint)bVar14;
  uVar2 = uVar6 + 0xa9f5c9ba;
  bVar14 = 0x560a3645 < uVar6 || CARRY4(uVar2,uVar1);
  piVar7 = (int *)(uVar2 + uVar1);
  puVar12 = unaff_EDI + 1;
  if (0x560a3645 >= uVar6 && !CARRY4(uVar2,uVar1)) {
    while( true ) {
      cVar16 = '\x01';
      in(0x3b);
      uStack_5 = (undefined1)in_SS;
      uStack_4 = (undefined1)((ushort)in_SS >> 8);
      uVar6 = in((short)param_2);
      *puVar12 = uVar6;
      uStack_9 = 0x5150d4;
      uVar4 = func_0x4d7a6705();
      unaff_EBX = (uint *)((int)unaff_EBX + 1);
      out(0x14,uVar4);
      if ((POPCOUNT((uint)unaff_EBX & 0xff) & 1U) != 0) break;
      unaff_EBP = CONCAT13(uStack_2,CONCAT12(uStack_3,CONCAT11(uStack_4,uStack_5)));
      uStack_3 = (undefined1)((uint)unaff_EBX >> 0x10);
      uStack_2 = (undefined1)((uint)unaff_EBX >> 0x18);
      param_2 = extraout_EDX;
      puVar12 = unaff_EBX;
    }
    iVar10 = CONCAT22((short)((uint)&uStack_9 >> 0x10),uVar13);
    iVar9 = (CONCAT31((int3)((uint)extraout_ECX >> 8),
                      ((char)extraout_ECX - *(char *)(extraout_ECX + 0x16)) - cVar16) + 1) * 2;
    bVar8 = (byte)iVar9;
    paddsw((longlong)Var18,*(undefined8 *)((int)puVar12 + 0x1abc3d7e));
    *(undefined4 *)(iVar10 + -4) = 0xe40a6917;
    *(uint *)(iVar10 + -8) =
         CONCAT31((int3)((uint)iVar9 >> 8),bVar8 >> (bVar8 & 7) | bVar8 << 8 - (bVar8 & 7));
    *(uint *)(iVar10 + -0xc) = extraout_EDX;
    *(uint *)(iVar10 + -0x10) =
         CONCAT22((short)((uint)unaff_EBX >> 0x10),
                  CONCAT11((char)((uint)unaff_EBX >> 8) + (char)unaff_EBX,(char)unaff_EBX));
    *(int *)(iVar10 + -0x14) = iVar10;
    *(uint *)(iVar10 + -0x18) = unaff_EBP;
    *(undefined4 *)(iVar10 + -0x1c) = uStack_d;
    *(uint **)(iVar10 + -0x20) = puVar12 + 1;
    do {
    } while( true );
  }
  do {
    bVar3 = (byte)piVar7 + 9;
    bVar15 = (byte)piVar7 < 0xf7 || bVar3 < bVar14;
    bVar3 = bVar3 - bVar14;
    bVar14 = CARRY1(DAT_fde9c80c,bVar3);
    bVar8 = DAT_fde9c80c + bVar3;
    DAT_fde9c80c = bVar8 + bVar15;
    uVar6 = (uint)(bVar14 || CARRY1(bVar8,bVar15));
    bVar15 = CARRY4(unaff_EBP,uVar11);
    uVar1 = unaff_EBP + uVar11;
    bVar14 = bVar15 || CARRY4(uVar1,uVar6);
    unaff_EBP = uVar1 + uVar6;
    uVar4 = in(0x26);
    piVar7 = (int *)CONCAT31((int3)((uint)(CONCAT31((int3)((uint)piVar7 >> 8),bVar3) + -1) >> 8),
                             uVar4);
  } while ((!bVar15 && !CARRY4(uVar1,uVar6)) && unaff_EBP != 0);
  *piVar7 = *piVar7 + 1;
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}


