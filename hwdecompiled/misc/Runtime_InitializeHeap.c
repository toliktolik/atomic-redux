/*
 * Function: Runtime_InitializeHeap
 * Address: 004f8515
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void Runtime_InitializeHeap(void)

{
  undefined4 *puVar1;
  uint uVar2;
  int iVar3;
  undefined2 extraout_DX;
  undefined4 extraout_EDX;
  int unaff_EBP;
  byte *pbVar4;
  undefined8 uVar5;
  undefined4 *in_stack_ffffffd8;
  undefined4 *in_stack_ffffffdc;
  
  Assembly_BitShiftLocking();
  uVar2 = DAT_00569f5c ^ *(uint *)(unaff_EBP + 4);
  *(undefined4 *)(unaff_EBP + -0x18) = DAT_00546d84;
  *(uint *)(unaff_EBP + -0x10) = uVar2;
  *(undefined1 *)(unaff_EBP + -0x14) = DAT_00546d88;
  String_Initialize(unaff_EBP + -0x34);
  *(undefined4 *)(unaff_EBP + -4) = 0;
  if (*(char *)(unaff_EBP + 0x24) == '\0') {
    *(undefined1 *)(unaff_EBP + -0x16) = *(undefined1 *)(unaff_EBP + 0x20);
  }
  else {
    *(char *)(unaff_EBP + -0x16) = *(char *)(unaff_EBP + 0x24);
    *(undefined1 *)(unaff_EBP + -0x15) = *(undefined1 *)(unaff_EBP + 0x20);
  }
  uVar2 = 0x10;
  while( true ) {
    Memory_AllocateSound((_String_base *)(unaff_EBP + -0x34),uVar2,(_String_base)0x0);
    iVar3 = *(int *)(unaff_EBP + -0x30);
    if (*(uint *)(unaff_EBP + -0x1c) < 0x10) {
      iVar3 = unaff_EBP + -0x30;
    }
    uVar5 = Assembly_ParityFlagCheck(iVar3,extraout_DX);
    if ((int)uVar5 != 0) break;
    uVar2 = uVar2 * 2;
  }
  pbVar4 = *(byte **)(unaff_EBP + -0x30);
  if (*(uint *)(unaff_EBP + -0x1c) < 0x10) {
    pbVar4 = (byte *)(unaff_EBP + -0x30);
  }
  while( true ) {
    iVar3 = (int)uVar5 + -1;
    if (iVar3 == 0) break;
    pbVar4 = pbVar4 + 1;
    Character_OutputValidator((void *)(unaff_EBP + 0xc),*pbVar4);
    uVar5 = CONCAT44(extraout_EDX,iVar3);
  }
  puVar1 = *(undefined4 **)(unaff_EBP + 8);
  *puVar1 = *(undefined4 *)(unaff_EBP + 0xc);
  puVar1[1] = *(undefined4 *)(unaff_EBP + 0x10);
  String_Reset(unaff_EBP + -0x34,(uint)((ulonglong)uVar5 >> 0x20),'\x01');
  ExceptionList = *(void **)(unaff_EBP + -0xc);
  Exception_SetMessage
            ((void *)(*(uint *)(unaff_EBP + -0x10) ^ *(uint *)(unaff_EBP + 4)),in_stack_ffffffd8,
             in_stack_ffffffdc);
  return;
}


