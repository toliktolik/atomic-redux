/*
 * Function: Unwind@00515cfb
 * Address: 00515cfb
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Removing unreachable block (ram,0x00515c53) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall Unwind_00515cfb(int param_1,short param_2)

{
  byte bVar1;
  byte bVar2;
  byte *in_EAX;
  byte *pbVar3;
  uint uVar4;
  int iVar5;
  uint *unaff_EBX;
  int unaff_EBP;
  uint unaff_ESI;
  byte *unaff_EDI;
  undefined2 in_SS;
  byte in_AF;
  float10 in_ST0;
  
  while( true ) {
    pbVar3 = in_EAX;
    iVar5 = CONCAT22((short)((uint)param_1 >> 0x10),CONCAT11(0x95,(byte)param_1));
    *unaff_EBX = *unaff_EBX ^ (uint)unaff_EBX;
    if (-1 < (int)*unaff_EBX) break;
    *(int *)unaff_EDI = *(int *)unaff_EDI << 1;
    *(double *)(pbVar3 + 0x62) = (double)in_ST0;
    unaff_EDI[0x71c55f10] = unaff_EDI[0x71c55f10] + 1;
    in_ST0 = (float10)*(short *)((int)unaff_EBX + -0x5d);
    in(param_2);
    *(uint *)(unaff_ESI - 0x1f) = *(uint *)(unaff_ESI - 0x1f) | unaff_ESI;
    uVar4 = in(param_2);
    in_EAX = (byte *)(uVar4 ^ 0x54);
    param_2 = param_2 + 1;
    param_1 = iVar5 + -2;
    unaff_EDI = pbVar3;
    if (param_1 == 0) {
      iVar5 = *(int *)in_EAX;
      out(0x58,(char)in_EAX);
      bVar1 = in(param_2);
      *pbVar3 = bVar1;
      *(undefined4 *)(pbVar3 + 1) =
           *(undefined4 *)CONCAT22((short)(unaff_ESI >> 0x10),(short)in_EAX);
      *(char *)(unaff_EBP + -0x7c) = *(char *)(unaff_EBP + -0x7c) + (char)unaff_EBX + (iVar5 != 0);
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
  }
  bVar1 = 9 < ((byte)pbVar3 & 0xf) | in_AF;
  bVar2 = (byte)pbVar3 + bVar1 * -6;
  *unaff_EDI = *unaff_EDI & (byte)param_1;
  uVar4 = CONCAT31((int3)((uint)pbVar3 >> 8),bVar2 + (0x9f < bVar2 | bVar1 * (bVar2 < 6)) * -0x60) ^
          0x162a6309;
  if (uVar4 == 0) {
    if (iVar5 != 1 && ((uint)unaff_EBX & unaff_ESI - 1) == 0) {
      *(undefined2 *)(unaff_EBX + -1) = in_SS;
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    out(*(undefined1 *)(unaff_ESI - 1),param_2);
    *(int *)(iVar5 + 0x79) = unaff_EBP;
    return;
  }
  uVar4 = uVar4 - 1;
  *unaff_EDI = (byte)uVar4;
  if ((POPCOUNT(uVar4 & 0xff) & 1U) == 0) {
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  bVar1 = *(byte *)((int)unaff_EBX + (uVar4 & 0xff));
  *(byte *)(unaff_ESI + 0x5301ddb7) = *(byte *)(unaff_ESI + 0x5301ddb7) & bVar1;
  out(1,bVar1);
  do {
                    /* WARNING: Do nothing block with infinite loop */
  } while( true );
}


