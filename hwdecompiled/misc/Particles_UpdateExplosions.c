/*
 * Function: Particles_UpdateExplosions
 * Address: 0041a160
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall Particles_UpdateExplosions(void *param_1)

{
  double dVar1;
  int iVar2;
  int iVar3;
  void *this;
  undefined4 *extraout_ECX;
  undefined4 *puVar4;
  uint extraout_EDX;
  uint uVar5;
  int *piVar6;
  ulonglong uVar7;
  void *local_10;
  undefined4 uStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  uStack_c = 0x51028b;
  local_10 = ExceptionList;
  if (*(int *)((int)param_1 + 0x30c) != 0) {
    ExceptionList = &local_10;
    (**(code **)(**(int **)((int)param_1 + 0x5c) + 0xb8))(0x15,0);
    ExceptionList = local_10;
    return;
  }
  if ((*(int *)((int)param_1 + 0x2e4) != 0) && (*(char *)((int)param_1 + 0x1e0) != '\0')) {
    ExceptionList = &local_10;
    (**(code **)(**(int **)((int)param_1 + 0x5c) + 0xb8))(0x15,0);
    ExceptionList = local_10;
    return;
  }
  iVar2 = *(int *)((int)param_1 + 0x314);
  ExceptionList = &local_10;
  if ((iVar2 != 0) &&
     ((ExceptionList = &local_10, *(char *)(iVar2 + 0x30) != '\0' &&
      (ExceptionList = &local_10,
      *(double *)(iVar2 + 0x18) < _DAT_0052c950 !=
      (NAN(*(double *)(iVar2 + 0x18)) || NAN(_DAT_0052c950)))))) {
    ExceptionList = &local_10;
    *(undefined1 *)(iVar2 + 0x31) = 1;
  }
  iVar2 = *(int *)((int)param_1 + 0x318);
  if (((iVar2 != 0) && (*(char *)(iVar2 + 0x30) != '\0')) &&
     (*(double *)(iVar2 + 0x18) < _DAT_0052c950 !=
      (NAN(*(double *)(iVar2 + 0x18)) || NAN(_DAT_0052c950)))) {
    *(undefined1 *)(iVar2 + 0x31) = 1;
  }
  iVar2 = *(int *)((int)param_1 + 0x31c);
  if (((iVar2 != 0) && (*(char *)(iVar2 + 0x30) != '\0')) &&
     (*(double *)(iVar2 + 0x18) < _DAT_0052c950 !=
      (NAN(*(double *)(iVar2 + 0x18)) || NAN(_DAT_0052c950)))) {
    *(undefined1 *)(iVar2 + 0x31) = 1;
  }
  iVar2 = *(int *)((int)param_1 + 800);
  if (((iVar2 != 0) && (*(char *)(iVar2 + 0x30) != '\0')) &&
     (*(double *)(iVar2 + 0x18) < _DAT_0052c950 !=
      (NAN(*(double *)(iVar2 + 0x18)) || NAN(_DAT_0052c950)))) {
    *(undefined1 *)(iVar2 + 0x31) = 1;
  }
  *(int *)(*(int *)((int)param_1 + 0x5c) + 0x968) =
       *(int *)(*(int *)((int)param_1 + 0x5c) + 0x968) + -1;
  *(undefined4 *)((int)param_1 + 0x84) = 0xfe;
  *(undefined4 *)((int)param_1 + 0x88) = 0;
  *(undefined4 *)((int)param_1 + 0x8c) = 0x406fe000;
  *(undefined4 *)((int)param_1 + 0x1f8) = *(undefined4 *)((int)param_1 + 500);
  while( true ) {
    iVar2 = *(int *)(*(int *)((int)param_1 + 0x1f8) + 4);
    if (iVar2 == 0) break;
    *(int *)((int)param_1 + 0x1f8) = iVar2;
    if (*(int *)((int)param_1 + 0x200) == 0) {
      piVar6 = (int *)0x0;
    }
    else {
      piVar6 = (int *)**(undefined4 **)((int)param_1 + 0x1f8);
    }
    if (((char)piVar6[0xe] == '\0') && ((char)piVar6[0x12] != '\0')) {
      dVar1 = *(double *)(piVar6 + 4);
      iVar2 = Boss_ProcessEyebot((int)piVar6);
      dVar1 = dVar1 - (double)(iVar2 / 2);
      if (dVar1 < _DAT_0052c958 != (NAN(dVar1) || NAN(_DAT_0052c958))) {
        if (*(int *)((int)param_1 + 0x2e4) == 0) {
          (**(code **)(*piVar6 + 0x10))();
          Boss_BattleshipCannonSystem((int)piVar6);
        }
        else {
          dVar1 = *(double *)(piVar6 + 0x16) -
                  *(double *)(piVar6 + 0x10) /
                  (double)(*(int *)(*(int *)((int)param_1 + 0x5c) + 0x960) + 5);
          *(double *)(piVar6 + 0x16) = dVar1;
          if (dVar1 < _DAT_0052a0c0 != (NAN(dVar1) || NAN(_DAT_0052a0c0))) {
            (**(code **)(*piVar6 + 0x10))();
            if (piVar6 != *(int **)((int)param_1 + 0x2e4)) {
              Boss_BattleshipCannonSystem((int)piVar6);
            }
          }
        }
      }
    }
  }
  *(undefined4 *)((int)param_1 + 0x1e8) = *(undefined4 *)((int)param_1 + 0x1e4);
  do {
    do {
      iVar2 = *(int *)(*(int *)((int)param_1 + 0x1e8) + 4);
      if (iVar2 == 0) {
        *(undefined4 *)((int)param_1 + 0x218) = *(undefined4 *)((int)param_1 + 0x214);
        do {
          do {
            iVar2 = *(int *)(*(int *)((int)param_1 + 0x218) + 4);
            if (iVar2 == 0) {
              LinkedList_ClearAllNodes((int *)((int)param_1 + 0x2b4));
              *(undefined4 *)((int)param_1 + 0x1d0) = 0;
              if (*(char *)((int)param_1 + 0x327) == '\0') {
                *(int *)((int)param_1 + 0x1b0) = *(int *)((int)param_1 + 0x184) / 6;
              }
              else {
                *(undefined4 *)((int)param_1 + 0x1b0) = 0x4b0;
              }
              (**(code **)(**(int **)((int)param_1 + 0x5c) + 0xb8))(0xc,0);
              this = operator_new(0x40);
              local_8 = 0;
              if (this != (void *)0x0) {
                Settings_ProcessVSyncOptions(this,(int)param_1);
              }
              ExceptionList = local_10;
              return;
            }
            *(int *)((int)param_1 + 0x218) = iVar2;
            if (*(int *)((int)param_1 + 0x220) == 0) {
              iVar2 = 0;
            }
            else {
              iVar2 = **(int **)((int)param_1 + 0x218);
            }
          } while (*(char *)(iVar2 + 0x41) == '\0');
          uVar7 = Math_FloatToUInt64();
          iVar3 = (int)uVar7;
          uVar7 = Math_FloatToUInt64();
          Game_DisplayScoreChange(param_1,*(int *)(iVar2 + 8),(int)uVar7,iVar3);
          iVar2 = *(int *)((int)param_1 + 0x218);
        } while (iVar2 == *(int *)((int)param_1 + 0x214));
        if (iVar2 == *(int *)((int)param_1 + 0x21c)) {
          *(undefined4 *)((int)param_1 + 0x21c) = *(undefined4 *)(iVar2 + 8);
        }
        uVar5 = *(uint *)(iVar2 + 4);
        *(uint *)(*(int *)(iVar2 + 8) + 4) = uVar5;
        iVar2 = *(int *)(*(int *)((int)param_1 + 0x218) + 4);
        if (iVar2 != 0) {
          *(undefined4 *)(iVar2 + 8) = *(undefined4 *)(*(int *)((int)param_1 + 0x218) + 8);
        }
        puVar4 = (undefined4 *)**(int **)((int)param_1 + 0x218);
        if (puVar4 != (undefined4 *)0x0) {
          (**(code **)*puVar4)(1);
          puVar4 = extraout_ECX;
          uVar5 = extraout_EDX;
        }
                    /* WARNING: Subroutine does not return */
        System_ShutdownHandler((int)puVar4,uVar5);
      }
      *(int *)((int)param_1 + 0x1e8) = iVar2;
      if (*(int *)((int)param_1 + 0x1f0) == 0) {
        iVar2 = 0;
      }
      else {
        iVar2 = **(int **)((int)param_1 + 0x1e8);
      }
    } while (*(char *)(iVar2 + 0x30) == '\0');
    uVar7 = Math_FloatToUInt64();
    iVar2 = (int)uVar7;
    uVar7 = Math_FloatToUInt64();
    Game_DisplayScoreChange(param_1,10,(int)uVar7,iVar2);
    iVar2 = *(int *)((int)param_1 + 0x1e8);
  } while (iVar2 == *(int *)((int)param_1 + 0x1e4));
  if (iVar2 == *(int *)((int)param_1 + 0x1ec)) {
    *(undefined4 *)((int)param_1 + 0x1ec) = *(undefined4 *)(iVar2 + 8);
  }
  uVar5 = *(uint *)(iVar2 + 8);
  *(undefined4 *)(uVar5 + 4) = *(undefined4 *)(iVar2 + 4);
  iVar2 = *(int *)(*(int *)((int)param_1 + 0x1e8) + 4);
  if (iVar2 != 0) {
    uVar5 = *(uint *)(*(int *)((int)param_1 + 0x1e8) + 8);
    *(uint *)(iVar2 + 8) = uVar5;
  }
  if (**(int **)((int)param_1 + 0x1e8) != 0) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(iVar2,uVar5);
  }
                    /* WARNING: Subroutine does not return */
  System_ShutdownHandler(iVar2,uVar5);
}


