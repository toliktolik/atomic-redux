/*
 * Function: Unwind@00510340
 * Address: 00510340
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Instruction at (ram,0x00510346) overlaps instruction at (ram,0x00510343)
    */
/* WARNING: Removing unreachable block (ram,0x00510336) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

float10 __fastcall Unwind_00510340(undefined4 param_1,undefined4 param_2)

{
  uint *puVar1;
  byte *pbVar2;
  uint uVar3;
  bool bVar5;
  code *pcVar6;
  byte bVar7;
  ushort uVar8;
  char cVar9;
  byte bVar13;
  undefined4 in_EAX;
  int iVar10;
  undefined2 uVar14;
  char *pcVar12;
  char *pcVar15;
  int unaff_EBP;
  undefined1 *unaff_ESI;
  undefined1 *unaff_EDI;
  byte in_CF;
  char in_PF;
  char in_AF;
  char in_ZF;
  char in_SF;
  char in_OF;
  float10 in_ST1;
  float10 extraout_ST1;
  float10 in_ST2;
  float10 in_ST3;
  float10 in_ST4;
  float10 in_ST5;
  float10 in_ST6;
  float10 in_ST7;
  undefined8 uVar16;
  uint unaff_retaddr;
  uint uVar4;
  uint uVar11;
  
  uVar16 = CONCAT44(param_2,in_EAX);
  pcVar6 = (code *)swi(4);
  if (in_OF == '\x01') {
    uVar16 = (*pcVar6)();
    in_ST1 = extraout_ST1;
  }
  while( true ) {
    pcVar15 = (char *)((ulonglong)uVar16 >> 0x20);
    iVar10 = (int)uVar16;
    uVar14 = (undefined2)((uint)unaff_EBP >> 0x10);
    bVar13 = in_SF << 7 | in_ZF << 6 | in_AF << 4 | in_PF << 2 | 2U | in_CF;
    cVar9 = ((char)unaff_EBP + '\b') - in_CF;
    uVar11 = CONCAT31((int3)(CONCAT22(uVar14,CONCAT11(bVar13,(char)unaff_EBP)) >> 8),cVar9);
    pbVar2 = unaff_ESI + iVar10 + 0x615d615b;
    *pbVar2 = *pbVar2 ^ bVar13;
    if ((POPCOUNT(*pbVar2) & 1U) == 0) {
      puVar1 = (uint *)(iVar10 + (int)pcVar15 * 4 + 10);
      *puVar1 = *puVar1 ^ uVar11;
      paddusb(SUB108(in_ST4,0),_DAT_a0272890);
      swi(4);
      return (float10)*(double *)(uVar11 + 0x8c4cdb4b);
    }
    in_AF = (bVar13 & 0x10) != 0;
    pcVar12 = (char *)CONCAT22(uVar14,CONCAT11(0x9e,cVar9));
    uVar16 = CONCAT44(pcVar15,pcVar12);
    *unaff_EDI = *unaff_ESI;
    *pcVar12 = *pcVar12 << 1;
    puVar1 = (uint *)(&stack0x00000000 + unaff_retaddr * 2);
    *puVar1 = *puVar1 & (uint)pcVar12;
    uVar11 = *puVar1;
    uVar3 = *puVar1;
    uVar4 = *puVar1;
    bVar13 = (byte)unaff_retaddr & 0x1f;
    cVar9 = *pcVar15;
    *pcVar15 = *pcVar15 >> bVar13;
    bVar5 = (unaff_retaddr & 0x1f) != 0;
    in_SF = !bVar5 && (int)uVar11 < 0 || bVar5 && *pcVar15 < '\0';
    in_ZF = !bVar5 && uVar3 == 0 || bVar5 && *pcVar15 == '\0';
    in_PF = !bVar5 && (POPCOUNT(uVar4 & 0xff) & 1U) == 0 || bVar5 && (POPCOUNT(*pcVar15) & 1U) == 0;
    if ((bVar5 || uVar3 != 0) && (!bVar5 || *pcVar15 != '\0')) break;
    bVar7 = ((byte)unaff_retaddr & 0x1f) % 9;
    uVar8 = CONCAT11((unaff_retaddr & 0x1f) != 0 && (cVar9 >> bVar13 - 1 & 1U) != 0,pcVar12[0x2c]);
    uVar8 = uVar8 >> bVar7 | uVar8 << 9 - bVar7;
    pcVar12[0x2c] = (char)uVar8;
    in_CF = (uVar8 & 0x100) != 0;
    unaff_EBP = iVar10;
    unaff_ESI = unaff_ESI + 1;
    unaff_EDI = unaff_EDI + 1;
    in_ST1 = in_ST2;
    in_ST2 = in_ST3;
    in_ST3 = in_ST4;
    in_ST4 = in_ST5;
    in_ST5 = in_ST6;
    in_ST6 = in_ST7;
  }
  return in_ST1;
}


