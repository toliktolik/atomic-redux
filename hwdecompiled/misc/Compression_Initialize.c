/*
 * Function: Compression_Initialize
 * Address: 004be3f0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl Compression_Initialize(int *param_1,byte *param_2,byte *param_3)

{
  ushort uVar1;
  int iVar2;
  byte bVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  uint uVar8;
  int iVar9;
  int local_18 [4];
  undefined4 local_8;
  
  if (*(byte *)(param_1 + 2) != 3) {
    uVar4 = (uint)*(byte *)((int)param_1 + 9);
    iVar9 = *param_1;
    local_8 = 0;
    if ((*(byte *)(param_1 + 2) & 2) == 0) {
      bVar3 = param_3[3];
      uVar8 = 1;
    }
    else {
      bVar3 = *param_3;
      local_18[1] = uVar4 - param_3[1];
      local_18[2] = uVar4 - param_3[2];
      uVar8 = 3;
    }
    iVar2 = uVar4 - bVar3;
    local_18[0] = iVar2;
    if ((*(byte *)(param_1 + 2) & 4) != 0) {
      local_18[uVar8] = uVar4 - param_3[4];
      uVar8 = uVar8 + 1;
    }
    iVar7 = 0;
    if (uVar8 != 0) {
      do {
        if (local_18[iVar7] < 1) {
          local_18[iVar7] = 0;
          iVar2 = local_18[0];
        }
        else {
          local_8 = 1;
        }
        iVar7 = iVar7 + 1;
      } while (iVar7 < (int)uVar8);
      if ((short)local_8 != 0) {
        switch(uVar4) {
        case 2:
          iVar9 = param_1[1];
          if (iVar9 != 0) {
            do {
              *param_2 = *param_2 >> 1 & 0x55;
              param_2 = param_2 + 1;
              iVar9 = iVar9 + -1;
            } while (iVar9 != 0);
            return;
          }
          break;
        case 4:
          iVar9 = param_1[1];
          bVar3 = (byte)iVar2;
          if (iVar9 != 0) {
            do {
              *param_2 = *param_2 >> (bVar3 & 0x1f) &
                         ((byte)(0xf0 >> (bVar3 & 0x1f)) & 0xf0 | (byte)(0xf >> (bVar3 & 0x1f)));
              param_2 = param_2 + 1;
              iVar9 = iVar9 + -1;
            } while (iVar9 != 0);
            return;
          }
          break;
        case 8:
          uVar4 = iVar9 * uVar8;
          uVar6 = 0;
          if (uVar4 != 0) {
            do {
              uVar5 = uVar6 % uVar8;
              uVar6 = uVar6 + 1;
              *param_2 = *param_2 >> (*(byte *)(local_18 + uVar5) & 0x1f);
              param_2 = param_2 + 1;
            } while (uVar6 < uVar4);
            return;
          }
          break;
        case 0x10:
          uVar4 = iVar9 * uVar8;
          uVar6 = 0;
          if (uVar4 != 0) {
            do {
              uVar1 = (ushort)((ushort)*param_2 * 0x100 + (ushort)param_2[1]) >>
                      ((byte)(short)local_18[uVar6 % uVar8] & 0x1f);
              uVar6 = uVar6 + 1;
              *param_2 = (byte)(uVar1 >> 8);
              param_2[1] = (byte)uVar1;
              param_2 = param_2 + 2;
            } while (uVar6 < uVar4);
          }
        }
      }
    }
  }
  return;
}


