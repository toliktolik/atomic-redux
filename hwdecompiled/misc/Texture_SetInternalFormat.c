/*
 * Function: Texture_SetInternalFormat
 * Address: 004b9980
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void * __thiscall Texture_SetInternalFormat(void *this,int param_1)

{
  ushort uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  byte extraout_DL;
  undefined4 *puVar8;
  undefined4 *puVar9;
  int iVar10;
  
  iVar2 = Graphics_SetTransform((int)this);
  iVar3 = (int)(param_1 + (param_1 >> 0x1f & 0xfU)) >> 4;
  if (0 < iVar3) {
    if (*(int *)((int)this + 0x10) <= *(int *)((int)this + 0xc) + -1 + iVar3) {
      do {
        Texture_Initialize(this);
      } while (*(int *)((int)this + 0x10) <= *(int *)((int)this + 0xc) + -1 + iVar3);
    }
    uVar5 = *(int *)((int)this + 0xc) << 1;
    puVar8 = *(undefined4 **)((int)this + 8);
    puVar9 = (undefined4 *)((int)*(undefined4 **)((int)this + 8) + iVar3 * 2);
    for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
      *puVar9 = *puVar8;
      puVar8 = puVar8 + 1;
      puVar9 = puVar9 + 1;
    }
    for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
      *(undefined1 *)puVar9 = *(undefined1 *)puVar8;
      puVar8 = (undefined4 *)((int)puVar8 + 1);
      puVar9 = (undefined4 *)((int)puVar9 + 1);
    }
    iVar7 = 0;
    if (0 < iVar3) {
      do {
        *(undefined2 *)(*(int *)((int)this + 8) + iVar7 * 2) = 0;
        iVar7 = iVar7 + 1;
      } while (iVar7 < iVar3);
    }
    *(int *)((int)this + 0xc) = *(int *)((int)this + 0xc) + iVar3;
  }
  iVar10 = 0;
  iVar7 = iVar3;
  param_1 = iVar2;
  if (0 < iVar2) {
    do {
      uVar1 = Texture_SetTarget(this,iVar7);
      iVar4 = ((uint)uVar1 << (extraout_DL & 0x1f)) + iVar10;
      iVar10 = iVar4 >> 0x10;
      Texture_GetInternalFormat(this,iVar7,(short)iVar4);
      param_1 = param_1 + -1;
      iVar7 = iVar7 + 1;
    } while (param_1 != 0);
    if (iVar10 != 0) {
      Texture_GetInternalFormat(this,iVar3 + iVar2,(short)((uint)iVar4 >> 0x10));
    }
  }
  return this;
}


