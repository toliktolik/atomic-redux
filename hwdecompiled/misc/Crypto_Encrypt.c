/*
 * Function: Crypto_Encrypt
 * Address: 004e29c0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl Crypto_Encrypt(int param_1,int param_2,undefined4 *param_3,int *param_4)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  byte *pbVar7;
  char *pcVar8;
  uint uVar9;
  uint uVar10;
  int *local_1c;
  undefined4 *local_18;
  int local_10;
  
  iVar1 = *(int *)(param_1 + 100);
  uVar2 = *(uint *)(param_1 + 0x5c);
  iVar3 = *(int *)(param_1 + 0x1a8);
  if (0 < (int)param_4) {
    local_18 = param_3;
    local_1c = param_4;
    do {
      Memory_ZeroFill((undefined4 *)*local_18,uVar2);
      iVar4 = *(int *)(iVar3 + 0x30);
      local_10 = 0;
      if (0 < iVar1) {
        param_4 = (int *)(iVar3 + 0x34);
        do {
          iVar5 = *(int *)(*(int *)(iVar3 + 0x18) + local_10 * 4);
          pcVar8 = (char *)*local_18;
          iVar6 = *param_4;
          uVar10 = 0;
          pbVar7 = (byte *)(*(int *)((param_2 - (int)param_3) + (int)local_18) + local_10);
          for (uVar9 = uVar2; uVar9 != 0; uVar9 = uVar9 - 1) {
            *pcVar8 = *pcVar8 + *(char *)(*(int *)(iVar6 + iVar4 * 0x40 + uVar10 * 4) +
                                          (uint)*pbVar7 + iVar5);
            pbVar7 = pbVar7 + iVar1;
            pcVar8 = pcVar8 + 1;
            uVar10 = uVar10 + 1 & 0xf;
          }
          local_10 = local_10 + 1;
          param_4 = param_4 + 1;
        } while (local_10 < iVar1);
      }
      local_18 = local_18 + 1;
      local_1c = (int *)((int)local_1c + -1);
      *(uint *)(iVar3 + 0x30) = iVar4 + 1U & 0xf;
    } while (local_1c != (int *)0x0);
  }
  return;
}


