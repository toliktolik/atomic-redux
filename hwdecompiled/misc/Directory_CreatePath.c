/*
 * Function: Directory_CreatePath
 * Address: 004d74f0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


undefined4 __cdecl Directory_CreatePath(int *param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  uint uVar6;
  int iVar7;
  int iVar8;
  byte local_10;
  int *local_c;
  int local_8;
  
  piVar4 = param_1;
  iVar1 = param_1[0x4e];
  iVar2 = param_1[0x57];
  *(undefined4 *)(iVar2 + 0x10) = *(undefined4 *)param_1[6];
  *(undefined4 *)(iVar2 + 0x14) = *(undefined4 *)(param_1[6] + 4);
  if ((param_1[0x2f] != 0) && (*(int *)(iVar2 + 0x44) == 0)) {
    Directory_ListFiles((char)*(undefined4 *)(iVar2 + 0x48));
  }
  local_8 = 0;
  if (0 < param_1[0x40]) {
    local_c = param_1 + 0x41;
    do {
      iVar8 = *local_c;
      iVar3 = piVar4[iVar8 + 0x3a];
      local_10 = (byte)iVar1;
      iVar7 = (int)**(short **)(param_2 + local_8 * 4) >> (local_10 & 0x1f);
      param_1 = (int *)(iVar7 - *(int *)(iVar2 + 0x24 + iVar8 * 4));
      *(int *)(iVar2 + 0x24 + iVar8 * 4) = iVar7;
      piVar5 = param_1;
      if ((int)param_1 < 0) {
        piVar5 = (int *)-(int)param_1;
        param_1 = (int *)((int)param_1 + -1);
      }
      iVar8 = 0;
      if (piVar5 != (int *)0x0) {
        do {
          piVar5 = (int *)((int)piVar5 >> 1);
          iVar8 = iVar8 + 1;
        } while (piVar5 != (int *)0x0);
        if (0xb < iVar8) {
          *(undefined4 *)(*piVar4 + 0x14) = 6;
          (**(code **)*piVar4)(piVar4);
        }
      }
      File_GetExtension(*(int *)(iVar3 + 0x14),iVar8);
      if (iVar8 != 0) {
        File_CopyFile((uint)param_1,iVar8);
      }
      local_8 = local_8 + 1;
      local_c = local_c + 1;
    } while (local_8 < piVar4[0x40]);
  }
  uVar6 = *(uint *)(iVar2 + 0x10);
  *(uint *)piVar4[6] = uVar6;
  *(undefined4 *)(piVar4[6] + 4) = *(undefined4 *)(iVar2 + 0x14);
  if (piVar4[0x2f] != 0) {
    uVar6 = *(uint *)(iVar2 + 0x44);
    if (uVar6 == 0) {
      uVar6 = *(int *)(iVar2 + 0x48) + 1U & 7;
      *(int *)(iVar2 + 0x44) = piVar4[0x2f];
      *(uint *)(iVar2 + 0x48) = uVar6;
    }
    *(int *)(iVar2 + 0x44) = *(int *)(iVar2 + 0x44) + -1;
  }
  return CONCAT31((int3)(uVar6 >> 8),1);
}


