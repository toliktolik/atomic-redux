/*
 * Function: Unwind@00510fd0
 * Address: 00510fd0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x0051126f) overlaps instruction at (ram,0x0051126e)
    */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Removing unreachable block (ram,0x005112ea) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 * __fastcall Unwind_00510fd0(uint *param_1,int param_2,undefined4 *param_3)

{
  int *piVar1;
  char *pcVar2;
  uint uVar3;
  code *pcVar4;
  ushort uVar5;
  uint in_EAX;
  undefined3 uVar10;
  uint uVar6;
  undefined4 *puVar7;
  undefined4 uVar8;
  short sVar11;
  uint uVar9;
  char cVar12;
  int iVar13;
  int extraout_ECX;
  undefined1 *extraout_ECX_00;
  uint *puVar14;
  undefined2 uVar15;
  int extraout_EDX;
  byte bVar16;
  uint *unaff_EBX;
  int iVar17;
  byte *pbVar18;
  undefined4 **ppuVar19;
  int unaff_EBP;
  uint *unaff_ESI;
  uint *puVar20;
  undefined1 *puVar21;
  uint *unaff_EDI;
  uint *puVar22;
  undefined4 *puVar23;
  undefined2 in_CS;
  undefined2 in_SS;
  byte in_AF;
  bool in_ZF;
  bool bVar24;
  bool bVar25;
  char in_SF;
  byte bVar26;
  bool in_OF;
  undefined2 in_FPUControlWord;
  undefined2 in_FPUStatusWord;
  undefined2 in_FPUTagWord;
  undefined2 in_FPULastInstructionOpcode;
  undefined4 in_FPUDataPointer;
  undefined4 in_FPUInstructionPointer;
  undefined8 uVar27;
  uint *unaff_retaddr;
  uint auStack_34 [7];
  undefined1 auStack_18 [4];
  int aiStack_14 [3];
  undefined4 *puStack_8;
  
  bVar26 = 0;
  iVar13 = unaff_EBP;
  puVar20 = unaff_ESI;
  if (in_ZF || in_OF != (bool)in_SF) {
    if (!in_OF) {
      pcVar4 = (code *)swi(1);
      puVar7 = (undefined4 *)(*pcVar4)();
      return puVar7;
    }
  }
  else {
    while( true ) {
      uVar10 = (undefined3)(in_EAX >> 8);
      unaff_EBP = CONCAT22((short)((uint)iVar13 >> 0x10),(short)CONCAT31(uVar10,(char)*puVar20));
      bVar16 = 9 < ((byte)iVar13 & 0xf) | in_AF;
      uVar6 = CONCAT31(uVar10,(byte)iVar13 + bVar16 * '\x06') & 0xffff000f;
      uVar6 = CONCAT22((short)(uVar6 >> 0x10),
                       CONCAT11((char)((uint)iVar13 >> 8) + bVar16,(char)uVar6)) ^ 0x9d7255ef;
      param_2 = param_2 - unaff_EBX[-0xe4e16e1];
      uVar5 = (short)(char)uVar6 * (short)*(char *)(uVar6 + 0x70087d84);
      puVar20 = (uint *)((int)puVar20 + (1 - *(int *)((int)unaff_EBX + 0x2fd7f182)));
      in_AF = (uVar5 & 0x1000) != 0;
      in_EAX = in((short)param_2);
      in_CS = *(undefined2 *)((int)param_1 + 0x5f);
      puVar14 = unaff_EBX;
      if ((uVar5 & 0x8000) != 0) {
        do {
          puVar22 = unaff_EDI;
          if (param_1 == (uint *)0x0) goto code_r0x0051102d;
          param_1 = (uint *)((int)param_1 + -1);
          puVar22 = unaff_EDI + 1;
          uVar6 = *unaff_EDI;
          unaff_EDI = puVar22;
          if (in_EAX == uVar6) goto code_r0x0051102d;
        } while( true );
      }
      bVar24 = (byte)((byte)unaff_EBX[-0xaaade85] & (byte)unaff_EBX) == 0;
      if (param_1 == (uint *)0x1 || bVar24) break;
      param_1 = (uint *)((int)param_1 + -2);
      iVar13 = unaff_EBP;
      if (param_1 == (uint *)0x0 || !bVar24) {
        pbVar18 = (byte *)(in_EAX - 1);
        *pbVar18 = *pbVar18 | 0x41;
        out(*puVar20,(short)param_2);
        iVar13 = CONCAT22((short)((uint)param_1 >> 0x10),CONCAT11(0xa1,(char)param_1));
        if (iVar13 == 1 || ((uint)pbVar18 & (uint)unaff_EDI) == 0) {
          LOCK();
          *(uint *)(unaff_EBP + 0x49) = _DAT_ade3a7f2 | 0x44;
          UNLOCK();
          *(undefined2 *)(iVar13 + -0x45) = in_FPUControlWord;
          *(undefined2 *)(iVar13 + -0x41) = in_FPUStatusWord;
          *(undefined2 *)(iVar13 + -0x3d) = in_FPUTagWord;
          *(undefined4 *)(iVar13 + -0x31) = in_FPUDataPointer;
          *(undefined4 *)(iVar13 + -0x39) = in_FPUInstructionPointer;
          *(undefined2 *)(iVar13 + -0x33) = in_FPULastInstructionOpcode;
          do {
                    /* WARNING: Do nothing block with infinite loop */
          } while( true );
        }
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      }
    }
    param_2 = CONCAT31((int3)((uint)param_2 >> 8),0x40);
    if (bVar24) {
      *unaff_EBX = *unaff_EBX << 0x16 | *unaff_EBX >> 10;
      bVar24 = (*unaff_EBX & 1) != 0;
      goto code_r0x0051107c;
    }
    param_1 = (uint *)((uint)unaff_EBX & *(uint *)(in_EAX - 0x79));
    unaff_ESI = (uint *)((int)puVar20 + 1);
    *(char *)unaff_EDI = (char)*puVar20;
    in_EAX = in_EAX & 0x1f5c2d1b;
    unaff_EDI = (uint *)((int)unaff_EDI + 1);
  }
  puVar20 = (uint *)((int)unaff_ESI + 1);
  in_EAX = CONCAT31((int3)(in_EAX >> 8),(char)*unaff_ESI);
  param_1 = (uint *)CONCAT31((int3)((uint)param_1 >> 8),
                             (byte)param_1 | *(byte *)((int)unaff_EDI + -0x5d2f6db5));
  while( true ) {
    puVar14 = unaff_EBX;
    puVar22 = unaff_EDI + (uint)bVar26 * -2 + 1;
code_r0x0051102d:
    puVar21 = (undefined1 *)((int)puVar20 + -1);
    *param_1 = *param_1 & (uint)&stack0x00000000;
    uVar6 = *param_1;
    pcVar2 = (char *)((int)param_1 + (int)puVar21);
    *pcVar2 = *pcVar2 << ((byte)param_1 & 0x1f);
    bVar24 = ((uint)param_1 & 0x1f) != 0;
    if ((bVar24 || uVar6 != 0) && (!bVar24 || *pcVar2 != '\0')) break;
    bVar24 = CARRY4((uint)puVar21,(uint)puVar21);
    puVar20 = (uint *)((int)puVar21 * 2);
    unaff_EBX = param_1;
    unaff_EDI = puVar22;
code_r0x0051107c:
    bVar26 = (byte)((uint)unaff_EBX >> 8);
    bVar16 = (byte)((uint)puVar14 >> 8);
    *(char *)(param_2 + 3) =
         *(char *)(param_2 + 3) + (byte)puVar14 +
         (CARRY1(bVar26,bVar16) || CARRY1(bVar26 + bVar16,bVar24));
    *(byte *)((int)puVar14 + -0x29) = *(byte *)((int)puVar14 + -0x29) | 0x31;
    pbVar18 = (byte *)((int)puVar14 + 0x452ba48e);
    bVar26 = (byte)unaff_retaddr & 7;
    *pbVar18 = *pbVar18 << bVar26 | *pbVar18 >> 8 - bVar26;
    if (((uint)unaff_retaddr & 0x1f) != 0 && (*pbVar18 & 1) != 0) {
      do {
                    /* WARNING: Do nothing block with infinite loop */
      } while( true );
    }
    bVar26 = 1;
    bVar16 = (byte)puVar14 ^ (byte)param_2;
    unaff_EBX = (uint *)CONCAT31((int3)((uint)puVar14 >> 8),bVar16);
    param_1 = unaff_retaddr;
    if (-1 < (char)bVar16) {
      *(char *)unaff_EDI = (char)in_EAX;
      uVar10 = (undefined3)(in_EAX >> 8);
      puVar7 = (undefined4 *)CONCAT31(uVar10,0xef);
      bVar24 = CARRY4((uint)unaff_EBX,*(uint *)((int)puVar7 + -0x27ed69aa));
      iVar17 = (int)unaff_EBX + *(uint *)((int)puVar7 + -0x27ed69aa);
      bVar25 = iVar17 == 0;
      iVar13 = (int)unaff_retaddr + -1;
      bVar26 = (byte)iVar13;
      if (iVar13 == 0 || bVar25) {
        iVar17 = CONCAT31(uVar10,*(undefined1 *)(iVar17 + 0xef));
        out((short)param_2,iVar17);
        _DAT_dc8fc793 = iVar17;
        *(int *)((int)unaff_EDI + -1) = iVar17;
        pbVar18 = (byte *)CONCAT31((int3)(CONCAT22((short)((uint)iVar13 >> 0x10),
                                                   CONCAT11((byte)((uint)iVar13 >> 8) |
                                                            *(byte *)(unaff_EBP + -99),bVar26)) >> 8
                                         ),bVar26 + 0x42);
        do {
          pbVar18 = (byte *)CONCAT31((int3)((uint)pbVar18 >> 8),(char)pbVar18 + -0x40);
          iVar17 = CONCAT31((int3)((uint)iVar17 >> 8),0xb9);
        } while (iVar17 == 0);
        *pbVar18 = *pbVar18 | (byte)param_2;
        *(byte **)((int)unaff_EDI + -5) = pbVar18;
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      }
      out((short)param_2,0xef);
      *(int *)((int)unaff_EDI + -1) = (int)puVar7;
      if (bVar24) {
        in_CS = 0xb69c;
        puStack_8 = (undefined4 *)0x511101;
        uVar27 = func_0xf5d6dec8();
        iVar13 = extraout_ECX;
        if (!bVar24 && !bVar25) {
          bVar26 = (byte)extraout_ECX;
          pbVar18 = (byte *)(iVar17 + 0x5f + (int)puVar20 * 2);
          cVar12 = bVar26 - *pbVar18;
          if (*pbVar18 <= bVar26 && cVar12 != '\0') {
            piVar1 = (int *)(CONCAT31((int3)(CONCAT22((short)((uint)extraout_ECX >> 0x10),
                                                      CONCAT11((char)((uint)extraout_ECX >> 8) +
                                                               (char)((ulonglong)uVar27 >> 0x28) +
                                                               bVar24,bVar26)) >> 8),cVar12) +
                            0x9e2709b);
            *piVar1 = *piVar1 + -0x1500fcf4;
            *puVar7 = *param_3;
            return param_3 + -1;
          }
          return (undefined4 *)uVar27;
        }
      }
      else {
        unaff_EDI[-0x115a7601] = unaff_EDI[-0x115a7601] << (bVar26 & 0x1f);
        uVar8 = in(0xce);
        uVar27 = CONCAT44(param_2,uVar8);
      }
      DAT_be6586a5 = (undefined1)uVar27;
      uVar6 = *puVar20;
      pbVar18 = &stack0x0000005f + (int)(puVar20 + -1) * 2;
      bVar26 = *pbVar18;
      bVar16 = (byte)((uint)iVar13 >> 8);
      *pbVar18 = *pbVar18 + bVar16;
      if (!CARRY1(bVar26,bVar16)) {
        puVar7 = (undefined4 *)(uVar6 & 0xcf837056);
        *(char *)(puVar20 + -0xc) = (char)puVar20[-0xc] + (char)iVar13;
        *(int *)((int)puVar20 + -0x73) = (int)(*(int *)((int)puVar20 + -0x73) + (int)(puVar20 + -1))
        ;
        *(undefined4 **)((int)unaff_EDI + -5) = puVar7;
        iVar13 = (int)((ulonglong)uVar27 >> 0x20) * 0x69;
        *(char *)(iVar13 + -2) = (char)iVar13;
        uVar8 = GlobalDescriptorTableRegister();
        *(undefined4 *)(iVar17 + -2) = uVar8;
        puVar20 = (uint *)((int)unaff_EDI + -0xd);
        uVar8 = in((short)((ulonglong)uVar27 >> 0x20));
        *(undefined4 *)((int)unaff_EDI + -9) = uVar8;
        puStack_8 = (undefined4 *)CONCAT22(puStack_8._2_2_,in_SS);
        bVar16 = (byte)(iVar17 + 1);
        pbVar18 = (byte *)CONCAT22((short)((uint)(iVar17 + 1) >> 0x10),CONCAT11(0xd3,bVar16));
        uVar8 = in(0xc2d8);
        pbVar18[(unaff_EBP + 1) * 2 + 0x55] = pbVar18[(unaff_EBP + 1) * 2 + 0x55] + 0xae;
        bVar26 = (byte)((uint)uVar8 >> 8);
        sVar11 = (short)((uint)uVar8 >> 0x10);
        cVar12 = bVar26 - *pbVar18;
        if (-1 < cVar12) {
          iVar13 = (int)sVar11 >> 0xf;
          if (cVar12 != '\0' && (char)*pbVar18 <= (char)bVar26) {
            *(char *)((int)puVar7 + 0x56) = *(char *)((int)puVar7 + 0x56) >> 1;
                    /* WARNING: Bad instruction - Truncating control flow here */
            halt_baddata();
          }
          uVar6 = CONCAT22(sVar11,CONCAT11(cVar12,(char)uVar8)) + *(int *)(pbVar18 + -0x29) +
                  (uint)(bVar26 < *pbVar18);
          *puVar20 = *puVar20 | 0xffffffe7;
          puVar21 = (undefined1 *)register0x00000010;
          if (-1 < (int)*puVar20) {
            pbVar18 = (byte *)CONCAT31((int3)((uint)pbVar18 >> 8),
                                       bVar16 | *(byte *)((int)&stack0x00000000 * 2 + 0x2a617254));
            puVar7 = (undefined4 *)CONCAT22((short)((uint)(unaff_EBP + 1) >> 0x10),in_CS);
            puStack_8 = (undefined4 *)((int)unaff_EDI + -0xe);
            *(char *)puVar20 = (char)uVar6;
            if (&stack0x00000000 != (undefined1 *)0x1 && (uVar6 & 0xdc) != 0) {
              pbVar18 = pbVar18 + 1;
            }
            puVar20 = (uint *)(uVar6 + 0x71d0f4cb);
            ppuVar19 = &puStack_8;
            cVar12 = '\x13';
            puVar23 = puStack_8;
            do {
              puVar23 = puVar23 + -1;
              ppuVar19 = ppuVar19 + -1;
              *ppuVar19 = (undefined4 *)*puVar23;
              cVar12 = cVar12 + -1;
            } while ('\0' < cVar12);
            bVar16 = (longlong)(int)((longlong)iVar13 * 0x44) != (longlong)iVar13 * 0x44;
            func_0x76848269();
            in(0xbd);
            bVar26 = (byte)extraout_ECX_00 & 0x1f;
            cVar12 = *(char *)puVar20;
            *(char *)puVar20 = *(char *)puVar20 << bVar26;
            bVar24 = ((uint)extraout_ECX_00 & 0x1f) != 0;
            *(byte **)pbVar18 =
                 pbVar18 + (uint)(byte)(!bVar24 & bVar16 |
                                       (bVar24 && (char)(cVar12 << bVar26 - 1) < '\0')) +
                           *(int *)pbVar18;
            puVar21 = extraout_ECX_00;
            iVar13 = extraout_EDX;
          }
          uVar15 = (undefined2)iVar13;
          uVar9 = in(uVar15);
          puVar14 = (uint *)CONCAT31((int3)((uint)puVar21 >> 8),0x60);
          uVar8 = in(uVar15);
          uVar3 = (uint)((uVar9 & 0x100) != 0);
          uVar6 = *puVar14;
          puVar21 = &stack0x00000000 + *puVar14;
          *(undefined4 *)(puVar21 + (uVar3 - 4)) = uVar8;
          *(undefined4 *)(puVar21 + (uVar3 - 8)) = uVar8;
          *(uint **)(puVar21 + (uVar3 - 0xc)) = puVar14;
          *(int *)(puVar21 + (uVar3 - 0x10)) = iVar13;
          *(byte **)(puVar21 + (uVar3 - 0x14)) = pbVar18;
          *(undefined1 **)(puVar21 + (uVar3 - 0x18)) = puVar21 + (uVar3 - 4);
          *(uint *)(puVar21 + (uVar3 - 0x1c)) = uVar9;
          *(undefined4 **)(puVar21 + (uVar3 - 0x20)) = puVar7;
          *(uint **)(puVar21 + (uVar3 - 0x24)) = puVar20;
          puVar23 = (undefined4 *)((uint)puVar20 ^ *(uint *)((int)puVar20 + 1));
          *(uint *)(puVar21 + (uVar3 - 0x28)) =
               CONCAT22((short)((uint)uVar8 >> 0x10),
                        CONCAT11(((int)(puVar21 + uVar3) < 0) << 7 |
                                 (puVar21 + uVar3 == (undefined1 *)0x0) << 6 |
                                 ((uVar9 & 0x1000) != 0) << 4 |
                                 ((POPCOUNT((uint)(puVar21 + uVar3) & 0xff) & 1U) == 0) << 2 | 2U |
                                 (CARRY4((uint)&stack0x00000000,uVar6) ||
                                 CARRY4((uint)puVar21,uVar3)),(char)uVar8));
          pbVar18[-0x3c] = pbVar18[-0x3c] - (char)((uint)iVar13 >> 8);
          *(undefined4 *)(puVar21 + (uVar3 - 0x2c)) = 0xffffffaf;
          uVar8 = in(0xa6);
          *(char *)(iVar13 + -0x66) = *(char *)(iVar13 + -0x66) - (char)((uint)uVar8 >> 8);
          out(uVar15,(char)uVar8);
          DAT_af3c70c7 = DAT_af3c70c7 | (byte)iVar13;
          uVar8 = in((short)(iVar13 + 1));
          DAT_10984e34 = DAT_10984e34 + '\x01';
          DAT_09247a77 = (undefined1)uVar8;
          iVar13 = -*(int *)(((iVar13 + 1) - (int)puVar23) + -0x5d914a3a);
          *(undefined4 *)(puVar21 + iVar13 + uVar3 + -0x30) = 0xb5d7fe81;
          *(undefined4 **)(puVar21 + iVar13 + uVar3 + -0x34) = puVar7;
          *puVar23 = *puVar7;
                    /* WARNING: Bad instruction - Truncating control flow here */
          halt_baddata();
        }
      }
      pcVar4 = (code *)swi(3);
      puVar7 = (undefined4 *)(*pcVar4)();
      return puVar7;
    }
  }
  *(byte *)((int)param_1 + -0x65) = *(byte *)((int)param_1 + -0x65) | (byte)param_2;
  pcVar4 = (code *)swi(1);
  puVar7 = (undefined4 *)(*pcVar4)();
  return puVar7;
}


