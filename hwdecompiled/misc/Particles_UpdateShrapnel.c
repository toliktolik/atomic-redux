/*
 * Function: Particles_UpdateShrapnel
 * Address: 0041c430
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __thiscall
Particles_UpdateShrapnel
          (void *this,undefined4 *param_1,char param_2,undefined4 *param_3,_String_base *param_4)

{
  char cVar1;
  int *piVar2;
  char *pcVar3;
  char *pcVar4;
  int *piVar5;
  int *piVar6;
  int *piVar7;
  int *piVar8;
  undefined **local_54 [10];
  undefined1 local_2c [4];
  undefined1 local_28;
  undefined4 local_18;
  undefined4 local_14;
  void *local_10;
  undefined4 uStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  uStack_c = 0x5109e8;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if (0x7fffffd < *(uint *)((int)this + 8)) {
    local_14 = 0xf;
    local_18 = 0;
    local_28 = 0;
    pcVar3 = "map/set<T> too long";
    do {
      pcVar4 = pcVar3;
      pcVar3 = pcVar4 + 1;
    } while (*pcVar4 != '\0');
    ExceptionList = &local_10;
    String_Assign(local_2c,(_String_base *)"map/set<T> too long",(uint)(pcVar4 + -0x52a4bc));
    local_8 = 0;
    Level_InitializeFrigistan(local_54,local_2c);
    local_54[0] = &PTR_Level_InitializePetrovakia_00531568;
    CRuntime_CxxThrowException(local_54,&DAT_0054f4b0);
  }
  piVar5 = (int *)DataStructure_Factory
                            (*(undefined4 *)((int)this + 4),param_3,*(undefined4 *)((int)this + 4),
                             param_4,0);
  *(int *)((int)this + 8) = *(int *)((int)this + 8) + 1;
  if (param_3 == *(undefined4 **)((int)this + 4)) {
    (*(undefined4 **)((int)this + 4))[1] = piVar5;
    **(undefined4 **)((int)this + 4) = piVar5;
    *(int **)(*(int *)((int)this + 4) + 8) = piVar5;
  }
  else if (param_2 == '\0') {
    param_3[2] = piVar5;
    if (param_3 == *(undefined4 **)(*(int *)((int)this + 4) + 8)) {
      *(int **)(*(int *)((int)this + 4) + 8) = piVar5;
    }
  }
  else {
    *param_3 = piVar5;
    if (param_3 == (undefined4 *)**(int **)((int)this + 4)) {
      **(int **)((int)this + 4) = (int)piVar5;
    }
  }
  cVar1 = *(char *)(piVar5[1] + 0x2c);
  piVar8 = piVar5;
  do {
    if (cVar1 != '\0') {
      *(undefined1 *)(*(int *)(*(int *)((int)this + 4) + 4) + 0x2c) = 1;
      *param_1 = piVar5;
      ExceptionList = local_10;
      return;
    }
    piVar6 = piVar8 + 1;
    piVar2 = (int *)*piVar6;
    piVar7 = *(int **)piVar2[1];
    if (piVar2 == piVar7) {
      piVar7 = (int *)((undefined4 *)piVar2[1])[2];
      if ((char)piVar7[0xb] == '\0') {
LAB_0041c52f:
        *(undefined1 *)(piVar2 + 0xb) = 1;
        *(undefined1 *)(piVar7 + 0xb) = 1;
        *(undefined1 *)(*(int *)(*piVar6 + 4) + 0x2c) = 0;
        piVar8 = *(int **)(*piVar6 + 4);
      }
      else {
        if (piVar8 == (int *)piVar2[2]) {
          LinkedList_InsertBefore(this,(int)piVar2);
          piVar8 = piVar2;
        }
        *(undefined1 *)(piVar8[1] + 0x2c) = 1;
        *(undefined1 *)(*(int *)(piVar8[1] + 4) + 0x2c) = 0;
        LinkedList_InsertAfter(this,*(int **)(piVar8[1] + 4));
      }
    }
    else {
      if ((char)piVar7[0xb] == '\0') goto LAB_0041c52f;
      if (piVar8 == (int *)*piVar2) {
        LinkedList_InsertAfter(this,piVar2);
        piVar8 = piVar2;
      }
      *(undefined1 *)(piVar8[1] + 0x2c) = 1;
      *(undefined1 *)(*(int *)(piVar8[1] + 4) + 0x2c) = 0;
      LinkedList_InsertBefore(this,*(int *)(piVar8[1] + 4));
    }
    cVar1 = *(char *)(piVar8[1] + 0x2c);
  } while( true );
}


