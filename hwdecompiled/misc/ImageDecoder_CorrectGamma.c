/*
 * Function: ImageDecoder_CorrectGamma
 * Address: 004cd8b0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __fastcall
ImageDecoder_CorrectGamma(undefined4 param_1,byte *param_2,uint param_3,byte *param_4,uint param_5)

{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  uint uVar4;
  undefined3 uVar6;
  uint uVar5;
  byte bVar7;
  undefined4 local_8;
  
  uVar6 = (undefined3)(param_5 >> 8);
  uVar5 = param_5;
  local_8 = param_1;
  if ((param_5 & 2) == 0) {
    bVar7 = param_4[3];
    if ((bVar7 == 0) || (*(byte *)(param_3 + 0x128) < bVar7)) goto LAB_004cd952;
    local_8 = CONCAT31((int3)((uint)param_1 >> 8),bVar7);
    uVar4 = 1;
  }
  else {
    bVar7 = 8;
    if (param_5 != 3) {
      bVar7 = *(byte *)(param_3 + 0x128);
    }
    bVar1 = *param_4;
    param_2 = (byte *)CONCAT31((int3)((uint)param_2 >> 8),bVar1);
    if ((bVar1 == 0) || (bVar7 < bVar1)) goto LAB_004cd952;
    bVar2 = param_4[1];
    uVar5 = CONCAT31(uVar6,bVar2);
    if ((bVar2 == 0) || (((bVar7 < bVar2 || (bVar3 = param_4[2], bVar3 == 0)) || (bVar7 < bVar3))))
    goto LAB_004cd952;
    local_8._3_1_ = (undefined1)((uint)param_1 >> 0x18);
    local_8 = CONCAT31(CONCAT12(local_8._3_1_,CONCAT11(bVar3,bVar2)),bVar1);
    uVar4 = 3;
  }
  if ((param_5 & 4) != 0) {
    bVar7 = param_4[4];
    uVar5 = CONCAT31(uVar6,bVar7);
    if ((bVar7 == 0) || (*(byte *)(param_3 + 0x128) < bVar7)) {
LAB_004cd952:
      CPU_Instruction21(uVar5,param_2,param_3,"Invalid sBIT depth specified");
      return;
    }
    *(byte *)((int)&local_8 + uVar4) = bVar7;
    uVar4 = uVar4 + 1;
  }
  ImageDecoder_ProcessHeader(param_3,(byte *)&DAT_00567d34,(byte *)&local_8,uVar4);
  return;
}


