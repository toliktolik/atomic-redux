/*
 * Function: CPU_Instruction30
 * Address: 004c8350
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl CPU_Instruction30(uint *param_1,int param_2,int param_3,uint param_4)

{
  byte bVar1;
  int iVar2;
  void *this;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  byte *pbVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  byte *pbVar9;
  undefined4 *puVar10;
  undefined4 *puVar11;
  byte *pbVar12;
  undefined4 *in_stack_ffffffd4;
  undefined4 *in_stack_ffffffd8;
  int iVar13;
  uint local_24;
  uint local_20;
  byte *local_1c;
  byte *local_18;
  uint local_14;
  
  this = DAT_00569f5c;
  if ((param_2 != 0) && (param_1 != (uint *)0x0)) {
    iVar2 = (&DAT_00567d80)[param_3];
    uVar4 = *param_1;
    bVar1 = *(byte *)((int)param_1 + 0xb);
    uVar3 = uVar4 * iVar2;
    if (bVar1 == 1) {
      local_18 = (byte *)((uVar4 - 1 >> 3) + param_2);
      pbVar12 = (byte *)((uVar3 - 1 >> 3) + param_2);
      if ((param_4 & 0x10000) == 0) {
        pbVar6 = (byte *)(7 - (uVar4 - 1 & 7));
        pbVar9 = (byte *)(7 - (uVar3 - 1 & 7));
        local_1c = (byte *)0x0;
        local_20 = 7;
        local_14 = 1;
      }
      else {
        pbVar6 = (byte *)(uVar4 - 1 & 7);
        pbVar9 = (byte *)(uVar3 - 1 & 7);
        local_1c = (byte *)0x7;
        local_20 = 0;
        local_14 = -1;
      }
      local_24 = 0;
      if (uVar4 != 0) {
        do {
          bVar1 = *local_18;
          iVar13 = iVar2;
          if (0 < iVar2) {
            do {
              *pbVar12 = (byte)(0x7f7f >> (7 - (byte)pbVar9 & 0x1f)) & *pbVar12 |
                         (bVar1 >> ((byte)pbVar6 & 0x1f) & 1) << ((byte)pbVar9 & 0x1f);
              if (pbVar9 == (byte *)local_20) {
                pbVar12 = pbVar12 + -1;
                pbVar9 = local_1c;
              }
              else {
                pbVar9 = (byte *)((int)pbVar9 + local_14);
              }
              iVar13 = iVar13 + -1;
            } while (iVar13 != 0);
            in_stack_ffffffd8 = (undefined4 *)0x0;
          }
          if (pbVar6 == (byte *)local_20) {
            local_18 = local_18 + -1;
            pbVar6 = local_1c;
          }
          else {
            pbVar6 = (byte *)((int)pbVar6 + local_14);
          }
          local_24 = local_24 + 1;
        } while (local_24 < *param_1);
      }
    }
    else if (bVar1 == 2) {
      local_18 = (byte *)((uVar4 - 1 >> 2) + param_2);
      pbVar12 = (byte *)((uVar3 - 1 >> 2) + param_2);
      if ((param_4 & 0x10000) == 0) {
        pbVar6 = (byte *)((3 - (uVar4 - 1 & 3)) * 2);
        pbVar9 = (byte *)((3 - (uVar3 - 1 & 3)) * 2);
        local_1c = (byte *)0x0;
        local_20 = 6;
        local_14 = 2;
      }
      else {
        pbVar6 = (byte *)(uVar4 * 2 - 1 & 6);
        pbVar9 = (byte *)(uVar3 * 2 - 1 & 6);
        local_1c = (byte *)0x6;
        local_20 = 0;
        local_14 = -2;
      }
      local_24 = 0;
      if (uVar4 != 0) {
        do {
          bVar1 = *local_18;
          iVar13 = iVar2;
          if (0 < iVar2) {
            do {
              *pbVar12 = (byte)(0x3f3f >> (6 - (byte)pbVar9 & 0x1f)) & *pbVar12 |
                         (bVar1 >> ((byte)pbVar6 & 0x1f) & 3) << ((byte)pbVar9 & 0x1f);
              if (pbVar9 == (byte *)local_20) {
                pbVar12 = pbVar12 + -1;
                pbVar9 = local_1c;
              }
              else {
                pbVar9 = (byte *)((int)pbVar9 + local_14);
              }
              iVar13 = iVar13 + -1;
            } while (iVar13 != 0);
            in_stack_ffffffd8 = (undefined4 *)0x0;
          }
          if (pbVar6 == (byte *)local_20) {
            local_18 = local_18 + -1;
            pbVar6 = local_1c;
          }
          else {
            pbVar6 = (byte *)((int)pbVar6 + local_14);
          }
          local_24 = local_24 + 1;
        } while (local_24 < *param_1);
      }
    }
    else if (bVar1 == 4) {
      local_1c = (byte *)((uVar4 - 1 >> 1) + param_2);
      pbVar12 = (byte *)((uVar3 - 1 >> 1) + param_2);
      if ((param_4 & 0x10000) == 0) {
        pbVar6 = (byte *)((uVar4 - 1 & 1) * -4 + 4);
        pbVar9 = (byte *)((uVar3 - 1 & 1) * -4 + 4);
        local_18 = (byte *)0x0;
        local_14 = 4;
        local_20 = 4;
      }
      else {
        pbVar6 = (byte *)(uVar4 * -4 - 1 & 4);
        pbVar9 = (byte *)(uVar3 * -4 - 1 & 4);
        local_18 = (byte *)0x4;
        local_14 = 0;
        local_20 = -4;
      }
      in_stack_ffffffd8 = (undefined4 *)0x0;
      if (uVar4 != 0) {
        do {
          bVar1 = *local_1c;
          local_24 = iVar2;
          if (0 < iVar2) {
            do {
              *pbVar12 = (byte)(0xf0f >> (4 - (byte)pbVar9 & 0x1f)) & *pbVar12 |
                         (bVar1 >> ((byte)pbVar6 & 0x1f) & 0xf) << ((byte)pbVar9 & 0x1f);
              if (pbVar9 == (byte *)local_14) {
                pbVar12 = pbVar12 + -1;
                pbVar9 = local_18;
              }
              else {
                pbVar9 = (byte *)((int)pbVar9 + local_20);
              }
              local_24 = local_24 + -1;
            } while (local_24 != 0);
          }
          if (pbVar6 == (byte *)local_14) {
            local_1c = local_1c + -1;
            pbVar6 = local_18;
          }
          else {
            pbVar6 = (byte *)((int)pbVar6 + local_20);
          }
          in_stack_ffffffd8 = (undefined4 *)((int)in_stack_ffffffd8 + 1);
        } while (in_stack_ffffffd8 < (undefined4 *)*param_1);
      }
    }
    else {
      uVar5 = (uint)(bVar1 >> 3);
      puVar10 = (undefined4 *)((uVar4 - 1) * uVar5 + param_2);
      puVar7 = (undefined4 *)((uVar3 - 1) * uVar5 + param_2);
      local_1c = (byte *)0x0;
      if (uVar4 != 0) {
        do {
          puVar8 = puVar10;
          puVar11 = (undefined4 *)&stack0xffffffd4;
          for (uVar4 = (uint)(bVar1 >> 5); uVar4 != 0; uVar4 = uVar4 - 1) {
            *puVar11 = *puVar8;
            puVar8 = puVar8 + 1;
            puVar11 = puVar11 + 1;
          }
          for (uVar4 = uVar5 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
            *(undefined1 *)puVar11 = *(undefined1 *)puVar8;
            puVar8 = (undefined4 *)((int)puVar8 + 1);
            puVar11 = (undefined4 *)((int)puVar11 + 1);
          }
          local_20 = iVar2;
          if (0 < iVar2) {
            do {
              puVar8 = (undefined4 *)&stack0xffffffd4;
              puVar11 = puVar7;
              for (uVar4 = (uint)(bVar1 >> 5); uVar4 != 0; uVar4 = uVar4 - 1) {
                *puVar11 = *puVar8;
                puVar8 = puVar8 + 1;
                puVar11 = puVar11 + 1;
              }
              puVar7 = (undefined4 *)((int)puVar7 - uVar5);
              local_20 = local_20 + -1;
              for (uVar4 = uVar5 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
                *(undefined1 *)puVar11 = *(undefined1 *)puVar8;
                puVar8 = (undefined4 *)((int)puVar8 + 1);
                puVar11 = (undefined4 *)((int)puVar11 + 1);
              }
            } while (local_20 != 0);
          }
          puVar10 = (undefined4 *)((int)puVar10 - uVar5);
          local_1c = (byte *)((int)local_1c + 1);
        } while (local_1c < *param_1);
      }
    }
    *param_1 = uVar3;
    param_1[1] = *(byte *)((int)param_1 + 0xb) * uVar3 + 7 >> 3;
  }
  Exception_SetMessage(this,in_stack_ffffffd4,in_stack_ffffffd8);
  return;
}


