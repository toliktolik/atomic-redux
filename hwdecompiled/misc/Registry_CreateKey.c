/*
 * Function: Registry_CreateKey
 * Address: 004e2dd0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl Registry_CreateKey(int *param_1)

{
  int iVar1;
  undefined4 *puVar2;
  int iVar3;
  
  iVar1 = param_1[0x6a];
  param_1[0x1d] = *(int *)(iVar1 + 0x10);
  iVar3 = param_1[0x13];
  param_1[0x1c] = *(int *)(iVar1 + 0x14);
  if (iVar3 == 0) {
    if (param_1[0x19] == 3) {
      *(code **)(iVar1 + 4) = Crypto_SHA1Hash;
      return;
    }
    *(code **)(iVar1 + 4) = Crypto_MD5Hash;
  }
  else if (iVar3 == 1) {
    if (param_1[0x19] == 3) {
      *(code **)(iVar1 + 4) = Crypto_Decrypt;
    }
    else {
      *(code **)(iVar1 + 4) = Crypto_Encrypt;
    }
    *(undefined4 *)(iVar1 + 0x30) = 0;
    if (*(char *)(iVar1 + 0x1c) == '\0') {
      Database_BeginTransaction((int)param_1);
    }
    if (*(int *)(iVar1 + 0x34) == 0) {
      Database_RollbackTransaction();
      return;
    }
  }
  else {
    if (iVar3 != 2) {
      *(undefined4 *)(*param_1 + 0x14) = 0x30;
      (**(code **)*param_1)(param_1);
      return;
    }
    puVar2 = (undefined4 *)(iVar1 + 0x44);
    *(code **)(iVar1 + 4) = Crypto_GenerateKey;
    *(undefined1 *)(iVar1 + 0x54) = 0;
    if (*(int *)(iVar1 + 0x44) == 0) {
      Registry_OpenKey();
    }
    iVar1 = param_1[0x17];
    iVar3 = 0;
    if (0 < param_1[0x19]) {
      do {
        Memory_ZeroFill((undefined4 *)*puVar2,iVar1 * 2 + 4);
        iVar3 = iVar3 + 1;
        puVar2 = puVar2 + 1;
      } while (iVar3 < param_1[0x19]);
      return;
    }
  }
  return;
}


