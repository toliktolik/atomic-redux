/*
 * Function: CRuntime_WideCharToMultiByte
 * Address: 004ec18e
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* Library Function - Single Match
    ___Wcrtomb_lk
   
   Library: Visual Studio 2003 Release */

int __fastcall
CRuntime_WideCharToMultiByte
          (undefined4 param_1,int param_2,LPSTR param_3,WCHAR param_4,undefined4 param_5,
          int *param_6)

{
  UINT CodePage;
  int iVar1;
  undefined4 *puVar2;
  int extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined8 uVar3;
  ulonglong uVar4;
  LPCSTR lpDefaultChar;
  int **lpUsedDefaultChar;
  
  if (param_6 == (int *)0x0) {
    uVar3 = func_0x00500cca();
    iVar1 = *(int *)((int)uVar3 + 8);
    uVar4 = Assembly_LongLongProcessing(extraout_ECX,(int *)((ulonglong)uVar3 >> 0x20));
    param_2 = (int)(uVar4 >> 0x20);
    CodePage = (UINT)uVar4;
    param_1 = extraout_ECX_00;
  }
  else {
    iVar1 = *param_6;
    CodePage = param_6[1];
  }
  if (iVar1 == 0) {
    if ((ushort)param_4 < 0x100) {
      *param_3 = (CHAR)param_4;
      return 1;
    }
  }
  else {
    param_6 = (int *)0x0;
    lpUsedDefaultChar = &param_6;
    lpDefaultChar = (LPCSTR)0x0;
    iVar1 = Assembly_ConditionalAdd(param_1,param_2);
    iVar1 = WideCharToMultiByte(CodePage,0,&param_4,1,param_3,iVar1,lpDefaultChar,
                                (LPBOOL)lpUsedDefaultChar);
    if ((iVar1 != 0) && (param_6 == (int *)0x0)) {
      return iVar1;
    }
  }
  puVar2 = (undefined4 *)System_GetSystemInfo();
  *puVar2 = 0x2a;
  return -1;
}


