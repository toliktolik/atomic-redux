/*
 * Function: Exception_Handler6
 * Address: 004f3e11
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void Exception_Handler6(void)

{
  byte bVar1;
  uint uVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  uint uVar5;
  facet *this;
  _String_base *p_Var6;
  int iVar7;
  int *extraout_ECX;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint extraout_EDX_03;
  uint extraout_EDX_04;
  uint extraout_EDX_05;
  uint extraout_EDX_06;
  uint extraout_EDX_07;
  int iVar8;
  void *this_00;
  int unaff_EBP;
  ushort *puVar9;
  undefined4 *in_stack_ffffff9c;
  undefined4 *in_stack_ffffffa0;
  
  Assembly_BitShiftLocking();
  uVar5 = DAT_00569f5c ^ *(uint *)(unaff_EBP + 4);
  *(undefined4 *)(unaff_EBP + -0x14) = 0;
  this_00 = *(void **)(unaff_EBP + 0x14);
  bVar1 = *(byte *)((int)this_00 + 0xd);
  *(uint *)(unaff_EBP + -0x10) = uVar5;
  if ((bVar1 & 0x40) == 0) {
    (**(code **)(*extraout_ECX + 0x1c))
              (*(undefined4 *)(unaff_EBP + 8),*(undefined4 *)(unaff_EBP + 0xc),
               *(undefined4 *)(unaff_EBP + 0x10),this_00,*(undefined4 *)(unaff_EBP + 0x18),
               *(undefined1 *)(unaff_EBP + 0x1c));
  }
  else {
    SexyWidget_ProcessInput(this_00,(int *)(unaff_EBP + -0x18));
    *(undefined4 *)(unaff_EBP + -4) = 0;
    this = Log_FlushBuffer();
    *(undefined4 *)(unaff_EBP + -4) = 0xffffffff;
    SmartPointer_Destructor((uint *)(unaff_EBP + -0x18));
    if (*(char *)(unaff_EBP + 0x1c) == '\0') {
      p_Var6 = (_String_base *)Resource_FreeResource(this,unaff_EBP + -0x54);
      *(undefined4 *)(unaff_EBP + -4) = 2;
      *(undefined4 *)(unaff_EBP + -0x14) = 2;
      uVar5 = extraout_EDX_00;
    }
    else {
      p_Var6 = (_String_base *)STL_String_Insert(this,unaff_EBP + -0x70);
      *(undefined4 *)(unaff_EBP + -4) = 1;
      *(undefined4 *)(unaff_EBP + -0x14) = 1;
      uVar5 = extraout_EDX;
    }
    Collision_ClosestPoint(unaff_EBP + -0x38,uVar5,'\0');
    UI_ShowWeaponDisplay((_String_base *)(unaff_EBP + -0x38),extraout_EDX_01,p_Var6,0,0xffffffff);
    uVar5 = extraout_EDX_02;
    if ((*(byte *)(unaff_EBP + -0x14) & 2) != 0) {
      *(uint *)(unaff_EBP + -0x14) = *(uint *)(unaff_EBP + -0x14) & 0xfffffffd;
      Collision_ClosestPoint(unaff_EBP + -0x54,extraout_EDX_02,'\x01');
      uVar5 = extraout_EDX_03;
    }
    *(undefined4 *)(unaff_EBP + -4) = 4;
    if ((*(byte *)(unaff_EBP + -0x14) & 1) != 0) {
      Collision_ClosestPoint(unaff_EBP + -0x70,uVar5,'\x01');
      uVar5 = extraout_EDX_04;
    }
    uVar2 = *(uint *)((int)this_00 + 0x14);
    if (((int)uVar2 < 1) || (uVar2 <= *(uint *)(unaff_EBP + -0x24))) {
      iVar7 = 0;
    }
    else {
      iVar7 = uVar2 - *(int *)(unaff_EBP + -0x24);
    }
    if ((*(uint *)((int)this_00 + 0xc) & 0x1c0) != 0x40) {
      *(undefined4 *)(unaff_EBP + -0x1c) = *(undefined4 *)(unaff_EBP + 0xc);
      *(undefined4 *)(unaff_EBP + -0x18) = *(undefined4 *)(unaff_EBP + 0x10);
      for (; iVar7 != 0; iVar7 = iVar7 + -1) {
        Timer_Create((void *)(unaff_EBP + -0x1c),*(undefined4 *)(unaff_EBP + 0x18));
        uVar5 = extraout_EDX_05;
      }
      *(undefined4 *)(unaff_EBP + 0xc) = *(undefined4 *)(unaff_EBP + -0x1c);
      *(undefined4 *)(unaff_EBP + 0x10) = *(undefined4 *)(unaff_EBP + -0x18);
      iVar7 = 0;
    }
    puVar9 = *(ushort **)(unaff_EBP + -0x34);
    if (*(uint *)(unaff_EBP + -0x20) < 8) {
      puVar9 = (ushort *)(unaff_EBP + -0x34);
    }
    *(undefined4 *)(unaff_EBP + -0x1c) = *(undefined4 *)(unaff_EBP + 0xc);
    *(undefined4 *)(unaff_EBP + -0x18) = *(undefined4 *)(unaff_EBP + 0x10);
    if (*(int *)(unaff_EBP + -0x24) != 0) {
      iVar8 = *(int *)(unaff_EBP + -0x24);
      do {
        Timer_Create((void *)(unaff_EBP + -0x1c),(uint)*puVar9);
        puVar9 = puVar9 + 1;
        iVar8 = iVar8 + -1;
      } while (iVar8 != 0);
      this_00 = *(void **)(unaff_EBP + 0x14);
      uVar5 = extraout_EDX_06;
    }
    uVar3 = *(undefined4 *)(unaff_EBP + -0x1c);
    *(undefined4 *)((int)this_00 + 0x14) = 0;
    *(undefined4 *)(unaff_EBP + 0xc) = uVar3;
    *(undefined4 *)(unaff_EBP + 0x10) = *(undefined4 *)(unaff_EBP + -0x18);
    for (; iVar7 != 0; iVar7 = iVar7 + -1) {
      Timer_Create((void *)(unaff_EBP + 0xc),*(undefined4 *)(unaff_EBP + 0x18));
      uVar5 = extraout_EDX_07;
    }
    puVar4 = *(undefined4 **)(unaff_EBP + 8);
    *puVar4 = *(undefined4 *)(unaff_EBP + 0xc);
    puVar4[1] = *(undefined4 *)(unaff_EBP + 0x10);
    Collision_ClosestPoint(unaff_EBP + -0x38,uVar5,'\x01');
  }
  ExceptionList = *(void **)(unaff_EBP + -0xc);
  Exception_SetMessage
            ((void *)(*(uint *)(unaff_EBP + -0x10) ^ *(uint *)(unaff_EBP + 4)),in_stack_ffffff9c,
             in_stack_ffffffa0);
  return;
}


