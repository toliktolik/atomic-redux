/*
 * Function: Unwind@00517931
 * Address: 00517931
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x00517a4b) overlaps instruction at (ram,0x00517a47)
    */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: This function may have set the stack pointer */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 __fastcall Unwind_00517931(undefined1 *param_1)

{
  undefined4 *puVar1;
  longlong lVar2;
  code *pcVar3;
  byte bVar4;
  ushort uVar5;
  uint uVar6;
  ushort uVar7;
  int in_EAX;
  undefined1 *puVar8;
  uint uVar9;
  byte extraout_CL;
  uint extraout_ECX;
  short sVar10;
  short extraout_DX;
  int iVar11;
  uint *puVar12;
  uint uVar13;
  int unaff_EBX;
  undefined1 *puVar14;
  undefined1 *puVar15;
  int unaff_EBP;
  int *unaff_ESI;
  int *piVar16;
  undefined4 *unaff_EDI;
  undefined2 in_CS;
  undefined2 in_DS;
  undefined1 uVar17;
  undefined8 uVar18;
  undefined2 unaff_retaddr;
  int iStack_10;
  undefined4 *in_stack_fffffff4;
  undefined4 uVar19;
  
  lVar2 = (longlong)(in_EAX + 1) * (longlong)*(int *)(unaff_EBX + 0x27);
  iVar11 = (int)((ulonglong)lVar2 >> 0x20);
  DAT_0c10fc67 = DAT_0c10fc67 >> 1 | DAT_0c10fc67 << 7;
  *(byte *)((int)unaff_ESI + -0x75964d4a) =
       *(byte *)((int)unaff_ESI + -0x75964d4a) | (byte)unaff_EBX;
  puVar8 = (undefined1 *)(CONCAT31((int3)((ulonglong)lVar2 >> 8),(char)lVar2 + 'V') ^ 0xe0342b1a);
  piVar16 = unaff_ESI;
  if ((POPCOUNT((uint)puVar8 & 0xff) & 1U) != 0) {
    out(*puVar8,in_DS);
    puVar12 = unaff_EDI + -0x190a8ffc;
    uVar13 = *puVar12;
    *puVar12 = *puVar12 + 0x6f586e3c;
    unaff_ESI[0xc0fdd31] = (int)param_1;
    uVar17 = 0x15a57b94 < (int)unaff_ESI + 1U ||
             CARRY4((uint)(unaff_ESI + -0x5695ee5),(uint)(uVar13 < 0x90a791c4));
    sVar10 = CONCAT11(0xae,(char)in_DS) + -1;
    *unaff_EDI = *(undefined4 *)(puVar8 + 1);
    puVar14 = &DAT_81ee52b6;
    pcVar3 = (code *)swi(4);
    _DAT_81ee52b6 = param_1;
    if (SCARRY4(unaff_EBP,1)) {
      (*pcVar3)();
      sVar10 = extraout_DX;
    }
    out(*(undefined4 *)(puVar8 + 5),sVar10);
    *(undefined2 *)(puVar14 + -4) = in_CS;
    in_CS = 0x178a;
    puVar15 = puVar14 + -8;
    *(undefined4 *)(puVar14 + -8) = 0x517982;
    uVar7 = func_0x9f95160b();
    *(undefined4 *)(puVar15 + -4) = 0x90a791c4;
    bVar4 = (extraout_CL & 0x1f) % 9;
    uVar5 = CONCAT11(uVar17,*(undefined1 *)(unaff_EBP + -0x13d582fb));
    uVar5 = uVar5 << bVar4 | uVar5 >> 9 - bVar4;
    *(undefined1 *)(unaff_EBP + -0x13d582fb) = (char)uVar5;
    uVar13 = (CONCAT22((short)((uint)(puVar15 + -4) >> 0x10),
                       (ushort)(puVar15 + -4) +
                       (ushort)((uVar5 & 0x100) != 0) * ((uVar7 & 3) - ((ushort)(puVar15 + -4) & 3))
                      ) + 4) * 2;
    unaff_EBP = *(int *)(uVar13 + 0xc);
    iVar11 = *(int *)(uVar13 + 0x18);
    param_1 = *(undefined1 **)(uVar13 + 0x1c);
    piVar16 = *(int **)(uVar13 + 8);
    unaff_EDI = in_stack_fffffff4;
    if ((POPCOUNT(uVar13 & 0xff) & 1U) != 0) {
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
  }
  param_1[-0x64b6141] = param_1[-0x64b6141] << 1;
  uVar17 = *param_1;
  *(byte *)((int)piVar16 + -0x51dea7e1) = *(byte *)((int)piVar16 + -0x51dea7e1) ^ (byte)param_1;
  in((short)CONCAT31((int3)((uint)(iVar11 - (int)&stack0xfffffff4) >> 8),uVar17));
  *(char *)unaff_EDI = (char)piVar16[1];
  uVar19 = CONCAT22((short)((uint)unaff_EDI >> 0x10),in_CS);
  uVar18 = (*(code *)((int)piVar16 + 0x597d2f3e))();
  puVar12 = (uint *)((ulonglong)uVar18 >> 0x20);
  puVar1 = (undefined4 *)((int)unaff_EDI + 3);
  iVar11 = (int)uVar18 + -1;
  if (iVar11 == 0 || (extraout_ECX & 0x4000) == 0) {
    out(1,uVar19);
    return uVar19;
  }
  if (!SBORROW1(*(char *)((int)piVar16 + 5),*(char *)((int)unaff_EDI + 2))) {
    do {
                    /* WARNING: Do nothing block with infinite loop */
    } while( true );
  }
  *puVar12 = *puVar12 | (int)piVar16 + 6U;
  puRam5eff25d6 =
       (undefined1 *)((int)puVar1 + (uint)(puVar1 < (undefined4 *)0x9a39dd2b) + (int)puRam5eff25d6);
  uVar13 = (int)puVar1 >> 0x1f;
  iStack_10 = unaff_EBP;
  do {
    uVar9 = in((short)uVar13);
    *(undefined4 *)(uVar13 + 0x48086a55) = *(undefined4 *)(uVar13 + 0x48086a55);
    iStack_10 = CONCAT22(iStack_10._2_2_,in_CS);
    *(undefined2 *)puVar1 = *(undefined2 *)puVar1;
    uVar9 = (uVar9 ^ 0xb3) + 0x42d04a72;
    uVar6 = uVar13 >> 8;
    uVar13 = CONCAT22((short)(uVar13 >> 0x10),CONCAT11((char)iVar11,(char)uVar13));
    iVar11 = (uVar6 & 0xff) - 1;
  } while ((POPCOUNT(((char)uVar9 + '4') - (uVar9 < 0xd93b54e0)) & 1U) == 0);
  *puVar1 = *(undefined4 *)((int)piVar16 + 6U);
  *unaff_ESI = (int)(&stack0x0000000c + *unaff_ESI);
  puVar12 = (uint *)(iStack_10 + 0x52);
  *puVar12 = *puVar12 << 1 | (uint)((int)*puVar12 < 0);
  in(unaff_retaddr);
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}


