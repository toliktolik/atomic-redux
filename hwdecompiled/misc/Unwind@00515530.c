/*
 * Function: Unwind@00515530
 * Address: 00515530
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Instruction at (ram,0x00515574) overlaps instruction at (ram,0x00515573)
    */
/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Removing unreachable block (ram,0x005155de) */
/* WARNING: Removing unreachable block (ram,0x005155df) */
/* WARNING: Removing unreachable block (ram,0x005155e9) */
/* WARNING: Removing unreachable block (ram,0x005155eb) */
/* WARNING: Removing unreachable block (ram,0x00515631) */
/* WARNING: Removing unreachable block (ram,0x005155f3) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

int __fastcall Unwind_00515530(int param_1,int param_2)

{
  int *piVar1;
  byte *pbVar2;
  undefined1 uVar3;
  uint uVar4;
  code *pcVar5;
  byte bVar6;
  int in_EAX;
  undefined4 uVar7;
  undefined1 *puVar8;
  uint *puVar9;
  int iVar10;
  int iVar11;
  byte *pbVar12;
  undefined4 uVar13;
  uint *puVar14;
  uint uVar15;
  undefined1 *puVar16;
  undefined2 *puVar17;
  int unaff_EBP;
  char *unaff_ESI;
  undefined1 *unaff_EDI;
  uint *puVar19;
  undefined2 in_ES;
  undefined2 in_CS;
  undefined2 in_SS;
  byte bVar20;
  bool bVar21;
  float10 in_ST0;
  undefined8 uVar22;
  int iStack_4;
  undefined2 *puVar18;
  
  *(byte *)(in_EAX + -0x26) = *(byte *)(in_EAX + -0x26) & (byte)in_EAX;
  pbVar12 = (byte *)(param_1 + -1);
  iStack_4 = CONCAT22(iStack_4._2_2_,in_SS);
  *(int *)(param_2 + 0x6a) = *(int *)(param_2 + 0x6a) + 0x31;
  puVar19 = (uint *)(unaff_EDI + -1);
  uVar3 = in((short)param_2);
  *unaff_EDI = uVar3;
  *pbVar12 = *pbVar12 & 0xde;
  uVar7 = 0x9d7a7308;
  *(int *)(param_1 + -0x543b5f6b) = (int)in_ST0;
  puVar14 = (uint *)((in_EAX >> 0x1f) + 1);
  if (-1 < (int)puVar14) {
    uVar15 = in((short)puVar14);
    *puVar19 = uVar15;
    *unaff_ESI = *unaff_ESI + (char)((uint)pbVar12 >> 8);
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  pbVar2 = pbVar12 + (in_EAX >> 0x1f) + -0x56e46beb;
  bVar6 = *pbVar2;
  *pbVar2 = *pbVar2 + 8;
  uVar15 = CONCAT31((int3)((uint)(iStack_4 * -0x32) >> 8),
                    ((char)(iStack_4 * -0x32) - *pbVar12) - (0xf7 < bVar6)) ^ *puVar14;
  if ((int)uVar15 < 1) {
    uVar13 = *(undefined4 *)(iStack_4 + 1);
    puVar9 = puVar19;
    puVar16 = (undefined1 *)(iStack_4 + 5);
    puVar19 = puVar14;
  }
  else {
    if (pbVar12 != (byte *)0x1 && uVar15 != 0) {
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    while( true ) {
      bVar21 = ((uint)puVar14 & 0x400) == 0;
      uVar13 = 0x856c24d0;
      _DAT_43712afb = puVar14;
      *(undefined2 *)(iStack_4 + -3) = in_ES;
      puVar9 = puVar14;
      puVar16 = (undefined1 *)(iStack_4 + -3);
      if (bVar21) break;
      unaff_ESI = (char *)0x7a699f13;
      uVar13 = *(undefined4 *)(iStack_4 + -3);
      if (bVar21) {
        *(uint **)(iStack_4 + -3) = puVar14;
        *puVar19 = (uint)puVar14;
        return CONCAT31((int3)((uint)puVar14 >> 8),(char)puVar14 + -0x51) + 1;
      }
      uVar15 = CONCAT22((short)((uint)uVar13 >> 0x10),
                        CONCAT11((char)((uint)uVar13 >> 8) - cRam856c2513,(char)uVar13));
    }
  }
  while( true ) {
    *(uint **)(puVar16 + -4) = puVar9;
    *(undefined4 *)(puVar16 + -8) = uVar13;
    *(uint *)(puVar16 + -0xc) = uVar15;
    *(undefined4 *)(puVar16 + -0x10) = uVar7;
    *(undefined1 **)(puVar16 + -0x14) = puVar16;
    *(int *)(puVar16 + -0x18) = unaff_EBP;
    *(char **)(puVar16 + -0x1c) = unaff_ESI;
    *(uint **)(puVar16 + -0x20) = puVar19;
    puVar8 = (undefined1 *)((int)puVar9 + -0x2a777a83);
    *(uint *)(puVar16 + -0x24) = uVar15;
    out(0x58,(char)puVar8);
    bVar6 = (char)puVar8 + (char)((uint)puVar8 >> 8) * '>';
    if ((POPCOUNT((ushort)bVar6) & 1U) != 0) {
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    bVar20 = (byte)uVar13;
    if (puVar9 >= (uint *)0x2a777a83) break;
    uVar7 = CONCAT22((short)((uint)uVar7 >> 0x10),CONCAT11(0x8a,(char)uVar7));
    unaff_EBP = unaff_EBP + -1;
    if ((char)(bVar6 | 0x81) < '\0') {
      puVar9 = (uint *)(CONCAT22((short)((uint)puVar8 >> 0x10),CONCAT11(bVar20,bVar6)) | 0x81);
      puVar18 = (undefined2 *)(puVar16 + -0x28);
      *(int *)(puVar16 + -0x28) = unaff_EBP;
      puVar16 = puVar16 + -0x28;
      if (bVar20 == 0) {
        while( true ) {
          bVar20 = 0;
          *(undefined2 *)((int)puVar18 + -4) = in_CS;
          in_CS = 0x6502;
          puVar17 = (undefined2 *)((int)puVar18 + -8);
          *(undefined4 *)((int)puVar18 + -8) = 0x51562c;
          uVar22 = func_0xdeff31e8();
          pbVar12 = (byte *)((int)uVar22 + 0x5c);
          bVar6 = *pbVar12;
          *pbVar12 = *pbVar12 << 1 | bVar20;
          piVar1 = (int *)((int)puVar19 + -0x7b);
          uVar15 = (uint)((char)bVar6 < '\0');
          iVar10 = *piVar1;
          iVar11 = *piVar1;
          uVar4 = *piVar1 - 1;
          *piVar1 = uVar4 - uVar15;
          if (SBORROW4(iVar11,1) != SBORROW4(uVar4,uVar15)) {
            pcVar5 = (code *)swi(1);
            iVar10 = (*pcVar5)();
            return iVar10;
          }
          unaff_EBP = unaff_EBP + -1;
          iVar11 = CONCAT31((int3)((ulonglong)uVar22 >> 8),DAT_72bce724) + -1;
          if ((iVar10 != 0 && uVar15 <= uVar4) && iVar11 != 0) break;
          puVar18 = puVar17 + 4;
          puVar14 = (uint *)(CONCAT31((int3)((uint)uVar7 >> 8),0x66) + 0x2633f666);
          *puVar14 = *puVar14 ^ (uint)unaff_ESI;
        }
        DAT_9226020b = (undefined1)iVar11;
        out(*unaff_ESI,(short)CONCAT31((int3)((ulonglong)uVar22 >> 0x28),6));
        *puVar17 = in_ES;
        *(int *)(puVar17 + -2) = unaff_EBP;
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      }
    }
    else {
      puVar9 = *(uint **)(puVar16 + -0x24);
      puVar16 = puVar16 + -0x20;
    }
  }
  pbVar12 = (byte *)(unaff_EBP + -0x57 + (int)puVar19);
  bVar20 = (bVar20 & 0x1f) % 9;
  bVar6 = *pbVar12;
  *pbVar12 = bVar6 << bVar20 | (byte)(CONCAT11(puVar9 < (uint *)0x2a777a83,bVar6) >> 9 - bVar20);
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}


