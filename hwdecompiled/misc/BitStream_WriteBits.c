/*
 * Function: BitStream_WriteBits
 * Address: 004a4a20
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __thiscall BitStream_WriteBits(void *this,uint param_1,int param_2)

{
  int iVar1;
  undefined1 *puVar2;
  uint uVar3;
  byte *pbVar4;
  bool bVar5;
  int local_c;
  undefined1 local_5;
  
  local_c = 0;
  if (0 < param_2) {
    do {
      uVar3 = *(uint *)((int)this + 0x1c) & 0x80000007;
      bVar5 = uVar3 == 0;
      if ((int)uVar3 < 0) {
        bVar5 = (uVar3 - 1 | 0xfffffff8) == 0xffffffff;
      }
      if (bVar5) {
        iVar1 = *(int *)((int)this + 8);
        local_5 = 0;
        if ((iVar1 == 0) ||
           ((uint)(*(int *)((int)this + 0x10) - iVar1) <= (uint)(*(int *)((int)this + 0xc) - iVar1))
           ) {
          Input_IsKeyPressed((void *)((int)this + 4),*(undefined1 **)((int)this + 0xc),
                             (undefined1 *)0x1,&local_5);
        }
        else {
          puVar2 = *(undefined1 **)((int)this + 0xc);
          Collision_ResolveResponse(puVar2,1,&local_5);
          *(undefined1 **)((int)this + 0xc) = puVar2 + 1;
        }
      }
      if ((param_1 & 1 << ((byte)local_c & 0x1f)) != 0) {
        uVar3 = *(uint *)((int)this + 0x1c);
        pbVar4 = (byte *)(((int)(uVar3 + ((int)uVar3 >> 0x1f & 7U)) >> 3) + *(int *)((int)this + 8))
        ;
        uVar3 = uVar3 & 0x80000007;
        if ((int)uVar3 < 0) {
          uVar3 = (uVar3 - 1 | 0xfffffff8) + 1;
        }
        *pbVar4 = *pbVar4 | '\x01' << ((byte)uVar3 & 0x1f);
      }
      local_c = local_c + 1;
      *(int *)((int)this + 0x1c) = *(int *)((int)this + 0x1c) + 1;
    } while (local_c < param_2);
  }
  if (*(int *)((int)this + 0x14) < *(int *)((int)this + 0x1c)) {
    *(int *)((int)this + 0x14) = *(int *)((int)this + 0x1c);
  }
  return;
}


