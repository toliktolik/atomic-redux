/*
 * Function: ImageFormat_ValidateHeader
 * Address: 004bd110
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __fastcall ImageFormat_ValidateHeader(uint param_1,byte *param_2,byte *param_3,uint *param_4)

{
  byte *pbVar1;
  uint *puVar2;
  int iVar3;
  int iVar4;
  byte *pbVar5;
  uint extraout_ECX;
  uint extraout_ECX_00;
  uint extraout_ECX_01;
  undefined4 extraout_ECX_02;
  uint extraout_ECX_03;
  uint extraout_ECX_04;
  uint extraout_ECX_05;
  uint extraout_ECX_06;
  uint extraout_ECX_07;
  uint extraout_ECX_08;
  uint extraout_ECX_09;
  uint extraout_ECX_10;
  uint extraout_ECX_11;
  uint extraout_ECX_12;
  uint extraout_ECX_13;
  uint extraout_ECX_14;
  uint extraout_ECX_15;
  uint extraout_ECX_16;
  uint extraout_ECX_17;
  uint extraout_ECX_18;
  uint extraout_ECX_19;
  byte *extraout_EDX;
  byte *extraout_EDX_00;
  byte *pbVar6;
  byte *extraout_EDX_01;
  uint uVar7;
  char *pcVar8;
  
  puVar2 = param_4;
  pbVar1 = param_3;
  if (param_3[300] < 8) {
    param_3 = (byte *)(uint)param_3[300];
    iVar4 = -(int)param_3;
    uVar7 = iVar4 + 8;
    CPU_Instruction2(param_1,param_2,(uint)pbVar1,param_3 + 0x20 + (int)param_4,uVar7);
    pbVar1[300] = 8;
    iVar3 = PixelFormat_PackPixel((int)(puVar2 + 8),(uint)param_3,uVar7);
    param_1 = extraout_ECX;
    if (iVar3 != 0) {
      uVar7 = extraout_ECX;
      pbVar6 = extraout_EDX;
      if (param_3 < (byte *)0x4) {
        iVar4 = PixelFormat_PackPixel((int)(puVar2 + 8),(uint)param_3,iVar4 + 4);
        uVar7 = extraout_ECX_00;
        pbVar6 = extraout_EDX_00;
        if (iVar4 == 0) goto LAB_004bd17f;
        pcVar8 = "Not a PNG file";
      }
      else {
LAB_004bd17f:
        pcVar8 = "PNG file corrupted by ASCII conversion";
      }
      CPU_Instruction20(uVar7,pbVar6,(int)pbVar1,pcVar8);
      param_1 = extraout_ECX_01;
    }
  }
  while( true ) {
    while( true ) {
      while( true ) {
        while( true ) {
          CPU_Instruction2(param_1,(byte *)&param_3,(uint)pbVar1,&param_3,4);
          pbVar5 = (byte *)CPU_Instruction24((undefined1 *)&param_3);
          PixelFormat_GetGreenComponent((int)pbVar1);
          CPU_Instruction26(extraout_ECX_02,extraout_EDX_01,(uint)pbVar1,pbVar1 + 0x11c,4);
          pbVar6 = *(byte **)(pbVar1 + 0x11c);
          if (pbVar6 != DAT_00567cdc) break;
          CPU_Instruction34(0x567cdc,pbVar6,(uint)pbVar1,puVar2,(int)pbVar5);
          param_1 = extraout_ECX_03;
        }
        uVar7 = *(uint *)(pbVar1 + 0x11c);
        if (uVar7 != DAT_00567cf4) break;
        CPU_Instruction35(uVar7,pbVar6,(uint)pbVar1,(int)puVar2,(uint)pbVar5);
        param_1 = extraout_ECX_04;
      }
      if (*(int *)(pbVar1 + 0x11c) != DAT_00567cec) break;
      CPU_Instruction36(uVar7,(byte *)&DAT_00567cec,(uint)pbVar1,(int)puVar2,(uint)pbVar5);
      param_1 = extraout_ECX_05;
    }
    pbVar6 = *(byte **)(pbVar1 + 0x11c);
    if (pbVar6 == DAT_00567ce4) break;
    if (pbVar6 == DAT_00567cfc) {
      CPU_Instruction42((uint)pbVar6,pbVar6,(uint)pbVar1,(int)puVar2,pbVar5);
      param_1 = extraout_ECX_06;
    }
    else if (*(int *)(pbVar1 + 0x11c) == DAT_00567d04) {
      CPU_Instruction39((uint)pbVar6,(byte *)&DAT_00567d04,(uint)pbVar1,(int)puVar2,(uint)pbVar5);
      param_1 = extraout_ECX_07;
    }
    else {
      pbVar6 = *(byte **)(pbVar1 + 0x11c);
      if (pbVar6 == DAT_00567d0c) {
        CPU_Instruction37(0x567d0c,pbVar6,(uint)pbVar1,(int)puVar2,(uint)pbVar5);
        param_1 = extraout_ECX_08;
      }
      else {
        uVar7 = *(uint *)(pbVar1 + 0x11c);
        if (uVar7 == DAT_00567d14) {
          CPU_Instruction43(uVar7,pbVar6,(uint)pbVar1,(int)puVar2,pbVar5);
          param_1 = extraout_ECX_09;
        }
        else if (*(int *)(pbVar1 + 0x11c) == DAT_00567d1c) {
          CPU_Instruction45(uVar7,(byte *)&DAT_00567d1c,(uint)pbVar1,(int)puVar2,(uint)pbVar5);
          param_1 = extraout_ECX_10;
        }
        else {
          pbVar6 = *(byte **)(pbVar1 + 0x11c);
          if (pbVar6 == DAT_00567d24) {
            CPU_Instruction46(0x567d24,pbVar6,(uint)pbVar1,(int)puVar2,(uint)pbVar5);
            param_1 = extraout_ECX_11;
          }
          else {
            uVar7 = *(uint *)(pbVar1 + 0x11c);
            if (uVar7 == DAT_00567d2c) {
              CPU_Instruction44(uVar7,pbVar6,(uint)pbVar1,(int)puVar2,(uint)pbVar5);
              param_1 = extraout_ECX_12;
            }
            else if (*(int *)(pbVar1 + 0x11c) == DAT_00567d34) {
              CPU_Instruction38(uVar7,(byte *)&DAT_00567d34,(uint)pbVar1,(int)puVar2,(uint)pbVar5);
              param_1 = extraout_ECX_13;
            }
            else {
              pbVar6 = *(byte **)(pbVar1 + 0x11c);
              if (pbVar6 == DAT_00567d3c) {
                CPU_Instruction40(0x567d3c,pbVar6,(uint)pbVar1,(int)puVar2,(uint)pbVar5);
                param_1 = extraout_ECX_14;
              }
              else {
                uVar7 = *(uint *)(pbVar1 + 0x11c);
                if (uVar7 == DAT_00567d44) {
                  CPU_Instruction48(uVar7,pbVar6,pbVar1,(int)puVar2,(uint)pbVar5);
                  param_1 = extraout_ECX_15;
                }
                else if (*(int *)(pbVar1 + 0x11c) == DAT_00567d4c) {
                  CPU_Instruction47(uVar7,(byte *)&DAT_00567d4c,(uint)pbVar1,(int)puVar2,
                                    (uint)pbVar5);
                  param_1 = extraout_ECX_16;
                }
                else {
                  pbVar6 = *(byte **)(pbVar1 + 0x11c);
                  if (pbVar6 == DAT_00567d54) {
                    CPU_Instruction41(0x567d54,pbVar6,(uint)pbVar1,(int)puVar2,pbVar5);
                    param_1 = extraout_ECX_17;
                  }
                  else if (*(uint *)(pbVar1 + 0x11c) == DAT_00567d5c) {
                    CPU_Instruction49(*(uint *)(pbVar1 + 0x11c),pbVar6,pbVar1,(int)puVar2,
                                      (uint)pbVar5);
                    param_1 = extraout_ECX_18;
                  }
                  else {
                    CPU_Instruction50((uint)pbVar1,(int)puVar2,(uint)pbVar5);
                    param_1 = extraout_ECX_19;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  if ((*(uint *)(pbVar1 + 0x68) & 1) == 0) {
    pcVar8 = "Missing IHDR before IDAT";
  }
  else {
    if ((pbVar1[0x126] != 3) || ((*(uint *)(pbVar1 + 0x68) & 2) != 0)) goto LAB_004bd3cc;
    pcVar8 = "Missing PLTE before IDAT";
  }
  CPU_Instruction20(0x567ce4,pbVar6,(int)pbVar1,pcVar8);
LAB_004bd3cc:
  *(byte **)(pbVar1 + 0x10c) = pbVar5;
  *(uint *)(pbVar1 + 0x68) = *(uint *)(pbVar1 + 0x68) | 4;
  return;
}


