/*
 * Function: Security_ValidateToken
 * Address: 004e3df0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


undefined4 __cdecl
Security_ValidateToken(int param_1,int *param_2,int param_3,int param_4,int param_5)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  int *piVar6;
  int iVar7;
  int iVar8;
  uint uVar9;
  int iVar10;
  int iVar11;
  int *local_10;
  int local_c;
  int local_8;
  
  iVar1 = *(int *)param_2[5];
  piVar2 = (int *)*param_2;
  iVar8 = piVar2[2];
  iVar5 = (piVar2[1] - *piVar2) / iVar8;
  piVar6 = (int *)CPU_ProcessData12(param_1,(iVar5 + -1 + iVar1) / iVar1 << 2);
  iVar3 = *piVar2;
  iVar7 = 0;
  if (0 < param_5) {
    do {
      if (*(int *)(param_4 + iVar7 * 4) != 0) break;
      iVar7 = iVar7 + 1;
    } while (iVar7 < param_5);
  }
  if (iVar7 != param_5) {
    iVar8 = iVar8 / param_5;
    local_c = 0;
    if (0 < param_2[3]) {
      do {
        local_8 = 0;
        local_10 = piVar6;
        if (0 < iVar5) {
          do {
            if (local_c == 0) {
              uVar9 = GIF_GetImagePointer(param_2[5],(uint *)(param_1 + 4));
              if (uVar9 == 0xffffffff) {
                return 0;
              }
              iVar7 = *(int *)(param_2[8] + uVar9 * 4);
              *local_10 = iVar7;
              if (iVar7 == 0) {
                return 0;
              }
            }
            iVar7 = 0;
            if (0 < iVar1) {
              iVar11 = local_8 * iVar8 + iVar3 / param_5;
              do {
                if (iVar5 <= local_8) break;
                iVar10 = *(int *)(*local_10 + iVar7 * 4);
                if ((((piVar2[iVar10 + 5] & 1 << ((byte)local_c & 0x1f)) != 0) &&
                    (piVar4 = *(int **)(*(int *)(param_2[6] + iVar10 * 4) + local_c * 4),
                    piVar4 != (int *)0x0)) &&
                   (iVar10 = GIF_ScalePixelData(piVar4,param_3,iVar11,param_5,(uint *)(param_1 + 4),
                                                iVar8,-8), iVar10 == -1)) {
                  return 0;
                }
                iVar7 = iVar7 + 1;
                local_8 = local_8 + 1;
                iVar11 = iVar11 + iVar8;
              } while (iVar7 < iVar1);
            }
            local_10 = local_10 + 1;
          } while (local_8 < iVar5);
        }
        local_c = local_c + 1;
      } while (local_c < param_2[3]);
    }
  }
  return 0;
}


