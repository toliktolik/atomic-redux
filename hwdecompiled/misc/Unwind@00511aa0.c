/*
 * Function: Unwind@00511aa0
 * Address: 00511aa0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Instruction at (ram,0x00511ac5) overlaps instruction at (ram,0x00511ac4)
    */
/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Removing unreachable block (ram,0x00511abd) */
/* WARNING: Removing unreachable block (ram,0x00511b7d) */

uint __fastcall Unwind_00511aa0(int *param_1,uint param_2)

{
  uint *puVar1;
  byte *pbVar2;
  undefined4 uVar3;
  int iVar4;
  byte bVar5;
  uint uVar6;
  undefined6 uVar7;
  undefined1 uVar8;
  byte bVar9;
  byte bVar16;
  int *piVar12;
  undefined3 uVar17;
  uint in_EAX;
  uint uVar13;
  uint uVar14;
  int *piVar15;
  int *piVar18;
  int iVar19;
  byte bVar21;
  undefined4 unaff_EBX;
  undefined6 *puVar20;
  int *unaff_EBP;
  undefined4 *unaff_ESI;
  int *piVar22;
  int unaff_EDI;
  int *piVar23;
  undefined4 *puVar24;
  undefined2 in_CS;
  bool bVar25;
  byte in_AF;
  undefined2 in_FPUControlWord;
  undefined1 unaff_retaddr;
  undefined1 uStack00000004;
  undefined6 *puVar10;
  int *piVar11;
  
  piVar23 = (int *)(unaff_EDI + 1);
  if (!SCARRY4(unaff_EDI,1)) {
    return in_EAX;
  }
  uVar13 = in_EAX & (uint)param_1;
  puVar10 = (undefined6 *)CONCAT31((int3)((uint)unaff_EBX >> 8),0x56);
  do {
    _uStack00000004 = puVar10;
    out(*unaff_ESI,(short)param_2);
    puVar1 = (uint *)(param_2 + 0x9a4bd5c6);
    bVar9 = (byte)param_1 & 0x1f;
    *puVar1 = *puVar1 << bVar9 | *puVar1 >> 0x20 - bVar9;
    bVar9 = (byte)uVar13;
    if (!SBORROW1(*(char *)(unaff_ESI + 1),(char)*piVar23)) {
      *(undefined4 *)((int)param_1 + -0x55188152) = 0x5ef5610a;
      *(byte *)(uVar13 + 0x3e) = *(byte *)(uVar13 + 0x3e) | bVar9;
      *(char *)((int)unaff_EBP + -0x4de6167d) =
           *(char *)((int)unaff_EBP + -0x4de6167d) + (byte)param_1;
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    uVar7 = *_uStack00000004;
    in_AF = 9 < (bVar9 & 0xf) | in_AF;
    uVar14 = CONCAT31((int3)(uVar13 >> 8),bVar9 + in_AF * -6) & 0xffffff0f;
    swi(4);
    piVar15 = (int *)in(0x9a);
    puVar20 = _uStack00000004;
    while( true ) {
      bVar9 = (byte)piVar15;
      puVar24 = (undefined4 *)uVar7;
      if (-1 < (char)(bVar9 + 0x19)) {
        do {
          iVar19 = param_2 + 1;
          uVar13 = (uint)piVar15 >> 8;
          param_2 = (uint)unaff_EBP & 0xffff;
          *(undefined2 *)(puVar24 + 0x10) = in_FPUControlWord;
          iVar4 = *piVar15;
          uVar3 = in((short)unaff_EBP);
          *puVar24 = uVar3;
          piVar15 = param_1;
          param_1 = (int *)(iVar4 * 0x5d);
          puVar24 = puVar24 + 1;
        } while (-1 < (char)((byte)((uint)iVar19 >> 8) & (byte)uVar13));
        do {
                    /* WARNING: Do nothing block with infinite loop */
        } while( true );
      }
      if (bVar9 < 0xe7) break;
      puVar20 = (undefined6 *)(*(int *)((int)puVar20 + -0x32) * -0x651a67ea);
    }
    unaff_ESI = (undefined4 *)
                (CONCAT22((short)(uVar14 >> 0x10),CONCAT11((char)(uVar13 >> 8) - in_AF,(char)uVar14)
                         ) + 1);
    *(byte *)((int)param_1 + -0x77) = *(byte *)((int)param_1 + -0x77) << 1 | bVar9 < 0xe7;
    piVar22 = (int *)((int)(undefined4 *)uVar7 + -1);
    while( true ) {
      piVar23 = piVar22;
      piVar11 = piVar15;
      bVar9 = (byte)piVar11 + 0x93;
      puVar10 = (undefined6 *)CONCAT31((int3)((uint)piVar11 >> 8),bVar9);
      uVar13 = (int)puVar20 + 1;
      if (uVar13 == 0 || SCARRY4((int)puVar20,1) != (int)uVar13 < 0) break;
      param_2 = (int)uVar13 >> 0x1f;
      unaff_EBP = (int *)((int)unaff_EBP + 1);
      piVar22 = (int *)((int)piVar23 + 1);
      uVar14 = (uint)(0x6c < (byte)piVar11);
      uVar6 = (int)puVar20 + 0x51294c72;
      bVar25 = uVar13 < 0xaed6b38f || uVar6 < uVar14;
      piVar12 = (int *)(uVar6 - uVar14);
      piVar15 = piVar12;
      puVar20 = puVar10;
      if (piVar12 == (int *)0x0 ||
          (SBORROW4(uVar13,-0x51294c71) != SBORROW4(uVar6,uVar14)) != (int)piVar12 < 0) {
        bVar16 = (byte)((uint)piVar12 >> 8);
        bVar21 = (byte)((uint)piVar11 >> 8);
        bVar5 = bVar21 + bVar16;
        piVar18 = (int *)CONCAT31((int3)((uint)param_1 >> 8),
                                  ((char)param_1 - bVar16) -
                                  (CARRY1(bVar21,bVar16) || CARRY1(bVar5,bVar25)));
        in_AF = ((uint)unaff_EBP & 0x1000) != 0;
        param_2 = param_2 - 1;
        pbVar2 = (byte *)(param_2 + (int)piVar22);
        *pbVar2 = *pbVar2 | bVar9;
        uVar17 = (undefined3)((uint)unaff_EBP >> 8);
        if ((POPCOUNT(*pbVar2) & 1U) != 0) {
          *piVar22 = (*piVar22 - param_2) - (uint)((byte)unaff_EBP < 199);
          LOCK();
          *(char *)CONCAT31(uVar17,((byte)unaff_EBP + 0x39 ^ 0x54) + 0x9d) =
               (char)((uint)((int)piVar18 * 2) >> 8);
          UNLOCK();
          func_0x04437490();
          return CONCAT13(uStack00000004,CONCAT12(unaff_retaddr,in_CS));
        }
        unaff_retaddr = (undefined1)((uint)param_1 >> 0x18);
        *(int **)((int)piVar23 + 0x21) = piVar18;
        uVar8 = in(4);
        puVar20 = (undefined6 *)CONCAT31(uVar17,uVar8);
        piVar15 = (int *)CONCAT22((short)((uint)piVar11 >> 0x10),CONCAT11(bVar5 + bVar25,bVar9));
        param_1 = piVar18;
        unaff_EBP = piVar12;
      }
    }
  } while( true );
}


