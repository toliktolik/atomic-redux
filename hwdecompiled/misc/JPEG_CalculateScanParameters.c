/*
 * Function: JPEG_CalculateScanParameters
 * Address: 004daab0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


uint JPEG_CalculateScanParameters(void)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int *unaff_ESI;
  int *local_c;
  uint local_8;
  
  iVar2 = unaff_ESI[0x39];
  if (iVar2 == 1) {
    iVar2 = unaff_ESI[0x3a];
    unaff_ESI[0x3e] = *(int *)(iVar2 + 0x1c);
    unaff_ESI[0x3f] = *(int *)(iVar2 + 0x20);
    uVar4 = *(uint *)(iVar2 + 0xc);
    uVar1 = *(uint *)(iVar2 + 0x20) / uVar4;
    uVar3 = *(uint *)(iVar2 + 0x20) % uVar4;
    *(undefined4 *)(iVar2 + 0x34) = 1;
    *(undefined4 *)(iVar2 + 0x38) = 1;
    *(undefined4 *)(iVar2 + 0x3c) = 1;
    *(undefined4 *)(iVar2 + 0x40) = 8;
    *(undefined4 *)(iVar2 + 0x44) = 1;
    if (uVar3 == 0) {
      uVar3 = uVar4;
    }
    *(uint *)(iVar2 + 0x48) = uVar3;
    unaff_ESI[0x40] = 1;
    unaff_ESI[0x41] = 0;
  }
  else {
    if ((iVar2 < 1) || (4 < iVar2)) {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x1a;
      *(int *)(*unaff_ESI + 0x18) = unaff_ESI[0x39];
      *(undefined4 *)(*unaff_ESI + 0x1c) = 4;
      (**(code **)*unaff_ESI)();
    }
    iVar2 = Math_AlignToMultiple(unaff_ESI[7],unaff_ESI[0x36] << 3);
    unaff_ESI[0x3e] = iVar2;
    iVar2 = Math_AlignToMultiple(unaff_ESI[8],unaff_ESI[0x37] << 3);
    unaff_ESI[0x3f] = iVar2;
    uVar1 = unaff_ESI[0x39];
    unaff_ESI[0x40] = 0;
    local_8 = 0;
    if (0 < (int)uVar1) {
      local_c = unaff_ESI + 0x3a;
      do {
        iVar2 = *local_c;
        uVar1 = *(uint *)(iVar2 + 8);
        *(uint *)(iVar2 + 0x40) = uVar1 * 8;
        uVar4 = *(uint *)(iVar2 + 0x1c) % uVar1;
        *(int *)(iVar2 + 0x38) = *(int *)(iVar2 + 0xc);
        iVar5 = *(int *)(iVar2 + 0xc) * uVar1;
        *(uint *)(iVar2 + 0x34) = uVar1;
        *(int *)(iVar2 + 0x3c) = iVar5;
        if (uVar4 == 0) {
          uVar4 = uVar1;
        }
        *(uint *)(iVar2 + 0x44) = uVar4;
        uVar1 = *(uint *)(iVar2 + 0x20) % *(uint *)(iVar2 + 0xc);
        if (uVar1 == 0) {
          uVar1 = *(uint *)(iVar2 + 0xc);
        }
        *(uint *)(iVar2 + 0x48) = uVar1;
        if (10 < unaff_ESI[0x40] + iVar5) {
          *(undefined4 *)(*unaff_ESI + 0x14) = 0xd;
          (**(code **)*unaff_ESI)();
        }
        if (0 < iVar5) {
          do {
            unaff_ESI[unaff_ESI[0x40] + 0x41] = local_8;
            iVar5 = iVar5 + -1;
            unaff_ESI[0x40] = unaff_ESI[0x40] + 1;
          } while (iVar5 != 0);
        }
        uVar1 = local_8 + 1;
        local_c = local_c + 1;
        local_8 = uVar1;
      } while ((int)uVar1 < unaff_ESI[0x39]);
    }
  }
  if (0 < unaff_ESI[0x30]) {
    uVar1 = unaff_ESI[0x3e] * unaff_ESI[0x30];
    if (0xfffe < (int)uVar1) {
      uVar1 = 0xffff;
    }
    unaff_ESI[0x2f] = uVar1;
  }
  return uVar1;
}


