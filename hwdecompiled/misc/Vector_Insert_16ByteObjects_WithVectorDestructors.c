/*
 * Function: Vector_Insert_16ByteObjects_WithVectorDestructors
 * Address: 0040b2f0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __thiscall
Vector_Insert_16ByteObjects_WithVectorDestructors
          (void *this,undefined1 *param_1,undefined1 *param_2,undefined1 *param_3)

{
  undefined1 *puVar1;
  undefined1 *puVar2;
  int iVar3;
  undefined4 uVar4;
  undefined1 *puVar5;
  undefined1 *extraout_ECX;
  int iVar6;
  int extraout_ECX_00;
  undefined1 *puVar7;
  undefined1 *extraout_ECX_01;
  undefined1 *extraout_ECX_02;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  undefined1 *extraout_EDX_02;
  uint extraout_EDX_03;
  uint uVar8;
  uint extraout_EDX_04;
  undefined1 local_2c [4];
  int iStack_28;
  int iStack_24;
  undefined1 *local_1c;
  void *local_18;
  undefined1 *local_14;
  void *pvStack_10;
  undefined4 uStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  uStack_c = 0x50fc38;
  pvStack_10 = ExceptionList;
  local_14 = &stack0xffffffc8;
  ExceptionList = &pvStack_10;
  local_18 = this;
  Wave_ProcessSpawning(local_2c,(int)param_3);
  puVar7 = param_2;
  puVar2 = param_1;
  uVar8 = *(uint *)((int)this + 4);
  puVar5 = (undefined1 *)0x0;
  local_8 = 0;
  if (uVar8 == 0) {
    puVar1 = (undefined1 *)0x0;
  }
  else {
    puVar1 = (undefined1 *)((int)(*(int *)((int)this + 0xc) - uVar8) >> 4);
  }
  if (param_2 != (undefined1 *)0x0) {
    if (uVar8 != 0) {
      puVar5 = (undefined1 *)((int)(*(int *)((int)this + 8) - uVar8) >> 4);
    }
    if ((undefined1 *)(0xfffffffU - (int)puVar5) < param_2) {
      Level_InitializeVodkavania();
      puVar5 = extraout_ECX;
      uVar8 = extraout_EDX;
    }
    else {
      if (uVar8 == 0) {
        iVar6 = 0;
      }
      else {
        iVar6 = (int)(*(int *)((int)this + 8) - uVar8) >> 4;
      }
      if (puVar1 < param_2 + iVar6) {
        if ((undefined1 *)(0xfffffff - ((uint)puVar1 >> 1)) < puVar1) {
          puVar1 = (undefined1 *)0x0;
        }
        else {
          puVar1 = puVar1 + ((uint)puVar1 >> 1);
        }
        if (uVar8 == 0) {
          iVar6 = 0;
        }
        else {
          iVar6 = (int)(*(int *)((int)this + 8) - uVar8) >> 4;
        }
        if (puVar1 < param_2 + iVar6) {
          if (uVar8 == 0) {
            iVar6 = 0;
          }
          else {
            iVar6 = (int)(*(int *)((int)this + 8) - uVar8) >> 4;
          }
          puVar1 = param_2 + iVar6;
        }
        param_3 = (undefined1 *)((int)puVar1 << 4);
        puVar2 = (undefined1 *)operator_new((uint)param_3);
        local_8 = CONCAT31(local_8._1_3_,1);
        param_2 = puVar2;
        local_1c = puVar2;
        param_2 = (undefined1 *)
                  Survival_ExecuteWaveSpawning(*(int *)((int)this + 4),(int)param_1,puVar2);
        Survival_ProcessBossEncounters(param_2,(int)puVar7,(int)local_2c);
        param_2 = param_2 + (int)puVar7 * 0x10;
        Survival_ExecuteWaveSpawning((int)param_1,*(int *)((int)this + 8),param_2);
        iVar6 = *(int *)((int)this + 4);
        if (iVar6 == 0) {
          iVar3 = 0;
        }
        else {
          iVar3 = *(int *)((int)this + 8) - iVar6 >> 4;
        }
        if (iVar6 != 0) {
          ArrayDestroy_16ByteVectors(this,*(uint *)((int)this + 8),iVar6,*(uint *)((int)this + 8));
                    /* WARNING: Subroutine does not return */
          System_ShutdownHandler(extraout_ECX_00,extraout_EDX_01);
        }
        *(undefined1 **)((int)this + 4) = puVar2;
        puVar5 = param_3 + (int)puVar2;
        *(undefined1 **)((int)this + 0xc) = puVar5;
        *(undefined1 **)((int)this + 8) = puVar2 + (int)(puVar7 + iVar3) * 0x10;
        uVar8 = extraout_EDX_00;
      }
      else {
        local_1c = *(undefined1 **)((int)this + 8);
        if ((undefined1 *)((int)local_1c - (int)param_1 >> 4) < param_2) {
          param_3 = (undefined1 *)((int)param_2 * 0x10);
          puVar5 = local_1c;
          local_1c = &stack0xffffffbc;
          Survival_ProcessDifficultyScaling((int)param_1,(int)puVar5,param_3 + (int)param_1);
          local_8 = CONCAT31(local_8._1_3_,3);
          Survival_ProcessEndlessWaves
                    (*(void **)((int)this + 8),
                     (int)puVar7 - ((int)*(void **)((int)this + 8) - (int)puVar2 >> 4),(int)local_2c
                    );
          iVar6 = *(int *)((int)this + 8);
          local_8 = 0;
          *(undefined1 **)((int)this + 8) = param_3 + iVar6;
          puVar5 = local_2c;
          puVar7 = param_3;
          puVar1 = param_3 + iVar6 + -(int)param_3;
        }
        else {
          param_3 = (undefined1 *)((int)param_2 * 0x10);
          param_1 = &stack0xffffffbc;
          puVar5 = local_1c + (int)param_2 * -0x10;
          uVar4 = Survival_ProcessDifficultyScaling((int)puVar5,(int)local_1c,local_1c);
          *(undefined4 *)((int)this + 8) = uVar4;
          param_1 = &stack0xffffffbc;
          MemoryCopy_Backward_16ByteObjects_Alt_Wrapper
                    ((int *)&param_1,puVar2,(uint)puVar5,(int)local_1c);
          puVar7 = param_3 + (int)puVar2;
          puVar5 = extraout_EDX_02;
          puVar1 = puVar7;
        }
        param_1 = &stack0xffffffbc;
        ArrayInit_16ByteObjects_Alt(puVar7,(uint)puVar5,(int)puVar2,(int)puVar1,(int)local_2c);
        puVar5 = extraout_ECX_01;
        uVar8 = extraout_EDX_03;
      }
    }
  }
  iVar6 = iStack_28;
  if (iStack_28 != 0) {
    for (; iVar6 != iStack_24; iVar6 = iVar6 + 0x50) {
      SingleDataStructure_Destructor(iVar6,uVar8,0);
      puVar5 = extraout_ECX_02;
      uVar8 = extraout_EDX_04;
    }
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler((int)puVar5,uVar8);
  }
  ExceptionList = pvStack_10;
  return;
}


