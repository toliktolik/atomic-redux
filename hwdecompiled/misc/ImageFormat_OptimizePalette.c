/*
 * Function: ImageFormat_OptimizePalette
 * Address: 004bdfb0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl ImageFormat_OptimizePalette(uint *param_1,undefined1 *param_2,char param_3)

{
  uint uVar1;
  undefined1 *puVar2;
  int iVar3;
  uint uVar4;
  
  uVar1 = *param_1;
  if (*(char *)((int)param_1 + 10) != '\x04') {
    if (*(char *)((int)param_1 + 10) == '\x02') {
      if (*(char *)((int)param_1 + 9) == '\b') {
        uVar4 = uVar1;
        puVar2 = param_2;
        if (param_3 < '\0') {
          if (uVar1 != 0) {
            do {
              *puVar2 = *param_2;
              param_2 = param_2 + 2;
              uVar4 = uVar4 - 1;
              puVar2 = puVar2 + 1;
            } while (uVar4 != 0);
            param_1[1] = uVar1;
            *(undefined1 *)((int)param_1 + 0xb) = 8;
            *(undefined1 *)((int)param_1 + 10) = 1;
            *(byte *)(param_1 + 2) = (byte)param_1[2] & 0xfb;
            return;
          }
        }
        else {
          for (; uVar4 != 0; uVar4 = uVar4 - 1) {
            *param_2 = puVar2[1];
            param_2 = param_2 + 1;
            puVar2 = puVar2 + 2;
          }
        }
        param_1[1] = uVar1;
        *(undefined1 *)((int)param_1 + 0xb) = 8;
        *(undefined1 *)((int)param_1 + 10) = 1;
        *(byte *)(param_1 + 2) = (byte)param_1[2] & 0xfb;
        return;
      }
      uVar4 = uVar1;
      puVar2 = param_2;
      if (param_3 < '\0') {
        if (1 < uVar1) {
          iVar3 = uVar1 - 1;
          do {
            param_2[2] = puVar2[4];
            param_2[3] = puVar2[5];
            iVar3 = iVar3 + -1;
            param_2 = param_2 + 2;
            puVar2 = puVar2 + 4;
          } while (iVar3 != 0);
        }
      }
      else {
        for (; uVar4 != 0; uVar4 = uVar4 - 1) {
          *param_2 = puVar2[2];
          param_2[1] = puVar2[3];
          param_2 = param_2 + 2;
          puVar2 = puVar2 + 4;
        }
      }
      param_1[1] = uVar1 * 2;
      *(undefined1 *)((int)param_1 + 0xb) = 0x10;
      *(undefined1 *)((int)param_1 + 10) = 1;
      *(byte *)(param_1 + 2) = (byte)param_1[2] & 0xfb;
    }
    return;
  }
  if (*(char *)((int)param_1 + 9) != '\b') {
    uVar4 = uVar1;
    puVar2 = param_2;
    if (param_3 < '\0') {
      if (1 < uVar1) {
        iVar3 = uVar1 - 1;
        do {
          param_2[6] = puVar2[8];
          param_2[7] = puVar2[9];
          param_2[8] = puVar2[10];
          param_2[9] = puVar2[0xb];
          param_2[10] = puVar2[0xc];
          param_2[0xb] = puVar2[0xd];
          iVar3 = iVar3 + -1;
          param_2 = param_2 + 6;
          puVar2 = puVar2 + 8;
        } while (iVar3 != 0);
      }
    }
    else {
      for (; uVar4 != 0; uVar4 = uVar4 - 1) {
        *param_2 = puVar2[2];
        param_2[1] = puVar2[3];
        param_2[2] = puVar2[4];
        param_2[3] = puVar2[5];
        param_2[4] = puVar2[6];
        param_2[5] = puVar2[7];
        param_2 = param_2 + 6;
        puVar2 = puVar2 + 8;
      }
    }
    param_1[1] = uVar1 * 6;
    *(undefined1 *)((int)param_1 + 0xb) = 0x30;
    *(undefined1 *)((int)param_1 + 10) = 3;
    *(byte *)(param_1 + 2) = (byte)param_1[2] & 0xfb;
    return;
  }
  uVar4 = uVar1;
  puVar2 = param_2;
  if (param_3 < '\0') {
    if (1 < uVar1) {
      iVar3 = uVar1 - 1;
      do {
        puVar2[3] = param_2[4];
        puVar2[4] = param_2[5];
        puVar2[5] = param_2[6];
        iVar3 = iVar3 + -1;
        param_2 = param_2 + 4;
        puVar2 = puVar2 + 3;
      } while (iVar3 != 0);
      param_1[1] = uVar1 * 3;
      *(undefined1 *)((int)param_1 + 0xb) = 0x18;
      *(undefined1 *)((int)param_1 + 10) = 3;
      *(byte *)(param_1 + 2) = (byte)param_1[2] & 0xfb;
      return;
    }
  }
  else {
    for (; uVar4 != 0; uVar4 = uVar4 - 1) {
      *param_2 = puVar2[1];
      param_2[1] = puVar2[2];
      param_2[2] = puVar2[3];
      param_2 = param_2 + 3;
      puVar2 = puVar2 + 4;
    }
  }
  param_1[1] = uVar1 * 3;
  *(undefined1 *)((int)param_1 + 0xb) = 0x18;
  *(undefined1 *)((int)param_1 + 10) = 3;
  *(byte *)(param_1 + 2) = (byte)param_1[2] & 0xfb;
  return;
}


