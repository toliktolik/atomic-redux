/*
 * Function: Unwind@00512500
 * Address: 00512500
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x00512505) overlaps instruction at (ram,0x00512502)
    */
/* WARNING: Unable to track spacebase fully for stack */

int __fastcall Unwind_00512500(uint *param_1,uint *param_2)

{
  int *piVar1;
  short sVar2;
  char cVar3;
  code *pcVar4;
  byte bVar5;
  undefined4 *in_EAX;
  int iVar6;
  undefined4 *puVar7;
  undefined4 uVar8;
  uint *puVar9;
  int extraout_ECX;
  int unaff_EBX;
  undefined4 *unaff_EBP;
  int unaff_ESI;
  uint unaff_EDI;
  undefined2 in_CS;
  undefined2 in_DS;
  byte in_CF;
  char in_ZF;
  char in_SF;
  char in_OF;
  uint6 uVar10;
  int unaff_retaddr;
  
  if ((bool)in_CF) {
    puVar7 = in_EAX;
    puVar9 = param_1;
    if (!(bool)in_ZF && in_OF == in_SF) goto LAB_0051256d;
  }
  else {
    unaff_ESI = unaff_ESI + -1;
    sVar2 = ((ushort)unaff_ESI & 3) - ((ushort)unaff_EBP & 3);
    in_ZF = 0 < sVar2;
    unaff_EBP = (undefined4 *)
                CONCAT22((short)((uint)unaff_EBP >> 0x10),
                         (ushort)unaff_EBP +
                         (ushort)((byte)((uint)param_2 >> 8) < *(byte *)((int)unaff_EBP + 0x7f)) *
                         sVar2);
  }
  puVar7 = unaff_EBP;
  puVar9 = (uint *)((int)param_1 + -1);
  if (puVar9 == (uint *)0x0 || in_ZF == '\0') {
    *(undefined2 *)param_1 = in_DS;
    param_1[-1] = unaff_EBX;
    pcVar4 = (code *)swi(3);
    iVar6 = (*pcVar4)();
    return iVar6;
  }
  unaff_EBP = (undefined4 *)((uint)in_EAX ^ 0xffffff80);
  *param_1 = unaff_EDI;
  if ((int)unaff_EBP < 1) {
    puVar9 = param_1 + -1;
    param_1[-1] = (uint)unaff_EBP;
    cVar3 = '\b';
    do {
      unaff_EBP = unaff_EBP + -1;
      puVar9 = puVar9 + -1;
      *puVar9 = *unaff_EBP;
      cVar3 = cVar3 + -1;
    } while ('\0' < cVar3);
    param_1[-10] = (uint)(param_1 + -1);
    if (SBORROW1((char)unaff_EBX,'2')) {
      do {
                    /* WARNING: Do nothing block with infinite loop */
      } while( true );
    }
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  param_2 = (uint *)*param_1;
  in_CF = 0;
  unaff_EDI = unaff_EDI | *param_2;
  in_SF = (int)unaff_EDI < 0;
LAB_0051256d:
  *(undefined4 **)(unaff_retaddr + -4) = puVar7;
  *(uint **)(unaff_retaddr + -8) = puVar9;
  *(uint **)(unaff_retaddr + -0xc) = param_2;
  *(int *)(unaff_retaddr + -0x10) = unaff_EBX;
  *(int *)(unaff_retaddr + -0x14) = unaff_retaddr;
  *(undefined4 **)(unaff_retaddr + -0x18) = unaff_EBP;
  *(int *)(unaff_retaddr + -0x1c) = unaff_ESI;
  *(uint *)(unaff_retaddr + -0x20) = unaff_EDI;
  if ((bool)in_SF) {
    piVar1 = (int *)(CONCAT22((short)((uint)param_2 >> 0x10),CONCAT11((char)unaff_EBX,(char)param_2)
                             ) + -0x46);
    *piVar1 = (*piVar1 - unaff_ESI) - (uint)in_CF;
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  *(undefined2 *)unaff_EBP = in_CS;
  unaff_EBP[-1] = 0x51258d;
  uVar10 = func_0x0efba9a4();
  puVar9 = (uint *)(unaff_EDI + 0x46);
  *puVar9 = *puVar9 >> 9 | *puVar9 << 0x17;
  *(int *)(unaff_ESI + -0x1f076a2d) =
       (*(int *)(unaff_ESI + -0x1f076a2d) + -0x5c) - (uint)((int)*puVar9 < 0);
  if (extraout_ECX != 1 && (uVar10 & 0xef) == 0) {
    return ((uint)uVar10 & 0xffffffef) * unaff_EBX;
  }
  uVar8 = in((short)(uVar10 >> 0x20));
  bVar5 = (byte)uVar8;
  return CONCAT31((int3)(CONCAT22((short)((uint)uVar8 >> 0x10),CONCAT11(bVar5 / 0xe9,bVar5)) >> 8),
                  bVar5 % 0xe9);
}


