/*
 * Function: PNG_WriteChunk
 * Address: 004cef70
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __thiscall PNG_WriteChunk(void *this,int *param_1,byte *param_2,byte *param_3)

{
  byte bVar1;
  uint uVar2;
  byte bVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  int local_3c [4];
  uint local_2c [4];
  uint local_1c;
  int local_18;
  uint local_14;
  int *local_10;
  uint local_c;
  uint local_8;
  
  if (*(byte *)(param_1 + 2) != 3) {
    bVar1 = *(byte *)((int)param_1 + 9);
    uVar2 = CONCAT31((int3)((uint)this >> 8),bVar1);
    uVar4 = (uint)bVar1;
    if ((*(byte *)(param_1 + 2) & 2) == 0) {
      local_2c[0] = (uint)param_3[3];
      uVar5 = 1;
    }
    else {
      local_2c[0] = (uint)*param_3;
      local_2c[1] = (uint)param_3[1];
      local_3c[1] = uVar4 - param_3[1];
      local_3c[2] = uVar4 - param_3[2];
      local_2c[2] = (uint)param_3[2];
      uVar5 = 3;
    }
    local_3c[0] = uVar4 - local_2c[0];
    local_8 = uVar5;
    if ((*(byte *)(param_1 + 2) & 4) != 0) {
      bVar3 = param_3[4];
      local_3c[uVar5] = uVar4 - bVar3;
      local_2c[uVar5] = (uint)bVar3;
      uVar5 = uVar5 + 1;
      local_8 = uVar5;
    }
    if (bVar1 < 8) {
      local_c = param_1[1];
      if ((param_3[3] == 1) && (bVar1 == 2)) {
        param_1._3_1_ = 0x55;
      }
      else if ((bVar1 != 4) || (param_1._3_1_ = 0x11, param_3[3] != 3)) {
        param_1._3_1_ = 0xff;
      }
      if (local_c != 0) {
        do {
          bVar1 = *param_2;
          *param_2 = 0;
          if ((int)-local_2c[0] < local_3c[0]) {
            iVar6 = -local_3c[0];
            iVar7 = local_3c[0];
            do {
              if (iVar7 < 1) {
                bVar3 = bVar1 >> ((byte)iVar6 & 0x1f) & param_1._3_1_;
              }
              else {
                bVar3 = bVar1 << ((byte)iVar7 & 0x1f);
              }
              *param_2 = *param_2 | bVar3;
              iVar7 = iVar7 - local_2c[0];
              iVar6 = iVar6 + local_2c[0];
            } while ((int)-local_2c[0] < iVar7);
          }
          param_2 = param_2 + 1;
          local_c = local_c + -1;
        } while (local_c != 0);
        return;
      }
    }
    else if (bVar1 == 8) {
      local_1c = *param_1 * uVar5;
      local_8 = 0;
      if (local_1c != 0) {
        do {
          uVar4 = local_8 % uVar5;
          bVar1 = *param_2;
          local_14 = local_2c[uVar4];
          param_1 = (int *)CONCAT22(param_1._2_2_,(ushort)bVar1);
          *param_2 = 0;
          iVar7 = local_3c[uVar4];
          if (iVar7 != -local_14 && SBORROW4(iVar7,-local_14) == (int)(iVar7 + local_14) < 0) {
            uVar4 = local_2c[uVar4];
            local_18 = -uVar4;
            local_c = -iVar7;
            do {
              if (iVar7 < 1) {
                local_10 = param_1;
                bVar3 = bVar1 >> ((byte)local_c & 0x1f);
              }
              else {
                bVar3 = bVar1 << ((byte)iVar7 & 0x1f);
              }
              iVar7 = iVar7 - local_14;
              *param_2 = *param_2 | bVar3;
              local_c = local_c + local_14;
            } while ((int)-uVar4 < iVar7);
          }
          local_8 = local_8 + 1;
          param_2 = param_2 + 1;
        } while (local_8 < local_1c);
        return;
      }
    }
    else {
      local_14 = *param_1 * uVar5;
      local_c = 0;
      if (local_14 != 0) {
        do {
          param_1 = (int *)0x0;
          param_1._0_2_ = 0;
          param_3 = (byte *)(CONCAT22((short)((uint)param_3 >> 0x10),(ushort)*param_2) * 0x100 +
                            CONCAT22((short)(uVar2 >> 0x10),(ushort)param_2[1]));
          iVar7 = local_3c[local_c % uVar5];
          local_1c = local_2c[local_c % uVar5];
          if (iVar7 != -local_1c && SBORROW4(iVar7,-local_1c) == (int)(iVar7 + local_1c) < 0) {
            local_18 = -local_2c[local_c % uVar5];
            local_10 = (int *)-iVar7;
            do {
              if (iVar7 < 1) {
                uVar4 = (uint)(ushort)((ushort)param_3 >> ((byte)local_10 & 0x1f));
              }
              else {
                uVar4 = (int)param_3 << ((byte)iVar7 & 0x1f);
              }
              param_1 = (int *)((uint)param_1 | uVar4);
              iVar7 = iVar7 - local_1c;
              local_10 = (int *)((int)local_10 + local_1c);
            } while (local_18 < iVar7);
          }
          *param_2 = (byte)((ushort)param_1._0_2_ >> 8);
          param_2[1] = (byte)param_1._0_2_;
          param_2 = param_2 + 2;
          local_c = local_c + 1;
          uVar2 = local_14;
        } while (local_c < local_14);
      }
    }
  }
  return;
}


