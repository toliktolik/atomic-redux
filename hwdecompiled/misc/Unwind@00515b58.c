/*
 * Function: Unwind@00515b58
 * Address: 00515b58
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x00515b64) overlaps instruction at (ram,0x00515b63)
    */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: This function may have set the stack pointer */

void __fastcall
Unwind_00515b58(undefined4 param_1,int param_2,byte *param_3,undefined4 *param_4,undefined4 param_5,
               undefined4 param_6,uint param_7,undefined4 param_8,undefined2 param_9)

{
  byte *pbVar1;
  undefined1 uVar2;
  char cVar3;
  code *pcVar4;
  undefined4 *puVar5;
  undefined4 in_EAX;
  byte bVar6;
  int iVar7;
  int iVar8;
  undefined4 *puVar9;
  undefined4 *puVar10;
  undefined4 *unaff_ESI;
  undefined1 *unaff_EDI;
  char in_CF;
  bool bVar11;
  byte in_AF;
  byte in_TF;
  byte in_IF;
  byte in_NT;
  byte in_AC;
  byte in_VIF;
  byte in_VIP;
  byte in_ID;
  int unaff_retaddr;
  
  bVar6 = *(byte *)((int)unaff_ESI + -0x3b);
  *unaff_EDI = (char)((uint)param_1 >> 8);
  out((short)param_2,in_EAX);
  bVar11 = (byte)(((char)in_EAX + '\x1f') - in_CF) < 0xbd;
  while (iVar7 = param_2, iVar8 = iVar7, !bVar11) {
    pbVar1 = (byte *)((int)unaff_ESI + 0x2455e1a1);
    *pbVar1 = *pbVar1 << (bVar6 & 7) | *pbVar1 >> 8 - (bVar6 & 7);
    bVar6 = 0xf3;
    bVar11 = (longlong)(int)&param_3 != (longlong)(int)&stack0x00000000 * -0x26031546;
    iVar8 = iRam748694da;
    unaff_retaddr = iVar7;
    if (!bVar11) break;
    param_2 = iRam748694da;
    if (!bVar11) {
      uVar2 = in((short)iRam748694da);
      *unaff_EDI = uVar2;
      pcVar4 = (code *)swi(1);
      (*pcVar4)();
      return;
    }
  }
  out(*unaff_ESI,(short)iVar8);
  *(uint *)(&stack0x0000007e + (unaff_retaddr + -1) * 2) =
       *(uint *)(&stack0x0000007e + (unaff_retaddr + -1) * 2) | (uint)param_3;
  puVar9 = (undefined4 *)((uint)&param_9 & param_7);
  if ((char)param_7 == *(char *)*puVar9) {
    puVar10 = (undefined4 *)((int)puVar9 + 1);
    *(undefined4 **)((int)puVar9 + 1) = param_4;
    cVar3 = '\x04';
    puVar5 = param_4;
    do {
      puVar5 = puVar5 + -1;
      puVar10 = puVar10 + -1;
      *puVar10 = *puVar5;
      cVar3 = cVar3 + -1;
    } while ('\0' < cVar3);
    *(int *)((int)puVar9 + -0x13) = (int)puVar9 + 1;
    puVar5 = (undefined4 *)puVar9[-0x2db0];
    puVar10 = puVar9 + -0x2db0;
    puVar9[-0x2db0] = puVar5;
    cVar3 = '\x14';
    do {
      puVar5 = puVar5 + -1;
      puVar10 = puVar10 + -1;
      *puVar10 = *puVar5;
      cVar3 = cVar3 + -1;
    } while ('\0' < cVar3);
    puVar9[-0x2dc5] = puVar9 + -0x2db0;
    *(uint *)((int)puVar9 + -0xc20f) =
         (uint)(in_NT & 1) * 0x4000 | (uint)SCARRY4((int)(puVar9 + -0x3083),1) * 0x800 |
         (uint)(in_IF & 1) * 0x200 | (uint)(in_TF & 1) * 0x100 |
         (uint)((int)puVar9 + -0xc20b < 0) * 0x80 | (uint)(puVar9 == (undefined4 *)0xc20b) * 0x40 |
         (uint)(in_AF & 1) * 0x10 | (uint)((POPCOUNT((int)puVar9 - 0xc20bU & 0xff) & 1U) == 0) * 4 |
         (uint)(*param_3 < 0xc2) | (uint)(in_ID & 1) * 0x200000 | (uint)(in_VIP & 1) * 0x100000 |
         (uint)(in_VIF & 1) * 0x80000 | (uint)(in_AC & 1) * 0x40000;
    pcVar4 = (code *)swi(3);
    (*pcVar4)();
    return;
  }
  puVar10 = (undefined4 *)((int)puVar9 + 1);
  *(undefined4 **)((int)puVar9 + 1) = param_4;
  cVar3 = '\x13';
  do {
    param_4 = param_4 + -1;
    puVar10 = puVar10 + -1;
    *puVar10 = *param_4;
    cVar3 = cVar3 + -1;
  } while ('\0' < cVar3);
  *(int *)((int)puVar9 + -0x4f) = (int)puVar9 + 1;
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}


