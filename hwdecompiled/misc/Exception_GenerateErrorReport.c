/*
 * Function: Exception_GenerateErrorReport
 * Address: 004ae8c0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl Exception_GenerateErrorReport(int *param_1)

{
  char cVar1;
  int *piVar2;
  int iVar3;
  char *pcVar4;
  _String_base *p_Var5;
  char *pcVar6;
  int iVar7;
  int extraout_ECX;
  int extraout_ECX_00;
  int extraout_ECX_01;
  int extraout_ECX_02;
  int extraout_ECX_03;
  int *extraout_ECX_04;
  int *piVar8;
  int extraout_ECX_05;
  undefined2 extraout_DX;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint extraout_EDX_03;
  undefined8 uVar9;
  uint unaff_retaddr;
  undefined4 *in_stack_fffff71c;
  undefined4 *in_stack_fffff720;
  undefined1 local_e4 [4];
  uint local_e0;
  undefined4 local_d0;
  uint local_cc;
  _String_base local_c8 [4];
  uint local_c4;
  undefined4 local_b4;
  uint local_b0;
  _String_base local_ac [4];
  uint local_a8;
  undefined4 local_98;
  uint local_94;
  _String_base local_90 [4];
  uint local_8c;
  undefined4 local_7c;
  uint local_78;
  _String_base local_74 [4];
  uint local_70;
  int local_60;
  uint local_5c;
  int local_58;
  int local_54;
  _String_base local_50 [4];
  uint local_4c;
  undefined4 local_3c;
  uint local_38;
  _String_base local_34 [4];
  uint local_30;
  int local_20;
  uint local_1c;
  char local_15;
  uint local_14;
  void *local_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_00516804;
  local_10 = ExceptionList;
  local_14 = DAT_00569f5c ^ unaff_retaddr;
  ExceptionList = &local_10;
  local_15 = DebugSymbols_Initialize();
  local_94 = 0xf;
  local_98 = 0;
  local_a8 = local_a8 & 0xffffff00;
  local_38 = 0xf;
  local_3c = 0;
  local_4c = local_4c & 0xffffff00;
  iVar7 = 0;
  local_8 = 1;
  if (DAT_00566b90 != -1) {
    iVar3 = DAT_00566b90;
    do {
      if (iVar3 == *(int *)*param_1) {
        if ((&PTR_s_Segment_Notification_00566b94)[iVar7 * 2] != (undefined *)0x0) {
          GetCurrentThreadId();
          Exception_Release(&stack0xfffff71c,
                            "Exception: %s (code 0x%x) at address %08X in thread %X\r\n");
          goto LAB_004ae969;
        }
        break;
      }
      iVar3 = (&DAT_00566b98)[iVar7 * 2];
      iVar7 = iVar7 + 1;
    } while (iVar3 != -1);
  }
  GetCurrentThreadId();
  Exception_Release(&stack0xfffff71c,
                    "Unknown exception: (code 0x%x) at address %08X in thread %X\r\n");
LAB_004ae969:
  pcVar4 = &stack0xfffff71c;
  do {
    cVar1 = *pcVar4;
    pcVar4 = pcVar4 + 1;
  } while (cVar1 != '\0');
  Enemy_ProcessSatelliteLogic
            (local_50,(_String_base *)&stack0xfffff71c,(int)pcVar4 - (int)&stack0xfffff71d);
  Matrix_Transpose(*(LPCVOID *)(*param_1 + 0xc),&stack0xfffff71c,0x800,&local_54,&local_58);
  pcVar4 = &stack0xfffff71c;
  local_78 = 0xf;
  local_7c = 0;
  local_8c = local_8c & 0xffffff00;
  do {
    cVar1 = *pcVar4;
    pcVar4 = pcVar4 + 1;
  } while (cVar1 != '\0');
  String_Assign(local_90,(_String_base *)&stack0xfffff71c,(int)pcVar4 - (int)&stack0xfffff71d);
  local_8._0_1_ = 2;
  p_Var5 = Image_ReleaseTexture(local_34,local_90);
  local_8._0_1_ = 3;
  p_Var5 = Survival_LoadConfiguration(local_c8,(_String_base *)"Module: ",(int)p_Var5);
  local_8._0_1_ = 4;
  p_Var5 = Intel_DisplayPopulationData
                     (local_e4,extraout_EDX,(_String_base *)local_e4,p_Var5,
                      (_String_base *)&DAT_00531704);
  local_8._0_1_ = 5;
  Enemy_UpdateAI(local_50,(int)p_Var5,0,0xffffffff);
  if (0xf < local_cc) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(extraout_ECX,local_e0);
  }
  local_cc = 0xf;
  local_d0 = 0;
  local_e0 = local_e0 & 0xffffff00;
  if (0xf < local_b0) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(extraout_ECX,extraout_EDX_00);
  }
  local_b0 = 0xf;
  local_b4 = 0;
  local_c4 = local_c4 & 0xffffff00;
  if (0xf < local_1c) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(local_30,extraout_EDX_00);
  }
  local_1c = 0xf;
  local_20 = 0;
  local_30 = local_30 & 0xffffff00;
  local_8._0_1_ = 1;
  if (0xf < local_78) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(extraout_ECX,local_8c);
  }
  Exception_Release(&stack0xfffff71c,"Logical Address: %04X:%08X\r\n");
  pcVar4 = &stack0xfffff71c;
  do {
    cVar1 = *pcVar4;
    pcVar4 = pcVar4 + 1;
  } while (cVar1 != '\0');
  Enemy_ProcessSatelliteLogic
            (local_50,(_String_base *)&stack0xfffff71c,(int)pcVar4 - (int)&stack0xfffff71d);
  pcVar4 = "\r\n";
  do {
    pcVar6 = pcVar4;
    pcVar4 = pcVar6 + 1;
  } while (*pcVar6 != '\0');
  Enemy_ProcessSatelliteLogic(local_50,(_String_base *)&DAT_00531704,(uint)(pcVar6 + -0x531704));
  uVar9 = Sound_SetPosition(local_34,"Exception at %04X:%08X");
  local_8._0_1_ = 6;
  PowerUp_ProcessThunderstrike
            (local_ac,(uint)((ulonglong)uVar9 >> 0x20),(_String_base *)uVar9,0,0xffffffff);
  if (0xf < local_1c) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(extraout_ECX_00,local_30);
  }
  local_5c = 0xf;
  local_60 = 0;
  local_70 = local_70 & 0xffffff00;
  local_8._0_1_ = 7;
  if (local_15 != '\0') {
    uVar9 = Input_GetMouseWheel(local_34,param_1[1],0);
    local_8._0_1_ = 8;
    PowerUp_ProcessThunderstrike
              (local_74,(uint)((ulonglong)uVar9 >> 0x20),(_String_base *)uVar9,0,0xffffffff);
    local_8._0_1_ = 7;
    if (0xf < local_1c) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler(extraout_ECX_01,local_30);
    }
    if (local_60 != 0) goto LAB_004aebe9;
  }
  local_8._0_1_ = 7;
  uVar9 = Input_IsMouseButtonReleased(local_34,param_1[1]);
  local_8._0_1_ = 9;
  PowerUp_ProcessThunderstrike
            (local_74,(uint)((ulonglong)uVar9 >> 0x20),(_String_base *)uVar9,0,0xffffffff);
  local_8._0_1_ = 7;
  if (0xf < local_1c) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(extraout_ECX_02,local_30);
  }
LAB_004aebe9:
  local_8._0_1_ = 7;
  Enemy_UpdateAI(local_50,(int)local_74,0,0xffffffff);
  pcVar4 = "\r\n";
  do {
    pcVar6 = pcVar4;
    pcVar4 = pcVar6 + 1;
  } while (*pcVar6 != '\0');
  Enemy_ProcessSatelliteLogic(local_50,(_String_base *)&DAT_00531704,(uint)(pcVar6 + -0x531704));
  Exception_Release(&stack0xfffff71c,"EAX:%08X EBX:%08X ECX:%08X EDX:%08X ESI:%08X EDI:%08X\r\n");
  pcVar4 = &stack0xfffff71c;
  do {
    cVar1 = *pcVar4;
    pcVar4 = pcVar4 + 1;
  } while (cVar1 != '\0');
  Enemy_ProcessSatelliteLogic
            (local_50,(_String_base *)&stack0xfffff71c,(int)pcVar4 - (int)&stack0xfffff71d);
  Exception_Release(&stack0xfffff71c,"EIP:%08X ESP:%08X  EBP:%08X\r\n");
  pcVar4 = &stack0xfffff71c;
  do {
    cVar1 = *pcVar4;
    pcVar4 = pcVar4 + 1;
  } while (cVar1 != '\0');
  Enemy_ProcessSatelliteLogic
            (local_50,(_String_base *)&stack0xfffff71c,(int)pcVar4 - (int)&stack0xfffff71d);
  Exception_Release(&stack0xfffff71c,"CS:%04X SS:%04X DS:%04X ES:%04X FS:%04X GS:%04X\r\n");
  pcVar4 = &stack0xfffff71c;
  do {
    cVar1 = *pcVar4;
    pcVar4 = pcVar4 + 1;
  } while (cVar1 != '\0');
  Enemy_ProcessSatelliteLogic
            (local_50,(_String_base *)&stack0xfffff71c,(int)pcVar4 - (int)&stack0xfffff71d);
  Exception_Release(&stack0xfffff71c,"Flags:%08X\r\n");
  pcVar4 = &stack0xfffff71c;
  do {
    cVar1 = *pcVar4;
    pcVar4 = pcVar4 + 1;
  } while (cVar1 != '\0');
  Enemy_ProcessSatelliteLogic
            (local_50,(_String_base *)&stack0xfffff71c,(int)pcVar4 - (int)&stack0xfffff71d);
  pcVar4 = "\r\n";
  do {
    pcVar6 = pcVar4;
    pcVar4 = pcVar6 + 1;
  } while (*pcVar6 != '\0');
  Enemy_ProcessSatelliteLogic(local_50,(_String_base *)&DAT_00531704,(uint)(pcVar6 + -0x531704));
  iVar7 = Image_Constructor(local_34);
  local_8._0_1_ = 10;
  Enemy_UpdateAI(local_50,iVar7,0,0xffffffff);
  local_8._0_1_ = 7;
  if (0xf < local_1c) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(extraout_ECX_03,local_30);
  }
  piVar8 = DAT_005a37d8;
  if (DAT_005a37d8 != (int *)0x0) {
    (**(code **)(*DAT_005a37d8 + 0x90))(local_34);
    local_8._0_1_ = 0xb;
    if (local_20 != 0) {
      pcVar4 = "\r\n";
      do {
        pcVar6 = pcVar4;
        pcVar4 = pcVar6 + 1;
      } while (*pcVar6 != '\0');
      Enemy_ProcessSatelliteLogic(local_50,(_String_base *)&DAT_00531704,(uint)(pcVar6 + -0x531704))
      ;
      Enemy_UpdateAI(local_50,(int)local_34,0,0xffffffff);
    }
    Math_NormalizeVector(DAT_005a37d8,(int)local_50);
    local_8._0_1_ = 7;
    piVar8 = extraout_ECX_04;
    if (0xf < local_1c) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler((int)extraout_ECX_04,local_30);
    }
  }
  local_8._0_1_ = 7;
  if (local_15 != '\0') {
    Debug_ParseMapFile(piVar8,local_50);
  }
  Database_ProcessOperation((int)local_50);
  if (DAT_005a37d8 != (int *)0x0) {
    if ((char)DAT_005a37d8[0x124] != '\0') {
      Threading_TerminateThread((int)DAT_005a37d8);
      BitStream_WriteBits(DAT_005a37d8 + 0x133,0,1);
      BitStream_WriteBits(DAT_005a37d8 + 0x133,0x1f,5);
      JSON_SaveDocument((int)DAT_005a37d8,extraout_DX);
      PowerUp_ProcessThunderstrike
                ((_String_base *)&DAT_00567654,extraout_EDX_01,(_String_base *)(DAT_005a37d8 + 300),
                 0,0xffffffff);
    }
    DAT_005a37e4 = (undefined1)DAT_005a37d8[0x124];
    (**(code **)(*DAT_005a37d8 + 300))(local_34);
    local_8._0_1_ = 0xc;
    if (local_20 != 0) {
      PowerUp_ProcessThunderstrike
                ((_String_base *)&DAT_00567654,extraout_EDX_02,local_34,0,0xffffffff);
      DAT_005a37e4 = 1;
    }
    piVar8 = DAT_005a37d8;
    *(undefined1 *)(DAT_005a37d8 + 0x124) = 0;
    piVar2 = DAT_005a37d8;
    *(undefined1 *)((int)DAT_005a37d8 + 0x491) = 0;
    local_8._0_1_ = 7;
    if (0xf < local_1c) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler((int)piVar8,(uint)piVar2);
    }
  }
  if (DAT_00566b88 != '\0') {
    ErrorDialog_CreateFatalErrorWindow((uint)local_ac,local_50);
  }
  Matrix_Multiply();
  if (0xf < local_5c) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(extraout_ECX_05,extraout_EDX_03);
  }
  local_5c = 0xf;
  local_60 = 0;
  local_70 = local_70 & 0xffffff00;
  if (0xf < local_38) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(local_4c,extraout_EDX_03);
  }
  local_38 = 0xf;
  local_3c = 0;
  local_4c = local_4c & 0xffffff00;
  if (0xf < local_94) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(extraout_ECX_05,local_a8);
  }
  ExceptionList = local_10;
  Exception_SetMessage((void *)(local_14 ^ unaff_retaddr),in_stack_fffff71c,in_stack_fffff720);
  return;
}


