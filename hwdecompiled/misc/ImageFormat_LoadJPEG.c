/*
 * Function: ImageFormat_LoadJPEG
 * Address: 004bb9d0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


undefined8 __cdecl ImageFormat_LoadJPEG(void *param_1,uint param_2,int param_3)

{
  uint uVar1;
  undefined8 uVar2;
  int in_EAX;
  uint uVar3;
  int iVar4;
  bool bVar5;
  
  if (param_3 < 0) goto LAB_004bba0c;
  if ((0 < param_3) || (param_2 != 0)) {
    bVar5 = CARRY4(param_2,*(uint *)(in_EAX + 8));
    param_2 = param_2 + *(uint *)(in_EAX + 8);
    param_3 = param_3 + *(int *)(in_EAX + 0xc) + (uint)bVar5;
  }
  while( true ) {
    while( true ) {
      if (((-1 < param_3) && ((0 < param_3 || (param_2 != 0)))) &&
         ((param_3 < *(int *)(in_EAX + 0xc) ||
          ((param_3 <= *(int *)(in_EAX + 0xc) && (param_2 <= *(uint *)(in_EAX + 8))))))) {
        return 0xffffffffffffffff;
      }
LAB_004bba0c:
      uVar3 = CPU_ProcessCompressedData(param_1,*(int *)(in_EAX + 0x18),(undefined4 *)param_1);
      if (-1 < (int)uVar3) break;
      uVar1 = *(uint *)(in_EAX + 8);
      *(uint *)(in_EAX + 8) = uVar1 - uVar3;
      *(uint *)(in_EAX + 0xc) =
           (*(int *)(in_EAX + 0xc) - ((int)uVar3 >> 0x1f)) - (uint)(uVar1 < uVar3);
    }
    if (uVar3 != 0) {
      uVar1 = *(uint *)(in_EAX + 8);
      uVar2 = *(undefined8 *)(in_EAX + 8);
      *(uint *)(in_EAX + 0xc) =
           ((int)uVar3 >> 0x1f) + *(int *)(in_EAX + 0xc) + (uint)CARRY4(uVar3,uVar1);
      *(uint *)(in_EAX + 8) = uVar3 + uVar1;
      return uVar2;
    }
    if (param_2 == 0 && param_3 == 0) break;
    iVar4 = ImageFormat_DetectFormat();
    if (iVar4 == 0) {
      return 0xfffffffffffffffe;
    }
    if (iVar4 < 0) {
      return 0xffffffffffffff80;
    }
  }
  return 0xffffffffffffffff;
}


