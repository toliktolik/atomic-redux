/*
 * Function: Unwind@005136e0
 * Address: 005136e0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Instruction at (ram,0x005136e1) overlaps instruction at (ram,0x005136e0)
    */
/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: This function may have set the stack pointer */
/* WARNING: Removing unreachable block (ram,0x005137a7) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall Unwind_005136e0(undefined4 param_1,undefined4 param_2)

{
  int iVar1;
  uint *puVar2;
  char cVar3;
  longlong lVar4;
  code *pcVar5;
  ulonglong uVar6;
  char cVar7;
  undefined1 *in_EAX;
  uint uVar9;
  uint uVar10;
  undefined1 *puVar11;
  int iVar12;
  uint3 uVar13;
  uint unaff_EBX;
  int *piVar14;
  undefined1 *puVar15;
  int unaff_EBP;
  undefined4 *unaff_ESI;
  uint *puVar16;
  uint *puVar17;
  uint *unaff_EDI;
  undefined2 in_CS;
  undefined2 in_SS;
  undefined2 in_GS;
  int in_GS_OFFSET;
  bool bVar18;
  undefined8 uVar19;
  char cVar8;
  
  while( true ) {
    uVar13 = (uint3)((uint)param_1 >> 8);
    LOCK();
    puVar11 = *(undefined1 **)(unaff_EBP + 0x3f49635);
    *(BADSPACEBASE **)(unaff_EBP + 0x3f49635) = register0x00000010;
    UNLOCK();
    out(*unaff_ESI,(short)param_2);
    uVar6 = (ulonglong)CONCAT31(uVar13,0x46) << 6 | (ulonglong)(uVar13 >> 0x13);
    uVar9 = CONCAT31((int3)((uint)in_EAX >> 8),DAT_86e8faf8) ^ 0x273d2900;
    piVar14 = (int *)(puVar11 + -4);
    *(undefined2 *)(puVar11 + -4) = in_SS;
    uVar10 = uVar9 + 0x3fe0dde;
    out(0x37,(char)uVar10);
    if ((POPCOUNT(uVar10 & 0xff) & 1U) == 0) {
      *(char *)((int)unaff_EDI + 0x455ecffb) =
           *(char *)((int)unaff_EDI + 0x455ecffb) << ((byte)uVar6 & 0x1f);
      pcVar5 = (code *)swi(3);
      (*pcVar5)();
      return;
    }
    bVar18 = uVar10 < 0xcfce3368 || uVar9 + 0x342fda76 < (uint)(uVar9 < 0xfc01f222);
    in_EAX = (undefined1 *)((uVar9 + 0x342fda76) - (uint)(uVar9 < 0xfc01f222));
    puVar16 = (uint *)*(undefined6 *)(unaff_EBP + -0x26c63085);
    iVar12 = (int)uVar6 + -1;
    if (iVar12 == 0 || in_EAX != (undefined1 *)0x0) {
      *(byte *)unaff_EDI = (char)*unaff_EDI << 3 | (byte)(CONCAT11(bVar18,(char)*unaff_EDI) >> 6);
      piVar14 = (int *)puVar11;
    }
    else {
      cVar8 = (char)(in_EAX + 1);
      cVar3 = cVar8 + -0x19;
      cVar7 = cVar3 + bVar18;
      in_EAX = (undefined1 *)CONCAT31((int3)((uint)(in_EAX + 1) >> 8),cVar7);
      if (cVar7 == '\0' || (SCARRY1(cVar8,-0x19) != SCARRY1(cVar3,bVar18)) != cVar7 < '\0') {
        pcVar5 = (code *)swi(3);
        (*pcVar5)();
        return;
      }
    }
    puVar2 = unaff_EDI + 1;
    puVar17 = puVar16 + 1;
    if (*unaff_EDI < *puVar16) break;
    if (iVar12 != 0) {
      *(char *)puVar2 = (char)in_EAX;
      uVar9 = (uint)in_EAX & 0xff;
      while (DAT_6b92f4d3 = (char)uVar9 + 'G', !SCARRY1((char)uVar9,'G')) {
        out(0x83,DAT_6b92f4d3);
        uVar9 = _DAT_23f137e9;
      }
      pcVar5 = (code *)swi(3);
      (*pcVar5)();
      return;
    }
    unaff_ESI = (undefined4 *)((int)puVar16 + 5);
    param_1 = 0;
    unaff_EDI = puVar2;
  }
  LOCK();
  iVar1 = *(int *)((int)piVar14 + (int)in_EAX);
  *(int *)((int)piVar14 + (int)in_EAX) = iVar12;
  UNLOCK();
  if (-1 < (char)((char)in_EAX + -0x17)) {
    piVar14[-1] = (int)puVar17;
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  unaff_EDI[iVar1 * 2 + 0x5684ac5] = unaff_EDI[iVar1 * 2 + 0x5684ac5] ^ unaff_EBX;
  *(char *)puVar2 = (char)*puVar2 + '\x01';
  if ((char)*puVar2 == '\0') {
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  uVar13 = (uint3)((uint)param_2 >> 8) ^
           (uint3)((uint)*(undefined4 *)((int)puVar16 + 0x78eb58b9) >> 8);
  puVar11 = (undefined1 *)CONCAT22((short)((uint)puVar2 >> 0x10),in_GS);
  if (iVar1 == 0) {
    puVar11 = &DAT_72650b0e;
  }
  else {
    iVar12 = *piVar14;
    *piVar14 = 0xf3ce482d;
    puVar17 = (uint *)((uint)puVar17 | *(uint *)(iVar1 + 0x2c));
    if ((int)puVar17 < 1) {
      lVar4 = (longlong)*(int *)((int)puVar17 + 0x35) * -0x16;
      puVar15 = puVar11 + -4;
      *(uint **)(puVar11 + -4) = puVar17;
      if (SBORROW4(CONCAT31(uVar13,0x7b),1)) {
        pcVar5 = (code *)swi(0x94);
        uVar19 = (*pcVar5)();
        puVar16 = (uint *)(in_GS_OFFSET + (int)((ulonglong)uVar19 >> 0x20) + 0x1b);
        *puVar16 = *puVar16 & (uint)uVar19;
        return;
      }
      puVar11 = (undefined1 *)CONCAT31((int3)((uint)piVar14 >> 8),-((int)lVar4 != lVar4));
      bVar18 = *(undefined1 **)(puVar11 + iVar12 + -0xd) < puVar15;
      goto code_r0x00513845;
    }
    *(undefined2 *)(piVar14 + -1) = in_CS;
  }
  puVar16 = (uint *)(CONCAT31(uVar13,'{' - *(byte *)((int)puVar17 + 0xc5a212bfU)) + -0x2a);
  uVar9 = (uint)(0x7b < *(byte *)((int)puVar17 + 0xc5a212bfU));
  bVar18 = 0xcd79bc6 < *puVar16 || CARRY4(*puVar16 + 0xf3286439,uVar9);
  *puVar16 = *puVar16 + 0xf3286439 + uVar9;
code_r0x00513845:
  uVar9 = *(uint *)(puVar11 + -0x79);
  *(uint *)(puVar11 + -0x79) = uVar9 << 5 | (uint)(CONCAT14(bVar18,uVar9) >> 0x1c);
  *in_EAX = (char)puVar11;
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}


