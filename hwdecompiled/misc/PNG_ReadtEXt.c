/*
 * Function: PNG_ReadtEXt
 * Address: 004cfcb0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void PNG_ReadtEXt(void)

{
  ushort *puVar1;
  void *pvVar2;
  uint uVar3;
  uint uVar4;
  short sVar5;
  void *pvVar6;
  short *psVar7;
  int *unaff_EBX;
  undefined4 *puVar8;
  int iVar9;
  void *pvVar10;
  undefined4 *puVar11;
  
  pvVar2 = (void *)unaff_EBX[9];
  do {
    uVar3 = unaff_EBX[0x19];
    pvVar6 = (void *)((unaff_EBX[0xd] - uVar3) - unaff_EBX[0x1b]);
    if (pvVar6 == (void *)0x0) {
      if ((uVar3 != 0) || (pvVar10 = pvVar2, unaff_EBX[0x1b] != 0)) {
LAB_004cfcf3:
        pvVar10 = pvVar6;
        if ((uint)((int)pvVar2 + unaff_EBX[9] + -0x106) <= uVar3) {
          puVar8 = (undefined4 *)(unaff_EBX[0xc] + (int)pvVar2);
          puVar11 = (undefined4 *)unaff_EBX[0xc];
          for (uVar3 = (uint)pvVar2 >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
            *puVar11 = *puVar8;
            puVar8 = puVar8 + 1;
            puVar11 = puVar11 + 1;
          }
          for (uVar3 = (uint)pvVar2 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
            *(undefined1 *)puVar11 = *(undefined1 *)puVar8;
            puVar8 = (undefined4 *)((int)puVar8 + 1);
            puVar11 = (undefined4 *)((int)puVar11 + 1);
          }
          unaff_EBX[0x1a] = unaff_EBX[0x1a] - (int)pvVar2;
          iVar9 = unaff_EBX[0x11];
          unaff_EBX[0x15] = unaff_EBX[0x15] - (int)pvVar2;
          unaff_EBX[0x19] = unaff_EBX[0x19] - (int)pvVar2;
          psVar7 = (short *)(unaff_EBX[0xf] + iVar9 * 2);
          do {
            puVar1 = (ushort *)(psVar7 + -1);
            psVar7 = psVar7 + -1;
            if ((void *)(uint)*puVar1 < pvVar2) {
              sVar5 = 0;
            }
            else {
              sVar5 = *puVar1 - (short)pvVar2;
            }
            iVar9 = iVar9 + -1;
            *psVar7 = sVar5;
          } while (iVar9 != 0);
          psVar7 = (short *)(unaff_EBX[0xe] + (int)pvVar2 * 2);
          pvVar10 = pvVar2;
          do {
            puVar1 = (ushort *)(psVar7 + -1);
            psVar7 = psVar7 + -1;
            if ((void *)(uint)*puVar1 < pvVar2) {
              sVar5 = 0;
            }
            else {
              sVar5 = *puVar1 - (short)pvVar2;
            }
            pvVar10 = (void *)((int)pvVar10 - 1);
            *psVar7 = sVar5;
          } while (pvVar10 != (void *)0x0);
          pvVar10 = (void *)((int)pvVar6 + (int)pvVar2);
        }
      }
    }
    else {
      if (pvVar6 != (void *)0xffffffff) goto LAB_004cfcf3;
      pvVar10 = (void *)0xfffffffe;
    }
    if (((int *)*unaff_EBX)[1] == 0) {
      return;
    }
    uVar3 = PNG_WritetRNS(pvVar10,(int *)*unaff_EBX,
                          (undefined4 *)(unaff_EBX[0x1b] + unaff_EBX[0x19] + unaff_EBX[0xc]));
    uVar3 = unaff_EBX[0x1b] + uVar3;
    unaff_EBX[0x1b] = uVar3;
    if (2 < uVar3) {
      uVar4 = (uint)*(byte *)(unaff_EBX[0x19] + unaff_EBX[0xc]);
      unaff_EBX[0x10] = uVar4;
      unaff_EBX[0x10] =
           (uVar4 << ((byte)unaff_EBX[0x14] & 0x1f) ^
           (uint)((byte *)(unaff_EBX[0x19] + unaff_EBX[0xc]))[1]) & unaff_EBX[0x13];
    }
    if (0x105 < uVar3) {
      return;
    }
    if (*(int *)(*unaff_EBX + 4) == 0) {
      return;
    }
  } while( true );
}


