/*
 * Function: Texture_GetSize
 * Address: 004b9a80
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void * __thiscall Texture_GetSize(void *this,uint param_1)

{
  ushort uVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  
  iVar2 = (int)(param_1 + ((int)param_1 >> 0x1f & 0xfU)) >> 4;
  if (0 < iVar2) {
    if (*(int *)((int)this + 0xc) <= iVar2) {
      *(undefined4 *)((int)this + 0xc) = 0;
      *(undefined1 *)((int)this + 4) = 0;
      return this;
    }
    iVar3 = *(int *)((int)this + 0xc) - iVar2;
    *(int *)((int)this + 0xc) = iVar3;
    uVar5 = iVar3 * 2;
    puVar6 = (undefined4 *)((int)*(undefined4 **)((int)this + 8) + iVar2 * 2);
    puVar7 = *(undefined4 **)((int)this + 8);
    for (uVar4 = uVar5 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
      *puVar7 = *puVar6;
      puVar6 = puVar6 + 1;
      puVar7 = puVar7 + 1;
    }
    for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
      *(undefined1 *)puVar7 = *(undefined1 *)puVar6;
      puVar6 = (undefined4 *)((int)puVar6 + 1);
      puVar7 = (undefined4 *)((int)puVar7 + 1);
    }
  }
  iVar2 = Graphics_SetTransform((int)this);
  iVar2 = iVar2 + -1;
  if (-1 < iVar2) {
    uVar5 = param_1 & 0x8000000f;
    if ((int)uVar5 < 0) {
      uVar5 = (uVar5 - 1 | 0xfffffff0) + 1;
    }
    uVar4 = 0;
    do {
      uVar1 = Texture_SetTarget(this,iVar2);
      Texture_GetInternalFormat
                (this,iVar2,(short)((int)(uint)uVar1 >> ((byte)uVar5 & 0x1f)) + (short)uVar4);
      iVar2 = iVar2 + -1;
      uVar4 = (uint)uVar1 << (0x10 - (byte)uVar5 & 0x1f) & 0xffff;
    } while (-1 < iVar2);
  }
  Texture_Release((int)this);
  return this;
}


