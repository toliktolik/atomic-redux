/*
 * Function: Unwind@00511a48
 * Address: 00511a48
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Instruction at (ram,0x00511a5a) overlaps instruction at (ram,0x00511a59)
    */
/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Removing unreachable block (ram,0x00511abd) */
/* WARNING: Removing unreachable block (ram,0x00511b7d) */

undefined4 __fastcall Unwind_00511a48(undefined4 param_1,int *param_2,undefined6 *param_3)

{
  uint *puVar1;
  byte *pbVar2;
  undefined4 uVar3;
  int iVar4;
  uint uVar5;
  undefined6 uVar6;
  uint uVar7;
  undefined1 uVar8;
  byte bVar9;
  byte bVar10;
  byte bVar13;
  undefined4 in_EAX;
  undefined6 *puVar11;
  uint uVar12;
  int *piVar14;
  uint uVar15;
  int iVar16;
  byte bVar17;
  byte bVar20;
  undefined4 unaff_EBX;
  uint uVar18;
  undefined6 *puVar19;
  int *unaff_EBP;
  undefined1 *unaff_ESI;
  undefined4 *puVar21;
  undefined1 *unaff_EDI;
  int *piVar22;
  undefined2 in_CS;
  char in_CF;
  bool bVar23;
  byte in_AF;
  undefined2 in_FPUControlWord;
  
  puVar21 = (undefined4 *)(unaff_ESI + 1);
  uVar15 = CONCAT31((int3)((uint)in_EAX >> 8),*unaff_ESI);
  piVar22 = (int *)(unaff_EDI + 1);
  *unaff_EDI = *unaff_ESI;
  puVar11 = (undefined6 *)
            CONCAT22((short)((uint)unaff_EBX >> 0x10),CONCAT11(-in_CF,(char)unaff_EBX));
  bVar23 = param_2 < *(int **)(unaff_ESI + -0x2f);
  piVar14 = param_2;
LAB_00511a55:
  uVar7 = (uint)piVar14 >> 0x18;
  piVar22[8] = (int)piVar14;
  uVar8 = in(4);
  puVar19 = (undefined6 *)CONCAT31((int3)((uint)param_2 >> 8),uVar8);
  param_2 = unaff_EBP;
  do {
    uVar18 = (int)puVar19 + 1;
    bVar10 = (byte)piVar14;
    if (uVar18 == 0 || SCARRY4((int)puVar19,1) != (int)uVar18 < 0) {
      out(*puVar21,(short)uVar15);
      puVar1 = (uint *)(uVar15 + 0x9a4bd5c6);
      *puVar1 = *puVar1 << (bVar10 & 0x1f) | *puVar1 >> 0x20 - (bVar10 & 0x1f);
      bVar9 = (byte)uVar18;
      if (!SBORROW1(*(char *)(puVar21 + 1),(char)*piVar22)) {
        *(undefined4 *)((int)piVar14 + -0x55188152) = 0x5ef5610a;
        *(byte *)((int)puVar19 + 0x3f) = *(byte *)((int)puVar19 + 0x3f) | bVar9;
        *(char *)((int)param_2 + -0x4de6167d) = *(char *)((int)param_2 + -0x4de6167d) + bVar10;
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      }
      uVar6 = *puVar11;
      in_AF = 9 < (bVar9 & 0xf) | in_AF;
      uVar12 = CONCAT31((int3)(uVar18 >> 8),bVar9 + in_AF * -6) & 0xffffff0f;
      swi(4);
      unaff_EBP = (int *)in(0x9a);
      puVar19 = puVar11;
      while( true ) {
        bVar10 = (byte)unaff_EBP;
        puVar21 = (undefined4 *)uVar6;
        if (-1 < (char)(bVar10 + 0x19)) {
          do {
            iVar16 = uVar15 + 1;
            uVar7 = (uint)unaff_EBP >> 8;
            uVar15 = (uint)param_2 & 0xffff;
            *(undefined2 *)(puVar21 + 0x10) = in_FPUControlWord;
            iVar4 = *unaff_EBP;
            uVar3 = in((short)param_2);
            *puVar21 = uVar3;
            unaff_EBP = piVar14;
            piVar14 = (int *)(iVar4 * 0x5d);
            puVar21 = puVar21 + 1;
          } while (-1 < (char)((byte)((uint)iVar16 >> 8) & (byte)uVar7));
          do {
                    /* WARNING: Do nothing block with infinite loop */
          } while( true );
        }
        if (bVar10 < 0xe7) break;
        puVar19 = (undefined6 *)(*(int *)((int)puVar19 + -0x32) * -0x651a67ea);
      }
      puVar21 = (undefined4 *)
                (CONCAT22((short)(uVar12 >> 0x10),CONCAT11((char)(uVar18 >> 8) - in_AF,(char)uVar12)
                         ) + 1);
      *(byte *)((int)piVar14 + -0x77) = *(byte *)((int)piVar14 + -0x77) << 1 | bVar10 < 0xe7;
      piVar22 = (int *)((int)(undefined4 *)uVar6 + -1);
      param_3 = puVar11;
    }
    else {
      uVar15 = (int)uVar18 >> 0x1f;
      param_2 = (int *)((int)param_2 + 1);
      piVar22 = (int *)((int)piVar22 + 1);
      uVar12 = (uint)bVar23;
      uVar5 = (int)puVar19 + 0x51294c72;
      bVar23 = uVar18 < 0xaed6b38f || uVar5 < uVar12;
      unaff_EBP = (int *)(uVar5 - uVar12);
      puVar19 = puVar11;
      if (unaff_EBP == (int *)0x0 ||
          (SBORROW4(uVar18,-0x51294c71) != SBORROW4(uVar5,uVar12)) != (int)unaff_EBP < 0) break;
    }
    bVar23 = 0x6c < (byte)unaff_EBP;
    puVar11 = (undefined6 *)CONCAT31((int3)((uint)unaff_EBP >> 8),(byte)unaff_EBP + 0x93);
  } while( true );
  bVar13 = (byte)((uint)unaff_EBP >> 8);
  bVar20 = (byte)((uint)puVar11 >> 8);
  bVar9 = bVar20 + bVar13;
  bVar17 = (byte)puVar11;
  puVar11 = (undefined6 *)CONCAT22((short)((uint)puVar11 >> 0x10),CONCAT11(bVar9 + bVar23,bVar17));
  piVar14 = (int *)CONCAT31((int3)((uint)piVar14 >> 8),
                            (bVar10 - bVar13) - (CARRY1(bVar20,bVar13) || CARRY1(bVar9,bVar23)));
  in_AF = ((uint)param_2 & 0x1000) != 0;
  uVar15 = uVar15 - 1;
  pbVar2 = (byte *)(uVar15 + (int)piVar22);
  bVar23 = false;
  *pbVar2 = *pbVar2 | bVar17;
  if ((POPCOUNT(*pbVar2) & 1U) != 0) {
    *piVar22 = (*piVar22 - uVar15) - (uint)((byte)param_2 < 199);
    LOCK();
    *(char *)CONCAT31((int3)((uint)param_2 >> 8),((byte)param_2 + 0x39 ^ 0x54) + 0x9d) =
         (char)((uint)((int)piVar14 * 2) >> 8);
    UNLOCK();
    func_0x04437490();
    return CONCAT13(param_3._0_1_,CONCAT12((char)uVar7,in_CS));
  }
  goto LAB_00511a55;
}


