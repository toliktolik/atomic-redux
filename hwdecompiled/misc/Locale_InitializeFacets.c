/*
 * Function: Locale_InitializeFacets
 * Address: 004ec469
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


_Locimp * Locale_InitializeFacets(void)

{
  _Locimp *this;
  int iVar1;
  uint uVar2;
  void *pvVar3;
  facet *pfVar4;
  _String_base *p_Var5;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  int unaff_EBP;
  
  Assembly_BitShiftLocking();
  this = *(_Locimp **)(unaff_EBP + 0x10);
  uVar2 = *(uint *)(unaff_EBP + 0xc) & 2;
  *(uint *)(unaff_EBP + -0x10) = uVar2;
  if (uVar2 != 0) {
    if (*(int *)(unaff_EBP + 0x14) == 0) {
      pvVar3 = operator_new(0x18);
      if (pvVar3 == (void *)0x0) {
        pfVar4 = (facet *)0x0;
      }
      else {
        pfVar4 = (facet *)Locale_ConstructorWithRotation(pvVar3,*(undefined4 *)(unaff_EBP + 8),0);
      }
      uVar2 = std::locale::id::Operator_CastToUnsignedInt((id *)&DAT_005a4878);
    }
    else {
      uVar2 = std::locale::id::Operator_CastToUnsignedInt((id *)&DAT_005a4878);
      pfVar4 = Memory_CopyImageBuffer(*(locale **)(unaff_EBP + 0x14));
    }
    std::locale::_Locimp::_Addfac(this,pfVar4,uVar2);
  }
  uVar2 = *(uint *)(unaff_EBP + 0xc) & 8;
  *(uint *)(unaff_EBP + 0x10) = uVar2;
  if (uVar2 != 0) {
    if (*(int *)(unaff_EBP + 0x14) == 0) {
      pfVar4 = (facet *)operator_new(8);
      if (pfVar4 == (facet *)0x0) {
        pfVar4 = (facet *)0x0;
      }
      else {
        *(undefined4 *)(pfVar4 + 4) = 0;
        *(undefined ***)pfVar4 = &PTR_Memory_UnlockImageBuffer_0053304c;
      }
      uVar2 = std::locale::id::Operator_CastToUnsignedInt((id *)&DAT_005a33bc);
    }
    else {
      uVar2 = std::locale::id::Operator_CastToUnsignedInt((id *)&DAT_005a33bc);
      pfVar4 = Database_ExecuteCommand(*(locale **)(unaff_EBP + 0x14));
    }
    std::locale::_Locimp::_Addfac(this,pfVar4,uVar2);
  }
  if (*(int *)(unaff_EBP + 0x10) != 0) {
    if (*(int *)(unaff_EBP + 0x14) == 0) {
      pfVar4 = (facet *)operator_new(8);
      if (pfVar4 == (facet *)0x0) {
        pfVar4 = (facet *)0x0;
      }
      else {
        *(undefined4 *)(pfVar4 + 4) = 0;
        *(undefined ***)pfVar4 = &PTR_Memory_UnlockImageBuffer_00531374;
      }
      uVar2 = std::locale::id::Operator_CastToUnsignedInt((id *)&DAT_0056d0cc);
    }
    else {
      uVar2 = std::locale::id::Operator_CastToUnsignedInt((id *)&DAT_0056d0cc);
      pfVar4 = LocaleFacet_ReferenceManager(*(locale **)(unaff_EBP + 0x14));
    }
    std::locale::_Locimp::_Addfac(this,pfVar4,uVar2);
    if (*(int *)(unaff_EBP + 0x10) != 0) {
      if (*(int *)(unaff_EBP + 0x14) == 0) {
        pvVar3 = operator_new(0x18);
        *(void **)(unaff_EBP + 0x10) = pvVar3;
        *(undefined4 *)(unaff_EBP + -4) = 4;
        if (pvVar3 == (void *)0x0) {
          pfVar4 = (facet *)0x0;
        }
        else {
          pfVar4 = (facet *)Renderer_InitializeTextureProcessor();
        }
        *(undefined4 *)(unaff_EBP + -4) = 0xffffffff;
        uVar2 = std::locale::id::Operator_CastToUnsignedInt((id *)&DAT_0056d0d0);
      }
      else {
        uVar2 = std::locale::id::Operator_CastToUnsignedInt((id *)&DAT_0056d0d0);
        pfVar4 = Renderer_SetModelViewMatrix(*(locale **)(unaff_EBP + 0x14));
      }
      std::locale::_Locimp::_Addfac(this,pfVar4,uVar2);
    }
  }
  if (*(int *)(unaff_EBP + -0x10) != 0) {
    if (*(int *)(unaff_EBP + 0x14) == 0) {
      pvVar3 = operator_new(0x10);
      if (pvVar3 == (void *)0x0) {
        pfVar4 = (facet *)0x0;
      }
      else {
        pfVar4 = (facet *)Locale_ConstructorWithTime(pvVar3,*(undefined4 *)(unaff_EBP + 8),0);
      }
      uVar2 = std::locale::id::Operator_CastToUnsignedInt((id *)&DAT_0056db14);
    }
    else {
      uVar2 = std::locale::id::Operator_CastToUnsignedInt((id *)&DAT_0056db14);
      pfVar4 = Locale_GetFacet(*(locale **)(unaff_EBP + 0x14));
    }
    std::locale::_Locimp::_Addfac(this,pfVar4,uVar2);
  }
  iVar1 = *(int *)(unaff_EBP + 8);
  Runtime_DebugCrtSetReportFile();
  Compiler_StaticCleanup();
  CppRuntime_EHCleanup();
  *(uint *)(this + 0x10) = *(uint *)(this + 0x10) | *(uint *)(unaff_EBP + 0xc);
  p_Var5 = Animation_CopyRareEvents(iVar1,extraout_EDX,(_String_base *)(unaff_EBP + -0x2c));
  *(undefined4 *)(unaff_EBP + -4) = 6;
  PowerUp_ProcessThunderstrike((_String_base *)(this + 0x18),extraout_EDX_00,p_Var5,0,0xffffffff);
  String_Reset(unaff_EBP + -0x2c,extraout_EDX_01,'\x01');
  ExceptionList = *(void **)(unaff_EBP + -0xc);
  return this;
}


