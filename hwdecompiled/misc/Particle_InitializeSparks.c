/*
 * Function: Particle_InitializeSparks
 * Address: 00437450
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 * __thiscall Particle_InitializeSparks(void *this,int param_1,undefined4 param_2)

{
  undefined4 uVar1;
  double dVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  int *piVar6;
  int iVar7;
  bool bVar8;
  ulonglong uVar9;
  void *local_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_00512048;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  Boss_HelicopterTurretSystem(this,param_1);
  *(undefined4 *)((int)this + 0x70) = param_2;
  iVar3 = *(int *)((int)this + 0x4c);
  *(undefined ***)this = &PTR_Particle_ProcessSparks_005305a8;
  *(undefined1 *)((int)this + 0x74) = 0;
  local_8 = 0;
  if (*(char *)(iVar3 + 0x327) == '\0') {
    iVar7 = *(int *)(*(int *)(iVar3 + 0x5c) + 0x960);
  }
  else {
    iVar7 = *(int *)(iVar3 + 0x17c) / 12000;
  }
  if (0xe < iVar7) {
    iVar7 = 0xe;
  }
  dVar2 = (double)((iVar7 * 5 + 0x32) * 2);
  *(double *)((int)this + 0x58) = dVar2;
  *(double *)((int)this + 0x40) = dVar2;
  uVar1 = *(undefined4 *)(*(int *)(iVar3 + 0x5c) + 0x76c);
  *(undefined4 *)((int)this + 0x78) = 0;
  *(undefined4 *)((int)this + 0x60) = uVar1;
  *(undefined4 *)((int)this + 0x7c) = 0;
  iVar3 = Boss_ProcessEyebot((int)this);
  iVar7 = Collision_HandleEnemyHit();
  iVar4 = Boss_ProcessEyebot((int)this);
  *(undefined4 *)((int)this + 0x20) = 0;
  *(undefined4 *)((int)this + 0x24) = 0;
  *(double *)((int)this + 0x10) = (double)(iVar7 % (0xb4 - iVar3) + 0x32 + iVar4 / 2);
  uVar5 = Collision_HandleEnemyHit();
  uVar5 = uVar5 & 0x80000001;
  bVar8 = uVar5 == 0;
  if ((int)uVar5 < 0) {
    bVar8 = (uVar5 - 1 | 0xfffffffe) == 0xffffffff;
  }
  *(bool *)((int)this + 0x30) = !bVar8;
  *(undefined4 *)((int)this + 100) = 0xfffffa24;
  iVar3 = Collision_HandleEnemyHit();
  *(undefined4 *)((int)this + 0x84) = 0;
  *(undefined4 *)((int)this + 0x88) = 0;
  *(undefined1 *)((int)this + 0x38) = 1;
  *(int *)((int)this + 0x80) = iVar3 % 200 + -100;
  *(int *)(*(int *)((int)this + 0x4c) + 0x1bc) = *(int *)(*(int *)((int)this + 0x4c) + 0x1bc) + 1;
  *(int *)(*(int *)((int)this + 0x50) + 0xb0c) = *(int *)(*(int *)((int)this + 0x50) + 0xb0c) + -1;
  *(int *)(*(int *)((int)this + 0x4c) + 0x32c) = *(int *)(*(int *)((int)this + 0x4c) + 0x32c) + -1;
  *(undefined1 *)((int)this + 0x90) = 0;
  *(undefined4 *)((int)this + 8) = 0;
  if (*(char *)((int)this + 0x30) == '\0') {
    *(undefined4 *)((int)this + 0xc) = 0xc0804000;
    iVar3 = Collision_HandleEnemyHit();
    dVar2 = (double)(iVar3 % 0x32) * _DAT_0052c538 + _DAT_0052c5d8;
  }
  else {
    *(undefined4 *)((int)this + 0xc) = 0x40804000;
    iVar3 = Collision_HandleEnemyHit();
    dVar2 = -((double)(iVar3 % 0x32) * _DAT_0052c538 + _DAT_0052c5d8);
  }
  *(double *)((int)this + 0x18) = dVar2;
  *(int *)(*(int *)((int)this + 0x4c) + 0x7c) =
       *(int *)(*(int *)((int)this + 0x4c) + 0x7c) + *(int *)(*(int *)((int)this + 0x50) + 0xba0);
  piVar6 = (int *)(**(code **)(**(int **)(*(int *)((int)this + 0x50) + 0x438) + 0x1c))(0x18);
  *(int **)((int)this + 0x8c) = piVar6;
  if (piVar6 != (int *)0x0) {
    iVar3 = *piVar6;
    uVar9 = Math_FloatToUInt64();
    (**(code **)(iVar3 + 0x18))((int)uVar9);
    (**(code **)(**(int **)((int)this + 0x8c) + 0x14))(0,0);
    (**(code **)(**(int **)((int)this + 0x8c) + 0x1c))(1,1);
  }
  ExceptionList = local_10;
  return (undefined4 *)this;
}


