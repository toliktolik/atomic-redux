/*
 * Function: Unwind@00513f00
 * Address: 00513f00
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x005140db) overlaps instruction at (ram,0x005140da)
    */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall Unwind_00513f00(undefined4 param_1,int param_2)

{
  char *pcVar1;
  code *pcVar2;
  byte bVar3;
  ushort uVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  int iVar8;
  char cVar9;
  undefined4 unaff_EBX;
  byte *unaff_EBP;
  byte *unaff_ESI;
  byte *pbVar11;
  undefined4 *unaff_EDI;
  byte *pbVar12;
  byte *pbVar13;
  undefined2 in_CS;
  undefined2 in_SS;
  bool bVar14;
  char cVar15;
  char cVar16;
  undefined2 in_FPUControlWord;
  undefined8 uVar17;
  byte *pbVar18;
  int *piVar19;
  byte *pbVar10;
  
  *(byte *)(param_2 + 0x35ea7637) = *(byte *)(param_2 + 0x35ea7637) & (byte)param_1;
  cVar9 = (char)unaff_EBX - DAT_22075e80;
  pbVar10 = (byte *)CONCAT31((int3)((uint)unaff_EBX >> 8),cVar9);
  pbVar12 = (byte *)((int)unaff_EDI + -0x2f);
  bVar3 = *pbVar12;
  *pbVar12 = *pbVar12 >> 1;
  pbVar12 = (byte *)((int)unaff_EDI + -1);
  uVar5 = (int)unaff_EDI + 0xea1ddb85U + (uint)(bVar3 & 1);
  *(char *)(unaff_EDI + -0x712c641) =
       *(char *)(unaff_EDI + -0x712c641) + cVar9 +
       ((byte *)0x15e22479 < pbVar12 || CARRY4((int)unaff_EDI + 0xea1ddb85U,(uint)(bVar3 & 1)));
  piVar19 = (int *)CONCAT31((int3)((uint)param_1 >> 8),0xa5);
  uVar6 = uVar5 & 0xffffffa4;
  bVar14 = -1 < (char)uVar5;
  if (bVar14) {
    out(*(undefined4 *)unaff_ESI,(short)param_2);
    pcVar2 = (code *)swi(0xef);
    (*pcVar2)();
    func_0xa01778b8();
    return;
  }
  pbVar18 = unaff_ESI;
  if (!bVar14) {
    out(*unaff_ESI,(short)unaff_EDI);
    *(char *)((int)piVar19 + -0x43) = *(char *)((int)piVar19 + -0x43) + (char)(uVar6 >> 8);
    out(unaff_ESI[1],(short)unaff_EDI);
    bVar3 = (char)uVar6 + 1;
    _DAT_17ceafa2 = in_FPUControlWord;
    if (bVar3 < *pbVar12 || bVar3 == *pbVar12) {
      *(undefined2 *)(pbVar10 + (int)(unaff_ESI + 2) * 2 + -0x545e3021) = in_SS;
      func_0x1ed2448f(in_CS);
      return;
    }
    if (SBORROW1(bVar3,*pbVar12)) {
      pcVar2 = (code *)*unaff_EDI;
      unaff_ESI[-0xffffffff00000004] = 0xa4;
      unaff_ESI[-0xffffffff00000003] = 0x3f;
      unaff_ESI[-0xffffffff00000002] = 0x51;
      unaff_ESI[-0xffffffff00000001] = 0;
      (*pcVar2)();
      do {
                    /* WARNING: Do nothing block with infinite loop */
      } while( true );
    }
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  while( true ) {
    in((short)unaff_EDI);
    pbVar12[-0xf] = pbVar12[-0xf] ^ (byte)((uint)param_1 >> 8);
    pbVar10 = pbVar10 + *(int *)(pbVar18 + 0x4a);
    *pbVar10 = *pbVar10 | (byte)((uint)pbVar10 >> 8);
    (pbVar10 + 0x263104e8)[(int)unaff_ESI] = (pbVar10 + 0x263104e8)[(int)unaff_ESI] - 1;
    iVar8 = (int)*(undefined6 *)(pbVar10 + 0x39);
    *piVar19 = *piVar19 - (int)&stack0xffffffe4;
    pbVar11 = unaff_ESI + 5;
    pbVar12 = (byte *)((int)pbVar11 * -0x7c671586);
    if ((*(int *)(unaff_ESI + 1) + 0xf183b91eU & 0x44029e05) != 0) break;
    unaff_EDI = (undefined4 *)(*(int *)pbVar10 * 0x64334a5f);
    *pbVar12 = *pbVar12 | (byte)((uint)unaff_EDI >> 8);
    unaff_ESI = pbVar11;
    pbVar18 = pbVar18 + 1;
  }
  cVar9 = '\0';
  cVar16 = '\0';
  cVar15 = (int)pbVar11 < 0;
  bVar14 = pbVar11 == (byte *)0x0;
  if ((int)pbVar11 < 1) {
    pbVar13 = &DAT_0bc0ce5a;
    piVar19 = (int *)0xe41aadc6;
    pbVar11[0] = 0x18;
    pbVar11[1] = 0xca;
    pbVar11[2] = 0x48;
    pbVar11[3] = 0xe9;
    bVar3 = 0;
    pcVar2 = (code *)swi(0x38);
    uVar17 = (*pcVar2)();
    pbVar12 = pbVar11;
    if (bVar14 || cVar16 != cVar15) goto LAB_005140d4;
    if (cVar16 != cVar15) {
      pbVar13 = unaff_EBP + 1;
      pbVar12 = unaff_ESI + 6;
      cVar9 = *pbVar11 < *unaff_EBP;
      bVar14 = *pbVar11 == *unaff_EBP;
      goto LAB_005140d4;
    }
    pcVar1 = (char *)((int)((ulonglong)uVar17 >> 0x20) + -0x42);
    *pcVar1 = *pcVar1 << 1;
    return;
  }
  *(undefined2 *)pbVar10 = in_SS;
  cVar9 = '\0';
  pbVar11 = (byte *)((uint)pbVar11 & *(uint *)(iVar8 + -0x5b));
  pbVar13 = pbVar18 + 2;
  pbVar18[1] = (byte)pbVar10;
  bVar3 = 1;
  pbVar12 = pbVar11;
  do {
    *pbVar13 = (byte)pbVar11;
    uVar5 = 0xa05d5950;
    pbVar10 = pbVar12 + (uint)bVar3 * -2;
    do {
      uVar4 = (ushort)uVar5;
      pbVar12 = pbVar10 + -1;
      cVar9 = cVar9 == '\0';
      if (pbVar12 == (byte *)0x0 || (int)pbVar10 < 1) goto code_r0x005140d8;
      pbVar13 = (byte *)0x85aa36de;
      uVar5 = in((short)iVar8);
      iVar8 = iVar8 + -1;
      pbVar10 = pbVar12;
    } while (piVar19 == (int *)0x0);
    uVar6 = (uint)(byte)cVar9;
    cVar9 = uVar5 < 0x248b162f || uVar5 + 0xdb74e9d1 < uVar6;
    iVar7 = (uVar5 + 0xdb74e9d1) - uVar6;
    uVar17 = CONCAT44(iVar8,iVar7);
    bVar14 = iVar7 == 0;
LAB_005140d4:
    iVar8 = (int)((ulonglong)uVar17 >> 0x20);
    uVar4 = CONCAT11(0xa6,(char)uVar17);
    pbVar11 = (byte *)(uint)uVar4;
  } while (!bVar14);
code_r0x005140d8:
  out(*(undefined4 *)pbVar12,uVar4);
  out(0x29,(char)iVar8);
  do {
                    /* WARNING: Do nothing block with infinite loop */
  } while( true );
}


