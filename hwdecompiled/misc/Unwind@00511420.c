/*
 * Function: Unwind@00511420
 * Address: 00511420
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Instruction at (ram,0x00511431) overlaps instruction at (ram,0x0051142d)
    */
/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined8 __fastcall Unwind_00511420(int param_1,undefined4 param_2)

{
  uint *puVar1;
  int iVar2;
  char *pcVar3;
  char cVar4;
  undefined1 uVar5;
  undefined4 in_EAX;
  undefined3 uVar8;
  int iVar6;
  undefined4 *puVar7;
  byte bVar9;
  uint uVar10;
  undefined2 uVar11;
  int *piVar12;
  uint unaff_EBX;
  undefined4 *puVar13;
  uint unaff_EBP;
  uint *unaff_ESI;
  undefined2 *unaff_EDI;
  undefined2 in_ES;
  bool bVar14;
  bool bVar15;
  undefined2 in_FPUStatusWord;
  float10 in_ST0;
  float10 in_ST1;
  undefined1 in_XMM0 [16];
  undefined4 uStack_c;
  uint uVar16;
  
  cVar4 = (char)in_EAX;
  uVar8 = (undefined3)((uint)in_EAX >> 8);
  iVar6 = CONCAT31(uVar8,0xbd);
  if (cVar4 == 'U') {
    do {
      pcVar3 = (char *)CONCAT31((int3)((uint)iVar6 >> 8),(char)*unaff_ESI);
      in(0xf2);
      iVar6 = in(0xb6);
      *(uint *)(iVar6 + -0x3cf7d442) = *(uint *)(iVar6 + -0x3cf7d442) | 0xab30122e;
      *pcVar3 = *pcVar3 + (char)unaff_ESI + '\x01';
      unaff_ESI = puRam5e27d870;
    } while( true );
  }
  *(float *)(iVar6 + 0x14) = (float)in_ST0;
  uVar11 = CONCAT11(0xa5,(char)param_2);
  piVar12 = (int *)CONCAT22((short)((uint)param_2 >> 0x10),uVar11);
  rsqrtps(in_XMM0,*(undefined1 (*) [16])((int)unaff_ESI + -0x7c70cf96));
  if (param_1 == 0) {
    unaff_EBP = *unaff_ESI;
    if (SBORROW1(cVar4,'U')) {
      unaff_EBP = in(uVar11);
code_r0x005114d2:
      return CONCAT44(piVar12,unaff_EBP);
    }
    _DAT_00000000 = _DAT_00000000 & (uint)unaff_EDI;
    cVar4 = (char)param_2 + '[';
    piVar12 = (int *)CONCAT31((int3)((uint)piVar12 >> 8),cVar4);
    bVar9 = 6;
    if (cVar4 != '\0') {
      *(double *)(unaff_EBX + 0x16) = (double)in_ST1;
      halt_baddata();
    }
  }
  else {
    uVar16 = *(uint *)(unaff_EBP + 0x8475edb0);
    bVar9 = (byte)uVar16 & 0x1f;
    uVar10 = uVar16 >> bVar9 | uVar16 << 0x20 - bVar9;
    bVar14 = (uVar16 & 0x1f) != 0;
    if ((!bVar14 || bVar14 && (int)uVar10 < 0) || cVar4 == 'U') {
      *piVar12 = *piVar12 + unaff_EBX;
      bVar9 = (byte)uVar10 - 1;
      unaff_EBP = (uint)CONCAT21((short)((uint)in_EAX >> 0x10),(char)((uint)in_EAX >> 8) + '[') << 8
      ;
      out(*(undefined4 *)((int)unaff_ESI + 5),uVar11);
    }
    else {
      iVar6 = CONCAT31(uVar8,(char)*unaff_ESI) + 0x5af3f27;
      puVar1 = (uint *)((int)unaff_EDI + 0xca4c0c99);
      bVar9 = (byte)uVar10 & 0x1f;
      *puVar1 = *puVar1 << bVar9 | *puVar1 >> 0x20 - bVar9;
      bVar14 = (uVar10 & 0x1f) != 0;
      bVar14 = !bVar14 && (unaff_EBX & 1) != 0 || bVar14 && (*puVar1 & 1) != 0;
      uVar16 = CONCAT22((short)(unaff_EBX >> 0x10),in_ES);
      if (uVar10 != 1) {
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      }
      if ((bVar9 != 1 && (unaff_EBX & 0x800) != 0 || bVar9 == 1 && bVar14 != (int)*puVar1 < 0) ==
          ((unaff_EBX & 0x80) != 0)) {
        piVar12 = (int *)((int)piVar12 + 1);
        unaff_EDI = (undefined2 *)((int)unaff_EDI + (uint)((unaff_EBX & 0x400) != 0) * -2 + 1);
        bVar15 = false;
        puVar7 = (undefined4 *)
                 (CONCAT22((short)((uint)iVar6 >> 0x10),
                           CONCAT11(((int)piVar12 < 0) << 7 | (piVar12 == (int *)0x0) << 6 |
                                    ((unaff_EBX & 0x10) != 0) << 4 |
                                    ((POPCOUNT((uint)piVar12 & 0xff) & 1U) == 0) << 2 | 2U | bVar14,
                                    (char)iVar6)) ^ 0x43131e1b);
        bVar14 = ((uint)puVar7 & 0x4000) != 0;
      }
      else {
        iVar2 = iVar6 + *(int *)(unaff_EBX - 0x62);
        bVar15 = SCARRY4(iVar6,*(int *)(unaff_EBX - 0x62)) != SCARRY4(iVar2,(uint)bVar14);
        puVar7 = (undefined4 *)(iVar2 + (uint)bVar14);
        bVar14 = puVar7 == (undefined4 *)0x0;
      }
      bVar9 = 0;
      if (!bVar14) {
        if (bVar15) {
          piVar12 = (int *)CONCAT22((short)((uint)piVar12 >> 0x10),
                                    CONCAT11((char)((uint)piVar12 >> 8) +
                                             *(char *)(uVar16 + 0xed4345),(char)piVar12));
          *unaff_EDI = in_FPUStatusWord;
          puVar13 = (undefined4 *)&stack0xfffffff8;
          cVar4 = '\x17';
          do {
            puVar7 = puVar7 + -1;
            puVar13 = puVar13 + -1;
            *puVar13 = *puVar7;
            cVar4 = cVar4 + -1;
          } while ('\0' < cVar4);
          unaff_EBP = uVar16 | 0x6584d763;
        }
        goto code_r0x005114d2;
      }
    }
  }
  uVar5 = in(0x5c);
  *(char *)((int)piVar12 + -0x3f68b923) = *(char *)((int)piVar12 + -0x3f68b923) << (bVar9 & 0x1f);
  return CONCAT44(0xf0c5018c,CONCAT31((int3)(unaff_EBP >> 8),uVar5));
}


