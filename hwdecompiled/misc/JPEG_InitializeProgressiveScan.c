/*
 * Function: JPEG_InitializeProgressiveScan
 * Address: 004df450
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl JPEG_InitializeProgressiveScan(int *param_1)

{
  int iVar1;
  int iVar2;
  bool bVar3;
  int *piVar4;
  int iVar5;
  bool bVar6;
  bool bVar7;
  undefined4 *local_10;
  int *local_c;
  int local_8;
  
  iVar1 = param_1[0x66];
  bVar6 = param_1[0x5b] != 0;
  bVar3 = false;
  if (bVar6) {
    if ((param_1[0x5c] < param_1[0x5b]) || (0x3f < param_1[0x5c])) {
      bVar3 = true;
    }
    bVar7 = param_1[0x49] == 1;
  }
  else {
    bVar7 = param_1[0x5c] == 0;
  }
  if (!bVar7) {
    bVar3 = true;
  }
  if ((param_1[0x5d] != 0) && (param_1[0x5e] != param_1[0x5d] + -1)) {
    bVar3 = true;
  }
  if ((0xd < param_1[0x5e]) || (bVar3)) {
    *(undefined4 *)(*param_1 + 0x14) = 0x10;
    *(int *)(*param_1 + 0x18) = param_1[0x5b];
    *(int *)(*param_1 + 0x1c) = param_1[0x5c];
    *(int *)(*param_1 + 0x20) = param_1[0x5d];
    *(int *)(*param_1 + 0x24) = param_1[0x5e];
    (**(code **)*param_1)(param_1);
  }
  local_8 = 0;
  if (0 < param_1[0x49]) {
    local_c = param_1 + 0x4a;
    do {
      iVar2 = *(int *)(*local_c + 4);
      piVar4 = (int *)(iVar2 * 0x100 + param_1[0x23]);
      if ((bVar6) && (*piVar4 < 0)) {
        *(undefined4 *)(*param_1 + 0x14) = 0x73;
        *(int *)(*param_1 + 0x18) = iVar2;
        *(undefined4 *)(*param_1 + 0x1c) = 0;
        (**(code **)(*param_1 + 4))(param_1,0xffffffff);
      }
      iVar5 = param_1[0x5b];
      if (iVar5 <= param_1[0x5c]) {
        do {
          if (param_1[0x5d] != (piVar4[iVar5] & (piVar4[iVar5] < 0) - 1)) {
            *(undefined4 *)(*param_1 + 0x14) = 0x73;
            *(int *)(*param_1 + 0x18) = iVar2;
            *(int *)(*param_1 + 0x1c) = iVar5;
            (**(code **)(*param_1 + 4))(param_1,0xffffffff);
          }
          piVar4[iVar5] = param_1[0x5e];
          iVar5 = iVar5 + 1;
        } while (iVar5 <= param_1[0x5c]);
      }
      local_8 = local_8 + 1;
      local_c = local_c + 1;
    } while (local_8 < param_1[0x49]);
  }
  if (param_1[0x5d] == 0) {
    if (bVar6) {
      *(code **)(iVar1 + 4) = JPEG_DecodeACCoefficients;
    }
    else {
      *(code **)(iVar1 + 4) = JPEG_DecodeSequentialData;
    }
  }
  else if (bVar6) {
    *(code **)(iVar1 + 4) = JPEG_DecodeProgressiveAC;
  }
  else {
    *(code **)(iVar1 + 4) = JPEG_DecodeBitSelection;
  }
  local_8 = 0;
  if (0 < param_1[0x49]) {
    local_10 = (undefined4 *)(iVar1 + 0x18);
    local_c = param_1 + 0x4a;
    do {
      if (bVar6) {
        iVar2 = *(int *)(*local_c + 0x18);
        piVar4 = (int *)(iVar1 + 0x2c + iVar2 * 4);
        Compression_BuildHuffmanTable(param_1,'\0',iVar2,piVar4);
        *(int *)(iVar1 + 0x3c) = *piVar4;
      }
      else if (param_1[0x5d] == 0) {
        iVar2 = *(int *)(*local_c + 0x14);
        Compression_BuildHuffmanTable(param_1,'\x01',iVar2,(int *)(iVar1 + 0x2c + iVar2 * 4));
      }
      *local_10 = 0;
      local_10 = local_10 + 1;
      local_8 = local_8 + 1;
      local_c = local_c + 1;
    } while (local_8 < param_1[0x49]);
  }
  *(undefined4 *)(iVar1 + 0x10) = 0;
  *(undefined4 *)(iVar1 + 0xc) = 0;
  *(undefined4 *)(iVar1 + 0x14) = 0;
  *(undefined1 *)(iVar1 + 8) = 0;
  *(int *)(iVar1 + 0x28) = param_1[0x3f];
  return;
}


