/*
 * Function: CPU_ExecuteWithBuffer
 * Address: 004c6080
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


undefined4 __thiscall CPU_ExecuteWithBuffer(void *this,int param_1)

{
  uint uVar1;
  int in_EAX;
  int *piVar2;
  int iVar3;
  undefined4 uVar4;
  undefined4 *unaff_EBX;
  undefined4 local_18 [5];
  
  CPU_ClearContext8(this,unaff_EBX);
  CPU_ExecuteStep();
  iVar3 = *(int *)(in_EAX + 0x38);
  if ((iVar3 != 0) && (*(uint *)(in_EAX + 0x38) = (uint)(*(int *)(in_EAX + 0x40) == 0), iVar3 == 2))
  {
    *(uint *)(in_EAX + 0x24) =
         *(int *)(in_EAX + 0x24) + (uint)(0xfffffffe < *(uint *)(in_EAX + 0x20));
    *(uint *)(in_EAX + 0x20) = *(uint *)(in_EAX + 0x20) + 1;
    return 0xfffffff6;
  }
  iVar3 = *(int *)(in_EAX + 0x3c);
  if ((iVar3 != 0) && (*(uint *)(in_EAX + 0x3c) = (uint)(*(int *)(in_EAX + 0x40) == 0), iVar3 == 2))
  {
    *(uint *)(in_EAX + 0x24) =
         *(int *)(in_EAX + 0x24) + (uint)(0xfffffffe < *(uint *)(in_EAX + 0x20));
    *(uint *)(in_EAX + 0x20) = *(uint *)(in_EAX + 0x20) + 1;
    return 0xfffffff5;
  }
  if ((*(uint *)(in_EAX + 0x34) & 0x80000000) == 0) {
    return 0;
  }
  if (unaff_EBX == (undefined4 *)0x0) {
    if (param_1 == 0) {
      return 1;
    }
  }
  else {
    unaff_EBX[2] = *(undefined4 *)(in_EAX + 0x14);
    if ((*(int *)(in_EAX + 0x10) == 0) || (*(int *)(in_EAX + 0x48) != 0)) {
      unaff_EBX[3] = 0;
    }
    else {
      unaff_EBX[3] = *(int *)(in_EAX + 0x10);
    }
    if (((*(uint *)(in_EAX + 0x34) & 0x80000000) == 0) ||
       ((*(uint *)(in_EAX + 0x48) & 0x80000000) != 0)) {
      unaff_EBX[4] = 0xffffffff;
      unaff_EBX[5] = 0xffffffff;
    }
    else {
      unaff_EBX[4] = *(undefined4 *)(in_EAX + 0x28);
      unaff_EBX[5] = *(undefined4 *)(in_EAX + 0x2c);
    }
    unaff_EBX[6] = *(undefined4 *)(in_EAX + 0x20);
    unaff_EBX[7] = *(undefined4 *)(in_EAX + 0x24);
    if (param_1 == 0) {
      uVar4 = PNG_SetMemoryCallbacks(0,*(int **)(in_EAX + 0xc));
      *unaff_EBX = uVar4;
      unaff_EBX[1] = *(uint *)(in_EAX + 0x34) & 0x7fffffff;
      return 1;
    }
  }
  PNG_GetBitDepth(local_18);
  if (unaff_EBX == (undefined4 *)0x0) {
    iVar3 = PNG_ProcessData(*(uint *)(in_EAX + 0x34) & 0x7fffffff);
    *(int *)(in_EAX + 0xc) = iVar3;
    if (iVar3 == 0) {
      *(undefined4 *)(in_EAX + 8) = 0;
    }
  }
  else {
    piVar2 = PNG_GetFreeFn((int *)(in_EAX + 8));
    *unaff_EBX = piVar2;
    unaff_EBX[1] = *(uint *)(in_EAX + 0x34) & 0x7fffffff;
  }
  *(undefined4 *)(in_EAX + 0x34) = *(undefined4 *)(in_EAX + 0x48);
  CPU_ReadInstructionBytes();
  uVar1 = *(uint *)(in_EAX + 0x20);
  *(undefined4 *)(in_EAX + 0x14) = 0;
  *(uint *)(in_EAX + 0x20) = uVar1 + 1;
  *(uint *)(in_EAX + 0x24) = *(int *)(in_EAX + 0x24) + (uint)(0xfffffffe < uVar1);
  return 1;
}


