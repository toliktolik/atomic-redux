/*
 * Function: Database_ExecuteCommand
 * Address: 0047e080
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


facet * __cdecl Database_ExecuteCommand(locale *param_1)

{
  facet *this;
  int iVar1;
  exception local_24 [12];
  int local_18;
  int local_14;
  void *local_10;
  undefined4 uStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  uStack_c = 0x5147a8;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  Threading_LockSectorByIndex(&local_18,0);
  local_8 = 0;
  if (DAT_005a33bc == 0) {
    Threading_LockSectorByIndex(&local_14,0);
    if (DAT_005a33bc == 0) {
      DAT_005a33bc = DAT_005a4828 + 1;
      DAT_005a4828 = DAT_005a33bc;
    }
    Threading_UnlockSectorByIndex(&local_14);
  }
  this = std::locale::_Getfacet(param_1,DAT_005a33bc);
  if ((this == (facet *)0x0) && (this = DAT_005a33b8, DAT_005a33b8 == (facet *)0x0)) {
    iVar1 = System_ProcessSystemEvents((int *)&DAT_005a33b8);
    if (iVar1 == -1) {
      Exception_Constructor(local_24);
      CRuntime_CxxThrowException(local_24,&DAT_005511f0);
    }
    this = DAT_005a33b8;
    RefCount_Increment((int)DAT_005a33b8);
    std::locale::facet::_Register(this);
  }
  local_8 = 0xffffffff;
  Threading_UnlockSectorByIndex(&local_18);
  ExceptionList = local_10;
  return this;
}


