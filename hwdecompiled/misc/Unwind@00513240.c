/*
 * Function: Unwind@00513240
 * Address: 00513240
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x0051331b) overlaps instruction at (ram,0x00513319)
    */
/* WARNING: Unable to track spacebase fully for stack */

void __fastcall Unwind_00513240(uint *param_1)

{
  byte *pbVar1;
  ushort *puVar2;
  char *pcVar3;
  byte bVar4;
  char cVar6;
  byte bVar7;
  code *pcVar8;
  ulonglong uVar9;
  uint5 uVar10;
  byte bVar11;
  undefined1 uVar12;
  undefined4 uVar13;
  uint in_EAX;
  int iVar14;
  undefined1 *puVar15;
  uint uVar16;
  byte *pbVar18;
  byte bVar19;
  undefined2 uVar20;
  byte bVar21;
  int unaff_EBX;
  int iVar22;
  undefined4 *puVar23;
  int unaff_EBP;
  uint *puVar24;
  uint *puVar25;
  undefined4 *unaff_ESI;
  undefined1 *puVar26;
  undefined4 *unaff_EDI;
  undefined2 in_CS;
  bool bVar27;
  bool bVar28;
  undefined8 in_MM1;
  undefined8 in_MM3;
  undefined4 uStack_d;
  byte bVar5;
  undefined4 *puVar17;
  
  *param_1 = *param_1 & 0x55;
  if (*param_1 != 0) {
    out(0x25e8,in_EAX + 1);
    *(uint *)(in_EAX + 0xbd17777a) = *(uint *)(in_EAX + 0xbd17777a) | in_EAX + 1;
    pcVar8 = (code *)swi(3);
    (*pcVar8)();
    return;
  }
  pcVar3 = (char *)((in_EAX - 0x70) + (int)unaff_EDI * 4);
  bVar11 = (byte)param_1 & 0x1f;
  cVar6 = *pcVar3;
  *pcVar3 = *pcVar3 << bVar11;
  bVar28 = ((uint)param_1 & 0x1f) != 0 && (char)(cVar6 << bVar11 - 1) < '\0';
  uVar13 = *unaff_ESI;
  if (bVar11 != 1 || bVar28 == *pcVar3 < '\0') {
    pcVar8 = (code *)swi(3);
    uVar13 = (*pcVar8)();
    *unaff_EDI = uVar13;
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  bVar11 = -bVar28;
  bVar19 = (byte)((uint)param_1 >> 8);
  puVar26 = (undefined1 *)((int)unaff_ESI + 5);
  *(undefined1 *)unaff_EDI = *(undefined1 *)(unaff_ESI + 1);
  paddusb(in_MM3,in_MM1);
  iVar14 = CONCAT31((int3)((uint)(CONCAT31((int3)(CONCAT22((short)((uint)uVar13 >> 0x10),
                                                           CONCAT11(bVar11 / 0x79,bVar11)) >> 8),
                                           bVar11 % 0x79) + 1) >> 8),0x6d);
  puVar15 = (undefined1 *)(iVar14 + 0x506f6ee8);
  bVar27 = false;
  uVar20 = SUB42(puVar15,0);
  uVar12 = in(uVar20);
  puVar17 = (undefined4 *)
            CONCAT31(CONCAT21((short)((uint)((int)unaff_ESI + -0x57) >> 0x10),
                              (char)((uint)((int)unaff_ESI + -0x57) >> 8) + bVar19 + bVar28),uVar12)
  ;
  puVar24 = (uint *)(unaff_EBP + 1);
  if (-1 < (int)puVar24) {
    pbVar18 = (byte *)((int)puVar17 + -0x2895672e);
    puVar2 = (ushort *)(puVar26 + unaff_EBX * 4);
    *puVar2 = *puVar2 + (ushort)(puVar17 < (undefined4 *)0x2895672e) *
                        (((ushort)(undefined4 *)((int)unaff_EDI + 5) & 3) - (*puVar2 & 3));
    if (SBORROW4((int)puVar17,0x2895672e)) {
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    *(undefined4 *)((int)unaff_EDI + 5) = pbVar18;
    bVar28 = (byte *)(unaff_EBX + 1) < pbVar18;
    *(uint **)((int)param_1 + (int)pbVar18) = param_1;
    pbVar1 = (byte *)(iVar14 + 0x6b2a839d);
    bVar11 = *pbVar1;
    bVar21 = (byte)((uint)puVar15 >> 8);
    bVar4 = *pbVar1;
    bVar7 = *pbVar1 - bVar21;
    *pbVar1 = bVar7 - bVar28;
    bVar5 = *pbVar1;
    uVar10 = CONCAT14(bVar11 < bVar21 || bVar7 < bVar28,*(uint *)((int)puVar17 + -0x2895674f));
    uVar9 = (ulonglong)uVar10 << 0x12;
    *(uint *)((int)puVar17 + -0x2895674f) = (uint)(uVar10 >> 0xf) | (uint)uVar9;
    bVar11 = (byte)pbVar18;
    out(uVar20,bVar11);
    if ((SBORROW1(bVar4,bVar21) != SBORROW1(bVar7,bVar28)) != (char)bVar5 < '\0') {
      if ((uVar9 & 0x100000000) == 0) {
        if (SCARRY4((int)puVar24,(int)param_1) !=
            SCARRY4((int)puVar24 + (int)param_1,(uint)(0x72 < bVar11))) {
          do {
                    /* WARNING: Do nothing block with infinite loop */
          } while( true );
        }
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      }
      while( true ) {
        *pbVar18 = *pbVar18 | 0x5e;
        *(byte *)(iVar14 + 0x6163621d) = *(byte *)(iVar14 + 0x6163621d) ^ (byte)pbVar18;
        *puVar15 = *puVar26;
        param_1[2] = (uint)puVar24;
        bVar11 = DAT_b121fca0;
        iVar22 = CONCAT31((int3)((uint)unaff_EBX >> 8),0x46);
        if ((POPCOUNT((byte)(pbVar18 + 1) & 0x4e) & 1U) != 0) {
                    /* WARNING: Bad instruction - Truncating control flow here */
          halt_baddata();
        }
        puVar25 = (uint *)*puVar24;
        pbVar18 = (byte *)CONCAT31((int3)((uint)(pbVar18 + 1) >> 8),DAT_b121fca0);
        pbVar1 = (byte *)(iVar14 + 0x506f6eac);
        *pbVar1 = *pbVar1 ^ bVar19;
        bVar4 = *pbVar1;
        *(undefined2 *)puVar24 = in_CS;
        out(puVar26[-1],uVar20);
        if ('\0' < (char)bVar4) break;
        pbVar18[-0x7c] = pbVar18[-0x7c] | bVar11;
        *(char *)((int)param_1 + 0x2463499f) = (char)((uint)unaff_EBX >> 8);
        puVar26 = puVar26 + -3;
        unaff_EBX = iVar22;
        puVar24 = puVar25;
      }
      *(int *)(puVar26 + 0x18) = iVar22;
      File_FlushBuffers((int)param_1);
      return;
    }
    bVar27 = 9 < (bVar11 & 0xf) || (in_EAX & 0x1000) != 0;
    uVar16 = CONCAT31((int3)((uint)pbVar18 >> 8),bVar11 + bVar27 * '\x06') & 0xffffff0f;
    puVar17 = (undefined4 *)
              CONCAT22((short)(uVar16 >> 0x10),
                       CONCAT11((char)((uint)pbVar18 >> 8) + bVar27,(char)uVar16));
  }
  *(uint *)(unaff_EBP + -0x7b) = *(uint *)(unaff_EBP + -0x7b) << 1 | (uint)bVar27;
  pcVar8 = (code *)swi(0x4f);
  (*pcVar8)();
  puVar23 = (undefined4 *)&stack0xfffffff7;
  cVar6 = '\x1d';
  do {
    puVar17 = puVar17 + -1;
    puVar23 = puVar23 + -1;
    *puVar23 = *puVar17;
    cVar6 = cVar6 + -1;
  } while ('\0' < cVar6);
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}


