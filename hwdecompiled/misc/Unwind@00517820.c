/*
 * Function: Unwind@00517820
 * Address: 00517820
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x005178d7) overlaps instruction at (ram,0x005178d5)
    */

void __fastcall Unwind_00517820(uint param_1,int *param_2,undefined4 *param_3)

{
  char *pcVar1;
  undefined4 uVar2;
  byte bVar3;
  ushort uVar4;
  byte *in_EAX;
  byte *pbVar5;
  short sVar7;
  uint uVar6;
  uint extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined2 uVar8;
  byte bVar11;
  int *piVar9;
  int iVar10;
  byte *unaff_EBX;
  byte *unaff_EBP;
  undefined1 *unaff_ESI;
  undefined1 *puVar12;
  byte *unaff_EDI;
  byte *pbVar13;
  undefined2 in_CS;
  undefined1 in_CF;
  bool bVar14;
  byte in_AF;
  bool bVar15;
  bool bVar16;
  char cVar17;
  char cVar18;
  undefined2 in_FPUControlWord;
  unkbyte10 extraout_ST0;
  undefined8 uVar19;
  undefined6 uVar20;
  byte *pbVar21;
  byte *unaff_retaddr;
  
code_r0x00517820:
  unaff_EDI = unaff_EDI + -1;
  if (!(bool)in_CF && unaff_EDI != (byte *)0x0) {
    *(uint *)(in_EAX + param_1 * 4) = *(uint *)(in_EAX + param_1 * 4) ^ 0xf;
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  pbVar21 = unaff_retaddr;
  if (unaff_EDI != (byte *)0x0) {
    iVar10 = (int)in_EAX >> 0x1f;
    pbVar5 = (byte *)CONCAT31((int3)((uint)in_EAX >> 8),DAT_b30b722a);
    *(int *)(iVar10 + 0x54) = *(int *)(iVar10 + 0x54) + 1;
    puVar12 = unaff_ESI;
    goto code_r0x00517888;
  }
  piVar9 = (int *)((int)param_2 + 1);
  pbVar5 = (byte *)((uint)in_EAX | 0x856f3951);
  param_1 = param_1 - 1;
  bVar11 = (byte)((uint)piVar9 >> 8);
  if (param_1 != 0 && pbVar5 != (byte *)0x0) {
    iVar10 = CONCAT22((short)((uint)piVar9 >> 0x10),CONCAT11(bVar11 - (char)param_2[3],(char)piVar9)
                     );
    in_EAX = unaff_EBX;
    do {
      unaff_EBX = (byte *)CONCAT31((int3)((uint)in_EAX >> 8),0xff);
      iVar10 = iVar10 + 1;
      unaff_EBP = unaff_retaddr;
      puVar12 = unaff_ESI;
      pbVar21 = (byte *)register0x00000010;
code_r0x00517888:
      uVar19 = CONCAT44(iVar10,unaff_EDI);
      pbVar13 = unaff_EDI + 0x13;
      bVar11 = *pbVar13;
      bVar3 = (byte)iVar10;
      *pbVar13 = *pbVar13 - bVar3;
      pcVar1 = (char *)(param_1 + 0x14 + (int)unaff_EBP * 4);
      *pcVar1 = (*pcVar1 - bVar3) - (bVar11 < bVar3);
      unaff_retaddr = unaff_EBP + -(int)unaff_EBX;
      if (unaff_retaddr == (byte *)0x0 || (int)unaff_EBP < (int)unaff_EBX) {
        cVar17 = (char)unaff_EBX + (char)(param_1 >> 8) + (unaff_EBP < unaff_EBX);
        in_EAX = (byte *)CONCAT31((int3)((uint)unaff_EBX >> 8),cVar17);
        pbVar13 = pbVar5;
        if ((POPCOUNT(cVar17) & 1U) != 0) goto LAB_005178d5;
      }
      else {
        uVar6 = (uint)pbVar5 ^ 0xd813135d;
        pbVar5 = puVar12 + (int)unaff_EDI * 4 + -0x40;
        bVar14 = *pbVar5 < 2;
        cVar18 = SBORROW1(*pbVar5,'\x02');
        *pbVar5 = *pbVar5 - 2;
        cVar17 = (char)*pbVar5 < '\0';
        bVar16 = *pbVar5 == 0;
        if (!(bool)cVar18) goto LAB_005178cf;
        in_EAX = (byte *)CONCAT22((short)((uint)unaff_EBX >> 0x10),CONCAT11(0xdd,(char)unaff_EBX));
        uVar19 = func_0x32972bce();
        uVar8 = (undefined2)((ulonglong)uVar19 >> 0x20);
        uVar2 = in(uVar8);
        *(undefined4 *)unaff_EDI = uVar2;
        param_1 = extraout_ECX;
        pbVar13 = unaff_EDI + 4;
        if (!bVar16 && cVar18 == cVar17) goto code_r0x005178ae;
      }
      bVar16 = false;
      pbVar5 = (byte *)((uint)uVar19 ^ 0xbd46c2d4);
      bVar14 = (int)pbVar5 < 0;
      bVar15 = pbVar5 == (byte *)0x0;
      do {
        if (!bVar15 && !bVar14) {
                    /* WARNING: Bad instruction - Truncating control flow here */
          halt_baddata();
        }
        while( true ) {
          sVar7 = (short)((uint)pbVar5 >> 0x10);
          uVar4 = (ushort)(byte)((char)pbVar5 + (char)((uint)pbVar5 >> 8) * -4);
          pbVar5 = (byte *)CONCAT22(sVar7,uVar4);
          bVar14 = false;
          bVar15 = uVar4 == 0;
          if (!bVar16 && !bVar15) break;
          pcVar1 = (char *)((int)((ulonglong)uVar19 >> 0x20) + -0x2b);
          bVar11 = (byte)param_1 & 0x1f;
          cVar17 = *pcVar1;
          *pcVar1 = *pcVar1 >> bVar11;
          bVar14 = (param_1 & 0x1f) != 0;
          bVar16 = (bool)(!bVar14 & bVar16 | (bVar14 && (cVar17 >> bVar11 - 1 & 1U) != 0));
        }
      } while (!bVar15);
      unaff_EDI = pbVar13 + 4;
      uVar2 = in((short)((ulonglong)uVar19 >> 0x20));
      *(undefined4 *)pbVar13 = uVar2;
      iVar10 = (int)sVar7 >> 0xf;
      unaff_ESI = puVar12 + 1;
      out(*puVar12,(short)iVar10);
    } while( true );
  }
  uVar2 = *param_3;
  *(bool *)(param_2 + 0x5dcdd57) = -1 < (int)pbVar5;
  pbVar5 = unaff_ESI + -0x493fcdab;
  *pbVar5 = *pbVar5 << 5 | *pbVar5 >> 3;
  bVar3 = (char)uVar2 - 0x11;
  in_AF = 9 < (bVar3 & 0xf) | in_AF;
  uVar6 = CONCAT31((int3)((uint)uVar2 >> 8),bVar3 + in_AF * '\x06') & 0xffffff0f;
  unaff_EBX = (byte *)(CONCAT22((short)(uVar6 >> 0x10),
                                CONCAT11((char)((uint)uVar2 >> 8) + in_AF,(char)uVar6)) + -1);
  unaff_ESI = unaff_ESI + 1;
  in_EAX = (byte *)(*piVar9 * -0x44a30e7b);
  *unaff_EBX = *unaff_EBX ^ bVar11;
  unaff_EDI = (byte *)0x0;
  goto Unwind_00517815_1;
code_r0x005178ae:
  if (bVar14) {
    in_EAX[0x4a2cc3eb] = in_EAX[0x4a2cc3eb] ^ (byte)((ulonglong)uVar19 >> 0x20);
    *(int *)(unaff_retaddr + 0x43) =
         *(int *)(unaff_retaddr + 0x43) - CONCAT31((int3)((uint)in_EAX >> 8),0xf2);
    uVar6 = in(uVar8);
    uVar2 = in(uVar8);
    *(undefined4 *)(unaff_EDI + 3) = uVar2;
    pbVar5 = (byte *)(uVar6 & 0xffffff10);
    goto code_r0x005178dd;
  }
  iVar10 = (int)uVar19 + -1;
  unaff_EBX = (byte *)CONCAT22((short)((uint)iVar10 >> 0x10),CONCAT11(0xf9,(char)iVar10));
  unaff_ESI = puVar12 + -1;
  unaff_EDI = unaff_EDI + 8;
  piVar9 = (int *)((uint)((ulonglong)uVar19 >> 0x20) | *(uint *)(extraout_ECX - 99));
  *piVar9 = *piVar9 + 0xd;
  bVar11 = (byte)((uint)piVar9 >> 8) & *unaff_EDI;
  piVar9 = (int *)CONCAT22((short)((uint)piVar9 >> 0x10),CONCAT11(bVar11,(char)piVar9));
  in_CS = SUB42(unaff_retaddr,0);
  if (extraout_ECX != 0) {
    param_1 = extraout_ECX - 2;
    uVar6 = CONCAT22((short)((uint)(unaff_EBX + 1) >> 0x10),CONCAT11(bVar11,(char)(unaff_EBX + 1)));
LAB_005178cf:
    pbVar5 = (byte *)(uVar6 ^ 0xed);
LAB_005178d5:
    in_CS = SUB42(unaff_EDI,0);
code_r0x005178dd:
    while( true ) {
      iVar10 = (*(code *)(param_1 + 0x5c))(in_CS);
      *(unkbyte10 *)(iVar10 + -0x24) = extraout_ST0;
      param_1 = CONCAT31((int3)((uint)extraout_ECX_00 >> 8),
                         (char)extraout_ECX_00 - *(char *)(iVar10 + -0x22c81293));
      out(0xcc,iVar10);
      do {
        param_1 = param_1 - 1;
      } while (param_1 != 0 && pbVar5 + 1 != (byte *)0x0);
      if ((POPCOUNT((uint)(pbVar5 + 1) & 0xff) & 1U) != 0) break;
      *(undefined2 *)(pbVar5 + -0x30712c09) = in_FPUControlWord;
      pbVar5 = (byte *)CONCAT31((int3)((uint)iVar10 >> 8),0xaf);
    }
    uVar20 = func_0x9aa8a8eb(in_CS);
    pcVar1 = (char *)((CONCAT31((int3)((uint6)uVar20 >> 8),0x2f) & 0xa91b1a26) + 0x93eb3d0a);
    *pcVar1 = *pcVar1 + (char)((uint6)uVar20 >> 0x28);
    in((short)((uint6)uVar20 >> 0x20));
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
Unwind_00517815_1:
  uVar6 = param_1 >> 8;
  in_CF = *unaff_EBX < (byte)unaff_EBX;
  LOCK();
  param_1 = *(uint *)(unaff_EDI + -0x4c379f9e);
  *(uint *)(unaff_EDI + -0x4c379f9e) = CONCAT31((int3)uVar6,0x8d);
  UNLOCK();
  param_2 = piVar9;
  unaff_EBP = unaff_retaddr;
  unaff_retaddr = pbVar21;
  goto code_r0x00517820;
}


