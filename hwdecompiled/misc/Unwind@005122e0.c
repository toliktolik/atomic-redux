/*
 * Function: Unwind@005122e0
 * Address: 005122e0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x005122d1) overlaps instruction at (ram,0x005122cf)
    */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

uint * __fastcall Unwind_005122e0(uint *param_1,uint param_2)

{
  undefined2 *puVar1;
  byte bVar2;
  uint *puVar3;
  byte bVar4;
  char cVar5;
  uint *puVar6;
  uint *puVar7;
  int extraout_ECX;
  int iVar8;
  int iVar9;
  int unaff_EBX;
  uint *puVar10;
  int unaff_ESI;
  uint *unaff_EDI;
  undefined2 in_CS;
  undefined2 uVar11;
  undefined2 uVar12;
  bool bVar13;
  bool bVar14;
  bool bVar15;
  byte in_AF;
  undefined1 in_ZF;
  undefined1 in_SF;
  byte in_TF;
  char in_OF;
  byte in_NT;
  byte in_AC;
  byte in_VIF;
  byte in_VIP;
  byte in_ID;
  undefined8 uVar16;
  uint unaff_retaddr;
  
  while( true ) {
    puVar7 = param_1;
    if ((bool)in_ZF || in_OF != in_SF) {
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    LOCK();
    *(uint *)(unaff_ESI + 1) = param_2;
    UNLOCK();
    if ((bool)in_SF) break;
    uVar11 = 0x9468;
    uVar16 = func_0x46b48ec7(in_CS);
    _DAT_1c6e2b14 = (undefined4)uVar16;
    cVar5 = in(0x29);
    iVar8 = CONCAT31((int3)((ulonglong)uVar16 >> 0x28),0x96);
    if (extraout_ECX != 0) {
      *(char *)((int)unaff_EDI + 0x43fad9d9) =
           *(char *)((int)unaff_EDI + 0x43fad9d9) << ((byte)extraout_ECX & 0x1f);
      halt_baddata();
    }
    out((short)iVar8,cVar5);
    bVar13 = *(uint *)(unaff_retaddr + 1) < *unaff_EDI;
    bVar4 = cVar5 + (char)((ulonglong)uVar16 >> 8) * -0x1f;
    bVar2 = bVar4 - 0x23;
    bVar14 = 0x22 < bVar4 || CARRY1(bVar2,bVar13);
    bVar4 = (byte)unaff_EBX + *(byte *)(unaff_retaddr + 0x4291f9dc);
    bVar15 = CARRY1((byte)unaff_EBX,*(byte *)(unaff_retaddr + 0x4291f9dc)) || CARRY1(bVar4,bVar14);
    unaff_EBX = CONCAT31((int3)((uint)unaff_EBX >> 8),bVar4 + bVar14);
    LOCK();
    puVar1 = *(undefined2 **)(unaff_EBX + 0x78);
    *(undefined1 **)(unaff_EBX + 0x78) = &stack0x00000004;
    UNLOCK();
    uVar12 = *puVar1;
    puVar6 = (uint *)0xfc3888cb;
    puVar3 = (uint *)(CONCAT31((int3)((ulonglong)uVar16 >> 8),bVar2 + bVar13) & 0xffff00ff);
    do {
      puVar10 = puVar3;
      bVar13 = SBORROW4(iVar8,*puVar7);
      iVar9 = iVar8 - *puVar7;
      iVar8 = iVar9 - (uint)bVar15;
      if (iVar8 != 0 && (bVar13 != SBORROW4(iVar9,(uint)bVar15)) == iVar8 < 0) {
        out(*(undefined4 *)(unaff_retaddr + 5),(short)iVar8);
        return puVar6;
      }
      iVar9 = CONCAT22((short)((uint)unaff_EBX >> 0x10),CONCAT11(0xf9,(char)unaff_EBX));
      puVar6 = (uint *)segment(uVar12,0xf3a1);
      *puVar6 = *puVar6 & 0xda50424e;
      bVar15 = false;
      unaff_EBX = iVar9 + -1;
      puVar6 = puVar10;
      puVar3 = puVar7;
    } while (SBORROW4(iVar9,1));
    bRamf0e8502b = bRamf0e8502b ^ (byte)puVar10;
    param_2 = iVar8 - 1;
    bVar13 = 9 < ((byte)puVar7 & 0xf);
    bVar2 = in_AF & 1;
    bVar4 = in_AF & 1;
    in_OF = '\0';
    in_SF = false;
    in_ZF = false;
    unaff_ESI = unaff_retaddr + 6;
    param_1 = (uint *)0x2;
    unaff_EDI = puVar7;
    in_CS = uVar11;
    in_AF = bVar13 | in_AF;
    unaff_retaddr =
         (uint)(in_NT & 1) * 0x4000 | (uint)SBORROW4(iVar8,1) * 0x800 | (uint)(in_TF & 1) * 0x100 |
         (uint)((int)param_2 < 0) * 0x80 | (uint)(param_2 == 0) * 0x40 |
         (uint)(bVar13 | bVar2) * 0x10 | (uint)((POPCOUNT(param_2 & 0xff) & 1U) == 0) * 4 |
         (uint)(bVar13 | bVar4) | (uint)(in_ID & 1) * 0x200000 | (uint)(in_VIP & 1) * 0x100000 |
         (uint)(in_VIF & 1) * 0x80000 | (uint)(in_AC & 1) * 0x40000;
  }
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}


