/*
 * Function: D3D_GetViewport
 * Address: 00483470
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __fastcall D3D_GetViewport(undefined4 param_1,uint param_2,_String_base *param_3,int param_4)

{
  char *pcVar1;
  char *pcVar2;
  int iVar3;
  int extraout_ECX;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint uVar4;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint extraout_EDX_03;
  uint uVar5;
  uint unaff_retaddr;
  undefined4 *in_stack_ffffffac;
  undefined4 *in_stack_ffffffb0;
  uint local_3c;
  _String_base local_38 [4];
  uint local_34;
  undefined4 local_24;
  uint local_20;
  undefined4 local_1c;
  undefined4 local_18;
  uint local_14;
  void *local_10;
  undefined4 uStack_c;
  int local_8;
  
  local_8 = -1;
  uStack_c = 0x514a80;
  local_10 = ExceptionList;
  local_14 = DAT_00569f5c ^ unaff_retaddr;
  local_1c = 0;
  local_18 = param_1;
  if (*(char *)(param_4 + 4) == '\0') {
    ExceptionList = &local_10;
    *(undefined4 *)(param_3 + 0x18) = 0xf;
    *(undefined4 *)(param_3 + 0x14) = 0;
    param_3[4] = (_String_base)0x0;
    PowerUp_ProcessThunderstrike(param_3,param_2,(_String_base *)(param_4 + 8),0,0xffffffff);
  }
  else {
    local_20 = 0xf;
    local_24 = 0;
    local_34 = local_34 & 0xffffff00;
    pcVar1 = "(";
    do {
      pcVar2 = pcVar1;
      pcVar1 = pcVar2 + 1;
    } while (*pcVar2 != '\0');
    ExceptionList = &local_10;
    String_Assign(local_38,(_String_base *)&DAT_00533404,(uint)(pcVar2 + -0x533404));
    local_8 = 0;
    uVar4 = extraout_EDX;
    for (uVar5 = 0;
        (*(int *)(param_4 + 0xc) != 0 &&
        (uVar5 < (uint)(*(int *)(param_4 + 0x10) - *(int *)(param_4 + 0xc) >> 2)));
        uVar5 = uVar5 + 1) {
      if (uVar5 != 0) {
        pcVar1 = ", ";
        do {
          pcVar2 = pcVar1;
          pcVar1 = pcVar2 + 1;
        } while (*pcVar2 != '\0');
        Enemy_ProcessSatelliteLogic
                  (local_38,(_String_base *)&DAT_00533400,(uint)(pcVar2 + -0x533400));
        uVar4 = extraout_EDX_00;
      }
      iVar3 = D3D_GetViewport(local_18,uVar4,(_String_base *)&stack0xffffffac,
                              *(int *)(*(int *)(param_4 + 0xc) + uVar5 * 4));
      local_8._0_1_ = 1;
      Enemy_UpdateAI(local_38,iVar3,0,0xffffffff);
      local_8 = (uint)local_8._1_3_ << 8;
      if (0xf < local_3c) {
                    /* WARNING: Subroutine does not return */
        System_ShutdownHandler(extraout_ECX,(uint)in_stack_ffffffb0);
      }
      local_3c = 0xf;
      in_stack_ffffffb0 = (undefined4 *)((uint)in_stack_ffffffb0 & 0xffffff00);
      uVar4 = extraout_EDX_01;
    }
    pcVar1 = ")";
    do {
      pcVar2 = pcVar1;
      pcVar1 = pcVar2 + 1;
    } while (*pcVar2 != '\0');
    Enemy_ProcessSatelliteLogic(local_38,(_String_base *)&DAT_005333fc,(uint)(pcVar2 + -0x5333fc));
    *(undefined4 *)(param_3 + 0x18) = 0xf;
    *(undefined4 *)(param_3 + 0x14) = 0;
    param_3[4] = (_String_base)0x0;
    PowerUp_ProcessThunderstrike(param_3,extraout_EDX_02,local_38,0,0xffffffff);
    if (0xf < local_20) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler(local_34,extraout_EDX_03);
    }
  }
  ExceptionList = local_10;
  Exception_SetMessage((void *)(local_14 ^ unaff_retaddr),in_stack_ffffffac,in_stack_ffffffb0);
  return;
}


