/*
 * Function: Unwind@00510888
 * Address: 00510888
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x00510ad7) overlaps instruction at (ram,0x00510ad6)
    */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Removing unreachable block (ram,0x00510a90) */
/* WARNING: Removing unreachable block (ram,0x00510a93) */
/* WARNING: Removing unreachable block (ram,0x00510a98) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

uint __fastcall Unwind_00510888(char *param_1,uint param_2)

{
  uint *puVar1;
  char cVar2;
  undefined1 uVar3;
  undefined4 uVar4;
  int iVar5;
  uint uVar6;
  undefined1 *puVar7;
  code *pcVar8;
  undefined6 uVar9;
  undefined4 uVar10;
  byte extraout_AL;
  uint in_EAX;
  int *piVar11;
  uint uVar12;
  undefined3 extraout_var;
  undefined3 uVar13;
  byte bVar15;
  char *pcVar14;
  char *extraout_ECX;
  undefined2 uVar16;
  uint *puVar17;
  uint *extraout_EDX;
  uint *puVar18;
  char cVar19;
  undefined4 unaff_EBX;
  byte *pbVar20;
  undefined4 *puVar21;
  undefined1 *puVar22;
  undefined1 *puVar23;
  undefined4 *unaff_EBP;
  uint *unaff_ESI;
  uint *puVar24;
  undefined4 *unaff_EDI;
  undefined2 in_CS;
  bool bVar25;
  byte bVar26;
  byte in_TF;
  byte bVar27;
  byte in_NT;
  byte in_AC;
  byte in_VIF;
  byte in_VIP;
  byte in_ID;
  float10 in_ST0;
  undefined2 unaff_retaddr;
  undefined4 uStack_1c;
  undefined4 auStack_18 [2];
  undefined1 auStack_10 [4];
  undefined4 uStack_c;
  uint3 uStack_8;
  undefined1 uStack_5;
  
  if (SCARRY4((int)param_1,1) != (int)(param_1 + 1) < 0) {
    puVar21 = (undefined4 *)&stack0xfffffffc;
    cVar19 = '\x04';
    do {
      unaff_EBP = unaff_EBP + -1;
      puVar21 = puVar21 + -1;
      *puVar21 = *unaff_EBP;
      cVar19 = cVar19 + -1;
    } while ('\0' < cVar19);
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  piVar11 = (int *)(in_EAX - param_2);
  uVar16 = CONCAT11(0xe4,(char)(param_2 - 1));
  cVar19 = ((char)unaff_EBX - *(char *)((int)unaff_EDI + -0x69)) - (in_EAX < param_2);
  puVar17 = (uint *)CONCAT31((int3)((uint)unaff_EBX >> 8),cVar19);
  pcVar14 = param_1 + 2;
  if ((POPCOUNT((uint)pcVar14 & 0xff) & 1U) == 0) {
    in(0x76);
    _DAT_186b3f31 =
         CONCAT22((short)((uint)pcVar14 >> 0x10),
                  CONCAT11((char)((uint)pcVar14 >> 8) + param_1[-0x41ed123e],(byte)pcVar14));
    uVar12 = in(uVar16);
    return uVar12;
  }
  iVar5 = *piVar11;
  *piVar11 = *piVar11 >> 0x1d;
  pbVar20 = (byte *)(unaff_EBP + 0x12e2c5af);
  bVar15 = (byte)pcVar14 & 7;
  *pbVar20 = *pbVar20 >> bVar15 | *pbVar20 << 8 - bVar15;
  bVar25 = ((uint)pcVar14 & 0x1f) != 0;
  bVar25 = !bVar25 && (iVar5 >> 0x1c & 1U) != 0 || bVar25 && (char)*pbVar20 < '\0';
  if (CONCAT31((int3)(CONCAT22((short)(param_2 - 1 >> 0x10),uVar16) >> 8),0x2c) != 1) {
    *(char *)unaff_EDI = (char)*unaff_ESI;
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  pbVar20 = (byte *)((int)unaff_ESI * 4 + -0x6311fff1);
  bVar15 = *pbVar20;
  bVar27 = (byte)((uint)unaff_EBX >> 8);
  bVar26 = *pbVar20 + bVar27;
  *pbVar20 = bVar26 + bVar25;
  *unaff_EDI = puVar17;
  if (param_1 != (char *)0xffffffff) {
    in(0);
    DAT_d430f6b3 = DAT_d430f6b3 + -0x1c;
    bVar15 = 0x16;
    uVar13 = 0x35ba47;
    if (param_1 == (char *)0x0) {
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    bVar26 = 0;
    bVar25 = DAT_00000000 != '\0';
    piVar11 = (int *)((int)unaff_EDI + 0x7e9dd451);
    iVar5 = *piVar11;
    *piVar11 = *piVar11 + -1;
    bVar27 = 1;
    if (SBORROW4(iVar5,1) != *piVar11 < 0) {
      _DAT_00000000 = _DAT_00000000 + 1;
      out(0x19,*unaff_ESI & 0xffffff64);
      return *unaff_ESI & 0xffffff64;
    }
    puVar17 = (uint *)0x0;
    puVar18 = (uint *)0x0;
    puVar24 = unaff_ESI;
    if (*piVar11 >= 0) {
      do {
        uVar10 = _uStack_8;
        uVar4 = uStack_c;
        pcVar14 = (char *)((int)puVar24 + 0x26475c9a);
        cVar2 = *pcVar14;
        *pcVar14 = *pcVar14 + '\x01';
        if (SCARRY1(cVar2,'\x01') != *pcVar14 < '\0') {
                    /* WARNING: Bad instruction - Truncating control flow here */
          halt_baddata();
        }
        unaff_ESI = puVar24 + 1;
        uVar12 = *puVar24;
        if (!SCARRY1(cVar2,'\x01')) {
          if ((POPCOUNT(*pcVar14) & 1U) != 0) {
            DAT_9b842832 = DAT_9b842832 + (char)puVar17;
            uVar9 = *(undefined6 *)(&stack0x3ee73063 + (int)unaff_ESI * 4);
            *puVar17 = *puVar17 | (uint)param_1;
            *(undefined2 *)((int)uVar9 + -4) = in_CS;
            return CONCAT31((int3)((uint)unaff_EBP >> 8),(char)unaff_EBP - *param_1);
          }
          *(double *)((int)unaff_EDI + 0x76) = (double)in_ST0;
          puVar18 = (uint *)((int)puVar17 + (int)unaff_ESI * 8 + 0x5c010a0f);
          uVar6 = *puVar18;
          pbVar20 = (byte *)(CONCAT22((short)((uint)unaff_EBX >> 0x10),CONCAT11(0xe4,cVar19)) +
                             0x2329ca7a + (uint)CARRY4((uint)unaff_ESI,*puVar18));
          *pbVar20 = *pbVar20 | (byte)uVar12;
          bVar15 = (byte)((uint)param_1 >> 8);
          bVar26 = (byte)((uint)puVar17 >> 8);
          pcVar14 = (char *)CONCAT22((short)((uint)param_1 >> 0x10),
                                     CONCAT11(bVar15 - bVar26,(char)param_1));
          if (CONCAT31((int3)((uint)pcVar14 >> 8),((char)param_1 - *pcVar14) - (bVar15 < bVar26)) !=
              1) {
            halt_baddata();
          }
          pcVar14 = (char *)((int)unaff_ESI + uVar6 + 0x5f);
          *pcVar14 = *pcVar14 + bVar26;
          uVar3 = in((ushort)puVar17 & 0xff00 ^ 0x14);
          *(undefined1 *)unaff_EDI = uVar3;
          unaff_EBP[1] = unaff_EBP + 2;
          iVar5 = *(int *)((int)unaff_EDI + 0x49);
          *unaff_EBP = unaff_EBP + 1;
          uVar4 = in((short)((int)&stack0xfffffffc >> 0x1f));
          *(undefined4 *)((int)unaff_EDI + iVar5 + -1) = uVar4;
                    /* WARNING: Bad instruction - Truncating control flow here */
          halt_baddata();
        }
        uStack_c._3_1_ =
             ((int)&uStack_5 < 0) * -0x80 | (&stack0x00000000 == (undefined1 *)0x5) * '@' |
             (bVar26 & 1) * '\x10' | ((POPCOUNT((uint)&uStack_5 & 0xff) & 1U) == 0) * '\x04' |
             bVar25;
        uStack_8 = (uint3)(in_NT & 1) * 0x40 | (uint3)SBORROW4((int)&stack0xfffffffc,1) * 8 |
                   (uint3)(bVar27 & 1) * 2 | (uint3)(in_TF & 1) | (uint3)(in_ID & 1) * 0x2000 |
                   (uint3)(in_VIP & 1) * 0x1000 | (uint3)(in_VIF & 1) * 0x800 |
                   (uint3)(in_AC & 1) * 0x400;
        uStack_c._0_3_ = (undefined3)uVar4;
        uStack_5 = SUB41(uVar10,3);
        pcVar8 = (code *)swi(0xbc);
        in_ST0 = (float10)(*pcVar8)();
        puVar1 = (uint *)((int)(puVar24 + 0x1a) + (int)extraout_ECX);
        bVar25 = CARRY4(*puVar1,(uint)extraout_ECX);
        *puVar1 = (uint)(extraout_ECX + *puVar1);
        param_1 = extraout_ECX;
        puVar17 = extraout_EDX;
        puVar18 = extraout_EDX;
        puVar24 = unaff_ESI;
        bVar15 = extraout_AL;
        uVar13 = extraout_var;
      } while (-1 < (int)*puVar1);
    }
    bVar26 = 9 < (bVar15 & 0xf) | bVar26;
    uVar12 = CONCAT31(uVar13,bVar15 + bVar26 * -6) & 0xffffff0f;
    out((char)*unaff_ESI,(short)puVar18);
    *(undefined2 *)
     (CONCAT22((short)(uVar12 >> 0x10),CONCAT11((char)uVar13 - bVar26,(char)uVar12)) + -0x17) =
         unaff_retaddr;
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  uVar6 = (uint)(CARRY1(bVar15,bVar27) || CARRY1(bVar26,bVar25));
  uVar12 = *puVar17;
  puVar7 = &stack0x00000004 + *puVar17;
  *(int **)(puVar7 + (uVar6 - 4)) = piVar11;
  *(undefined4 *)(puVar7 + (uVar6 - 8)) = 0;
  *(undefined4 *)(puVar7 + (uVar6 - 0xc)) = 0;
  *(uint **)(puVar7 + (uVar6 - 0x10)) = puVar17;
  *(undefined1 **)(puVar7 + (uVar6 - 0x14)) = puVar7 + uVar6;
  *(undefined4 **)(puVar7 + (uVar6 - 0x18)) = unaff_EBP;
  puVar22 = puVar7 + (uVar6 - 0x1c);
  *(uint **)(puVar7 + (uVar6 - 0x1c)) = unaff_ESI;
  *(undefined4 **)(puVar7 + (uVar6 - 0x20)) = unaff_EDI;
  *unaff_EDI = piVar11;
  iVar5 = *piVar11;
  unaff_EDI[1] = *unaff_ESI;
  pcVar8 = (code *)swi(4);
  puVar23 = puVar7 + (uVar6 - 0x1c);
  if (SBORROW1(-(char)iVar5,CARRY4((uint)&stack0x00000004,uVar12) || CARRY4((uint)puVar7,uVar6))) {
    (*pcVar8)();
    puVar23 = puVar22;
  }
  *(uint **)(puVar23 + -4) = puVar17;
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}


