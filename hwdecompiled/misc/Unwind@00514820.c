/*
 * Function: Unwind@00514820
 * Address: 00514820
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x00514852) overlaps instruction at (ram,0x00514851)
    */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall Unwind_00514820(int param_1,int *param_2,undefined6 *param_3)

{
  char *pcVar1;
  int iVar2;
  char cVar3;
  code *pcVar4;
  undefined6 uVar5;
  int iVar6;
  undefined6 *puVar7;
  byte bVar8;
  byte *in_EAX;
  int *piVar9;
  undefined4 uVar10;
  undefined1 uVar11;
  int extraout_ECX;
  undefined2 uVar12;
  int *unaff_EBX;
  undefined4 *puVar13;
  undefined1 *unaff_EBP;
  undefined4 *puVar14;
  uint unaff_ESI;
  int *unaff_EDI;
  undefined2 in_ES;
  float10 extraout_ST0;
  int unaff_retaddr;
  
  while( true ) {
    param_2 = (int *)((int)param_2 - *(int *)((int)unaff_EDI + 0x6f));
    piVar9 = (int *)(CONCAT22((short)((uint)in_EAX >> 0x10),
                              CONCAT11((char)((uint)in_EAX >> 8) + *(char *)(param_1 + 0x4a),
                                       (char)in_EAX)) ^ 0x8d7a3ad8);
    iVar2 = *param_2;
    *param_2 = *param_2 << 1;
    iVar6 = *param_2;
    cVar3 = (char)*param_2 + (char)param_2;
    *(char *)param_2 = cVar3 + (iVar2 < 0);
    uVar12 = (undefined2)((uint)param_1 >> 0x10);
    uVar11 = (undefined1)param_1;
    param_1 = CONCAT22(uVar12,CONCAT11(*(undefined1 *)(param_1 + -0x34 + (int)piVar9),uVar11));
    if (SCARRY1((char)iVar6,(char)param_2) != SCARRY1(cVar3,iVar2 < 0)) {
      unaff_EBX = (int *)CONCAT22((short)((uint)unaff_EBX >> 0x10),CONCAT11(0x44,(char)unaff_EBX));
      goto code_r0x00514854;
    }
    puVar14 = (undefined4 *)((uint)unaff_EBP | (uint)param_2);
    if (0 < (int)puVar14) break;
    pcVar4 = (code *)swi(0xc6);
    in_EAX = (byte *)(*pcVar4)();
    unaff_EBX[-0x751e259] = unaff_EBX[-0x751e259] + (int)unaff_EDI;
    *unaff_EDI = *unaff_EDI - (int)unaff_EDI;
    iVar2 = *unaff_EDI;
    param_2 = (int *)0x64073b28;
    puVar13 = (undefined4 *)&stack0x00003ab2;
    unaff_EBP = &stack0x00003ab2;
    cVar3 = '\x02';
    do {
      puVar14 = puVar14 + -1;
      puVar13 = puVar13 + -1;
      *puVar13 = *puVar14;
      cVar3 = cVar3 + -1;
    } while ('\0' < cVar3);
    param_1 = extraout_ECX + -1;
    if (param_1 != 0 && iVar2 == 0) {
      if (iVar2 != 0) {
        *in_EAX = *in_EAX | (byte)in_EAX;
        _DAT_797a2b07 = (float)extraout_ST0;
        return;
      }
code_r0x00514854:
      puVar7 = param_3;
      unaff_EDI[0x10] = unaff_retaddr;
      *(uint *)((int)param_3 * 3) = *(uint *)((int)param_3 * 3) & 0x62a44b7;
      *(int *)((int)unaff_EBX + 0x65fb5f85) = *(int *)((int)unaff_EBX + 0x65fb5f85) + -0x51e2abe0;
      param_3 = (undefined6 *)CONCAT22(param_3._2_2_,in_ES);
      pcVar1 = (char *)((int)puVar7 + -0x726de8af);
      *pcVar1 = *pcVar1 + (char)((uint)param_2 >> 8);
      uVar5 = *puVar7;
      uVar10 = (undefined4)uVar5;
      bVar8 = (byte)uVar5;
      if ((char)bVar8 <= (char)*(byte *)((int)unaff_EDI + 1)) {
        *(int *)((int)param_2 + -0x31e939b1) =
             (*(int *)((int)param_2 + -0x31e939b1) - unaff_ESI) -
             (uint)(bVar8 < *(byte *)((int)unaff_EDI + 1));
        pcVar4 = (code *)swi(1);
        (*pcVar4)();
        return;
      }
      LOCK();
      iVar2 = *unaff_EBX;
      *unaff_EBX = (int)&param_3;
      UNLOCK();
      out((short)param_2,uVar10);
      *(int *)(iVar2 + -4) = (int)unaff_EDI + 2;
      *(int *)(iVar2 + -8) = param_1;
      _DAT_56bd081d = uVar10;
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
  }
  param_2[-0x10] = param_2[-0x10] | unaff_ESI;
  bVar8 = *(byte *)((int)param_2 + 0x62);
  *(byte *)((int)param_2 + 0x62) = bVar8 >> 3 | bVar8 << 6;
  param_1 = CONCAT22(uVar12,CONCAT11(0x7e,uVar11));
  *(uint *)((int)puVar14 + 0x2e3132a2) = *(uint *)((int)puVar14 + 0x2e3132a2) | (uint)piVar9;
  unaff_ESI = unaff_ESI - *(int *)((int)puVar14 + -0x69);
  unaff_EBX = piVar9;
  goto code_r0x00514854;
}


