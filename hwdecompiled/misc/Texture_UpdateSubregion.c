/*
 * Function: Texture_UpdateSubregion
 * Address: 004b8e40
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


uint __fastcall
Texture_UpdateSubregion(undefined4 param_1,undefined2 param_2,int param_3,int param_4)

{
  uint uVar1;
  int iVar2;
  undefined4 uVar3;
  int extraout_ECX;
  int extraout_ECX_00;
  int extraout_ECX_01;
  int extraout_ECX_02;
  int extraout_ECX_03;
  int extraout_EDX;
  int extraout_EDX_00;
  uint extraout_EDX_01;
  int extraout_EDX_02;
  uint extraout_EDX_03;
  undefined1 local_1c;
  undefined1 local_1b;
  undefined1 local_1a;
  undefined1 local_18;
  int local_14;
  uint local_10;
  uint *local_c;
  byte *local_8;
  
  local_10 = String_AllocateBuffer(param_1,param_2);
  if (local_10 != 0) {
    local_8 = (byte *)PNG_CreateReadStruct("1.0.5",0,0,0);
    if (local_8 == (byte *)0x0) {
      uVar1 = Memory_AllocateBlock(extraout_ECX,extraout_EDX);
      return uVar1 & 0xffffff00;
    }
    local_c = PixelFormat_SetBlueComponent((int)local_8);
    if (local_c == (uint *)0x0) {
      Memory_AllocateBlock(extraout_ECX_00,extraout_EDX_00);
      uVar1 = PNG_CleanupStructures(extraout_ECX_01,extraout_EDX_01,&local_8,(int *)0x0);
      return uVar1 & 0xffffff00;
    }
    iVar2 = Assembly_LoopingConstruct((undefined4 *)local_8,extraout_EDX_00);
    if (iVar2 == 0) {
      PixelFormat_SetGreenComponent((int)local_8,local_10);
      local_1c = 8;
      local_1b = 8;
      local_1a = 8;
      local_18 = 8;
      PNG_SetModificationTime((int)local_8,(int)local_c,(undefined4 *)&local_1c);
      ImageFormat_SupportsAnimation((int)local_8);
      PNG_SetImageHeader((uint)local_8,local_c,*(uint *)(param_4 + 4),*(uint *)(param_4 + 8),'\b',6,
                         0,0,0);
      PNG_ProcessImageTransforms(local_8,(int *)local_c);
      iVar2 = 0;
      if (0 < *(int *)(param_4 + 8)) {
        do {
          local_14 = *(int *)(param_4 + 0xc) + *(int *)(param_4 + 4) * iVar2 * 4;
          PNG_ProcessRowData(local_8,&local_14,1);
          iVar2 = iVar2 + 1;
        } while (iVar2 < *(int *)(param_4 + 8));
      }
      PNG_FinalizeImageDecoding(local_c,local_8,local_8,(int)local_c);
      PNG_CleanupStructures((int)&local_8,extraout_EDX_03,&local_8,(int *)&local_c);
      uVar3 = Memory_AllocateBlock(extraout_ECX_03,local_10);
      return CONCAT31((int3)((uint)uVar3 >> 8),1);
    }
    PNG_CleanupStructures(extraout_ECX_02,(uint)&local_c,&local_8,(int *)&local_c);
    local_10 = Memory_AllocateBlock(local_10,extraout_EDX_02);
  }
  return local_10 & 0xffffff00;
}


