/*
 * Function: Unwind@00513f29
 * Address: 00513f29
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x005140db) overlaps instruction at (ram,0x005140da)
    */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall
Unwind_00513f29(int *param_1,undefined2 param_2,undefined1 *param_3,byte *param_4,int *param_5)

{
  char *pcVar1;
  uint uVar2;
  code *pcVar3;
  byte bVar4;
  ushort uVar5;
  uint in_EAX;
  uint uVar6;
  int iVar7;
  int iVar8;
  byte *unaff_EBX;
  byte *unaff_ESI;
  byte *pbVar9;
  byte *pbVar10;
  byte *unaff_EDI;
  undefined1 *puVar11;
  byte *pbVar12;
  undefined2 in_SS;
  char cVar13;
  bool bVar14;
  char cVar15;
  char cVar16;
  undefined2 in_FPUControlWord;
  undefined8 uVar17;
  undefined4 *unaff_retaddr;
  
  bVar14 = -1 < (char)in_EAX;
  if (bVar14) {
    out(*(undefined4 *)unaff_ESI,param_2);
    pcVar3 = (code *)swi(0xef);
    (*pcVar3)();
    param_4 = (byte *)0x513f43;
    func_0xa01778b8();
    return;
  }
  if (!bVar14) {
    out(*unaff_ESI,(short)unaff_retaddr);
    *(char *)((int)param_1 + -0x43) =
         *(char *)((int)param_1 + -0x43) + (char)((in_EAX & 0xffffffa4) >> 8);
    out(unaff_ESI[1],(short)unaff_retaddr);
    bVar4 = (char)(in_EAX & 0xffffffa4) + 1;
    _DAT_17ceafa2 = in_FPUControlWord;
    if (bVar4 < *unaff_EDI || bVar4 == *unaff_EDI) {
      *(undefined2 *)(unaff_EBX + (int)(unaff_ESI + 2) * 2 + -0x545e3021) = in_SS;
      func_0x1ed2448f();
      return;
    }
    if (SBORROW1(bVar4,*unaff_EDI)) {
      pcVar3 = (code *)*unaff_retaddr;
      *(undefined4 *)(param_3 + -4) = 0x513fa4;
      (*pcVar3)();
      do {
                    /* WARNING: Do nothing block with infinite loop */
      } while( true );
    }
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  while( true ) {
    in((short)unaff_retaddr);
    unaff_EDI[-0xf] = unaff_EDI[-0xf] ^ (byte)((uint)param_1 >> 8);
    unaff_EBX = unaff_EBX + *(int *)(param_3 + 0x4a);
    puVar11 = param_3 + 1;
    *unaff_EBX = *unaff_EBX | (byte)((uint)unaff_EBX >> 8);
    (unaff_EBX + 0x263104e8)[(int)unaff_ESI] = (unaff_EBX + 0x263104e8)[(int)unaff_ESI] - 1;
    iVar8 = (int)*(undefined6 *)(unaff_EBX + 0x39);
    *param_1 = *param_1 - (int)&param_3;
    pbVar9 = unaff_ESI + 5;
    unaff_EDI = (byte *)((int)pbVar9 * -0x7c671586);
    if ((*(int *)(unaff_ESI + 1) + 0xf183b91eU & 0x44029e05) != 0) break;
    unaff_retaddr = (undefined4 *)(*(int *)unaff_EBX * 0x64334a5f);
    *unaff_EDI = *unaff_EDI | (byte)((uint)unaff_retaddr >> 8);
    unaff_ESI = pbVar9;
    param_3 = puVar11;
  }
  cVar13 = '\0';
  cVar16 = '\0';
  cVar15 = (int)pbVar9 < 0;
  bVar14 = pbVar9 == (byte *)0x0;
  if ((int)pbVar9 < 1) {
    pbVar12 = &DAT_0bc0ce5a;
    param_5 = (int *)0xe41aadc6;
    pbVar9[0] = 0x18;
    pbVar9[1] = 0xca;
    pbVar9[2] = 0x48;
    pbVar9[3] = 0xe9;
    bVar4 = 0;
    pcVar3 = (code *)swi(0x38);
    param_3 = puVar11;
    uVar17 = (*pcVar3)();
    pbVar10 = pbVar9;
    if (bVar14 || cVar16 != cVar15) goto LAB_005140d4;
    if (cVar16 != cVar15) {
      pbVar12 = param_4 + 1;
      pbVar10 = unaff_ESI + 6;
      cVar13 = *pbVar9 < *param_4;
      bVar14 = *pbVar9 == *param_4;
      goto LAB_005140d4;
    }
    pcVar1 = (char *)((int)((ulonglong)uVar17 >> 0x20) + -0x42);
    *pcVar1 = *pcVar1 << 1;
    return;
  }
  *(undefined2 *)unaff_EBX = in_SS;
  cVar13 = '\0';
  pbVar9 = (byte *)((uint)pbVar9 & *(uint *)(iVar8 + -0x5b));
  pbVar12 = param_3 + 2;
  *puVar11 = (char)unaff_EBX;
  bVar4 = 1;
  pbVar10 = pbVar9;
  param_5 = param_1;
  do {
    *pbVar12 = (byte)pbVar9;
    uVar6 = 0xa05d5950;
    pbVar9 = pbVar10 + (uint)bVar4 * -2;
    do {
      uVar5 = (ushort)uVar6;
      pbVar10 = pbVar9 + -1;
      cVar13 = cVar13 == '\0';
      if (pbVar10 == (byte *)0x0 || (int)pbVar9 < 1) goto code_r0x005140d8;
      pbVar12 = (byte *)0x85aa36de;
      uVar6 = in((short)iVar8);
      iVar8 = iVar8 + -1;
      pbVar9 = pbVar10;
    } while (param_5 == (int *)0x0);
    uVar2 = (uint)(byte)cVar13;
    cVar13 = uVar6 < 0x248b162f || uVar6 + 0xdb74e9d1 < uVar2;
    iVar7 = (uVar6 + 0xdb74e9d1) - uVar2;
    uVar17 = CONCAT44(iVar8,iVar7);
    bVar14 = iVar7 == 0;
LAB_005140d4:
    iVar8 = (int)((ulonglong)uVar17 >> 0x20);
    uVar5 = CONCAT11(0xa6,(char)uVar17);
    pbVar9 = (byte *)(uint)uVar5;
  } while (!bVar14);
code_r0x005140d8:
  out(*(undefined4 *)pbVar10,uVar5);
  out(0x29,(char)iVar8);
  do {
                    /* WARNING: Do nothing block with infinite loop */
  } while( true );
}


