/*
 * Function: JPEG_DecodeSequentialData
 * Address: 004deb60
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


uint __cdecl JPEG_DecodeSequentialData(uint param_1,int param_2)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  int *piVar7;
  int *piVar8;
  int local_44 [5];
  undefined4 local_30;
  undefined4 local_2c;
  uint local_28;
  int local_24;
  uint local_20;
  undefined2 *local_1c;
  undefined4 local_18;
  int local_14;
  int local_10;
  int local_c;
  int *local_8;
  
  uVar1 = param_1;
  local_18 = *(undefined4 *)(param_1 + 0x178);
  local_c = *(int *)(param_1 + 0x198);
  if (((*(int *)(param_1 + 0xfc) != 0) && (*(int *)(*(int *)(param_1 + 0x198) + 0x28) == 0)) &&
     (uVar2 = JPEG_ProcessNewScanlineSequential(), (char)uVar2 == '\0')) {
    return uVar2;
  }
  iVar5 = local_c;
  if (*(char *)(local_c + 8) == '\0') {
    local_20 = param_1;
    local_30 = **(undefined4 **)(param_1 + 0x18);
    local_2c = (*(undefined4 **)(param_1 + 0x18))[1];
    uVar2 = *(uint *)(local_c + 0xc);
    iVar3 = *(int *)(local_c + 0x10);
    piVar7 = (int *)(local_c + 0x14);
    piVar8 = local_44;
    for (iVar4 = 5; iVar4 != 0; iVar4 = iVar4 + -1) {
      *piVar8 = *piVar7;
      piVar7 = piVar7 + 1;
      piVar8 = piVar8 + 1;
    }
    local_10 = 0;
    if (0 < *(int *)(param_1 + 0x140)) {
      local_8 = (int *)(param_1 + 0x144);
      param_1 = uVar2;
      do {
        local_1c = *(undefined2 **)(param_2 + local_10 * 4);
        local_14 = *local_8;
        iVar5 = *(int *)(iVar5 + 0x2c + *(int *)(*(int *)(uVar1 + 0x128 + *local_8 * 4) + 0x14) * 4)
        ;
        if (iVar3 < 8) {
          uVar2 = Compression_FillBitBuffer(&local_30,param_1,iVar3,0);
          if ((char)uVar2 == '\0') goto LAB_004ded61;
          param_1 = local_28;
          iVar3 = local_24;
          if (7 < local_24) goto LAB_004dec45;
          iVar4 = 1;
LAB_004dec6f:
          uVar2 = Compression_DecodeHuffmanSymbol(&local_30,param_1,iVar3,iVar5,iVar4);
          if ((int)uVar2 < 0) goto LAB_004ded61;
          param_1 = local_28;
          iVar3 = local_24;
          uVar6 = uVar2;
        }
        else {
LAB_004dec45:
          uVar2 = (int)param_1 >> ((char)iVar3 - 8U & 0x1f) & 0xff;
          iVar4 = *(int *)(iVar5 + 0x90 + uVar2 * 4);
          if (iVar4 == 0) {
            iVar4 = 9;
            goto LAB_004dec6f;
          }
          uVar6 = (uint)*(byte *)(uVar2 + 0x490 + iVar5);
          iVar3 = iVar3 - iVar4;
        }
        uVar2 = uVar6;
        if (uVar6 != 0) {
          if (iVar3 < (int)uVar6) {
            uVar2 = Compression_FillBitBuffer(&local_30,param_1,iVar3,uVar6);
            if ((char)uVar2 == '\0') {
LAB_004ded61:
              return uVar2 & 0xffffff00;
            }
            param_1 = local_28;
            iVar3 = local_24;
          }
          iVar3 = iVar3 - uVar6;
          uVar2 = (1 << ((byte)uVar6 & 0x1f)) - 1U & (int)param_1 >> ((byte)iVar3 & 0x1f);
          if ((int)uVar2 < *(int *)(&DAT_005438f0 + uVar6 * 4)) {
            uVar2 = *(int *)(&DAT_00543930 + uVar6 * 4) + uVar2;
          }
        }
        iVar5 = local_44[local_14 + 1];
        local_44[local_14 + 1] = iVar5 + uVar2;
        local_8 = local_8 + 1;
        *local_1c = (short)(iVar5 + uVar2 << ((byte)local_18 & 0x1f));
        local_10 = local_10 + 1;
        iVar5 = local_c;
        uVar2 = param_1;
      } while (local_10 < *(int *)(uVar1 + 0x140));
    }
    param_1 = uVar2;
    **(undefined4 **)(uVar1 + 0x18) = local_30;
    *(undefined4 *)(*(int *)(uVar1 + 0x18) + 4) = local_2c;
    *(uint *)(iVar5 + 0xc) = param_1;
    *(int *)(iVar5 + 0x10) = iVar3;
    piVar7 = local_44;
    piVar8 = (int *)(iVar5 + 0x14);
    for (iVar3 = 5; iVar3 != 0; iVar3 = iVar3 + -1) {
      *piVar8 = *piVar7;
      piVar7 = piVar7 + 1;
      piVar8 = piVar8 + 1;
    }
  }
  iVar3 = *(int *)(iVar5 + 0x28) + -1;
  *(int *)(iVar5 + 0x28) = iVar3;
  return CONCAT31((int3)((uint)iVar3 >> 8),1);
}


