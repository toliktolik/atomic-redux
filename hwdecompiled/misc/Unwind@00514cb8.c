/*
 * Function: Unwind@00514cb8
 * Address: 00514cb8
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Instruction at (ram,0x00514dd2) overlaps instruction at (ram,0x00514dce)
    */
/* WARNING: Unable to track spacebase fully for stack */
/* WARNING: Removing unreachable block (ram,0x00514d0a) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall Unwind_00514cb8(int param_1,char *param_2)

{
  byte *pbVar1;
  char cVar2;
  undefined1 uVar3;
  undefined1 *puVar4;
  bool bVar5;
  code *pcVar6;
  undefined6 uVar7;
  byte bVar8;
  ushort uVar9;
  char *pcVar10;
  uint uVar11;
  uint uVar12;
  char *in_EAX;
  undefined1 *puVar13;
  uint *extraout_ECX;
  int extraout_ECX_00;
  int extraout_ECX_01;
  int extraout_ECX_02;
  int iVar15;
  undefined2 uVar16;
  char *extraout_EDX;
  undefined2 *puVar17;
  char *unaff_EBX;
  undefined4 *puVar18;
  undefined1 *puVar19;
  undefined4 *puVar20;
  undefined4 uVar21;
  byte *unaff_EBP;
  char *pcVar22;
  char *pcVar23;
  int *piVar24;
  char *unaff_ESI;
  uint uVar25;
  byte *pbVar26;
  char *pcVar27;
  char *unaff_EDI;
  char *pcVar28;
  byte *pbVar29;
  uint *puVar30;
  uint *puVar31;
  undefined2 uVar32;
  undefined2 in_CS;
  undefined2 in_SS;
  undefined2 in_DS;
  byte in_CF;
  byte bVar33;
  bool bVar34;
  undefined1 in_PF;
  byte in_AF;
  undefined1 in_ZF;
  char in_SF;
  byte bVar35;
  char in_OF;
  float10 in_ST0;
  unkbyte10 in_ST7;
  undefined4 in_XMM1_Da;
  undefined4 in_XMM1_Db;
  undefined4 in_XMM1_Dc;
  undefined4 in_XMM1_Dd;
  undefined8 uVar36;
  char *unaff_retaddr;
  undefined1 auStack_5f27 [17498];
  char *pcStack_1acd;
  char acStack_79 [21];
  undefined1 *puStack_64;
  char *pcStack_50;
  undefined4 *puStack_48;
  undefined1 *puStack_44;
  char *pcStack_40;
  char *pcStack_3c;
  char *pcStack_38;
  char *pcStack_34;
  byte bStack_30;
  byte bStack_2f;
  undefined2 uStack_2e;
  undefined1 auStack_2c [2];
  undefined2 uStack_2a;
  char *pcStack_24;
  char *pcStack_20;
  undefined4 *puStack_1c;
  undefined1 *puStack_18;
  char *pcStack_14;
  char *pcStack_10;
  char *pcStack_c;
  char *pcStack_8;
  undefined4 uStack_4;
  undefined3 uVar14;
  
  bVar35 = 0;
  if (param_1 != 0) {
    piVar24 = (int *)((int)unaff_ESI * 4 + 0xca84539);
    *piVar24 = *piVar24 + (int)unaff_EBP;
    uStack_4 = 0x514ccb;
    func_0xa0ecf380();
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  pcVar28 = (char *)0x0;
  pcRam5e6f02e2 = in_EAX;
  while( true ) {
    pcVar23 = unaff_ESI + (uint)bVar35 * -2 + 1;
    out(*unaff_ESI,(short)param_2);
    uStack_4 = CONCAT22(uStack_4._2_2_,in_DS);
    pcStack_8 = in_EAX;
    pcStack_c = pcVar28;
    pcStack_10 = param_2;
    pcStack_14 = unaff_EBX;
    puStack_18 = (undefined1 *)&uStack_4;
    puStack_1c = (undefined4 *)unaff_EBP;
    pcStack_20 = pcVar23;
    pcStack_24 = unaff_EDI;
    if (!(bool)in_ZF && in_OF == in_SF) goto LAB_00514c12_5;
    auStack_2c[0] = SUB41(unaff_EDI,0);
    auStack_2c[1] = (undefined1)((uint)unaff_EDI >> 8);
    uStack_2a = (undefined2)((uint)unaff_EDI >> 0x10);
    uVar11 = (uint)in_EAX & 0x27f02f34;
    in_PF = (POPCOUNT((uint)in_EAX & 0x34) & 1U) == 0;
    *(short *)((int)unaff_EBP + 0x12) = (short)ROUND(in_ST0);
    in_CF = 9 < ((byte)uVar11 & 0xf) | in_AF;
    uVar12 = CONCAT31((int3)(uVar11 >> 8),(byte)uVar11 + in_CF * '\x06') & 0xffffff0f;
    pcVar22 = (char *)CONCAT22((short)(uVar12 >> 0x10),
                               CONCAT11((char)(uVar11 >> 8) + in_CF,(char)uVar12));
    pcVar10 = pcVar22;
    puVar20 = (undefined4 *)unaff_EBP;
    in_AF = in_CF;
    if (uVar11 != 0) break;
    while( true ) {
      pcVar22 = pcVar28;
      if (!(bool)in_PF) {
        pcVar23 = (char *)*(undefined6 *)(param_2 + 0x7b);
        goto code_r0x00514c8f;
      }
      puVar30 = (uint *)(pcVar10 + 0x5b25e658);
      uVar11 = *puVar30;
      uVar12 = *puVar30;
      *puVar30 = (uint)(auStack_2c + uVar12 + in_CF);
      *pcVar10 = *pcVar10 + -0x42 +
                 (CARRY4(uVar11,(uint)auStack_2c) || CARRY4((uint)(auStack_2c + uVar12),(uint)in_CF)
                 );
      param_2 = (char *)(*(int *)(pcVar22 + 0x12) * -0x32);
      pbVar26 = &bStack_30;
      unaff_EBP = &bStack_30;
      bStack_30 = (byte)puVar20;
      bStack_2f = (byte)((uint)puVar20 >> 8);
      uStack_2e = (undefined2)((uint)puVar20 >> 0x10);
      cVar2 = '\f';
      do {
        puVar20 = puVar20 + -1;
        pbVar26 = (byte *)((int)pbVar26 + -4);
        *(undefined4 *)pbVar26 = *puVar20;
        cVar2 = cVar2 + -1;
      } while ('\0' < cVar2);
      puStack_64 = &bStack_30;
      unaff_EBX = (char *)CONCAT31((int3)((uint)unaff_EBX >> 8),
                                   (char)unaff_EBX - acStack_79[(int)param_2]);
      pcVar28 = (char *)CONCAT22((short)((uint)pcVar22 >> 0x10),CONCAT11(0x38,(char)pcVar22));
      in_CF = 0;
      in_OF = '\0';
      bVar33 = (byte)pcVar10 & 0xc9;
      in_EAX = (char *)((uint)pcVar10 & 0xffffffc9);
      in_SF = (char)bVar33 < '\0';
      in_ZF = ((uint)pcVar10 & 0xc9) == 0;
      in_PF = (POPCOUNT(bVar33) & 1U) == 0;
      pcStack_1acd = pcVar10;
LAB_00514c12_5:
      if (!(bool)in_PF) break;
      while (pcVar10 = param_2, (bool)in_ZF || in_OF != in_SF) {
        while( true ) {
          pcVar22 = pcVar23 + -1;
          bVar33 = (byte)in_EAX;
          uStack_2e = (undefined2)((uint)in_EAX >> 0x10);
          uVar14 = (undefined3)(CONCAT22(uStack_2e,CONCAT11(bVar33 / 0x66,bVar33)) >> 8);
          uVar9 = (ushort)CONCAT31(uVar14,bVar33 % 0x66);
          if (uVar9 == 0) break;
          iVar15 = in(0x5a);
          if ((POPCOUNT(uVar9 & 0xff) & 1U) != 0) {
                    /* WARNING: Bad instruction - Truncating control flow here */
            halt_baddata();
          }
          pcVar27 = unaff_EDI + (uint)bVar35 * -2 + 1;
          *unaff_EDI = *pcVar22;
          puVar30 = (uint *)(pcVar10 + -0x15);
          uVar11 = *puVar30;
          *puVar30 = (int)*puVar30 >> 1;
          uVar12 = *puVar30;
          bStack_30 = (byte)pcVar10;
          uStack_2e = (undefined2)((uint)pcVar10 >> 0x10);
          unaff_EDI = pcVar27 + (uint)bVar35 * -2 + 1;
          *pcVar27 = pcVar23[(uint)bVar35 * -2];
          bVar35 = 1;
          if ((POPCOUNT(uVar12 & 0xff) & 1U) != 0) {
            DAT_28bdda20 = DAT_28bdda20 & bStack_30;
            pcRamf775c62f = pcVar28;
                    /* WARNING: Bad instruction - Truncating control flow here */
            halt_baddata();
          }
          LOCK();
          cVar2 = *pcVar10;
          *pcVar10 = (char)((uint)pcVar28 >> 8);
          pcVar28 = (char *)CONCAT22((short)((uint)pcVar28 >> 0x10),CONCAT11(cVar2,(byte)pcVar28));
          UNLOCK();
          unaff_EBX = pcVar10 + -1;
          in_EAX = (char *)((iVar15 + 0x762820d6) - (uint)((uVar11 & 1) != 0));
          pcVar23 = (char *)0x9cea6bd8;
          *(int *)(pcVar28 + 0x4108dc58) = *(int *)(pcVar28 + 0x4108dc58) + 0x5f;
          pcVar10 = (char *)CONCAT22(uStack_2e,CONCAT11(0x6d,bStack_30));
        }
        bStack_30 = 0x26;
        bStack_2f = bVar33 / 0x66;
        param_2 = unaff_EDI + (uint)bVar35 * -8 + 4;
        *(uint *)unaff_EDI = CONCAT31(uVar14,0x26);
        in_EAX = (char *)(CONCAT31((int3)(CONCAT22(uStack_2e,0x9026) >> 8),0x26) | 0x25);
        *(uint *)(unaff_EBX + -0xf) = *(uint *)(unaff_EBX + -0xf) | (uint)in_EAX;
        pcStack_34 = in_EAX;
        pcStack_38 = pcVar28;
        pcStack_3c = pcVar10;
        pcStack_40 = unaff_EBX;
        puStack_44 = &bStack_30;
        puStack_48 = (undefined4 *)unaff_EBP;
        auStack_2c[0] = SUB41(pcVar22,0);
        auStack_2c[1] = (undefined1)((uint)pcVar22 >> 8);
        uStack_2a = (undefined2)((uint)pcVar22 >> 0x10);
        pcStack_50 = param_2;
        uVar11 = (int)param_2 - (int)unaff_EBX;
        bVar34 = (POPCOUNT(uVar11 & 0xff) & 1U) == 0;
        if (bVar34) {
          pcVar6 = (code *)swi(0x53);
          (*pcVar6)();
                    /* WARNING: Bad instruction - Truncating control flow here */
          halt_baddata();
        }
        pcVar23 = (char *)((int)unaff_EBP + 0x7bc92438);
        bVar33 = (byte)pcVar28 & 0x1f;
        cVar2 = *pcVar23;
        *pcVar23 = *pcVar23 << bVar33;
        bVar5 = ((uint)pcVar28 & 0x1f) != 0;
        in_CF = !bVar5 && param_2 < unaff_EBX || bVar5 && (char)(cVar2 << bVar33 - 1) < '\0';
        in_OF = bVar33 != 1 && SBORROW4((int)param_2,(int)unaff_EBX) ||
                bVar33 == 1 && (bool)in_CF != *pcVar23 < '\0';
        bVar5 = ((uint)pcVar28 & 0x1f) != 0;
        in_SF = !bVar5 && (int)uVar11 < 0 || bVar5 && *pcVar23 < '\0';
        in_PF = !bVar5 && bVar34 || bVar5 && (POPCOUNT(*pcVar23) & 1U) == 0;
        in_ZF = !bVar5 && uVar11 == 0 || bVar5 && *pcVar23 == '\0';
        pcVar23 = pcVar22;
        unaff_EDI = param_2;
      }
      pcVar10 = in_EAX;
      puVar20 = (undefined4 *)unaff_EBP;
      if ((bool)in_OF) {
        piVar24 = (int *)CONCAT22((short)((uint)in_EAX >> 0x10),CONCAT11(0xa3,(char)in_EAX));
        if (!(bool)in_ZF && in_OF == in_SF) {
          *piVar24 = *piVar24 >> 1;
          return;
        }
        *(int *)(unaff_EDI + -0x2a) = *(int *)(unaff_EDI + -0x2a) - (int)pcVar28;
                    /* WARNING: Bad instruction - Truncating control flow here */
        halt_baddata();
      }
    }
    pcVar28 = pcVar28 + -1;
    unaff_ESI = pcVar23;
    if (pcVar28 == (char *)0x0) {
      out(*(undefined4 *)pcVar23,(short)param_2);
      unaff_ESI = unaff_retaddr;
    }
  }
  puVar20 = (undefined4 *)((uint)unaff_EBP | (uint)pcVar22);
code_r0x00514c8f:
  uVar7 = *(undefined6 *)(pcVar22 + 0x1b5c9807);
  uVar32 = (undefined2)((uint6)uVar7 >> 0x20);
  out(0xec,pcVar22);
  pcVar28 = pcVar23 + 0x325f871d;
  cVar2 = *pcVar28;
  *pcVar28 = *pcVar28 - (char)param_2;
  piVar24 = (int *)(pcVar23 + (uint)bVar35 * -2 + 1);
  out(*pcVar23,(short)param_2);
  pcVar6 = (code *)swi(4);
  if (SBORROW1(cVar2,(char)param_2)) {
    (*pcVar6)();
    param_2 = extraout_EDX;
  }
  uVar21 = *puVar20;
  auStack_2c[0] = (undefined1)in_CS;
  auStack_2c[1] = (undefined1)((ushort)in_CS >> 8);
  bStack_30 = 0x1b;
  bStack_2f = 0x4d;
  uStack_2e = 0x51;
  uVar36 = (*(code *)(param_2 + 0x1d))();
  pcVar28 = unaff_EDI + (uint)bVar35 * -2 + 1;
  bVar33 = (byte)uVar36;
  if (SBORROW1(bVar33,*unaff_EDI)) {
    uVar11 = CONCAT22((short)((uint6)uVar7 >> 0x10),
                      CONCAT11((char)((uint6)uVar7 >> 8) + *(char *)((ulonglong)uVar36 >> 0x20),
                               (char)uVar7));
    pbVar29 = (byte *)((int)(pcVar28 + (uint)bVar35 * -2 + 1) + ((uint)bVar35 * -2 + 1) * 4);
    *(int *)(pcVar28 + (uint)bVar35 * -2 + 1) = *piVar24;
    pbVar26 = (byte *)(uVar11 - 0x2e);
    *pbVar26 = *pbVar26 << 1 | *pbVar26 >> 7;
    bVar8 = *pbVar26;
    cVar2 = *(char *)((int)uVar36 + -0x2a0e4518);
    *extraout_ECX = *extraout_ECX ^ uVar11;
    bStack_30 = (byte)in_SS;
    bStack_2f = (byte)((ushort)in_SS >> 8);
    bVar33 = 0xf < (byte)(bVar33 + cVar2 + ((bVar8 & 1) != 0));
    *pbVar29 = *pbVar29 - 1;
    ffree(in_ST7);
    pcStack_34 = (char *)0x514d44;
    uVar36 = func_0x11b54bd3();
    puVar17 = (undefined2 *)((ulonglong)uVar36 >> 0x20);
    uVar25 = (int)piVar24 + (uint)bVar35 * -8 + 3;
    uVar11 = (uint)bVar33;
    uVar12 = (int)piVar24 + (uint)bVar35 * -8 + 0x29f53f96;
    pbVar26 = (byte *)(uVar12 + uVar11);
    uVar16 = (undefined2)((ulonglong)uVar36 >> 0x20);
    if ((SCARRY4(uVar25,0x29f53f93) != SCARRY4(uVar12,uVar11)) != (int)pbVar26 < 0) {
      bVar35 = 9 < ((byte)uVar36 & 0xf) | in_AF;
      bVar33 = (byte)uVar36 + bVar35 * -6;
      *(uint *)(puVar17 + -0x3fbcdc63) =
           *(uint *)(puVar17 + -0x3fbcdc63) ^
           CONCAT31((int3)((ulonglong)uVar36 >> 8),
                    bVar33 + (0x9f < bVar33 |
                             (0xd60ac06c < uVar25 || CARRY4(uVar12,uVar11)) | bVar35 * (bVar33 < 6))
                             * -0x60 + (char)((ulonglong)uVar36 >> 8) * '~' + 'P') & 0xffff00ff;
      _DAT_a21d64f1 = in(uVar16);
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    pbVar1 = (byte *)((int)puVar17 + 0x1b);
    bVar33 = (byte)extraout_ECX_00 & 7;
    *pbVar1 = *pbVar1 << bVar33 | *pbVar1 >> 8 - bVar33;
    out(0xfe,(int)uVar36);
    if (*pbVar26 >= *pbVar29) {
      out(uVar16,(char)*(undefined4 *)(pbVar26 + (uint)bVar35 * -2 + 2));
      *(uint *)(pbVar26 + (uint)bVar35 * -8 + (uint)bVar35 * -2 + (int)&uStack_2a +
               (*pbVar26 < *pbVar29)) =
           *(uint *)(pbVar26 + (uint)bVar35 * -8 + (uint)bVar35 * -2 + (int)&uStack_2a +
                    (*pbVar26 < *pbVar29)) ^ (uint)&bStack_30;
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
    if (extraout_ECX_00 == 0) {
      bVar33 = in(uVar16);
      pbVar29[(uint)bVar35 * -2 + 1] = bVar33;
                    /* WARNING: Bad instruction - Truncating control flow here */
      halt_baddata();
    }
  }
  else {
    bVar33 = 9 < (bVar33 & 0xf) | in_AF;
    pbVar26 = &bStack_30;
    bStack_30 = (byte)uVar21;
    bStack_2f = (byte)((uint)uVar21 >> 8);
    uStack_2e = (undefined2)((uint)uVar21 >> 0x10);
    pcVar6 = (code *)swi(0x43);
    uVar36 = (*pcVar6)();
    puVar17 = (undefined2 *)((ulonglong)uVar36 >> 0x20);
    puVar30 = (uint *)((int)pcVar28 * 0x200000);
    puVar20 = (undefined4 *)*(undefined6 *)(extraout_ECX_01 + 0x14d442a4 + (int)pcVar28 * 0x800000);
    uVar11 = (uint)((int)pcVar28 * 0x100000 < 0);
    puVar13 = &stack0xa5aa28c6 + uVar11;
    iVar15 = *(int *)uVar36;
    puVar19 = (undefined1 *)(iVar15 + -4);
    *(undefined2 *)(iVar15 + -4) = uVar32;
    if (auStack_5f27 < (undefined1 *)0x5a557813 && !CARRY4((uint)&stack0xa5aa28c6,uVar11)) {
      if ((int)((uint)puVar20 & (uint)puVar30) < 1) {
        bVar35 = 0;
        iVar15 = extraout_ECX_01;
        puVar18 = puVar20;
      }
      else {
        bVar34 = *(uint *)(extraout_ECX_01 + 0x19) < 0x6383ea3e;
        puVar19 = (undefined1 *)(iVar15 + -8);
        *(undefined4 *)(iVar15 + -8) = 0x514db1;
        uVar36 = func_0x8f4910b7();
        puVar17 = (undefined2 *)((ulonglong)uVar36 >> 0x20);
        if (bVar34) {
          puVar18 = (undefined4 *)(puVar19 + -4);
          *(undefined4 **)(puVar19 + -4) = puVar20;
          cVar2 = '\x1d';
          do {
            puVar20 = puVar20 + -1;
            puVar18 = puVar18 + -1;
            *puVar18 = *puVar20;
            cVar2 = cVar2 + -1;
          } while ('\0' < cVar2);
          *(undefined1 **)(puVar19 + -0x7c) = puVar19 + -4;
                    /* WARNING: Bad instruction - Truncating control flow here */
          halt_baddata();
        }
        *piVar24 = (*piVar24 - (int)piVar24) - (uint)bVar34;
        bVar33 = 9 < ((byte)uVar36 & 0xf) | bVar33;
        uVar14 = (undefined3)((ulonglong)uVar36 >> 8);
        bVar8 = (byte)uVar36 + bVar33 * '\x06';
        puVar18 = (undefined4 *)
                  (puVar13 +
                  (-(uint)(CONCAT31(uVar14,bVar8 + (0x90 < (bVar8 & 0xf0) |
                                                   puVar20 < *(undefined4 **)
                                                              (puVar17 + (int)puVar13 * 4) |
                                                   bVar33 * (0xf9 < bVar8)) * '`') < 0xb79e35cb) -
                  *(int *)((int)piVar24 + 0xf)));
        puVar13 = (undefined1 *)CONCAT31(uVar14,uRamf0a18cd1);
        puVar31 = puVar30 + (uint)bVar35 * -2 + 1;
        puVar4 = (undefined1 *)*puVar30;
        iVar15 = extraout_ECX_02;
        do {
          iVar15 = iVar15 + -1;
          pbVar26 = (byte *)puVar20;
          puVar30 = puVar31;
        } while (iVar15 != 0 && puVar13 == puVar4);
      }
      *(undefined4 *)((int)pbVar26 + -0x3f3251b) = in_XMM1_Da;
      *(undefined4 *)((int)pbVar26 + -0x3f32517) = in_XMM1_Db;
      *(undefined4 *)((int)pbVar26 + -0x3f32513) = in_XMM1_Dc;
      *(undefined4 *)((int)pbVar26 + -0x3f3250f) = in_XMM1_Dd;
      *(uint *)(puVar19 + -4) = (uint)puVar13 | 0xee99e10d;
      *(int *)(puVar19 + -8) = iVar15;
      *(undefined2 **)(puVar19 + -0xc) = puVar17;
      *(undefined4 **)(puVar19 + -0x10) = puVar18;
      *(undefined1 **)(puVar19 + -0x14) = puVar19;
      *(int *)(puVar19 + -0x18) = (int)pbVar26 + 1;
      *(int **)(puVar19 + -0x1c) = piVar24;
      *(uint **)(puVar19 + -0x20) = puVar30;
      while (iVar15 != 0) {
        iVar15 = iVar15 + -1;
        uVar3 = in((short)puVar17);
        *(undefined1 *)puVar30 = uVar3;
        puVar30 = (uint *)((int)puVar30 + (uint)bVar35 * -2 + 1);
      }
      halt_baddata();
    }
  }
  *puVar17 = uVar32;
                    /* WARNING: Bad instruction - Truncating control flow here */
  halt_baddata();
}


