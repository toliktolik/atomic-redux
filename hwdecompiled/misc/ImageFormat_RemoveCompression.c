/*
 * Function: ImageFormat_RemoveCompression
 * Address: 004bccd0
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void * ImageFormat_RemoveCompression(void)

{
  int iVar1;
  void *pvVar2;
  void *this;
  double *extraout_EDX;
  double *extraout_EDX_00;
  double *pdVar3;
  undefined4 *unaff_ESI;
  longlong lVar4;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  int local_10;
  int local_c;
  int local_8;
  
  local_8 = unaff_ESI[0x11];
  local_14 = unaff_ESI[2];
  local_10 = unaff_ESI[3];
  local_24 = 0;
  local_20 = 0;
  local_1c = 0;
  local_18 = 0;
  (*(code *)unaff_ESI[0x47])(*unaff_ESI,0,0,2);
  iVar1 = (*(code *)unaff_ESI[0x49])();
  unaff_ESI[5] = iVar1 >> 0x1f;
  unaff_ESI[4] = iVar1;
  unaff_ESI[3] = unaff_ESI[5];
  unaff_ESI[2] = iVar1;
  lVar4 = ImageFormat_LoadPNG(&local_24);
  iVar1 = (int)((ulonglong)lVar4 >> 0x20);
  if ((iVar1 == 0 || lVar4 < 0) && (lVar4 < 0)) {
    return (void *)lVar4;
  }
  local_c = CPU_ExecuteInstruction14();
  CPU_ClearContext4(this,&local_24);
  if (local_c == local_8) {
    iVar1 = ImageFormat_LoadTGA((int)unaff_ESI,0,0,(void *)lVar4,iVar1,(void *)(lVar4 + 1),
                                (int)((ulonglong)(lVar4 + 1) >> 0x20),local_8,0);
    pdVar3 = extraout_EDX_00;
    if (iVar1 == 0) goto LAB_004bcdb0;
  }
  else {
    iVar1 = ImageFormat_LoadTGA((int)unaff_ESI,0,0,(void *)0x0,0,(void *)(lVar4 + 1),
                                (int)((ulonglong)(lVar4 + 1) >> 0x20),local_8,0);
    pdVar3 = extraout_EDX;
    if (-1 < iVar1) {
LAB_004bcdb0:
      ImageFormat_SaveBMP(local_14,pdVar3,local_14,local_10);
      pvVar2 = (void *)ImageFormat_GetColorDepth((int)unaff_ESI,0,0);
      return pvVar2;
    }
  }
  return (void *)0xffffff80;
}


