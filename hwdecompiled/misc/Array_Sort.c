/*
 * Function: Array_Sort
 * Address: 00499940
 * Category: misc
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


_String_base * __thiscall
Array_Sort(void *this,uint param_1,_String_base *param_2,uint param_3,uint param_4)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int iVar3;
  uint uVar4;
  _String_base *p_Var5;
  uint uVar6;
  _String_base *p_Var7;
  
  if ((*(uint *)((int)this + 0x14) < param_1) || (*(uint *)(param_2 + 0x14) < param_3)) {
    std::_String_base::_Xran((_String_base *)this);
  }
  if (*(int *)(param_2 + 0x14) - param_3 < param_4) {
    param_4 = *(int *)(param_2 + 0x14) - param_3;
  }
  if (-*(int *)((int)this + 0x14) - 1U <= param_4) {
    std::_String_base::_Xlen((_String_base *)this);
  }
  if (param_4 != 0) {
    uVar6 = *(int *)((int)this + 0x14) + param_4;
    if (uVar6 == 0xffffffff) {
      std::_String_base::_Xlen((_String_base *)this);
    }
    if (*(uint *)((int)this + 0x18) < uVar6) {
      String_AllocateMemory(uVar6);
    }
    else if (uVar6 == 0) {
      *(undefined4 *)((int)this + 0x14) = 0;
      if (0xf < *(uint *)((int)this + 0x18)) {
        **(undefined1 **)((int)this + 4) = 0;
        return (_String_base *)this;
      }
      *(undefined1 *)((int)this + 4) = 0;
      return (_String_base *)this;
    }
    if (uVar6 != 0) {
      if (*(uint *)((int)this + 0x18) < 0x10) {
        iVar3 = (int)this + 4;
      }
      else {
        iVar3 = *(int *)((int)this + 4);
      }
      puVar2 = (undefined4 *)((int)this + 4);
      puVar1 = puVar2;
      if (0xf < *(uint *)((int)this + 0x18)) {
        puVar1 = (undefined4 *)*puVar2;
      }
      STL_MemoryCopy((void *)((int)puVar1 + param_4 + param_1),(void *)(iVar3 + param_1),
                     *(int *)((int)this + 0x14) - param_1);
      if ((_String_base *)this == param_2) {
        if (param_1 < param_3) {
          param_3 = param_3 + param_4;
        }
        puVar1 = puVar2;
        if (0xf < *(uint *)((int)this + 0x18)) {
          puVar1 = (undefined4 *)*puVar2;
          puVar2 = (undefined4 *)*puVar2;
        }
        STL_MemoryCopy((void *)((int)puVar2 + param_1),(void *)((int)puVar1 + param_3),param_4);
      }
      else {
        if (*(uint *)(param_2 + 0x18) < 0x10) {
          p_Var5 = param_2 + 4;
        }
        else {
          p_Var5 = *(_String_base **)(param_2 + 4);
        }
        if (0xf < *(uint *)((int)this + 0x18)) {
          puVar2 = (undefined4 *)*puVar2;
        }
        p_Var5 = p_Var5 + param_3;
        p_Var7 = (_String_base *)(param_1 + (int)puVar2);
        for (uVar4 = param_4 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
          *(undefined4 *)p_Var7 = *(undefined4 *)p_Var5;
          p_Var5 = p_Var5 + 4;
          p_Var7 = p_Var7 + 4;
        }
        for (uVar4 = param_4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
          *p_Var7 = *p_Var5;
          p_Var5 = p_Var5 + 1;
          p_Var7 = p_Var7 + 1;
        }
      }
      *(uint *)((int)this + 0x14) = uVar6;
      if (0xf < *(uint *)((int)this + 0x18)) {
        *(undefined1 *)(*(int *)((int)this + 4) + uVar6) = 0;
        return (_String_base *)this;
      }
      *(undefined1 *)((int)this + uVar6 + 4) = 0;
    }
  }
  return (_String_base *)this;
}


