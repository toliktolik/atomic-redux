/*
 * Function: Music_PlayTrack
 * Address: 004a07f0
 * Category: audio
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


undefined1 __thiscall Music_PlayTrack(void *this,int param_1,int param_2)

{
  undefined1 uVar1;
  undefined4 *puVar2;
  int iVar3;
  undefined1 *puVar4;
  uint extraout_EDX;
  undefined1 *puVar5;
  uint extraout_EDX_00;
  undefined8 uVar6;
  _String_base local_4c [4];
  int local_48;
  uint local_34;
  _String_base local_30 [4];
  uint local_2c;
  undefined4 local_1c;
  uint local_18;
  undefined4 *local_14;
  void *local_10;
  undefined4 uStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  uStack_c = 0x515898;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  puVar2 = (undefined4 *)Texture_SetPixelData((_String_base *)(param_1 + 0x50),'\x01');
  if (puVar2 == (undefined4 *)0x0) {
    uVar6 = Sound_SetPosition(local_4c,"Failed to load image: %s");
    local_8 = 0;
    uVar1 = Sound_Release((int)this,(uint)((ulonglong)uVar6 >> 0x20),(_String_base *)uVar6);
    if (0xf < local_34) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler(local_48,extraout_EDX);
    }
  }
  else {
    local_8 = 1;
    local_14 = puVar2;
    if ((puVar2[1] == *(int *)(param_2 + 4)) && (puVar2[2] == *(int *)(param_2 + 8))) {
      iVar3 = *(int *)(param_2 + 8) * *(int *)(param_2 + 4);
      puVar4 = (undefined1 *)puVar2[3];
      if (0 < iVar3) {
        puVar5 = (undefined1 *)(*(int *)(param_2 + 0xc) + 3);
        do {
          *puVar5 = *puVar4;
          puVar5 = puVar5 + 4;
          puVar4 = puVar4 + 4;
          iVar3 = iVar3 + -1;
        } while (iVar3 != 0);
      }
      local_8 = 0xffffffff;
      (**(code **)*puVar2)(1);
      ExceptionList = local_10;
      return 1;
    }
    uVar6 = Sound_SetPosition(local_30,"AlphaImage size mismatch between %s and %s");
    local_8 = CONCAT31(local_8._1_3_,2);
    uVar1 = Sound_Release((int)this,(uint)((ulonglong)uVar6 >> 0x20),(_String_base *)uVar6);
    if (0xf < local_18) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler(local_2c,extraout_EDX_00);
    }
    local_18 = 0xf;
    local_1c = 0;
    local_2c = local_2c & 0xffffff00;
    local_8 = 0xffffffff;
    (**(code **)*puVar2)(1);
  }
  ExceptionList = local_10;
  return uVar1;
}


