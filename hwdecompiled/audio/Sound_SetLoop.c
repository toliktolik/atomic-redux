/*
 * Function: Sound_SetLoop
 * Address: 004a0090
 * Category: audio
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __fastcall Sound_SetLoop(int param_1)

{
  char cVar1;
  DWORD color;
  HWND pHVar2;
  LPCSTR pCVar3;
  char *pcVar4;
  uint unaff_retaddr;
  undefined4 *in_stack_fffffeb8;
  undefined4 *in_stack_fffffebc;
  WNDCLASSA local_48;
  HWND local_20;
  tagRECT local_1c;
  char local_9;
  uint local_8;
  
  local_8 = DAT_00569f5c ^ unaff_retaddr;
  *(undefined1 *)(param_1 + 0x125) = 0;
  *(undefined1 *)(param_1 + 0x124) = 0;
  if (*(char *)((int)*(void **)(param_1 + 4) + 0x491) == '\0') {
    Sound_FadeOut(param_1);
    local_48.style = 0;
    local_48.cbClsExtra = 0;
    local_48.cbWndExtra = 0;
    color = GetSysColor(0xf);
    local_48.hbrBackground = CreateSolidBrush(color);
    local_48.hCursor = LoadCursorA((HINSTANCE)0x0,(LPCSTR)0x7f00);
    local_48.hIcon = LoadIconA((HINSTANCE)0x0,(LPCSTR)0x7f02);
    local_48.hInstance = DAT_005a33c0;
    local_48.lpfnWndProc = Level_InitializeVodkavania;
    local_48.lpszClassName = "LoginWindow";
    local_48.lpszMenuName = (LPCSTR)0x0;
    RegisterClassA(&local_48);
    local_1c.left = 0;
    local_1c.top = 0;
    local_1c.right = 0x132;
    local_1c.bottom = 0xa2;
    AdjustWindowRect(&local_1c,0x82ca0000,0);
    pHVar2 = CreateWindowExA(0,"LoginWindow","PopCap Beta Login...",0x82ca0000,0x40,0x40,
                             local_1c.right - local_1c.left,local_1c.bottom - local_1c.top,(HWND)0x0
                             ,(HMENU)0x0,DAT_005a33c0,(LPVOID)0x0);
    *(HWND *)(param_1 + 0x18) = pHVar2;
    SetWindowLongA(pHVar2,-0x15,param_1);
    SetTimer(*(HWND *)(param_1 + 0x18),0,0x14,(TIMERPROC)0x0);
    SetTimer(*(HWND *)(param_1 + 0x18),1,1000,(TIMERPROC)0x0);
    if (*(uint *)(param_1 + 0x178) < 0x10) {
      pCVar3 = (LPCSTR)(param_1 + 0x164);
    }
    else {
      pCVar3 = *(LPCSTR *)(param_1 + 0x164);
    }
    pHVar2 = CreateWindowExA(0x200,"EDIT",pCVar3,0x50810000,6,0x14,0xcc,0x16,
                             *(HWND *)(param_1 + 0x18),(HMENU)0x0,DAT_005a33c0,(LPVOID)0x0);
    *(HWND *)(param_1 + 0x20) = pHVar2;
    SendMessageA(pHVar2,0x30,*(WPARAM *)(param_1 + 8),0);
    if (*(uint *)(param_1 + 0x194) < 0x10) {
      pCVar3 = (LPCSTR)(param_1 + 0x180);
    }
    else {
      pCVar3 = *(LPCSTR *)(param_1 + 0x180);
    }
    pHVar2 = CreateWindowExA(0x200,"EDIT",pCVar3,0x50810020,6,0x41,0xcc,0x16,
                             *(HWND *)(param_1 + 0x18),(HMENU)0x0,DAT_005a33c0,(LPVOID)0x0);
    *(HWND *)(param_1 + 0x24) = pHVar2;
    SendMessageA(pHVar2,0x30,*(WPARAM *)(param_1 + 8),0);
    local_20 = CreateWindowExA(0,"BUTTON","Login",0x50010001,0xde,6,0x48,0x14,
                               *(HWND *)(param_1 + 0x18),(HMENU)0x1,DAT_005a33c0,(LPVOID)0x0);
    SendMessageA(local_20,0x30,*(WPARAM *)(param_1 + 8),0);
    pHVar2 = CreateWindowExA(0,"BUTTON","Cancel",0x50010000,0xde,0x20,0x48,0x14,
                             *(HWND *)(param_1 + 0x18),(HMENU)0x2,DAT_005a33c0,(LPVOID)0x0);
    SendMessageA(pHVar2,0x30,*(WPARAM *)(param_1 + 8),0);
    Level_InitializeZamblamia(*(HWND *)(param_1 + 0x18));
    pHVar2 = local_20;
    if (*(int *)(param_1 + 400) == 0) {
      pHVar2 = *(HWND *)(param_1 + 0x20);
    }
    SetFocus(pHVar2);
    ShowWindow(*(HWND *)(param_1 + 0x18),1);
    Level_InitializeTankylvania(param_1);
    if (*(char *)(param_1 + 0x124) == '\0') {
      GetWindowTextA(*(HWND *)(param_1 + 0x20),&stack0xfffffeb8,0x100);
      pcVar4 = &stack0xfffffeb8;
      do {
        cVar1 = *pcVar4;
        pcVar4 = pcVar4 + 1;
      } while (cVar1 != '\0');
      String_Assign((void *)(param_1 + 0x160),(_String_base *)&stack0xfffffeb8,
                    (int)pcVar4 - (int)&stack0xfffffeb9);
      GetWindowTextA(*(HWND *)(param_1 + 0x24),&stack0xfffffeb8,0x100);
      pcVar4 = &stack0xfffffeb8;
      do {
        cVar1 = *pcVar4;
        pcVar4 = pcVar4 + 1;
      } while (cVar1 != '\0');
      String_Assign((void *)(param_1 + 0x17c),(_String_base *)&stack0xfffffeb8,
                    (int)pcVar4 - (int)&stack0xfffffeb9);
    }
    DestroyWindow(*(HWND *)(param_1 + 0x18));
    *(undefined4 *)(param_1 + 0x18) = 0;
    Iterator_MoveToPrevious(*(void **)(param_1 + 4),(char *)(param_1 + 0x124));
  }
  else {
    local_9 = '\0';
    Iterator_MoveToPrevious(*(void **)(param_1 + 4),&local_9);
  }
  Exception_SetMessage((void *)(local_8 ^ unaff_retaddr),in_stack_fffffeb8,in_stack_fffffebc);
  return;
}


