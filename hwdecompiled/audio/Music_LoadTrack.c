/*
 * Function: Music_LoadTrack
 * Address: 004a05d0
 * Category: audio
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


undefined1 __thiscall Music_LoadTrack(void *this,int param_1,int param_2)

{
  undefined4 *puVar1;
  undefined1 uVar2;
  undefined4 *puVar3;
  undefined1 *puVar4;
  int extraout_ECX;
  uint extraout_EDX;
  undefined1 *puVar5;
  int iVar6;
  int iVar7;
  undefined8 uVar8;
  _String_base local_68 [4];
  int local_64;
  uint local_50;
  _String_base local_4c [4];
  uint local_48;
  undefined4 local_38;
  uint local_34;
  undefined4 *local_30;
  int local_2c;
  int local_28;
  int local_24;
  int local_20;
  int local_1c;
  int local_18;
  int local_14;
  void *local_10;
  undefined4 uStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  uStack_c = 0x515868;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  puVar3 = (undefined4 *)Texture_SetPixelData((_String_base *)(param_1 + 0x6c),'\x01');
  if (puVar3 == (undefined4 *)0x0) {
    uVar8 = Sound_SetPosition(local_68,"Failed to load image: %s");
    local_8 = 0;
    uVar2 = Sound_Release((int)this,(uint)((ulonglong)uVar8 >> 0x20),(_String_base *)uVar8);
    if (0xf < local_50) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler(local_64,extraout_EDX);
    }
  }
  else {
    local_1c = *(int *)(param_1 + 0x94);
    local_20 = *(int *)(param_2 + 4) / local_1c;
    puVar1 = *(undefined4 **)(param_1 + 0x90);
    local_8 = 1;
    local_24 = *(int *)(param_2 + 8) / (int)puVar1;
    local_30 = puVar3;
    if ((puVar3[1] == local_20) && (puVar3[2] == local_24)) {
      local_18 = *(int *)(param_2 + 0xc);
      if (0 < (int)puVar1) {
        do {
          local_30 = puVar1;
          local_14 = local_18;
          iVar7 = local_1c;
          if (0 < local_1c) {
            do {
              local_2c = iVar7;
              puVar5 = (undefined1 *)puVar3[3];
              iVar7 = local_14;
              iVar6 = local_24;
              if (0 < local_24) {
                do {
                  local_28 = iVar6;
                  if (0 < local_20) {
                    puVar4 = (undefined1 *)(iVar7 + 3);
                    iVar6 = local_20;
                    do {
                      *puVar4 = *puVar5;
                      puVar5 = puVar5 + 4;
                      puVar4 = puVar4 + 4;
                      iVar6 = iVar6 + -1;
                    } while (iVar6 != 0);
                  }
                  local_28 = local_28 + -1;
                  iVar7 = iVar7 + *(int *)(param_2 + 4) * 4;
                  iVar6 = local_28;
                } while (local_28 != 0);
              }
              local_14 = local_14 + local_20 * 4;
              local_2c = local_2c + -1;
              iVar7 = local_2c;
            } while (local_2c != 0);
          }
          local_18 = local_18 + *(int *)(param_2 + 4) * local_24 * 4;
          local_30 = (undefined4 *)((int)local_30 + -1);
          puVar1 = local_30;
        } while (local_30 != (undefined4 *)0x0);
      }
      local_8 = 0xffffffff;
      (**(code **)*puVar3)(1);
      ExceptionList = local_10;
      return 1;
    }
    uVar8 = Sound_SetPosition(local_4c,"GridAlphaImage size mismatch between %s and %s");
    local_8 = CONCAT31(local_8._1_3_,2);
    uVar2 = Sound_Release((int)this,(uint)((ulonglong)uVar8 >> 0x20),(_String_base *)uVar8);
    if (0xf < local_34) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler(extraout_ECX,local_48);
    }
    local_34 = 0xf;
    local_38 = 0;
    local_48 = local_48 & 0xffffff00;
    local_8 = 0xffffffff;
    (**(code **)*puVar3)(1);
  }
  ExceptionList = local_10;
  return uVar2;
}


