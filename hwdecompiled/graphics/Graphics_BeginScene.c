/*
 * Function: Graphics_BeginScene
 * Address: 004e49f0
 * Category: graphics
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Restarted to delay deadcode elimination for space: stack */

void __thiscall
Graphics_BeginScene(void *this,undefined4 *param_1,int param_2,int param_3,undefined4 param_4,
                   undefined4 param_5,uint param_6,int param_7,int param_8,int param_9)

{
  int iVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  int extraout_ECX;
  int iVar5;
  uint uVar6;
  int iVar7;
  uint extraout_EDX;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  int unaff_ESI;
  uint *puVar11;
  int unaff_EDI;
  int *piVar12;
  undefined8 uVar13;
  int iStack_34;
  int local_8;
  
  iVar2 = param_7;
  iVar3 = param_8 * 0x1000;
  piVar12 = (int *)&stack0xffffffd0;
  System_LoadLibrary(this);
  param_8 = 0;
  iVar5 = extraout_ECX;
  if (0 < (int)param_6) {
    do {
      System_GetProcessHandle(iVar5);
      if (((int)extraout_EDX < 0) || (iVar5 = (int)extraout_EDX >> 9, 0x7f < iVar5)) {
        for (; param_3 != 0; param_3 = param_3 + -1) {
          *param_1 = 0;
          param_1 = param_1 + 1;
        }
        return;
      }
      *piVar12 = *(int *)(&DAT_00544258 + iVar5 * 4) -
                 ((int)((*(int *)(&DAT_00544258 + iVar5 * 4) - *(int *)(&DAT_0054425c + iVar5 * 4))
                       * (extraout_EDX & 0x1ff)) >> 9);
      param_8 = param_8 + 1;
      piVar12 = piVar12 + 1;
    } while (param_8 < (int)param_6);
  }
  param_8 = 0;
  if (0 < param_3) {
    do {
      iVar5 = *(int *)(param_2 + param_8 * 4);
      iVar7 = *(int *)(param_9 + iVar5 * 4);
      uVar8 = unaff_EDI - iVar7 >> 0x1f;
      uVar8 = ((unaff_EDI - iVar7 ^ uVar8) - uVar8) * 0xb505;
      uVar9 = unaff_ESI - iVar7 >> 0x1f;
      uVar9 = ((unaff_ESI - iVar7 ^ uVar9) - uVar9) * 0xb505;
      param_7 = 0;
      local_8 = 3;
      if (3 < (int)param_6) {
        do {
          uVar4 = uVar8 | uVar9;
          uVar6 = (uint)(byte)(&DAT_005444d0)[uVar4 >> 0x19];
          if ((uVar6 == 0) && (uVar6 = (uint)(byte)(&DAT_00544510)[uVar4 >> 0x13], uVar6 == 0)) {
            uVar6 = (uint)(byte)(&DAT_00544550)[uVar4 >> 0x10];
          }
          uVar4 = (&iStack_34)[local_8] - iVar7 >> 0x1f;
          uVar8 = (uVar8 >> ((byte)uVar6 & 0x1f)) *
                  (((&iStack_34)[local_8] - iVar7 ^ uVar4) - uVar4);
          uVar4 = *(int *)(&stack0xffffffd0 + local_8 * 4) - iVar7 >> 0x1f;
          uVar9 = (uVar9 >> ((byte)uVar6 & 0x1f)) *
                  ((*(int *)(&stack0xffffffd0 + local_8 * 4) - iVar7 ^ uVar4) - uVar4);
          param_7 = param_7 + uVar6;
          local_8 = local_8 + 2;
        } while (local_8 < (int)param_6);
      }
      uVar4 = uVar8 | uVar9;
      uVar6 = (uint)(byte)(&DAT_005444d0)[uVar4 >> 0x19];
      if ((uVar6 == 0) && (uVar6 = (uint)(byte)(&DAT_00544510)[uVar4 >> 0x13], uVar6 == 0)) {
        uVar6 = (uint)(byte)(&DAT_00544550)[uVar4 >> 0x10];
      }
      uVar9 = uVar9 >> ((byte)uVar6 & 0x1f);
      uVar8 = uVar8 >> ((byte)uVar6 & 0x1f);
      if ((param_6 & 1) == 0) {
        uVar4 = (uVar6 + param_7) * 2 + param_6 * -0xd;
        uVar8 = (uVar9 * uVar9 >> 0x10) * (0x4000 - iVar7) +
                (uVar8 * uVar8 >> 0x10) * (iVar7 + 0x4000) >> 0xe;
      }
      else {
        uVar4 = (&iStack_34)[local_8] - iVar7 >> 0x1f;
        uVar8 = (((&iStack_34)[local_8] - iVar7 ^ uVar4) - uVar4) * uVar8;
        uVar10 = uVar8 | uVar9 << 0xe;
        uVar4 = (uint)(byte)(&DAT_005444d0)[uVar10 >> 0x19];
        if ((uVar4 == 0) && (uVar4 = (uint)(byte)(&DAT_00544510)[uVar10 >> 0x13], uVar4 == 0)) {
          uVar4 = (uint)(byte)(&DAT_00544550)[uVar10 >> 0x10];
        }
        uVar9 = (uVar9 << 0xe) >> ((byte)uVar4 & 0x1f);
        uVar8 = uVar8 >> ((byte)uVar4 & 0x1f);
        uVar4 = param_6 + (uVar4 + ((int)(param_6 + 1) >> 1) * -0xe + param_7 + uVar6) * 2;
        uVar8 = ((0x4000 - (iVar7 * iVar7 >> 0xe)) * (uVar9 * uVar9 >> 0x10) >> 0xe) +
                (uVar8 * uVar8 >> 0x10);
      }
      if ((uVar8 & 0xffff0000) == 0) {
        for (; (uVar8 != 0 && (-1 < (char)(uVar8 >> 8))); uVar8 = uVar8 << 1) {
          uVar4 = uVar4 - 1;
        }
      }
      else {
        uVar8 = uVar8 >> 1;
        uVar4 = uVar4 + 1;
      }
      uVar9 = (int)uVar8 >> 9 & 0x3f;
      iVar7 = iVar3 - ((*(int *)(&DAT_00544050 + uVar9 * 4) -
                       ((int)(*(int *)(&DAT_00544158 + uVar9 * 4) * (uVar8 & 0x3ff)) >> 10)) *
                       *(int *)(&DAT_00568398 + (uVar4 & 1) * 4) >>
                      ((char)((int)uVar4 >> 1) + 0x15U & 0x1f)) * iVar2;
      uVar8 = iVar7 >> 9;
      if ((int)uVar8 < 0) {
        iVar7 = 0x7fffffff;
      }
      else if ((int)uVar8 < 0x460) {
        iVar7 = *(int *)(&DAT_00543fd0 + (uVar8 & 0x1f) * 4) *
                *(int *)(&DAT_00543f40 + (iVar7 >> 0xe) * 4);
      }
      else {
        iVar7 = 0;
      }
      uVar13 = System_GetProcessHandle(iVar7 >> 0x1f);
      param_1[param_8] = (uint)uVar13 >> 0xf | (int)((ulonglong)uVar13 >> 0x20) << 0x11;
      iVar1 = param_8 * 4;
      param_8 = param_8 + 1;
      if (*(int *)(param_2 + 4 + iVar1) == iVar5) {
        puVar11 = param_1 + param_8;
        do {
          uVar13 = System_GetProcessHandle(iVar7 >> 0x1f);
          *puVar11 = (uint)uVar13 >> 0xf | (int)((ulonglong)uVar13 >> 0x20) << 0x11;
          piVar12 = (int *)((param_2 - (int)param_1) + 4 + (int)puVar11);
          puVar11 = puVar11 + 1;
          param_8 = param_8 + 1;
        } while (*piVar12 == iVar5);
      }
    } while (param_8 < param_3);
  }
  return;
}


