/*
 * Function: Graphics_SetMaterial
 * Address: 004e5220
 * Category: graphics
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __cdecl Graphics_SetMaterial(uint param_1,byte *param_2,int param_3)

{
  byte bVar1;
  uint *puVar2;
  undefined1 *puVar3;
  byte *pbVar4;
  uint uVar5;
  uint uVar6;
  undefined1 *puVar7;
  undefined1 *puVar8;
  uint uVar9;
  int iVar10;
  undefined1 *local_18;
  byte *local_14;
  undefined1 *local_10;
  uint local_c;
  
  pbVar4 = param_2;
  uVar5 = param_1;
  puVar2 = *(uint **)(param_1 + 4);
  uVar9 = *(uint *)(param_1 + 0x1c);
  local_c = *(uint *)(param_2 + 4);
  puVar8 = *(undefined1 **)(param_1 + 0x34);
  if (puVar8 < *(undefined1 **)(param_1 + 0x30)) {
    local_10 = *(undefined1 **)(param_1 + 0x30) + (-1 - (int)puVar8);
  }
  else {
    local_10 = (undefined1 *)(*(int *)(param_1 + 0x2c) - (int)puVar8);
  }
  uVar6 = *puVar2;
  param_2 = *(byte **)param_2;
  param_1 = *(uint *)(param_1 + 0x20);
  while (uVar6 < 10) {
    switch(uVar6) {
    case 0:
      if ((local_10 < (undefined1 *)0x102) || (local_c < 10)) {
LAB_004e531a:
        puVar2[3] = (uint)(byte)puVar2[4];
        puVar2[2] = puVar2[5];
        *puVar2 = 1;
        goto switchD_004e5270_caseD_1;
      }
      *(uint *)(uVar5 + 0x20) = param_1;
      *(uint *)(uVar5 + 0x1c) = uVar9;
      iVar10 = *(int *)pbVar4;
      *(uint *)(pbVar4 + 4) = local_c;
      *(byte **)pbVar4 = param_2;
      *(byte **)(pbVar4 + 8) = param_2 + (*(int *)(pbVar4 + 8) - iVar10);
      *(undefined1 **)(uVar5 + 0x34) = puVar8;
      param_3 = Compression_InflateDecodeLZ77
                          ((uint)(byte)puVar2[4],(uint)*(byte *)((int)puVar2 + 0x11),puVar2[5],
                           puVar2[6],uVar5,(int *)pbVar4);
      param_2 = *(byte **)pbVar4;
      local_c = *(uint *)(pbVar4 + 4);
      uVar9 = *(uint *)(uVar5 + 0x1c);
      param_1 = *(uint *)(uVar5 + 0x20);
      puVar8 = *(undefined1 **)(uVar5 + 0x34);
      if (puVar8 < *(undefined1 **)(uVar5 + 0x30)) {
        local_10 = *(undefined1 **)(uVar5 + 0x30) + (-1 - (int)puVar8);
      }
      else {
        local_10 = (undefined1 *)(*(int *)(uVar5 + 0x2c) - (int)puVar8);
      }
      if (param_3 == 0) goto LAB_004e531a;
      *puVar2 = (uint)(param_3 != 1) * 2 + 7;
      goto LAB_004e5765;
    case 1:
switchD_004e5270_caseD_1:
      for (; uVar9 < puVar2[3]; uVar9 = uVar9 + 8) {
        if (local_c == 0) goto LAB_004e57ab;
        local_c = local_c - 1;
        param_3 = 0;
        param_1 = param_1 | (uint)*param_2 << ((byte)uVar9 & 0x1f);
        param_2 = param_2 + 1;
      }
      local_14 = (byte *)(puVar2[2] + (*(uint *)(&DAT_005694c0 + puVar2[3] * 4) & param_1) * 8);
      param_1 = param_1 >> (local_14[1] & 0x1f);
      uVar9 = uVar9 - local_14[1];
      bVar1 = *local_14;
      uVar6 = (uint)bVar1;
      if (uVar6 == 0) {
        puVar2[2] = *(uint *)(local_14 + 4);
        *puVar2 = 6;
        goto LAB_004e5765;
      }
      if ((bVar1 & 0x10) != 0) {
        puVar2[2] = uVar6 & 0xf;
        puVar2[1] = *(uint *)(local_14 + 4);
        *puVar2 = 2;
        goto LAB_004e5765;
      }
      if ((bVar1 & 0x40) == 0) goto LAB_004e551e;
      if ((bVar1 & 0x20) != 0) {
        *puVar2 = 7;
        goto LAB_004e5765;
      }
      *puVar2 = 9;
      *(char **)(pbVar4 + 0x18) = "invalid literal/length code";
      goto LAB_004e57dc;
    case 2:
      uVar6 = puVar2[2];
      for (; uVar9 < uVar6; uVar9 = uVar9 + 8) {
        if (local_c == 0) goto LAB_004e57ab;
        local_c = local_c - 1;
        param_3 = 0;
        param_1 = param_1 | (uint)*param_2 << ((byte)uVar9 & 0x1f);
        param_2 = param_2 + 1;
      }
      puVar2[1] = puVar2[1] + (*(uint *)(&DAT_005694c0 + uVar6 * 4) & param_1);
      param_1 = param_1 >> ((byte)uVar6 & 0x1f);
      uVar9 = uVar9 - uVar6;
      puVar2[3] = (uint)*(byte *)((int)puVar2 + 0x11);
      puVar2[2] = puVar2[6];
      *puVar2 = 3;
      break;
    case 3:
      break;
    case 4:
      uVar6 = puVar2[2];
      for (; uVar9 < uVar6; uVar9 = uVar9 + 8) {
        if (local_c == 0) goto LAB_004e57ab;
        local_c = local_c - 1;
        param_3 = 0;
        param_1 = param_1 | (uint)*param_2 << ((byte)uVar9 & 0x1f);
        param_2 = param_2 + 1;
      }
      puVar2[3] = puVar2[3] + (*(uint *)(&DAT_005694c0 + uVar6 * 4) & param_1);
      param_1 = param_1 >> ((byte)uVar6 & 0x1f);
      uVar9 = uVar9 - uVar6;
      *puVar2 = 5;
    case 5:
      if ((uint)((int)puVar8 - *(int *)(uVar5 + 0x28)) < puVar2[3]) {
        iVar10 = (*(int *)(uVar5 + 0x2c) - *(int *)(uVar5 + 0x28)) - puVar2[3];
      }
      else {
        iVar10 = -puVar2[3];
      }
      local_18 = puVar8 + iVar10;
      uVar6 = puVar2[1];
      while (uVar6 != 0) {
        puVar7 = puVar8;
        if (local_10 == (undefined1 *)0x0) {
          if (puVar8 == *(undefined1 **)(uVar5 + 0x2c)) {
            local_10 = *(undefined1 **)(uVar5 + 0x30);
            puVar7 = *(undefined1 **)(uVar5 + 0x28);
            if (local_10 != puVar7) {
              if (puVar7 < local_10) {
                local_10 = local_10 + (-1 - (int)puVar7);
              }
              else {
                local_10 = *(undefined1 **)(uVar5 + 0x2c) + -(int)puVar7;
              }
              puVar8 = puVar7;
              if (local_10 != (undefined1 *)0x0) goto LAB_004e567f;
            }
          }
          *(undefined1 **)(uVar5 + 0x34) = puVar8;
          param_3 = Audio_StopSound(uVar5,(int)pbVar4,param_3);
          puVar7 = *(undefined1 **)(uVar5 + 0x34);
          puVar8 = *(undefined1 **)(uVar5 + 0x30);
          if (puVar7 < puVar8) {
            local_10 = puVar8 + (-1 - (int)puVar7);
          }
          else {
            local_10 = (undefined1 *)(*(int *)(uVar5 + 0x2c) - (int)puVar7);
          }
          if ((puVar7 == *(undefined1 **)(uVar5 + 0x2c)) &&
             (puVar3 = *(undefined1 **)(uVar5 + 0x28), puVar8 != puVar3)) {
            puVar7 = puVar3;
            if (puVar3 < puVar8) {
              local_10 = puVar8 + (-1 - (int)puVar3);
            }
            else {
              local_10 = *(undefined1 **)(uVar5 + 0x2c) + -(int)puVar3;
            }
          }
          if (local_10 == (undefined1 *)0x0) goto LAB_004e57ef;
        }
LAB_004e567f:
        *puVar7 = *local_18;
        puVar8 = puVar7 + 1;
        local_18 = local_18 + 1;
        local_10 = local_10 + -1;
        param_3 = 0;
        if (local_18 == *(undefined1 **)(uVar5 + 0x2c)) {
          local_18 = *(undefined1 **)(uVar5 + 0x28);
        }
        puVar2[1] = puVar2[1] - 1;
        uVar6 = puVar2[1];
      }
LAB_004e575f:
      *puVar2 = 0;
      goto LAB_004e5765;
    case 6:
      puVar7 = puVar8;
      if (local_10 == (undefined1 *)0x0) {
        if (puVar8 == *(undefined1 **)(uVar5 + 0x2c)) {
          local_10 = *(undefined1 **)(uVar5 + 0x30);
          puVar7 = *(undefined1 **)(uVar5 + 0x28);
          if (local_10 != puVar7) {
            if (puVar7 < local_10) {
              local_10 = local_10 + (-1 - (int)puVar7);
            }
            else {
              local_10 = *(undefined1 **)(uVar5 + 0x2c) + -(int)puVar7;
            }
            puVar8 = puVar7;
            if (local_10 != (undefined1 *)0x0) goto LAB_004e5748;
          }
        }
        *(undefined1 **)(uVar5 + 0x34) = puVar8;
        param_3 = Audio_StopSound(uVar5,(int)pbVar4,param_3);
        puVar7 = *(undefined1 **)(uVar5 + 0x34);
        puVar8 = *(undefined1 **)(uVar5 + 0x30);
        if (puVar7 < puVar8) {
          local_10 = puVar8 + (-1 - (int)puVar7);
        }
        else {
          local_10 = (undefined1 *)(*(int *)(uVar5 + 0x2c) - (int)puVar7);
        }
        if ((puVar7 == *(undefined1 **)(uVar5 + 0x2c)) &&
           (puVar3 = *(undefined1 **)(uVar5 + 0x28), puVar8 != puVar3)) {
          puVar7 = puVar3;
          if (puVar3 < puVar8) {
            local_10 = puVar8 + (-1 - (int)puVar3);
          }
          else {
            local_10 = *(undefined1 **)(uVar5 + 0x2c) + -(int)puVar3;
          }
        }
        if (local_10 == (undefined1 *)0x0) {
LAB_004e57ef:
          *(uint *)(uVar5 + 0x20) = param_1;
          *(uint *)(uVar5 + 0x1c) = uVar9;
          *(uint *)(pbVar4 + 4) = local_c;
          puVar8 = puVar7;
          goto LAB_004e57fe;
        }
      }
LAB_004e5748:
      *puVar7 = (char)puVar2[2];
      puVar8 = puVar7 + 1;
      local_10 = local_10 + -1;
      param_3 = 0;
      goto LAB_004e575f;
    case 7:
      if (7 < uVar9) {
        uVar9 = uVar9 - 8;
        local_c = local_c + 1;
        param_2 = param_2 + -1;
      }
      *(undefined1 **)(uVar5 + 0x34) = puVar8;
      iVar10 = Audio_StopSound(uVar5,(int)pbVar4,param_3);
      puVar8 = *(undefined1 **)(uVar5 + 0x34);
      if (*(undefined1 **)(uVar5 + 0x30) != puVar8) {
        *(uint *)(uVar5 + 0x20) = param_1;
        *(uint *)(uVar5 + 0x1c) = uVar9;
        *(uint *)(pbVar4 + 4) = local_c;
        *(byte **)(pbVar4 + 8) = param_2 + (*(int *)(pbVar4 + 8) - *(int *)pbVar4);
        *(byte **)pbVar4 = param_2;
        *(undefined1 **)(uVar5 + 0x34) = puVar8;
        Audio_StopSound(uVar5,(int)pbVar4,iVar10);
        return;
      }
      *puVar2 = 8;
    case 8:
      *(uint *)(uVar5 + 0x20) = param_1;
      *(uint *)(uVar5 + 0x1c) = uVar9;
      *(uint *)(pbVar4 + 4) = local_c;
      iVar10 = 1;
      goto LAB_004e5784;
    case 9:
      iVar10 = -3;
      goto LAB_004e5775;
    }
    for (; uVar9 < puVar2[3]; uVar9 = uVar9 + 8) {
      if (local_c == 0) goto LAB_004e57ab;
      local_c = local_c - 1;
      param_3 = 0;
      param_1 = param_1 | (uint)*param_2 << ((byte)uVar9 & 0x1f);
      param_2 = param_2 + 1;
    }
    local_14 = (byte *)(puVar2[2] + (*(uint *)(&DAT_005694c0 + puVar2[3] * 4) & param_1) * 8);
    param_1 = param_1 >> (local_14[1] & 0x1f);
    bVar1 = *local_14;
    uVar6 = (uint)bVar1;
    uVar9 = uVar9 - local_14[1];
    if ((bVar1 & 0x10) == 0) {
      if ((bVar1 & 0x40) != 0) {
        *puVar2 = 9;
        *(char **)(pbVar4 + 0x18) = "invalid distance code";
LAB_004e57dc:
        *(uint *)(uVar5 + 0x20) = param_1;
        *(uint *)(uVar5 + 0x1c) = uVar9;
        *(uint *)(pbVar4 + 4) = local_c;
        iVar10 = -3;
        goto LAB_004e5784;
      }
LAB_004e551e:
      puVar2[3] = uVar6;
      puVar2[2] = (uint)(local_14 + *(int *)(local_14 + 4) * 8);
    }
    else {
      puVar2[2] = uVar6 & 0xf;
      puVar2[3] = *(uint *)(local_14 + 4);
      *puVar2 = 4;
    }
LAB_004e5765:
    uVar6 = *puVar2;
  }
  iVar10 = -2;
LAB_004e5775:
  *(uint *)(uVar5 + 0x1c) = uVar9;
  *(uint *)(uVar5 + 0x20) = param_1;
  *(uint *)(pbVar4 + 4) = local_c;
LAB_004e5784:
  *(byte **)(pbVar4 + 8) = param_2 + (*(int *)(pbVar4 + 8) - *(int *)pbVar4);
  *(byte **)pbVar4 = param_2;
  *(undefined1 **)(uVar5 + 0x34) = puVar8;
  Audio_StopSound(uVar5,(int)pbVar4,iVar10);
  return;
LAB_004e57ab:
  *(uint *)(uVar5 + 0x20) = param_1;
  *(uint *)(uVar5 + 0x1c) = uVar9;
  pbVar4[4] = 0;
  pbVar4[5] = 0;
  pbVar4[6] = 0;
  pbVar4[7] = 0;
LAB_004e57fe:
  *(byte **)(pbVar4 + 8) = param_2 + (*(int *)(pbVar4 + 8) - *(int *)pbVar4);
  *(byte **)pbVar4 = param_2;
  *(undefined1 **)(uVar5 + 0x34) = puVar8;
  Audio_StopSound(uVar5,(int)pbVar4,param_3);
  return;
}


