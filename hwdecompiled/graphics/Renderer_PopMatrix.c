/*
 * Function: Renderer_PopMatrix
 * Address: 004cc790
 * Category: graphics
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __fastcall Renderer_PopMatrix(uint param_1,byte *param_2,uint param_3,int param_4,uint param_5)

{
  uint uVar1;
  uint uVar2;
  undefined1 *puVar3;
  
  uVar2 = param_5;
  uVar1 = param_3;
  if (((*(char *)(param_3 + 0x218) == '\0') && (param_5 == 0)) || (0x100 < param_5)) {
    if (*(char *)(param_3 + 0x126) != '\x03') {
      CPU_Instruction21(param_1,param_2,param_3,"Invalid number of colors in palette");
      return;
    }
    CPU_Instruction20(param_1,param_2,param_3,"Invalid number of colors in palette");
  }
  *(short *)(uVar1 + 0x118) = (short)uVar2;
  Renderer_SetViewport(uVar1,(byte *)&DAT_00567cf4,uVar2 * 3);
  if (uVar2 != 0) {
    puVar3 = (undefined1 *)(param_4 + 2);
    do {
      param_3._0_3_ = CONCAT12(*puVar3,*(undefined2 *)(puVar3 + -2));
      Renderer_SetProjection(uVar1,(byte *)&param_3,3);
      puVar3 = puVar3 + 3;
      uVar2 = uVar2 - 1;
    } while (uVar2 != 0);
  }
  Renderer_SetModelView(uVar1);
  *(uint *)(uVar1 + 0x68) = *(uint *)(uVar1 + 0x68) | 2;
  return;
}


