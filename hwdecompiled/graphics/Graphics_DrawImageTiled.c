/*
 * Function: Graphics_DrawImageTiled
 * Address: 00475450
 * Category: graphics
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __thiscall
Graphics_DrawImageTiled(void *this,undefined1 *param_1,int *param_2,undefined4 param_3,int *param_4)

{
  uint uVar1;
  uint uVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  int unaff_EBX;
  uint unaff_EDI;
  uint *puVar10;
  ulonglong uVar11;
  ulonglong uVar12;
  undefined4 in_stack_ffffffdc;
  int *piVar13;
  byte *in_stack_ffffffe0;
  int local_14;
  int local_10;
  uint *local_c;
  
  uVar11 = Memory_ValidateHeap(this,param_1,0,0x566184,&Sexy::MemoryImage::RTTI_Type_Descriptor,0,
                               unaff_EDI,unaff_EBX,in_stack_ffffffdc,in_stack_ffffffe0);
  piVar3 = (int *)uVar11;
  if (piVar3 != (int *)0x0) {
                    /* WARNING: Load size is inaccurate */
    piVar13 = piVar3;
    iVar4 = (**(code **)(*this + 100))();
    local_c = (uint *)(iVar4 + (param_2[1] * *(int *)((int)this + 4) + *param_2) * 4);
    iVar5 = (**(code **)(*piVar3 + 100))();
    iVar8 = param_2[2];
    iVar4 = param_2[3];
    uVar6 = SexyWidget_ProcessTexture(param_4,&DAT_005a2378);
    if (((char)uVar6 != '\0') && (local_14 = 0, 0 < iVar4)) {
      do {
        local_10 = 0;
        if (0 < iVar8) {
          uVar11 = Math_FloatToUInt64();
          puVar10 = local_c;
          do {
            iVar4 = piVar3[1];
            uVar12 = Math_FloatToUInt64();
            uVar1 = *(uint *)(iVar5 + (iVar4 * (int)uVar11 + (int)uVar12) * 4);
            uVar2 = *puVar10;
            uVar7 = uVar1 >> 0x18;
            if (uVar7 != 0) {
              iVar8 = (int)((0xff - (uVar2 >> 0x18)) * uVar7) / 0xff + (uVar2 >> 0x18);
              iVar4 = (int)(uVar7 * 0xff) / iVar8;
              iVar9 = 0x100 - iVar4;
              *puVar10 = ((uVar2 & 0xff0000) * iVar9 >> 8) + ((uVar1 & 0xff0000) * iVar4 >> 8) &
                         0xff0000 |
                         ((uVar2 & 0xff) * iVar9 >> 8) + ((uVar1 & 0xff) * iVar4 >> 8) & 0xff |
                         ((uVar2 & 0xff00) * iVar9 >> 8) + ((uVar1 & 0xff00) * iVar4 >> 8) & 0xff00
                         | iVar8 * 0x1000000;
              piVar3 = piVar13;
            }
            iVar8 = param_2[2];
            puVar10 = puVar10 + 1;
            local_10 = local_10 + 1;
          } while (local_10 < iVar8);
        }
        local_c = local_c + *(int *)((int)this + 4);
        local_14 = local_14 + 1;
      } while (local_14 < param_2[3]);
    }
  }
                    /* WARNING: Load size is inaccurate */
  (**(code **)(*this + 0x4c))();
  return;
}


