/*
 * Function: Graphics_DrawPrimitive
 * Address: 004e5040
 * Category: graphics
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


int __cdecl Graphics_DrawPrimitive(int param_1,int param_2)

{
  uint *puVar1;
  int iVar2;
  undefined4 uVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int *piVar10;
  
  iVar8 = param_1;
  iVar7 = *(int *)(param_2 + 0x10);
  puVar1 = (uint *)(param_1 + 4);
  uVar4 = GIF_SetTransparentIndex(puVar1,*(int *)(iVar7 + 0xc));
  if (0 < (int)uVar4) {
    iVar2 = *(int *)(iVar7 + 0x10);
    uVar3 = *(undefined4 *)(iVar7 + 0xc);
    iVar5 = GIF_GetDisposalMethod(*(uint *)(iVar7 + 0x14));
    uVar6 = GIF_SetTransparentIndex(puVar1,iVar5);
    if ((uVar6 != 0xffffffff) && ((int)uVar6 < *(int *)(iVar7 + 0x14))) {
      piVar10 = (int *)(*(int *)(iVar7 + 0x18 + uVar6 * 4) * 0x34 +
                       *(int *)(*(int *)(*(int *)(*(int *)(param_1 + 0x48) + 4) + 0x1c) + 0xc20));
      iVar5 = 0;
      param_1 = 0;
      iVar7 = CPU_ProcessData12(iVar8,*(int *)(param_2 + 8) * 4 + 4);
      if (0 < *(int *)(param_2 + 8)) {
        do {
          iVar8 = GIF_WritePixelData(piVar10,iVar7 + iVar5 * 4,puVar1,*piVar10,-0x18);
          if (iVar8 == -1) {
            return 0;
          }
          iVar5 = iVar5 + *piVar10;
        } while (iVar5 < *(int *)(param_2 + 8));
      }
      iVar8 = 0;
      if (0 < *(int *)(param_2 + 8)) {
        iVar5 = *piVar10;
        do {
          iVar9 = 0;
          if (0 < iVar5) {
            do {
              *(int *)(iVar7 + iVar8 * 4) = *(int *)(iVar7 + iVar8 * 4) + param_1;
              iVar5 = *piVar10;
              iVar9 = iVar9 + 1;
              iVar8 = iVar8 + 1;
            } while (iVar9 < iVar5);
          }
          param_1 = *(int *)(iVar7 + -4 + iVar8 * 4);
        } while (iVar8 < *(int *)(param_2 + 8));
      }
      *(int *)(iVar7 + *(int *)(param_2 + 8) * 4) =
           (int)(iVar2 * uVar4 * 0x10) / ((1 << ((byte)uVar3 & 0x1f)) + -1);
      return iVar7;
    }
  }
  return 0;
}


