/*
 * Function: Graphics_SetRenderState
 * Address: 004e4f00
 * Category: graphics
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


int * __cdecl Graphics_SetRenderState(int param_1,int *param_2,int *param_3)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  void *pvVar4;
  int iVar5;
  uint uVar6;
  
  iVar3 = *(int *)(*(int *)(param_1 + 4) + 0x1c);
  piVar2 = (int *)Assembly_DecompilationFailed(1,0x18);
  piVar2[2] = *param_3;
  iVar3 = *(int *)(iVar3 + *param_2 * 4) / 2;
  *piVar2 = iVar3;
  piVar2[1] = param_3[2];
  piVar2[4] = (int)param_3;
  pvVar4 = _malloc(iVar3 * 4 + 4);
  piVar2[3] = (int)pvVar4;
  param_1 = 0;
  if (0 < *piVar2) {
    do {
      iVar1 = piVar2[1];
      iVar3 = Graphics_ReleaseTexture();
      iVar5 = Graphics_ReleaseTexture();
      iVar3 = ((iVar3 << 0xb) / iVar5) * iVar1 >> 0xb;
      if (iVar1 <= iVar3) {
        iVar3 = iVar1 + -1;
      }
      *(int *)(piVar2[3] + param_1 * 4) = iVar3;
      param_1 = param_1 + 1;
    } while (param_1 < *piVar2);
  }
  *(undefined4 *)(piVar2[3] + param_1 * 4) = 0xffffffff;
  pvVar4 = _malloc(piVar2[1] << 2);
  piVar2[5] = (int)pvVar4;
  iVar3 = 0;
  if (0 < piVar2[1]) {
    param_3 = (int *)0x0;
    do {
      uVar6 = (int)param_3 / piVar2[1] & 0x1ffff;
      if (0x10000 < uVar6) {
        uVar6 = 0x20000 - uVar6;
      }
      *(int *)(piVar2[5] + iVar3 * 4) =
           (int)(*(int *)(&DAT_00544258 + ((int)uVar6 >> 9) * 4) * 0x200 -
                (*(int *)(&DAT_00544258 + ((int)uVar6 >> 9) * 4) -
                *(int *)(&DAT_0054425c + ((int)uVar6 >> 9) * 4)) * (uVar6 & 0x1ff)) >> 9;
      iVar3 = iVar3 + 1;
      param_3 = param_3 + 0x4000;
    } while (iVar3 < piVar2[1]);
  }
  return piVar2;
}


