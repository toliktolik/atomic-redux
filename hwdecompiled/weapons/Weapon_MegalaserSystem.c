/*
 * Function: Weapon_MegalaserSystem
 * Address: 00418770
 * Category: weapons
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall Weapon_MegalaserSystem(void *param_1)

{
  double dVar1;
  double dVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  double *pdVar8;
  float10 fVar9;
  ulonglong uVar10;
  int iVar11;
  int iVar12;
  char cVar13;
  int iVar14;
  int iVar15;
  char cVar16;
  undefined4 uVar17;
  char cVar18;
  undefined4 uVar19;
  int local_10;
  int local_c;
  int local_8;
  
  dVar2 = _DAT_0052c840;
  dVar1 = (double)*(int *)(*(int *)((int)param_1 + 0x5c) + 0x980);
  dVar1 = (_DAT_0052c568 - (dVar1 + dVar1)) + *(double *)((int)param_1 + 0x110);
  *(double *)((int)param_1 + 0x110) = dVar1;
  if (dVar2 < dVar1) {
    *(double *)((int)param_1 + 0x110) = dVar1 - _DAT_0052c840;
  }
  local_10 = 0;
  if (0 < *(int *)(*(int *)((int)param_1 + 0x5c) + 0x980)) {
    local_c = 0;
    local_8 = 0;
    pdVar8 = (double *)((int)param_1 + 0xd8);
    do {
      dVar1 = *pdVar8 - _DAT_0052c838;
      *pdVar8 = dVar1;
      if (dVar1 < _DAT_0052a0c0 != (NAN(dVar1) || NAN(_DAT_0052a0c0))) {
        *(undefined4 *)pdVar8 = 0;
        *(undefined4 *)((int)pdVar8 + 4) = 0;
      }
      iVar3 = local_c;
      if (*(int *)(*(int *)((int)param_1 + 0x5c) + 0x980) == 2) {
        iVar3 = local_8;
      }
      uVar19 = 0x408f4000;
      uVar17 = 0;
      iVar15 = 0;
      iVar14 = 0;
      fVar9 = (float10)fcos(((float10)iVar3 + (float10)*(double *)((int)param_1 + 0x110)) *
                            (float10)_DAT_0052a0d8);
      pdVar8[-2] = (double)(fVar9 * (float10)_DAT_0052a0a8 +
                           (float10)*(double *)((int)param_1 + 0x90));
      fVar9 = (float10)fsin(((float10)iVar3 + (float10)*(double *)((int)param_1 + 0x110)) *
                            (float10)_DAT_0052a0d8);
      pdVar8[-1] = (double)(fVar9 * (float10)_DAT_0052a0b0 + (float10)*(int *)((int)param_1 + 0x98))
      ;
      uVar10 = Math_FloatToUInt64();
      iVar3 = (int)uVar10;
      uVar10 = Math_FloatToUInt64();
      uVar17 = Projectile_HitDetectionSystem
                         (param_1,*(void **)(*(int *)((int)param_1 + 0x5c) + 0x814),(int)uVar10,
                          iVar3,iVar14,iVar15,(double)CONCAT44(uVar19,uVar17));
      if ((char)uVar17 != '\0') {
        *(undefined4 *)pdVar8 = 0;
        *(undefined4 *)((int)pdVar8 + 4) = 0x3ff00000;
        iVar3 = **(int **)((int)param_1 + 0x5c);
        uVar10 = Math_FloatToUInt64();
        (**(code **)(iVar3 + 0xb8))(0x43,(int)uVar10);
      }
      *(undefined4 *)((int)param_1 + 0x1e8) = *(undefined4 *)((int)param_1 + 0x1e4);
      while( true ) {
        iVar14 = 0;
        iVar3 = *(int *)(*(int *)((int)param_1 + 0x1e8) + 4);
        if (iVar3 == 0) break;
        *(int *)((int)param_1 + 0x1e8) = iVar3;
        if (*(int *)((int)param_1 + 0x1f0) != 0) {
          iVar14 = **(int **)((int)param_1 + 0x1e8);
        }
        if (*(char *)(iVar14 + 0x30) != '\0') {
          iVar3 = *(int *)(iVar14 + 0x3c);
          iVar15 = *(int *)(iVar14 + 0x38);
          cVar18 = '\x01';
          cVar16 = '\0';
          uVar10 = Math_FloatToUInt64();
          iVar4 = (int)uVar10;
          uVar10 = Math_FloatToUInt64();
          iVar5 = (int)uVar10;
          iVar14 = *(int *)(iVar14 + 0x34);
          cVar13 = '\0';
          iVar12 = 0;
          iVar11 = 0;
          uVar10 = Math_FloatToUInt64();
          iVar6 = (int)uVar10;
          uVar10 = Math_FloatToUInt64();
          uVar17 = Collision_PixelPerfectDetection
                             (*(void **)(*(int *)((int)param_1 + 0x5c) + 0x814),(int)uVar10,iVar6,
                              iVar11,iVar12,cVar13,iVar14,iVar5,iVar4,iVar15,iVar3,cVar16,cVar18);
          if ((char)uVar17 != '\0') {
            *(undefined4 *)pdVar8 = 0;
            *(undefined4 *)((int)pdVar8 + 4) = 0x3ff00000;
            uVar10 = Math_FloatToUInt64();
            iVar3 = (int)uVar10;
            uVar10 = Math_FloatToUInt64();
            Game_DisplayScoreChange(param_1,10,(int)uVar10,iVar3);
            iVar3 = *(int *)((int)param_1 + 0x1e8);
            if (iVar3 != *(int *)((int)param_1 + 0x1e4)) {
              if (iVar3 == *(int *)((int)param_1 + 0x1ec)) {
                *(undefined4 *)((int)param_1 + 0x1ec) = *(undefined4 *)(iVar3 + 8);
              }
              uVar7 = *(uint *)(iVar3 + 8);
              *(undefined4 *)(uVar7 + 4) = *(undefined4 *)(iVar3 + 4);
              iVar3 = *(int *)(*(int *)((int)param_1 + 0x1e8) + 4);
              if (iVar3 != 0) {
                uVar7 = *(uint *)(*(int *)((int)param_1 + 0x1e8) + 8);
                *(uint *)(iVar3 + 8) = uVar7;
              }
              if (**(int **)((int)param_1 + 0x1e8) == 0) {
                    /* WARNING: Subroutine does not return */
                System_ShutdownHandler(iVar3,uVar7);
              }
                    /* WARNING: Subroutine does not return */
              System_ShutdownHandler(iVar3,uVar7);
            }
            SexyAppFramework_HandleActivation
                      (param_1,*(int *)(pdVar8 + -2),*(int *)((int)pdVar8 + -0xc),
                       *(int *)(pdVar8 + -1),*(int *)((int)pdVar8 + -4),0x32,0x32,0,0,0,0,0.0);
            iVar3 = **(int **)((int)param_1 + 0x5c);
            uVar10 = Math_FloatToUInt64();
            (**(code **)(iVar3 + 0xb8))(0x43,(int)uVar10);
          }
        }
      }
      local_8 = local_8 + 0xb4;
      local_c = local_c + 0x78;
      local_10 = local_10 + 1;
      pdVar8 = pdVar8 + 3;
    } while (local_10 < *(int *)(*(int *)((int)param_1 + 0x5c) + 0x980));
  }
  return;
}


