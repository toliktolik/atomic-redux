/*
 * Function: PowerUp_SpawnRapidFire
 * Address: 00488820
 * Category: weapons
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __fastcall PowerUp_SpawnRapidFire(void *param_1,uint param_2,int param_3,uint param_4)

{
  void *this;
  char cVar1;
  undefined4 *puVar2;
  char ****ppppcVar3;
  undefined4 uVar4;
  undefined1 *this_00;
  _String_base *p_Var5;
  int extraout_ECX;
  undefined4 extraout_ECX_00;
  int extraout_ECX_01;
  int extraout_ECX_02;
  int iVar6;
  undefined4 extraout_ECX_03;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint extraout_EDX_03;
  uint extraout_EDX_04;
  uint extraout_EDX_05;
  void *this_01;
  undefined4 *unaff_ESI;
  int iVar7;
  undefined4 *unaff_EDI;
  uint unaff_retaddr;
  undefined4 in_stack_ffffff44;
  int in_stack_ffffff48;
  _String_base local_94 [28];
  undefined1 local_78 [28];
  _String_base local_5c [28];
  _String_base local_40 [4];
  char ***local_3c [4];
  int local_2c;
  uint local_28;
  undefined1 *local_24;
  int local_20;
  undefined4 *local_1c;
  void *local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00514f34;
  local_10 = ExceptionList;
  local_14 = DAT_00569f5c ^ unaff_retaddr;
  this_01 = (void *)(param_4 + 8);
  local_18 = param_1;
  if (*(int *)(param_4 + 0xc) != 0) {
    ExceptionList = &local_10;
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler((int)param_1,param_2);
  }
  ExceptionList = &local_10;
  *(undefined4 *)(param_4 + 0xc) = 0;
  *(undefined4 *)(param_4 + 0x10) = 0;
  *(undefined4 *)(param_4 + 0x14) = 0;
  param_4 = 0;
  do {
    while( true ) {
      puVar2 = (undefined4 *)0x0;
      iVar6 = *(int *)(param_3 + 0xc);
      if ((iVar6 == 0) || ((uint)(*(int *)(param_3 + 0x10) - iVar6 >> 2) <= param_4))
      goto LAB_00488adb;
      iVar7 = param_4 * 4;
      cVar1 = *(char *)(*(int *)(iVar7 + iVar6) + 4);
      if (cVar1 == '\0') break;
      local_1c = (undefined4 *)operator_new(0x18);
      local_8 = 0;
      if (local_1c != (undefined4 *)0x0) {
        puVar2 = Registry_QueryValue(local_1c);
      }
      local_8 = 0xffffffff;
      local_1c = puVar2;
      SexyFramework_HandleInput(this_01,&local_1c);
      cVar1 = PowerUp_SpawnRapidFire
                        (local_18,extraout_EDX,*(int *)(*(int *)(param_3 + 0xc) + iVar7),
                         (uint)puVar2);
      if (cVar1 == '\0') goto LAB_00488adb;
      param_4 = param_4 + 1;
    }
    local_28 = 0xf;
    local_2c = 0;
    local_3c[0] = (char ***)((uint)local_3c[0] & 0xffffff00);
    PowerUp_ProcessThunderstrike
              (local_40,CONCAT31((int3)((uint)param_3 >> 8),cVar1),
               (_String_base *)(*(int *)(iVar7 + iVar6) + 8),0,0xffffffff);
    this = local_18;
    local_8 = 1;
    iVar6 = extraout_ECX;
    if (local_2c != 0) {
      ppppcVar3 = (char ****)local_3c[0];
      if (local_28 < 0x10) {
        ppppcVar3 = local_3c;
      }
      if (*(char *)ppppcVar3 == '\'') {
LAB_004889fd:
        this_00 = (undefined1 *)operator_new(0x24);
        local_8 = CONCAT31(local_8._1_3_,2);
        local_24 = this_00;
        if (this_00 == (undefined1 *)0x0) {
LAB_00488a32:
          local_1c = (undefined4 *)0x0;
        }
        else {
          local_1c = (undefined4 *)&stack0xffffff44;
          Database_RollbackTransaction((_String_base *)&stack0xffffff44,(uint)local_40);
          local_1c = Database_ExecuteQuery(this_00,in_stack_ffffff44,in_stack_ffffff48);
        }
      }
      else {
        ppppcVar3 = (char ****)local_3c[0];
        if (local_28 < 0x10) {
          ppppcVar3 = local_3c;
        }
        if (*(char *)ppppcVar3 == '\"') goto LAB_004889fd;
        uVar4 = DirectX_FlipBackBuffer((int)local_40);
        if ((char)uVar4 == '\0') {
          Image_LoadFromFile(extraout_ECX_00,(byte *)local_40,local_5c,(int)local_40);
          local_8._0_1_ = 4;
          Database_ReconnectIfNeeded((void *)((int)this + 0x18c),&local_20,local_5c);
          if (local_20 != *(int *)((int)this + 400)) {
            local_1c = (undefined4 *)(**(code **)(**(int **)(local_20 + 0x28) + 4))();
            SexyFramework_HandleInput(this_01,&local_1c);
            String_Destructor((int)local_5c,extraout_EDX_01);
            iVar6 = extraout_ECX_01;
            goto LAB_00488a46;
          }
          p_Var5 = Survival_LoadConfiguration
                             (local_94,(_String_base *)"Unable to Dereference \"",(int)local_40);
          local_8._0_1_ = 5;
          p_Var5 = Intel_DisplayPopulationData
                             (extraout_ECX_03,(uint)local_78,(_String_base *)local_78,p_Var5,
                              (_String_base *)&DAT_005339dc);
          local_8 = CONCAT31(local_8._1_3_,6);
          D3D_SetViewport(this,(int)p_Var5);
          String_Destructor((int)local_78,extraout_EDX_02);
          String_Destructor((int)local_94,extraout_EDX_03);
          String_Destructor((int)local_5c,extraout_EDX_04);
          String_Destructor((int)local_40,extraout_EDX_05);
LAB_00488adb:
          ExceptionList = local_10;
          Exception_SetMessage((void *)(local_14 ^ unaff_retaddr),unaff_EDI,unaff_ESI);
          return;
        }
        puVar2 = (undefined4 *)operator_new(0x24);
        local_8 = CONCAT31(local_8._1_3_,3);
        if (puVar2 == (undefined4 *)0x0) goto LAB_00488a32;
        local_24 = &stack0xffffff44;
        local_1c = puVar2;
        Animation_HandleRareEvents((_String_base *)&stack0xffffff44,extraout_EDX_00,local_40);
        local_1c = Database_ExecuteQuery(puVar2,in_stack_ffffff44,in_stack_ffffff48);
      }
      local_8 = CONCAT31(local_8._1_3_,1);
      SexyFramework_HandleInput(this_01,&local_1c);
      iVar6 = extraout_ECX_02;
    }
LAB_00488a46:
    local_8 = 0xffffffff;
    if (0xf < local_28) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler(iVar6,(uint)local_3c[0]);
    }
    param_4 = param_4 + 1;
    local_28 = 0xf;
    local_2c = 0;
    local_3c[0] = (char ***)((uint)local_3c[0] & 0xffffff00);
  } while( true );
}


