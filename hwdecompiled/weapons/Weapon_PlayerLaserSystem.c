/*
 * Function: Weapon_PlayerLaserSystem
 * Address: 00418a50
 * Category: weapons
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall Weapon_PlayerLaserSystem(void *param_1)

{
  double dVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  int *piVar7;
  float10 fVar8;
  float10 fVar9;
  ulonglong uVar10;
  int iVar11;
  int iVar12;
  char cVar13;
  int iVar14;
  int iVar15;
  undefined8 uVar16;
  double dVar17;
  
  if (0x31 < *(int *)((int)param_1 + 0xb4)) {
    iVar2 = *(int *)((int)param_1 + 0x98) + -0xc;
    iVar3 = *(int *)((int)param_1 + 100);
    if (iVar2 < *(int *)((int)param_1 + 100)) {
      iVar3 = iVar2;
    }
    *(undefined4 *)((int)param_1 + 0x158) = 0;
    *(undefined4 *)((int)param_1 + 0x15c) = 0x40418000;
    fVar9 = (float10)fpatan((float10)(*(int *)((int)param_1 + 0x60) + -0x140) -
                            (float10)*(double *)((int)param_1 + 0x90),
                            (float10)((*(int *)((int)param_1 + 0x98) - iVar3) + -0xc));
    *(double *)((int)param_1 + 0x150) = (double)(fVar9 - (float10)_DAT_0052c530);
    while( true ) {
      fVar9 = (float10)*(double *)((int)param_1 + 0x158) + (float10)_DAT_0052c628;
      fVar8 = (float10)fcos((float10)*(double *)((int)param_1 + 0x150));
      dVar17 = (double)(fVar8 * fVar9 + (float10)*(double *)((int)param_1 + 0x90));
      fVar8 = (float10)fsin((float10)*(double *)((int)param_1 + 0x150));
      *(undefined4 *)((int)param_1 + 0x1f8) = *(undefined4 *)((int)param_1 + 500);
      dVar1 = (double)((float10)(*(int *)((int)param_1 + 0x98) + -0xc) + fVar8 * fVar9);
      while (iVar2 = *(int *)(*(int *)((int)param_1 + 0x1f8) + 4), iVar2 != 0) {
        *(int *)((int)param_1 + 0x1f8) = iVar2;
        if (*(int *)((int)param_1 + 0x200) == 0) {
          piVar7 = (int *)0x0;
        }
        else {
          piVar7 = (int *)**(undefined4 **)((int)param_1 + 0x1f8);
        }
        if (dVar17 < _DAT_0052c850 != (NAN(dVar17) || NAN(_DAT_0052c850))) {
          return;
        }
        if (_DAT_0052c848 < dVar17) {
          return;
        }
        if (dVar1 < _DAT_0052a0c0 != (NAN(dVar1) || NAN(_DAT_0052a0c0))) {
          return;
        }
        if ((char)piVar7[0x12] != '\0') {
          uVar16 = CONCAT44(1,(uint)*(byte *)(piVar7 + 0xc));
          iVar15 = 0;
          uVar10 = Math_FloatToUInt64();
          iVar2 = (int)uVar10;
          uVar10 = Math_FloatToUInt64();
          iVar3 = (int)uVar10;
          uVar10 = Math_FloatToUInt64();
          iVar14 = (int)uVar10;
          iVar4 = Boss_ProcessHeadBustczar((int)piVar7);
          cVar13 = '\0';
          iVar12 = 0;
          iVar11 = 0;
          uVar10 = Math_FloatToUInt64();
          iVar5 = (int)uVar10;
          uVar10 = Math_FloatToUInt64();
          uVar6 = Collision_PixelPerfectDetection
                            (*(void **)(*(int *)((int)param_1 + 0x5c) + 0x6f4),(int)uVar10,iVar5,
                             iVar11,iVar12,cVar13,iVar4,iVar14,iVar3,iVar2,iVar15,(char)uVar16,
                             (char)((ulonglong)uVar16 >> 0x20));
          if ((char)uVar6 != '\0') {
            iVar2 = *(int *)(*(int *)((int)param_1 + 0x5c) + 0x988);
            piVar7[0xd] = 0xff;
            *(double *)(piVar7 + 0x16) = *(double *)(piVar7 + 0x16) - (double)iVar2 * _DAT_0052c590;
            if (*(double *)(piVar7 + 0x16) < _DAT_0052a0c0 ==
                (NAN(*(double *)(piVar7 + 0x16)) || NAN(_DAT_0052a0c0))) {
              return;
            }
            (**(code **)(*piVar7 + 0x10))();
            if (piVar7 == *(int **)((int)param_1 + 0x2e4)) {
              return;
            }
            Boss_BattleshipCannonSystem((int)piVar7);
            return;
          }
        }
      }
      iVar2 = *(int *)((int)param_1 + 0x5c);
      dVar17 = (double)*(int *)(iVar2 + 0x988) * _DAT_0052c668;
      iVar4 = 0;
      iVar14 = 0;
      uVar10 = Math_FloatToUInt64();
      iVar3 = (int)uVar10;
      uVar10 = Math_FloatToUInt64();
      uVar6 = Projectile_HitDetectionSystem
                        (param_1,*(void **)(iVar2 + 0x6f4),(int)uVar10,iVar3,iVar14,iVar4,dVar17);
      if ((char)uVar6 != '\0') break;
      *(double *)((int)param_1 + 0x158) = *(double *)((int)param_1 + 0x158) + _DAT_0052c628;
      if (*(double *)((int)param_1 + 0x158) < _DAT_0052c740 ==
          (NAN(*(double *)((int)param_1 + 0x158)) || NAN(_DAT_0052c740))) {
        return;
      }
    }
  }
  return;
}


