/*
 * Function: Boss_FinalWeaponUpdate
 * Address: 0043aaa0
 * Category: weapons
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall Boss_FinalWeaponUpdate(int param_1)

{
  double dVar1;
  undefined4 uVar2;
  void *pvVar3;
  double dVar4;
  int iVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  uint uVar8;
  double *pdVar9;
  uint extraout_ECX;
  double *extraout_ECX_00;
  double *pdVar10;
  uint extraout_ECX_01;
  double *extraout_ECX_02;
  int extraout_ECX_03;
  int iVar11;
  uint *extraout_EDX;
  double *pdVar12;
  uint *extraout_EDX_00;
  uint uVar13;
  uint extraout_EDX_01;
  double *pdVar14;
  int *piVar15;
  int *piVar16;
  bool bVar17;
  float10 extraout_ST0;
  float10 extraout_ST0_00;
  float10 fVar18;
  float10 fVar19;
  ulonglong uVar20;
  undefined1 local_38 [4];
  int local_34;
  double local_30;
  double local_28;
  undefined4 local_20;
  int iStack_1c;
  double *local_18;
  int *local_14;
  void *local_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_005123a8;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  Boss_ProcessWreckerWarWrecker(param_1);
  if (_DAT_0052f9f0 < *(double *)(param_1 + 0x10)) {
    *(int *)(param_1 + 0xc4) = *(int *)(param_1 + 0xc4) + 1;
  }
  if (((*(int *)(param_1 + 0xc4) % 1000 < 500) || (*(int *)(*(int *)(param_1 + 0x4c) + 0x300) != 0))
     && (0 < *(int *)(param_1 + 0xc0))) {
    dVar1 = *(double *)(param_1 + 0x28) - _DAT_0052c590;
    *(double *)(param_1 + 0x28) = dVar1;
    if (dVar1 < _DAT_0052a0c0 != (NAN(dVar1) || NAN(_DAT_0052a0c0))) {
      *(undefined4 *)(param_1 + 0x2c) = 0;
LAB_0043ab47:
      *(undefined4 *)(param_1 + 0x28) = 0;
    }
  }
  else {
    dVar1 = *(double *)(param_1 + 0x28) + _DAT_0052c590;
    *(double *)(param_1 + 0x28) = dVar1;
    if (_DAT_0052c628 < dVar1) {
      *(undefined4 *)(param_1 + 0x2c) = 0x40140000;
      goto LAB_0043ab47;
    }
  }
  if (*(double *)(param_1 + 0x28) <= _DAT_0052a0c0) {
    *(undefined1 *)(param_1 + 0x48) = 0;
    *(undefined4 *)(param_1 + 0x98) = 0;
  }
  else {
    *(undefined1 *)(param_1 + 0x48) = 1;
    iVar11 = *(int *)(*(int *)(param_1 + 0x50) + 0x414) % 0x3f;
    _local_20 = CONCAT44(iVar11,local_20);
    fcos((float10)iVar11 * (float10)_DAT_0052c5a0);
    uVar20 = Math_FloatToUInt64();
    *(int *)(param_1 + 0x98) = (int)uVar20;
  }
  if (*(int *)(*(int *)(param_1 + 0x50) + 0x414) % 0x32 == 0) {
    iVar11 = Collision_HandleEnemyHit();
    _local_20 = CONCAT44(iVar11 % 400,local_20);
    *(double *)(param_1 + 0x88) = (double)(iVar11 % 400) - _DAT_0052c710;
    iVar11 = Collision_HandleEnemyHit();
    pdVar12 = (double *)(param_1 + 0x3d0);
    _local_20 = CONCAT44(iVar11 % 0x14,local_20);
    *(double *)(param_1 + 0x90) = (double)(iVar11 % 0x14) + _DAT_00530860;
    piVar15 = &DAT_005307f4;
    do {
      iVar11 = Collision_HandleEnemyHit();
      _local_20 = CONCAT44(iVar11 % 0x28,local_20);
      pdVar12[-1] = ((double)(iVar11 % 0x28) - _DAT_0052c5a8) + (double)piVar15[-1];
      iVar11 = Collision_HandleEnemyHit();
      piVar16 = piVar15 + 2;
      _local_20 = CONCAT44(iVar11 % 0x28,local_20);
      *pdVar12 = ((double)(iVar11 % 0x28) - _DAT_0052c5a8) + (double)*piVar15;
      pdVar12 = pdVar12 + 5;
      piVar15 = piVar16;
    } while ((int)piVar16 < 0x530824);
  }
  if ((*(double *)(param_1 + 8) < *(double *)(param_1 + 0x88) !=
       (NAN(*(double *)(param_1 + 8)) || NAN(*(double *)(param_1 + 0x88)))) &&
     (*(double *)(param_1 + 0x18) < _DAT_0052c620 !=
      (NAN(*(double *)(param_1 + 0x18)) || NAN(_DAT_0052c620)))) {
    *(double *)(param_1 + 0x18) = *(double *)(param_1 + 0x18) + _DAT_0052c838;
  }
  if ((*(double *)(param_1 + 0x88) < *(double *)(param_1 + 8)) &&
     (_DAT_00530388 < *(double *)(param_1 + 0x18))) {
    *(double *)(param_1 + 0x18) = *(double *)(param_1 + 0x18) - _DAT_0052c838;
  }
  if ((*(double *)(param_1 + 0x10) < *(double *)(param_1 + 0x90) !=
       (NAN(*(double *)(param_1 + 0x10)) || NAN(*(double *)(param_1 + 0x90)))) &&
     (*(double *)(param_1 + 0x20) < _DAT_0052a0e8 !=
      (NAN(*(double *)(param_1 + 0x20)) || NAN(_DAT_0052a0e8)))) {
    *(double *)(param_1 + 0x20) = *(double *)(param_1 + 0x20) + _DAT_0052c538;
  }
  if ((*(double *)(param_1 + 0x90) < *(double *)(param_1 + 0x10)) &&
     (_DAT_00530380 < *(double *)(param_1 + 0x20))) {
    *(double *)(param_1 + 0x20) = *(double *)(param_1 + 0x20) - _DAT_0052c538;
  }
  pdVar12 = (double *)(param_1 + 0x3d8);
  local_14 = &DAT_005307f4;
  pdVar14 = (double *)(param_1 + 0x140);
  *(double *)(param_1 + 8) = *(double *)(param_1 + 0x18) + *(double *)(param_1 + 8);
  *(double *)(param_1 + 0x10) = *(double *)(param_1 + 0x20) + *(double *)(param_1 + 0x10);
  local_18 = pdVar12;
  do {
    dVar1 = (double)local_14[-1] + local_18[-2] + *(double *)(param_1 + 8);
    dVar4 = (double)*local_14 + local_18[-1] + *(double *)(param_1 + 0x10);
    if ((pdVar14[-1] < dVar1) &&
       (*local_18 < _DAT_0052a0f0 != (NAN(*local_18) || NAN(_DAT_0052a0f0)))) {
      *local_18 = *local_18 + _DAT_0052c538;
    }
    if ((dVar1 < pdVar14[-1] != (NAN(dVar1) || NAN(pdVar14[-1]))) && (_DAT_0052f6b0 < *local_18)) {
      *local_18 = *local_18 - _DAT_0052c538;
    }
    if ((*pdVar14 < dVar4 != (NAN(*pdVar14) || NAN(dVar4))) &&
       (local_18[1] < _DAT_0052a0f0 != (NAN(local_18[1]) || NAN(_DAT_0052a0f0)))) {
      local_18[1] = local_18[1] + _DAT_0052c538;
    }
    if ((dVar4 < *pdVar14) && (_DAT_0052f6b0 < local_18[1])) {
      local_18[1] = local_18[1] - _DAT_0052c538;
    }
    pdVar10 = pdVar14 + -3;
    local_20 = SUB84(dVar4,0);
    iStack_1c = 7;
    pdVar14[-1] = *local_18 + *(double *)(param_1 + 0x18) + pdVar14[-1];
    *pdVar14 = local_18[1] + *(double *)(param_1 + 0x20) + *pdVar14;
    pdVar9 = local_18;
    do {
      local_28 = *pdVar10 - pdVar10[2];
      local_30 = pdVar10[1] - pdVar10[3];
      Math_ProcessFloatPrecision((uint)pdVar9,(uint *)pdVar12);
      Math_ProcessFloatPrecision(extraout_ECX,extraout_EDX);
      uVar20 = Math_FloatToUInt64();
      pdVar12 = (double *)(uVar20 >> 0x20);
      if ((int)uVar20 != 0xc) {
        fVar18 = (float10)_DAT_0052a0d0;
        *pdVar10 = (double)((float10)local_28 * (fVar18 / extraout_ST0) + (float10)pdVar10[2]);
        pdVar10[1] = (double)((float10)local_30 * (fVar18 / extraout_ST0) + (float10)pdVar10[3]);
      }
      pdVar10 = pdVar10 + -2;
      iStack_1c = iStack_1c + -1;
      pdVar9 = extraout_ECX_00;
    } while (iStack_1c != 0);
    local_14 = local_14 + 2;
    local_18 = local_18 + 5;
    pdVar14 = pdVar14 + 0x10;
  } while ((int)local_14 < 0x530824);
  pdVar14 = (double *)(param_1 + 0xd0);
  local_18 = (double *)&DAT_005307f4;
  pdVar10 = extraout_ECX_00;
  do {
    pdVar9 = pdVar14 + 1;
    iStack_1c = 7;
    pdVar14[-1] = (double)*(int *)((int)local_18 + -4) + *(double *)(param_1 + 8);
    *pdVar14 = (double)*(int *)local_18 + *(double *)(param_1 + 0x10);
    do {
      local_30 = *pdVar9 - pdVar9[-2];
      local_28 = pdVar9[1] - pdVar9[-1];
      Math_ProcessFloatPrecision((uint)pdVar10,(uint *)pdVar12);
      Math_ProcessFloatPrecision(extraout_ECX_01,extraout_EDX_00);
      uVar20 = Math_FloatToUInt64();
      pdVar12 = (double *)(uVar20 >> 0x20);
      if ((int)uVar20 != 0xc) {
        fVar18 = (float10)_DAT_0052a0d0;
        *pdVar9 = (double)((float10)local_30 * (fVar18 / extraout_ST0_00) + (float10)pdVar9[-2]);
        pdVar9[1] = (double)((float10)local_28 * (fVar18 / extraout_ST0_00) + (float10)pdVar9[-1]);
      }
      pdVar9 = pdVar9 + 2;
      iStack_1c = iStack_1c + -1;
      pdVar10 = extraout_ECX_02;
    } while (iStack_1c != 0);
    pdVar14 = pdVar14 + 0x10;
    local_18 = local_18 + 1;
  } while ((int)local_18 < 0x530824);
  iVar11 = *(int *)(param_1 + 0x4c);
  if (((*(int *)(iVar11 + 0x80) == 0) &&
      ((NAN(*(double *)(iVar11 + 0x88)) || NAN(_DAT_0052a0c0)) !=
       (*(double *)(iVar11 + 0x88) == _DAT_0052a0c0))) &&
     (*(double *)(param_1 + 0x10) < _DAT_0052f9f0 ==
      (NAN(*(double *)(param_1 + 0x10)) || NAN(_DAT_0052f9f0)))) {
    if (*(int *)(param_1 + 0x9c) != 0) {
      iVar5 = *(int *)(param_1 + 0x9c) + -1;
      goto LAB_0043af86;
    }
  }
  else {
    iVar5 = *(int *)(param_1 + 0xa0);
LAB_0043af86:
    *(int *)(param_1 + 0x9c) = iVar5;
  }
  iVar5 = 0;
  if (*(int *)(param_1 + 0x9c) == 0) {
    if (*(char *)(param_1 + 0x48) != '\0') {
      if (((*(int *)(param_1 + 0x28) == 0) && (*(int *)(param_1 + 0x2c) == 0x40140000)) &&
         (*(int *)(iVar11 + 0x300) == 0)) {
        puVar6 = (undefined4 *)operator_new(0x40);
        iVar11 = *(int *)(param_1 + 0x4c);
        puVar7 = (undefined4 *)operator_new(0xc);
        uVar2 = *(undefined4 *)(iVar11 + 0x1ec);
        puVar7[1] = 0;
        puVar7[2] = uVar2;
        *(undefined4 **)(*(int *)(iVar11 + 0x1ec) + 4) = puVar7;
        *puVar7 = puVar6;
        *(undefined4 **)(iVar11 + 0x1ec) = puVar7;
        *(int *)(iVar11 + 0x1f0) = *(int *)(iVar11 + 0x1f0) + 1;
        *puVar6 = *(undefined4 *)(param_1 + 8);
        puVar6[1] = *(undefined4 *)(param_1 + 0xc);
        puVar6[2] = *(undefined4 *)(param_1 + 0x10);
        puVar6[3] = *(undefined4 *)(param_1 + 0x14);
        iStack_1c = Collision_HandleEnemyHit();
        *(undefined1 *)(puVar6 + 0xc) = 1;
        iStack_1c = iStack_1c % 0x9d;
        puVar6[8] = 0;
        puVar6[9] = 0;
        fVar18 = (float10)iStack_1c * (float10)_DAT_0052c538 + (float10)_DAT_00530858;
        fVar19 = (float10)fcos(fVar18);
        *(double *)(puVar6 + 4) = (double)(fVar19 * (float10)_DAT_00530850);
        fVar18 = (float10)fsin(fVar18);
        *(double *)(puVar6 + 6) = (double)(fVar18 * (float10)_DAT_00530850);
        uVar2 = *(undefined4 *)(*(int *)(*(int *)(param_1 + 0x4c) + 0x5c) + 0x71c);
        puVar6[0xe] = 0;
        puVar6[0xd] = uVar2;
        puVar6[0xf] = 0;
        *(undefined4 *)(param_1 + 0x9c) = *(undefined4 *)(param_1 + 0xa0);
        iVar11 = **(int **)(param_1 + 0x50);
        uVar20 = Math_FloatToUInt64();
        (**(code **)(iVar11 + 0xb8))(0x33,(int)uVar20);
        iVar5 = iStack_1c;
      }
      goto LAB_0043b09f;
    }
LAB_0043b0aa:
    iStack_1c = iVar5;
    if ((*(int *)(param_1 + 0xa8) == -1) && (_DAT_0052f9f0 < *(double *)(param_1 + 0x10))) {
      iVar11 = *(int *)(param_1 + 0x4c);
      if ((*(int *)(iVar11 + 0x80) == 0) &&
         ((NAN(*(double *)(iVar11 + 0x88)) || NAN(_DAT_0052a0c0)) !=
          (*(double *)(iVar11 + 0x88) == _DAT_0052a0c0))) {
        if (*(int *)(param_1 + 0xac) != 0) {
          *(int *)(param_1 + 0xac) = *(int *)(param_1 + 0xac) + -1;
        }
      }
      else {
        *(undefined4 *)(param_1 + 0xac) = *(undefined4 *)(param_1 + 0xb0);
      }
      if ((*(int *)(param_1 + 0xac) == 0) && (*(int *)(iVar11 + 0x300) == 0)) {
        iVar11 = 0;
        uVar13 = 0;
        local_34 = 0;
        local_30 = 0.0;
        local_8 = 0;
        local_18 = (double *)0x0;
        do {
          iVar5 = *(int *)(param_1 + ((int)local_18 * 5 + 0x7d) * 8);
          if ((iVar5 != 0) && (_DAT_0052c658 < *(double *)(iVar5 + 0x10))) {
            Vector_PushBack_4ByteObjects(local_38,&local_18);
            uVar13 = local_30._0_4_;
            iVar11 = local_34;
          }
          local_18 = (double *)((int)local_18 + 1);
        } while ((int)local_18 < 6);
        if (iVar11 != 0) {
          uVar13 = uVar13 - iVar11;
          if ((int)uVar13 >> 2 != 0) {
            uVar8 = Collision_HandleEnemyHit();
            uVar2 = *(undefined4 *)(iVar11 + (uVar8 % (uint)((int)uVar13 >> 2)) * 4);
            *(undefined4 *)(param_1 + 0xac) = *(undefined4 *)(param_1 + 0xb0);
            *(undefined4 *)(param_1 + 0xa8) = uVar2;
            iVar11 = **(int **)(param_1 + 0x50);
            uVar20 = Math_FloatToUInt64();
            (**(code **)(iVar11 + 0xb8))(0x51,(int)uVar20);
                    /* WARNING: Subroutine does not return */
            System_ShutdownHandler(extraout_ECX_03,extraout_EDX_01);
          }
        }
        local_8 = 0xffffffff;
        if (iVar11 != 0) {
                    /* WARNING: Subroutine does not return */
          System_ShutdownHandler((int)local_18,uVar13);
        }
      }
    }
  }
  else {
LAB_0043b09f:
    iStack_1c = iVar5;
    iVar5 = iStack_1c;
    if (*(char *)(param_1 + 0x48) == '\0') goto LAB_0043b0aa;
  }
  if (-1 < *(int *)(param_1 + 0xa8)) {
    dVar1 = *(double *)(*(int *)(param_1 + 0x4c) + 0x88);
    if ((NAN(dVar1) || NAN(_DAT_0052a0c0)) == (dVar1 == _DAT_0052a0c0)) {
      *(undefined4 *)(param_1 + 0xa8) = 0xffffffff;
      *(undefined4 *)(param_1 + 0xb4) = 0;
      *(undefined4 *)(param_1 + 0xb8) = 0;
      *(undefined4 *)(param_1 + 0xbc) = 0;
    }
    else if (*(double *)(param_1 + 0xb8) < _DAT_0052a0b8 !=
             (NAN(*(double *)(param_1 + 0xb8)) || NAN(_DAT_0052a0b8))) {
      iVar11 = *(int *)(param_1 + 0xb4);
      bVar17 = iVar11 == 0;
      if (!bVar17) goto LAB_0043b2bc;
      dVar1 = *(double *)(param_1 + 0xb8) + _DAT_0052c5c0;
      *(double *)(param_1 + 0xb8) = dVar1;
      if (_DAT_0052a0b8 <= dVar1) {
        *(undefined4 *)(param_1 + 0xb8) = 0;
        *(undefined4 *)(param_1 + 0xbc) = 0x406fe000;
        *(undefined4 *)(param_1 + 0xb4) = 0x32;
        iVar11 = **(int **)(param_1 + 0x50);
        uVar20 = Math_FloatToUInt64();
        (**(code **)(iVar11 + 0xb8))(0x50,(int)uVar20);
      }
    }
  }
  iVar11 = *(int *)(param_1 + 0xb4);
  bVar17 = iVar11 == 0;
LAB_0043b2bc:
  if (!bVar17 && -1 < iVar11) {
    pvVar3 = *(void **)(param_1 + 0x4c);
    if (((*(int *)((int)pvVar3 + 0x80) == 0) &&
        (iVar11 = *(int *)(param_1 + (*(int *)(param_1 + 0xa8) + 0x19) * 0x28),
        *(double *)(iVar11 + 8) < *(double *)((int)pvVar3 + 0x90) + _DAT_0052a0b0)) &&
       (dVar4 = *(double *)((int)pvVar3 + 0x90) - _DAT_0052a0b0, dVar1 = *(double *)(iVar11 + 8),
       dVar4 < dVar1 != (NAN(dVar4) || NAN(dVar1)))) {
      Particles_UpdateFire(pvVar3);
    }
    iVar11 = *(int *)(param_1 + 0xb4) + -1;
    *(int *)(param_1 + 0xb4) = iVar11;
    if (iVar11 == 0) {
      *(undefined4 *)(param_1 + 0xb8) = 0;
      *(undefined4 *)(param_1 + 0xbc) = 0;
      *(undefined4 *)(param_1 + 0xa8) = 0xffffffff;
    }
  }
  ExceptionList = local_10;
  return;
}


