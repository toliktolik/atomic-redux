/*
 * Function: Projectile_HitDetectionSystem
 * Address: 00417390
 * Category: weapons
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

uint __thiscall
Projectile_HitDetectionSystem
          (void *param_1,void *param_2,int param_3,int param_4,int param_5,int param_6,
          double param_7)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  int iVar5;
  ulonglong uVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  double dVar10;
  undefined8 uVar11;
  char cVar12;
  char cVar13;
  undefined4 uVar14;
  
  if ((*(int *)((int)param_1 + 0x80) != 0) &&
     (param_2 == *(void **)(*(uint *)((int)param_1 + 0x5c) + 0x6cc))) {
    return *(uint *)((int)param_1 + 0x5c) & 0xffffff00;
  }
  *(undefined4 *)((int)param_1 + 0x218) = *(undefined4 *)((int)param_1 + 0x214);
  do {
    do {
      iVar5 = *(int *)(*(int *)((int)param_1 + 0x218) + 4);
      if (iVar5 == 0) {
        return 0;
      }
      *(int *)((int)param_1 + 0x218) = iVar5;
      if (*(int *)((int)param_1 + 0x220) == 0) {
        iVar5 = 0;
      }
      else {
        iVar5 = **(int **)((int)param_1 + 0x218);
      }
    } while (((*(char *)(iVar5 + 0x41) == '\0') || (*(char *)(iVar5 + 0x54) == '\0')) ||
            (*(char *)(iVar5 + 0x55) != '\0'));
    cVar12 = *(char *)(iVar5 + 0x40);
    cVar13 = '\x01';
    iVar8 = 0;
    uVar6 = Math_FloatToUInt64();
    iVar1 = (int)uVar6;
    uVar6 = Math_FloatToUInt64();
    iVar7 = (int)uVar6;
    uVar6 = Math_FloatToUInt64();
    iVar4 = (int)uVar6;
    iVar2 = String_Compare(iVar5);
    uVar3 = Collision_PixelPerfectDetection
                      (param_2,param_3,param_4,param_5,param_6,*(char *)(iVar5 + 0x40),iVar2,iVar4,
                       iVar7,iVar1,iVar8,cVar12,cVar13);
  } while ((char)uVar3 == '\0');
  dVar10 = *(double *)(iVar5 + 0x48) - param_7;
  *(undefined4 *)(iVar5 + 0x50) = 0xff;
  *(double *)(iVar5 + 0x48) = dVar10;
  if (dVar10 < _DAT_0052a0c0 != (NAN(dVar10) || NAN(_DAT_0052a0c0))) {
    uVar6 = Math_FloatToUInt64();
    iVar1 = (int)uVar6;
    uVar6 = Math_FloatToUInt64();
    Game_DisplayScoreChange(param_1,*(int *)(iVar5 + 8),(int)uVar6,iVar1);
    dVar10 = *(double *)(iVar5 + 0x28) - _DAT_0052a0e8;
    iVar1 = *(int *)(iVar5 + 0x24);
    iVar7 = *(int *)(iVar5 + 0x20);
    uVar14 = 0;
    uVar3 = 0;
    iVar4 = Level_InitializePetrovakia(*(int *)(iVar5 + 0x5c));
    iVar4 = iVar4 + 0x28;
    iVar2 = SexyWidget_GetTextureId(*(int *)(iVar5 + 0x5c));
    SexyAppFramework_HandleActivation
              (param_1,*(int *)(iVar5 + 0x10),*(int *)(iVar5 + 0x14),*(int *)(iVar5 + 0x18),
               *(int *)(iVar5 + 0x1c),iVar2 + 0x28,iVar4,iVar7,iVar1,SUB84(dVar10,0),
               (int)((ulonglong)dVar10 >> 0x20),(double)CONCAT44(uVar14,uVar3));
    String_ToLowerCase(iVar5);
    *(int *)(*(int *)((int)param_1 + 0x5c) + 0xb10) =
         *(int *)(*(int *)((int)param_1 + 0x5c) + 0xb10) + 1;
    iVar5 = *(int *)((int)param_1 + 0x330) + 1;
    *(int *)((int)param_1 + 0x330) = iVar5;
    return CONCAT31((int3)((uint)iVar5 >> 8),1);
  }
  (**(code **)(**(int **)((int)param_1 + 0x5c) + 0xb8))(9,param_3 * 3);
  iVar1 = *(int *)((int)param_1 + 0x5c);
  uVar11 = 0xffffffff00000001;
  iVar9 = 0x1e;
  iVar8 = 0x40080000;
  iVar2 = 0;
  iVar4 = 0x3fa99999;
  iVar7 = -0x66666666;
  uVar14 = 0x40000000;
  uVar3 = 0;
  uVar6 = Math_FloatToUInt64();
  uVar3 = ParticleEffects_CreateParticles
                    ((int)param_1 + 0x2e8,*(int *)(iVar1 + 0x6e0),SUB84((double)param_3,0),
                     (int)((ulonglong)(double)param_3 >> 0x20),SUB84((double)param_4,0),
                     (int)((ulonglong)(double)param_4 >> 0x20),*(double *)(iVar5 + 0x20),
                     *(double *)(iVar5 + 0x28),(int)uVar6,(double)CONCAT44(uVar14,uVar3),iVar7,iVar4
                     ,iVar2,iVar8,iVar9,(char)uVar11,(int)((ulonglong)uVar11 >> 0x20));
  return CONCAT31((int3)((uint)uVar3 >> 8),1);
}


