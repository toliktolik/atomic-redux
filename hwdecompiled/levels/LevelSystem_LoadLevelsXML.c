/*
 * Function: LevelSystem_LoadLevelsXML
 * Address: 0040a8b0
 * Category: levels
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void LevelSystem_LoadLevelsXML(void)

{
  char cVar1;
  undefined4 *puVar2;
  char *pcVar3;
  _String_base *p_Var4;
  int iVar5;
  char *pcVar6;
  int extraout_ECX;
  int extraout_ECX_00;
  int extraout_ECX_01;
  undefined4 *extraout_ECX_02;
  undefined2 extraout_DX;
  uint extraout_EDX;
  char *extraout_EDX_00;
  char *pcVar7;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint extraout_EDX_03;
  uint extraout_EDX_04;
  uint uVar8;
  uint extraout_EDX_05;
  uint extraout_EDX_06;
  char *extraout_EDX_07;
  char *extraout_EDX_08;
  char *extraout_EDX_09;
  byte ****ppppbVar9;
  byte *pbVar10;
  bool bVar11;
  bool bVar12;
  uint unaff_retaddr;
  undefined4 *in_stack_fffffed4;
  undefined4 *in_stack_fffffed8;
  byte ***local_108 [4];
  char *local_f8;
  uint local_f4;
  undefined1 local_d4 [24];
  _String_base local_bc [4];
  uint local_b8;
  undefined4 local_a8;
  uint local_a4;
  undefined1 local_a0 [4];
  uint local_9c;
  undefined4 local_8c;
  uint local_88;
  _String_base local_84 [4];
  uint local_80;
  undefined4 local_70;
  uint local_6c;
  _String_base local_68 [4];
  undefined1 local_64;
  undefined4 local_54;
  undefined4 local_50;
  undefined1 local_4c [4];
  uint local_48;
  int local_44;
  undefined4 local_40;
  long local_3c;
  undefined1 local_38 [4];
  uint local_34;
  undefined4 local_24;
  uint local_20;
  int local_1c;
  undefined4 *local_18;
  uint local_14;
  void *local_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0050fbc4;
  local_10 = ExceptionList;
  local_14 = DAT_00569f5c ^ unaff_retaddr;
  ExceptionList = &local_10;
  local_18 = (undefined4 *)operator_new(0x74);
  local_8 = 0;
  if (local_18 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    puVar2 = (undefined4 *)ObjectType1_Constructor(local_18);
  }
  local_8 = 0xffffffff;
  local_20 = 0xf;
  local_24 = 0;
  local_34 = local_34 & 0xffffff00;
  pcVar7 = "data\\levels.xml";
  do {
    pcVar6 = pcVar7;
    pcVar7 = pcVar6 + 1;
  } while (*pcVar6 != '\0');
  local_18 = puVar2;
  String_Assign(local_38,(_String_base *)"data\\levels.xml",(uint)(pcVar6 + -0x52a530));
  local_8 = 1;
  Image_UpdateTexture((int)puVar2,extraout_DX,(int)local_38);
  local_8 = 0xffffffff;
  if (0xf < local_20) {
                    /* WARNING: Subroutine does not return */
    System_ShutdownHandler(local_34,extraout_EDX);
  }
  WeaponBomb_ProcessBurstingRocket((int)&stack0xfffffed4);
  local_50 = 0xf;
  local_54 = 0;
  local_64 = 0;
  local_48 = 0;
  local_44 = 0;
  local_40 = 0;
  local_6c = 0xf;
  local_70 = 0;
  local_80 = local_80 & 0xffffff00;
  local_8 = 5;
  cVar1 = XML_ParseDocument((int)puVar2,(uint)&stack0xfffffed4,(int *)&stack0xfffffed4);
  pcVar7 = extraout_EDX_00;
  puVar2 = local_18;
  do {
    local_18 = puVar2;
    if (cVar1 == '\0') {
      if (puVar2 != (undefined4 *)0x0) {
        (**(code **)*puVar2)(1);
        puVar2 = extraout_ECX_02;
        pcVar7 = extraout_EDX_09;
      }
      if (0xf < local_6c) {
                    /* WARNING: Subroutine does not return */
        System_ShutdownHandler((int)puVar2,(uint)pcVar7);
      }
      local_6c = 0xf;
      local_70 = 0;
      local_80 = local_80 & 0xffffff00;
      ComplexObject_Destructor((int)local_68,(uint)pcVar7);
      local_8 = 0xffffffff;
      PowerUp_ProcessNuke((int)&stack0xfffffed4);
      ExceptionList = local_10;
      Exception_SetMessage((void *)(local_14 ^ unaff_retaddr),in_stack_fffffed4,in_stack_fffffed8);
      return;
    }
    if (in_stack_fffffed4 == (undefined4 *)0x1) {
      pcVar7 = "evel";
      pcVar6 = "Level";
      do {
        pcVar3 = pcVar6;
        pcVar6 = pcVar3 + 1;
      } while (*pcVar3 != '\0');
      pcVar3 = pcVar3 + -0x52a528;
      if (local_f8 != (char *)0x0) {
        pcVar6 = local_f8;
        if (pcVar3 <= local_f8) {
          pcVar6 = pcVar3;
        }
        ppppbVar9 = (byte ****)local_108[0];
        if (local_f4 < 0x10) {
          ppppbVar9 = local_108;
        }
        bVar11 = false;
        pcVar7 = (char *)0x0;
        bVar12 = true;
        pbVar10 = (byte *)"Level";
        do {
          if (pcVar6 == (char *)0x0) break;
          pcVar6 = pcVar6 + -1;
          bVar11 = *(byte *)ppppbVar9 < *pbVar10;
          bVar12 = *(byte *)ppppbVar9 == *pbVar10;
          ppppbVar9 = (byte ****)((int)ppppbVar9 + 1);
          pbVar10 = pbVar10 + 1;
        } while (bVar12);
        if (!bVar12) {
          pcVar7 = (char *)((1 - (uint)bVar11) - (uint)(bVar11 != 0));
        }
        if (pcVar7 != (char *)0x0) goto LAB_0040ad29;
      }
      if ((pcVar3 <= local_f8) &&
         (pcVar7 = (char *)(uint)(local_f8 != pcVar3), pcVar7 == (char *)0x0)) {
        if (local_48 != 0) {
          Background_ProcessGroundLayer(local_44,(uint)local_4c,local_48,local_44);
                    /* WARNING: Subroutine does not return */
          System_ShutdownHandler(extraout_ECX,local_48);
        }
        local_48 = 0;
        local_44 = 0;
        local_40 = 0;
        local_a4 = 0xf;
        local_a8 = 0;
        local_b8 = local_b8 & 0xffffff00;
        pcVar7 = "name";
        do {
          pcVar6 = pcVar7;
          pcVar7 = pcVar6 + 1;
        } while (*pcVar6 != '\0');
        String_Assign(local_bc,(_String_base *)&DAT_0052a4f0,(uint)(pcVar6 + -0x52a4f0));
        local_8._0_1_ = 6;
        p_Var4 = (_String_base *)StringMap_LookupAndConcatenate(local_d4,extraout_EDX_01,local_bc);
        PowerUp_ProcessThunderstrike(local_68,extraout_EDX_02,p_Var4,0,0xffffffff);
        local_8._0_1_ = 5;
        if (0xf < local_a4) {
                    /* WARNING: Subroutine does not return */
          System_ShutdownHandler(local_b8,extraout_EDX_03);
        }
        local_a4 = 0xf;
        local_a8 = 0;
        local_b8 = local_b8 & 0xffffff00;
        local_20 = 0xf;
        local_24 = 0;
        local_34 = local_34 & 0xffffff00;
        pcVar7 = "length";
        do {
          pcVar6 = pcVar7;
          pcVar7 = pcVar6 + 1;
        } while (*pcVar6 != '\0');
        String_Assign(local_38,(_String_base *)"length",(uint)(pcVar6 + -0x52a520));
        local_8._0_1_ = 7;
        iVar5 = StringMap_LookupAndConcatenate(local_d4,(uint)local_38,(_String_base *)local_38);
        if (*(uint *)(iVar5 + 0x18) < 0x10) {
          pcVar7 = (char *)(iVar5 + 4);
        }
        else {
          pcVar7 = *(char **)(iVar5 + 4);
        }
        local_3c = _atol(pcVar7);
        local_8 = CONCAT31(local_8._1_3_,5);
        if (0xf < local_20) {
                    /* WARNING: Subroutine does not return */
          System_ShutdownHandler(extraout_ECX_00,extraout_EDX_04);
        }
        local_20 = 0xf;
        local_24 = 0;
        local_34 = local_34 & 0xffffff00;
        cVar1 = XML_ParseDocument((int)local_18,extraout_EDX_04,(int *)&stack0xfffffed4);
        while (cVar1 != '\0') {
          if (in_stack_fffffed4 == (undefined4 *)0x1) {
            pcVar7 = "Intel";
            do {
              pcVar6 = pcVar7;
              pcVar7 = pcVar6 + 1;
            } while (*pcVar6 != '\0');
            pcVar6 = pcVar6 + -0x52a518;
            if (local_f8 == (char *)0x0) {
LAB_0040abe2:
              if (local_f8 < pcVar6) goto LAB_0040ad00;
              uVar8 = (uint)(local_f8 != pcVar6);
            }
            else {
              pcVar7 = local_f8;
              if (pcVar6 <= local_f8) {
                pcVar7 = pcVar6;
              }
              ppppbVar9 = (byte ****)local_108[0];
              if (local_f4 < 0x10) {
                ppppbVar9 = local_108;
              }
              bVar11 = false;
              uVar8 = 0;
              bVar12 = true;
              pbVar10 = (byte *)"Intel";
              do {
                if (pcVar7 == (char *)0x0) break;
                pcVar7 = pcVar7 + -1;
                bVar11 = *(byte *)ppppbVar9 < *pbVar10;
                bVar12 = *(byte *)ppppbVar9 == *pbVar10;
                ppppbVar9 = (byte ****)((int)ppppbVar9 + 1);
                pbVar10 = pbVar10 + 1;
              } while (bVar12);
              if (!bVar12) {
                uVar8 = (1 - (uint)bVar11) - (uint)(bVar11 != 0);
              }
              if (uVar8 == 0) goto LAB_0040abe2;
            }
            if (uVar8 == 0) {
              local_88 = 0xf;
              local_8c = 0;
              local_9c = local_9c & 0xffffff00;
              pcVar7 = "text";
              do {
                pcVar6 = pcVar7;
                pcVar7 = pcVar6 + 1;
              } while (*pcVar6 != '\0');
              String_Assign(local_a0,(_String_base *)&DAT_0052a510,(uint)(pcVar6 + -0x52a510));
              local_8._0_1_ = 8;
              p_Var4 = (_String_base *)
                       StringMap_LookupAndConcatenate
                                 (local_d4,(uint)local_a0,(_String_base *)local_a0);
              PowerUp_ProcessThunderstrike(local_84,extraout_EDX_05,p_Var4,0,0xffffffff);
              local_8 = CONCAT31(local_8._1_3_,5);
              if (0xf < local_88) {
                    /* WARNING: Subroutine does not return */
                System_ShutdownHandler(extraout_ECX_01,extraout_EDX_06);
              }
              local_88 = 0xf;
              local_8c = 0;
              local_9c = local_9c & 0xffffff00;
              Craft_ProcessCruise(local_4c,(uint)local_84);
            }
          }
          else if (in_stack_fffffed4 == (undefined4 *)0x2) {
            pcVar7 = "Level";
            do {
              pcVar6 = pcVar7;
              pcVar7 = pcVar6 + 1;
            } while (*pcVar6 != '\0');
            pcVar6 = pcVar6 + -0x52a528;
            if (local_f8 != (char *)0x0) {
              pcVar7 = local_f8;
              if (pcVar6 <= local_f8) {
                pcVar7 = pcVar6;
              }
              ppppbVar9 = (byte ****)local_108[0];
              if (local_f4 < 0x10) {
                ppppbVar9 = local_108;
              }
              bVar11 = false;
              iVar5 = 0;
              bVar12 = true;
              pbVar10 = (byte *)"Level";
              do {
                if (pcVar7 == (char *)0x0) break;
                pcVar7 = pcVar7 + -1;
                bVar11 = *(byte *)ppppbVar9 < *pbVar10;
                bVar12 = *(byte *)ppppbVar9 == *pbVar10;
                ppppbVar9 = (byte ****)((int)ppppbVar9 + 1);
                pbVar10 = pbVar10 + 1;
              } while (bVar12);
              if (!bVar12) {
                iVar5 = (1 - (uint)bVar11) - (uint)(bVar11 != 0);
              }
              if (iVar5 != 0) goto LAB_0040ad00;
            }
            if ((pcVar6 <= local_f8) && (local_f8 == pcVar6)) break;
          }
LAB_0040ad00:
          cVar1 = XML_ParseDocument((int)local_18,(uint)&stack0xfffffed4,(int *)&stack0xfffffed4);
        }
        Survival_ProcessWaveSequence((void *)(local_1c + 0x1458),(uint)local_68);
        pcVar7 = extraout_EDX_07;
      }
    }
LAB_0040ad29:
    cVar1 = XML_ParseDocument((int)local_18,(uint)pcVar7,(int *)&stack0xfffffed4);
    pcVar7 = extraout_EDX_08;
    puVar2 = local_18;
  } while( true );
}


