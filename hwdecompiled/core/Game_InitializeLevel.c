/*
 * Function: Game_InitializeLevel
 * Address: 004184b0
 * Category: core
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __thiscall Game_InitializeLevel(void *this,void *param_1)

{
  char *pcVar1;
  void *pvVar2;
  char *pcVar3;
  undefined4 ***pppuVar4;
  int iVar5;
  int extraout_ECX;
  uint extraout_EDX;
  uint extraout_EDX_00;
  undefined4 in_stack_fffffef0;
  uint in_stack_fffffef4;
  undefined4 in_stack_fffffef8;
  undefined4 in_stack_fffffefc;
  undefined4 in_stack_ffffff00;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined1 local_b8 [8];
  int local_b0;
  undefined1 local_ac [64];
  undefined4 local_6c;
  undefined **local_64 [13];
  undefined1 local_30 [4];
  undefined4 **local_2c [4];
  uint local_1c;
  uint local_18;
  undefined1 *local_14;
  void *local_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_00510664;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  Algorithm_CountIf(this,param_1);
  SexyWidget_GetColor(param_1,*(int **)((int)this + 0x304));
  (**(code **)(**(int **)(*(int *)((int)this + 0x5c) + 0x330) + 0x24))();
  (**(code **)(**(int **)(*(int *)((int)this + 0x5c) + 0x330) + 0x1c))();
  uVar7 = 0;
  (**(code **)(**(int **)((int)this + 0x5c) + 0xb8))();
  if (*(char *)((int)this + 0x327) == '\0') {
    ComplexObject_VirtualTableConstructor(local_b8,3,1);
    local_8 = 1;
    uVar6 = 0x4185d5;
    pvVar2 = (void *)Memory_GarbageCollection(&local_b0,"MISSION ");
    Stream_LocaleAwareProcessor(pvVar2,uVar7);
    pvVar2 = operator_new(0x78);
    local_8._0_1_ = 2;
    if (pvVar2 != (void *)0x0) {
      local_14 = &stack0xfffffef8;
      StringBuffer_ExtractionWrapper(local_b8,(_String_base *)&stack0xfffffef8);
      DataStructure_InitializeBinaryTree
                (pvVar2,(uint)this,*(int **)(*(int *)((int)this + 0x5c) + 0x924),in_stack_fffffef8,
                 in_stack_fffffefc);
    }
    local_8._0_1_ = 1;
    local_18 = 0xf;
    local_1c = 0;
    local_2c[0] = (undefined4 **)((uint)local_2c[0] & 0xffffff00);
    pcVar1 = "";
    do {
      pcVar3 = pcVar1;
      pcVar1 = pcVar3 + 1;
    } while (*pcVar3 != '\0');
    String_Assign(local_30,(_String_base *)&DAT_0052c7cf,(uint)(pcVar3 + -0x52c7cf));
    local_8._0_1_ = 3;
    SexyAppFramework_InitializeDirectX((int)local_ac,extraout_EDX);
    pppuVar4 = (undefined4 ***)local_2c[0];
    if (local_18 < 0x10) {
      pppuVar4 = local_2c;
    }
    Audio_ProcessPowerUpSounds(local_ac,pppuVar4,local_1c,local_6c);
    local_8._0_1_ = 1;
    if (0xf < local_18) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler(extraout_ECX,extraout_EDX_00);
    }
    local_18 = 0xf;
    local_1c = 0;
    local_2c[0] = (undefined4 **)((uint)local_2c[0] & 0xffffff00);
    iVar5 = GetBossIndex(*(void **)((int)this + 0x5c),
                         *(int *)((int)*(void **)((int)this + 0x5c) + 0x960));
    Memory_HeapManager(&local_b0,iVar5 * 0x30 + *(int *)(*(int *)((int)this + 0x5c) + 0x145c));
    pvVar2 = operator_new(0x78);
    local_8 = CONCAT31(local_8._1_3_,4);
    if (pvVar2 != (void *)0x0) {
      local_14 = &stack0xffffff00;
      StringBuffer_ExtractionWrapper(local_b8,(_String_base *)&stack0xffffff00);
      DataStructure_InitializeBinaryTree
                (pvVar2,(uint)this,*(int **)(*(int *)((int)this + 0x5c) + 0x928),in_stack_ffffff00,
                 uVar6);
    }
    local_8 = 0xffffffff;
    ComplexObject_DestructorWithVTables((int)local_64);
    local_64[0] = &PTR_IOSBase_DestructorWrapper_00531324;
    IOStream_RefCountDestructor((ios_base *)local_64);
  }
  else {
    pvVar2 = operator_new(0x78);
    local_8 = 0;
    if (pvVar2 != (void *)0x0) {
      local_14 = &stack0xfffffef0;
      in_stack_fffffef4 = in_stack_fffffef4 & 0xffffff00;
      pcVar1 = "SURVIVAL MODE";
      do {
        pcVar3 = pcVar1;
        pcVar1 = pcVar3 + 1;
      } while (*pcVar3 != '\0');
      String_Assign(&stack0xfffffef0,(_String_base *)"SURVIVAL MODE",(uint)(pcVar3 + -0x52c828));
      DataStructure_InitializeBinaryTree
                (pvVar2,(uint)this,*(int **)(*(int *)((int)this + 0x5c) + 0x924),in_stack_fffffef0,
                 in_stack_fffffef4);
    }
    local_8 = 0xffffffff;
  }
  if ((*(char *)((int)this + 0x20) == '\0') &&
     (*(undefined1 *)((int)this + 0x325) = 1, *(char *)(*(int *)((int)this + 0x5c) + 0x454) == '\0')
     ) {
    Projectile_CreateAndFire((int)this);
  }
  ExceptionList = local_10;
  return;
}


