/*
 * Function: GameEngine_Run
 * Address: 004515a0
 * Category: core
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __fastcall GameEngine_Run(int *param_1,undefined4 param_2)

{
  void *this;
  DWORD DVar1;
  undefined8 uVar2;
  undefined4 *in_stack_fffffef4;
  undefined4 *in_stack_fffffef8;
  
  this = DAT_00569f5c;
  if (*(char *)((int)param_1 + 0x2fd) == '\0') {
    uVar2 = Threading_CreateEvent((int)param_1,param_2);
    if ((char)param_1[0x11f] != '\0') {
      Threading_DestroyMutex((int)param_1,(int)((ulonglong)uVar2 >> 0x20));
    }
    ShowWindow((HWND)param_1[0xc3],5);
    SetFocus((HWND)param_1[0xc3]);
    timeBeginPeriod(1);
    DVar1 = timeGetTime();
    *(undefined1 *)((int)param_1 + 0x451) = 1;
    param_1[0x101] = DVar1;
    param_1[0x102] = DVar1;
    param_1[0xec] = DVar1;
    (**(code **)(*param_1 + 0x60))(0xffffffff);
    GameEngine_MainLoop((int)param_1);
    *(undefined1 *)((int)param_1 + 0x451) = 0;
    Registry_EnumerateValues((int)param_1);
    timeGetTime();
    Exception_Release(&stack0xfffffef4,"Seconds       = %g\r\n");
    OutputDebugStringA(&stack0xfffffef4);
    Exception_Release(&stack0xfffffef4,"Sleep Count   = %d\r\n");
    OutputDebugStringA(&stack0xfffffef4);
    Exception_Release(&stack0xfffffef4,"Update Count  = %d\r\n");
    OutputDebugStringA(&stack0xfffffef4);
    Exception_Release(&stack0xfffffef4,"Draw Count    = %d\r\n");
    OutputDebugStringA(&stack0xfffffef4);
    Exception_Release(&stack0xfffffef4,"Draw Time     = %d\r\n");
    OutputDebugStringA(&stack0xfffffef4);
    Exception_Release(&stack0xfffffef4,"Screen Blt    = %d\r\n");
    OutputDebugStringA(&stack0xfffffef4);
    if (0 < param_1[0x11e] + param_1[0x116]) {
      Exception_Release(&stack0xfffffef4,"Avg FPS       = %d\r\n");
      OutputDebugStringA(&stack0xfffffef4);
    }
    timeEndPeriod(1);
    (**(code **)(*param_1 + 0x4c))();
    (**(code **)(*param_1 + 0x54))();
  }
  Exception_SetMessage(this,in_stack_fffffef4,in_stack_fffffef8);
  return;
}


