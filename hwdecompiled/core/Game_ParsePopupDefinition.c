/*
 * Function: Game_ParsePopupDefinition
 * Address: 004acb00
 * Category: core
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


void __fastcall
Game_ParsePopupDefinition(int param_1,uint param_2,_String_base *param_3,undefined1 param_4)

{
  undefined1 uVar1;
  char *pcVar2;
  bool bVar3;
  uint uVar4;
  uint uVar5;
  _String_base *p_Var6;
  int iVar7;
  int iVar8;
  char *pcVar9;
  char ******ppppppcVar10;
  long lVar11;
  int *piVar12;
  undefined4 *puVar13;
  int extraout_ECX;
  int extraout_ECX_00;
  int extraout_ECX_01;
  int extraout_ECX_02;
  int extraout_ECX_03;
  int extraout_ECX_04;
  _String_base *p_Var14;
  int extraout_ECX_05;
  uint extraout_ECX_06;
  undefined2 extraout_DX;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint extraout_EDX_03;
  uint extraout_EDX_04;
  uint extraout_EDX_05;
  uint extraout_EDX_06;
  uint extraout_EDX_07;
  _String_base *extraout_EDX_08;
  uint extraout_EDX_09;
  uint extraout_EDX_10;
  uint extraout_EDX_11;
  void *this;
  undefined8 uVar15;
  uint unaff_retaddr;
  undefined4 *in_stack_ffffff18;
  undefined4 *in_stack_ffffff1c;
  uint local_d0;
  int local_cc;
  long local_c8;
  long local_c4;
  undefined1 local_c0 [4];
  undefined4 local_bc;
  int local_b8;
  undefined1 local_b4;
  undefined1 local_b3;
  undefined1 local_b2;
  undefined1 local_b1;
  _String_base local_b0 [4];
  undefined1 local_ac;
  undefined4 local_9c;
  undefined4 local_98;
  _String_base local_94 [4];
  undefined1 local_90;
  undefined4 local_80;
  undefined4 local_7c;
  _String_base local_78 [4];
  uint local_74;
  undefined4 local_64;
  uint local_60;
  int local_5c;
  _String_base local_58 [4];
  uint local_54;
  uint local_44;
  uint local_40;
  int local_3c;
  int local_38;
  _String_base local_34 [4];
  char *****local_30 [4];
  uint local_20;
  uint local_1c;
  int local_18;
  uint local_14;
  void *local_10;
  undefined4 uStack_c;
  undefined4 local_8;
  
  local_8._0_1_ = 0xff;
  local_8._1_3_ = 0xffffff;
  uStack_c = 0x5165bc;
  local_10 = ExceptionList;
  local_14 = DAT_00569f5c ^ unaff_retaddr;
  local_38 = param_1;
  if (*(int *)(param_3 + 0x14) != 0) {
    local_40 = 0xf;
    local_44 = 0;
    local_54 = local_54 & 0xffffff00;
    ExceptionList = &local_10;
    PowerUp_ProcessThunderstrike(local_58,param_2,param_3,0,0xffffffff);
    local_8 = 0;
    local_cc = 0;
    local_bc = Memory_CleanupPool();
    local_b8 = 0;
    local_b2 = 0;
    local_b1 = 0;
    local_98 = 0xf;
    local_9c = 0;
    local_ac = 0;
    local_7c = 0xf;
    local_80 = 0;
    local_90 = 0;
    local_b4 = 0;
    local_b3 = 0;
    local_18 = 0;
    local_3c = 0;
    local_1c = 0xf;
    local_20 = 0;
    local_30[0] = (char *****)((uint)local_30[0] & 0xffffff00);
    local_8._0_1_ = 2;
    param_3 = (_String_base *)CONCAT13(0x20,param_3._0_3_);
    uVar4 = Collision_HandlePowerUpPickup(local_58,(void *)((int)&param_3 + 3),0,1);
    param_3 = (_String_base *)CONCAT13(0x20,param_3._0_3_);
    uVar5 = UI_Widget_ResetTransform(local_58,(char *)((int)&param_3 + 3),uVar4 + 1,1);
    if ((uVar5 == 0xffffffff) || (uVar4 == 0xffffffff)) {
      if (0xf < local_1c) {
                    /* WARNING: Subroutine does not return */
        System_ShutdownHandler(extraout_ECX,extraout_EDX);
      }
      local_1c = 0xf;
      local_20 = 0;
      local_30[0] = (char *****)((uint)local_30[0] & 0xffffff00);
      Input_ProcessEvents((int)&local_cc,extraout_EDX);
      uVar4 = extraout_EDX_11;
      uVar5 = local_54;
    }
    else {
      p_Var6 = GameMenu_ProcessRegistrationScreen
                         (local_58,(_String_base *)&stack0xffffff18,uVar4,uVar5 - uVar4);
      local_8._0_1_ = 3;
      uVar15 = Image_CreateSurface(local_78,(int)p_Var6);
      local_8._0_1_ = 4;
      PowerUp_ProcessThunderstrike
                (local_34,(uint)((ulonglong)uVar15 >> 0x20),(_String_base *)uVar15,0,0xffffffff);
      if (0xf < local_60) {
                    /* WARNING: Subroutine does not return */
        System_ShutdownHandler(extraout_ECX_00,extraout_EDX_00);
      }
      local_60 = 0xf;
      local_64 = 0;
      local_74 = local_74 & 0xffffff00;
      local_8._0_1_ = 2;
      if (0xf < local_d0) {
                    /* WARNING: Subroutine does not return */
        System_ShutdownHandler((int)in_stack_ffffff1c,extraout_EDX_00);
      }
      bVar3 = String_EqualsCharArray(local_34,(_String_base *)"popup");
      iVar8 = extraout_ECX_01;
      if ((bVar3) ||
         (iVar7 = Windows_SetWindowPos(extraout_ECX_01,extraout_DX), iVar8 = extraout_ECX_02,
         iVar7 != 0)) {
        local_cc = 1;
      }
      else {
        bVar3 = String_EqualsCharArray(local_34,(_String_base *)&DAT_0053639c);
        if (!bVar3) {
          String_Destructor((int)local_34,extraout_EDX_01);
          Input_ProcessEvents((int)&local_cc,extraout_EDX_02);
          String_Destructor((int)local_58,extraout_EDX_03);
          goto LAB_004ad078;
        }
        local_cc = 2;
        iVar8 = extraout_ECX_03;
      }
      ppppppcVar10 = (char ******)local_30[0];
      if (local_1c < 0x10) {
        ppppppcVar10 = local_30;
      }
      iVar8 = Windows_SetWindowPos(iVar8,(short)*(char *)ppppppcVar10);
      if (iVar8 == 0) {
        p_Var6 = GameMenu_ProcessRegistrationScreen
                           (local_58,(_String_base *)&stack0xffffff18,uVar5 + 1,0xffffffff);
        local_8._0_1_ = 5;
        PowerUp_ProcessThunderstrike(local_58,extraout_EDX_04,p_Var6,0,0xffffffff);
        local_8._0_1_ = 2;
        String_Destructor((int)&stack0xffffff18,extraout_EDX_05);
      }
      while (local_44 != 0) {
        param_3 = (_String_base *)CONCAT13(0x20,param_3._0_3_);
        uVar4 = UI_Widget_ResetTransform(local_58,(char *)((int)&param_3 + 3),0,1);
        if (uVar4 == 0xffffffff) {
          uVar4 = local_44;
        }
        p_Var6 = GameMenu_ProcessRegistrationScreen(local_58,local_78,0,uVar4);
        local_8._0_1_ = 6;
        PowerUp_ProcessThunderstrike(local_34,extraout_EDX_06,p_Var6,0,0xffffffff);
        local_8._0_1_ = 2;
        if (0xf < local_60) {
                    /* WARNING: Subroutine does not return */
          System_ShutdownHandler(extraout_ECX_04,extraout_EDX_07);
        }
        local_60 = 0xf;
        local_64 = 0;
        local_74 = local_74 & 0xffffff00;
        pcVar2 = "|";
        do {
          pcVar9 = pcVar2;
          pcVar2 = pcVar9 + 1;
        } while (*pcVar9 != '\0');
        uVar5 = String_Compare(local_34,0,local_20,(_String_base *)&DAT_00536398,
                               (uint)(pcVar9 + -0x536398));
        if (uVar5 == 0) {
          local_3c = local_3c + 1;
          local_18 = 0;
        }
        else {
          if (local_3c == 0) {
            if (local_cc == 1) {
              if (local_18 == 0) {
                ppppppcVar10 = (char ******)local_30[0];
                if (local_1c < 0x10) {
                  ppppppcVar10 = local_30;
                }
                local_c8 = _atol((char *)ppppppcVar10);
              }
              else if (local_18 == 1) {
                ppppppcVar10 = (char ******)local_30[0];
                if (local_1c < 0x10) {
                  ppppppcVar10 = local_30;
                }
                local_c4 = _atol((char *)ppppppcVar10);
              }
            }
            else if (local_cc == 2) {
              if (local_18 == 0) {
                p_Var14 = local_b0;
                p_Var6 = extraout_EDX_08;
              }
              else {
                if (local_18 != 1) goto LAB_004acf7d;
                p_Var6 = local_34;
                p_Var14 = local_94;
              }
              PowerUp_ProcessThunderstrike(p_Var14,(uint)p_Var6,local_34,0,0xffffffff);
            }
          }
          else if (local_3c == 1) {
            List_InsertSorted(local_c0,local_34);
            this = (void *)(local_38 + 0x52c);
            if (*(undefined4 **)(local_38 + 0x530) == (undefined4 *)0x0) {
              piVar12 = (int *)0x0;
            }
            else {
              piVar12 = (int *)**(undefined4 **)(local_38 + 0x530);
            }
            Collision_ProjectShape(&local_5c,piVar12,*(int **)(local_38 + 0x530),(int)local_34);
            if (local_5c == *(int *)(local_38 + 0x530)) {
              List_InsertSorted(this,local_34);
            }
            if (local_b8 == 1) {
              local_b3 = 1;
              puVar13 = Math_NormalizeVector(local_38 + 0x520,(int)&local_cc);
              if (puVar13 == (undefined4 *)0x0) {
                local_b1 = param_4;
              }
              else {
                local_b3 = *(undefined1 *)((int)puVar13 + 0x19);
                local_b2 = *(undefined1 *)((int)puVar13 + 0x1a);
                local_b1 = *(undefined1 *)((int)puVar13 + 0x1b);
              }
            }
          }
          else if (local_3c == 2) {
            if (local_18 == 0) {
              ppppppcVar10 = (char ******)local_30[0];
              if (local_1c < 0x10) {
                ppppppcVar10 = local_30;
              }
              lVar11 = _atol((char *)ppppppcVar10);
              local_b3 = lVar11 != 0;
            }
            else if (local_18 == 1) {
              ppppppcVar10 = (char ******)local_30[0];
              if (local_1c < 0x10) {
                ppppppcVar10 = local_30;
              }
              lVar11 = _atol((char *)ppppppcVar10);
              local_b2 = lVar11 != 0;
            }
          }
LAB_004acf7d:
          local_18 = local_18 + 1;
        }
        if ((int)local_44 <= (int)(uVar4 + 1)) break;
        p_Var6 = GameMenu_ProcessRegistrationScreen
                           (local_58,(_String_base *)&stack0xffffff18,uVar4 + 1,0xffffffff);
        local_8._0_1_ = 7;
        PowerUp_ProcessThunderstrike(local_58,extraout_EDX_09,p_Var6,0,0xffffffff);
        local_8._0_1_ = 2;
        uVar1 = (undefined1)local_8;
        local_8._0_1_ = 2;
        if (0xf < local_d0) {
                    /* WARNING: Subroutine does not return */
          System_ShutdownHandler(extraout_ECX_05,(uint)in_stack_ffffff1c);
        }
        local_d0 = 0xf;
        in_stack_ffffff1c = (undefined4 *)((uint)in_stack_ffffff1c & 0xffffff00);
        local_8._0_1_ = uVar1;
      }
      STL_List_PushBack((void *)(local_38 + 0x514),&local_cc);
      if (0xf < local_1c) {
                    /* WARNING: Subroutine does not return */
        System_ShutdownHandler((int)local_30[0],extraout_EDX_10);
      }
      local_1c = 0xf;
      local_20 = 0;
      local_30[0] = (char *****)((uint)local_30[0] & 0xffffff00);
      Input_ProcessEvents((int)&local_cc,extraout_EDX_10);
      uVar4 = local_54;
      uVar5 = extraout_ECX_06;
    }
    if (0xf < local_40) {
                    /* WARNING: Subroutine does not return */
      System_ShutdownHandler(uVar5,uVar4);
    }
  }
LAB_004ad078:
  ExceptionList = local_10;
  Exception_SetMessage((void *)(local_14 ^ unaff_retaddr),in_stack_ffffff18,in_stack_ffffff1c);
  return;
}


