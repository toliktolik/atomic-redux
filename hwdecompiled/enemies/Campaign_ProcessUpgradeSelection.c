/*
 * Function: Campaign_ProcessUpgradeSelection
 * Address: 0041ddd0
 * Category: enemies
 * Generated by Ghidra Bulk Exporter
 */

#include "../heavy_weapon_deluxe.h"


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __thiscall Campaign_ProcessUpgradeSelection(void *this,void *param_1)

{
  double dVar1;
  void *this_00;
  undefined4 *puVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  ulonglong uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  undefined1 local_4c [16];
  undefined1 local_3c [16];
  undefined1 local_2c [16];
  undefined1 local_1c [8];
  double local_14;
  int local_c;
  int local_8;
  
  this_00 = param_1;
  DrawSprite(*(void **)(*(int *)((int)this + 0x5c) + 0x894),param_1,0,0,'\0',0,0,'\0');
  puVar2 = (undefined4 *)SexyWidget_ApplyMatrix(local_1c,0,0,0);
  SexyWidget_SetRectangle(param_1,puVar2);
  Polygon_Rasterize(param_1,(int)this + 0x70,0x10,'\0');
  param_1 = (void *)0x0;
  local_c = 0;
  local_8 = 0;
  do {
    if (*(int *)((int)this + 0xf4) == 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = *(int *)((int)this + 0xf8) - *(int *)((int)this + 0xf4) >> 5;
    }
    if (iVar3 <= local_c) {
      dVar1 = (double)(int)param_1 + *(double *)((int)this + 0x68);
      if (dVar1 < _DAT_0052a0c0 != (NAN(dVar1) || NAN(_DAT_0052a0c0))) {
        *(undefined4 *)((int)this + 0x68) = 0;
        *(undefined4 *)((int)this + 0x6c) = 0x407fe000;
      }
      return;
    }
    local_14 = (double)(int)param_1;
    uVar6 = Math_FloatToUInt64();
    uVar5 = (int)(uint)uVar6 >> 0x1f;
    iVar3 = (((uint)uVar6 ^ uVar5) - uVar5) * -2 + 0x1ef;
    if (0xff < iVar3) {
      iVar3 = 0xff;
    }
    puVar2 = (undefined4 *)CreateColor(local_2c,0xff,0xff,0xff,iVar3);
    SexyWidget_SetRectangle(this_00,puVar2);
    iVar4 = *(int *)(local_8 + 0x1c + *(int *)((int)this + 0xf4));
    if (iVar4 == 0) {
      dVar1 = local_14 + *(double *)((int)this + 0x68);
      if ((_DAT_0052a0c0 < dVar1) && (dVar1 < _DAT_0052cd50 != (NAN(dVar1) || NAN(_DAT_0052cd50))))
      {
        SexyWidget_Translate(this_00,-0x55,0);
        Graphics_SetProjection(this_00,*(undefined4 *)(*(int *)((int)this + 0x5c) + 0x928));
                    /* WARNING: Load size is inaccurate */
        iVar3 = *this;
        iVar4 = *(int *)((int)this + 0xf4) + local_8;
        uVar6 = Math_FloatToUInt64();
        (**(code **)(iVar3 + 0x90))(local_3c,this_00,(int)uVar6,iVar4);
        SexyWidget_Translate(this_00,0x55,0);
      }
      iVar3 = (**(code **)(**(int **)(*(int *)((int)this + 0x5c) + 0x928) + 0x10))();
      param_1 = (void *)((int)param_1 + iVar3 * 2);
    }
    else if (iVar4 == 1) {
      dVar1 = local_14 + *(double *)((int)this + 0x68);
      if ((_DAT_0052a0c0 < dVar1) && (dVar1 < _DAT_0052cd50 != (NAN(dVar1) || NAN(_DAT_0052cd50))))
      {
        puVar2 = (undefined4 *)CreateColor(local_4c,0xff,0xff,0,iVar3);
        SexyWidget_SetRectangle(this_00,puVar2);
        Graphics_SetProjection(this_00,*(undefined4 *)(*(int *)((int)this + 0x5c) + 0x92c));
                    /* WARNING: Load size is inaccurate */
        iVar3 = *this;
        uVar11 = 0xffffffff;
        uVar10 = 0;
        uVar9 = 1;
        uVar8 = 0xffffffff;
        uVar7 = 0xffffffff;
        uVar6 = Math_FloatToUInt64();
        (**(code **)(iVar3 + 0x94))
                  (this_00,*(int *)((int)this + 0xf4) + local_8,0xf,(int)uVar6,uVar7,uVar8,uVar9,
                   uVar10,uVar11);
      }
    }
    else {
      if (iVar4 == 2) {
        dVar1 = local_14 + *(double *)((int)this + 0x68);
        if ((_DAT_0052a0c0 < dVar1) && (dVar1 < _DAT_0052cd50 != (NAN(dVar1) || NAN(_DAT_0052cd50)))
           ) {
          Graphics_SetProjection(this_00,*(undefined4 *)(*(int *)((int)this + 0x5c) + 0x92c));
                    /* WARNING: Load size is inaccurate */
          iVar3 = *this;
          uVar11 = 0xffffffff;
          uVar10 = 0;
          uVar9 = 1;
          uVar8 = 0xffffffff;
          uVar7 = 0xffffffff;
          uVar6 = Math_FloatToUInt64();
          (**(code **)(iVar3 + 0x94))
                    (this_00,*(int *)((int)this + 0xf4) + local_8,0xb9,(int)uVar6,uVar7,uVar8,uVar9,
                     uVar10,uVar11);
        }
      }
      else if (iVar4 != 3) goto LAB_0041e056;
      iVar3 = (**(code **)(**(int **)(*(int *)((int)this + 0x5c) + 0x92c) + 0x10))();
      param_1 = (void *)((int)param_1 + iVar3);
    }
LAB_0041e056:
    local_c = local_c + 1;
    local_8 = local_8 + 0x20;
  } while( true );
}


